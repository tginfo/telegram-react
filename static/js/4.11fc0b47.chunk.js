(this.webpackJsonptelegram_react=this.webpackJsonptelegram_react||[]).push([[4],Array(278).concat([function(e,t,a){"use strict";var n=a(7),s=a.n(n),i=a(11),o=a(17),r=a(281),c=a(14),l=a(2);class d extends o.a{constructor(){var e;super(),e=this,this.reset=()=>{this.callbacks=[],this.db=null,this.urls=new WeakMap,this.dataUrls=new Map,this.items=new Map,this.blobItems=new Map,this.locationItems=new Map,this.downloads=new Map,this.uploads=new Map},this.onUpdate=function(){var t=Object(i.a)(s.a.mark((function t(a){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=a["@type"],t.next="updateAuthorizationState"===t.t0?3:"updateFile"===t.t0?6:10;break;case 3:return t.next=5,e.onUpdateAuthorizationState(a);case 5:return t.abrupt("break",11);case 6:return e.set(a.file),e.onUpdateFile(a),e.emit(a["@type"],a),t.abrupt("break",11);case 10:return t.abrupt("break",11);case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.onClientUpdate=e=>{switch(e["@type"]){case"clientUpdateAudioThumbnailBlob":case"clientUpdateAudioBlob":case"clientUpdateDocumentBlob":case"clientUpdateSendFiles":this.emit(e["@type"],e)}},this.addTdLibListener=()=>{l.a.on("update",this.onUpdate),l.a.on("clientUpdate",this.onClientUpdate)},this.removeTdLibListener=()=>{l.a.off("update",this.onUpdate),l.a.off("clientUpdate",this.onClientUpdate)},this.onUpdateAuthorizationState=function(){var t=Object(i.a)(s.a.mark((function t(a){var n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a){t.next=2;break}return t.abrupt("return");case 2:if(n=a.authorization_state){t.next=5;break}return t.abrupt("return");case 5:t.t0=n["@type"],t.next="authorizationStateWaitTdlibParameters"===t.t0?8:"authorizationStateClosed"===t.t0?11:13;break;case 8:return t.next=10,e.initDB();case 10:return t.abrupt("break",13);case 11:return e.reset(),t.abrupt("break",13);case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.onUpdateFile=e=>{if(!e)return;const t=e.file;t&&(this.handleDownloads(t),this.handleUploads(t))},this.handleDownloads=e=>{const t=e.arr,a=e.id,n=(e.idb_key,e.local);if(delete e.arr,!this.downloads.has(a))return;if(!n.is_downloading_completed)return;const s=this.downloads.get(a);if(!s)return;this.downloads.delete(a);const i=this.getStore();s.forEach(a=>{switch(a["@type"]){case"animation":this.handleAnimation(i,a,e,t,null);break;case"audio":this.handleAudio(i,a,e,t,null);break;case"chat":this.handleChat(i,a,e,t);break;case"document":this.handleDocument(i,a,e,t,null);break;case"game":this.handleGame(i,a,e,t,null);break;case"location":this.handleLocation(i,a,e,t,null);break;case"message":this.handleMessage(i,a,e,t);break;case"pageBlockMap":this.handlePageBlockMap(i,a,e,t,null);break;case"photo":this.handlePhoto(i,a,e,t,null);break;case"sticker":this.handleSticker(i,a,e,t,null);break;case"video":this.handleVideo(i,a,e,t,null);break;case"videoNote":this.handleVideoNote(i,a,e,t,null);break;case"voiceNote":this.handleVoiceNote(i,a,e,t,null);break;case"user":this.handleUser(i,a,e,t);break;default:console.error("FileStore.onUpdateFile unhandled item",a)}})},this.handleUploads=e=>{const t=e.id,a=e.remote;delete e.arr,this.uploads.has(t)&&(a.is_uploading_completed||this.uploads.delete(t))},this.handleChat=(e,t,a,n)=>{t&&this.getLocalFile(e,a,n,()=>this.updateChatPhotoBlob(t.id,a.id),()=>this.getRemoteFile(a.id,c.g,t))},this.handleUser=(e,t,a,n)=>{t&&this.getLocalFile(e,a,n,()=>this.updateUserPhotoBlob(t.id,a.id),()=>this.getRemoteFile(a.id,c.g,t))},this.handleMessage=(e,t,a,n)=>{if(!t)return;const s=t.content;if(s)switch(s["@type"]){case"messageAnimation":{const i=s.animation;this.handleAnimation(e,i,a,n,t);break}case"messageAudio":{const i=s.audio;this.handleAudio(e,i,a,n,t);break}case"messageChatChangePhoto":{const i=s.photo;this.handlePhoto(e,i,a,n,t);break}case"messageDocument":{const i=s.document;this.handleDocument(e,i,a,n,t);break}case"messageGame":{const i=s.game;this.handleGame(e,i,a,n,t);break}case"messageLocation":{const i=s.location;this.handleLocation(e,i,a,n,t);break}case"messagePhoto":{const i=s.photo;this.handlePhoto(e,i,a,n,t);break}case"messageSticker":{const i=s.sticker;this.handleSticker(e,i,a,n,t);break}case"messageText":{const i=s.web_page;if(!i)break;const o=i.animation,r=i.audio,c=i.document,l=i.photo,d=i.sticker,h=i.video,u=i.video_note,p=i.voice_note;o&&this.handleAnimation(e,o,a,n,t),r&&this.handleAudio(e,r,a,n,t),c&&this.handleDocument(e,c,a,n,t),l&&this.handlePhoto(e,l,a,n,t),d&&this.handleSticker(e,d,a,n,t),h&&this.handleVideo(e,h,a,n,t),p&&this.handleVoiceNote(e,p,a,n,t),u&&this.handleVideoNote(e,u,a,n,t);break}case"messageVenue":{const i=s.venue.location;this.handleLocation(e,i,a,n,t);break}case"messageVideo":{const i=s.video;this.handleVideo(e,i,a,n,t);break}case"messageVideoNote":{const i=s.video_note;this.handleVideoNote(e,i,a,n,t);break}case"messageVoiceNote":{const i=s.voice_note;this.handleVoiceNote(e,i,a,n,t);break}}},this.handleAnimation=(e,t,a,n,s)=>{const i=s?s.chat_id:0,o=s?s.id:0;if(t.thumbnail){const r=t.thumbnail.photo;r&&r.id===a.id&&this.getLocalFile(e,r,n,()=>this.updateAnimationThumbnailBlob(i,o,a.id),()=>this.getRemoteFile(a.id,c.ob,s||t))}if(t.animation){const r=t.animation;r&&r.id===a.id&&this.getLocalFile(e,r,n,()=>this.updateAnimationBlob(i,o,a.id),()=>this.getRemoteFile(a.id,c.g,s||t))}},this.handleAudio=(e,t,a,n,s)=>{const i=s?s.chat_id:0,o=s?s.id:0;if(t.album_cover_thumbnail){const r=t.album_cover_thumbnail.photo;r&&r.id===a.id&&this.getLocalFile(e,r,n,()=>this.updateAudioThumbnailBlob(i,o,a.id),()=>this.getRemoteFile(a.id,c.ob,s||t))}if(t.audio){const r=t.audio;r&&r.id===a.id&&this.getLocalFile(e,r,n,()=>this.updateAudioBlob(i,o,a.id),()=>this.getRemoteFile(a.id,c.g,s||t))}},this.handleGame=(e,t,a,n,s)=>{if(!t)return;const i=t.animation,o=t.photo;o&&this.handlePhoto(e,o,a,n,s),i&&this.handleAnimation(e,i,a,n,s)},this.handleDocument=(e,t,a,n,s)=>{const i=s?s.chat_id:0,o=s?s.id:0;if(t.thumbnail){const r=t.thumbnail.photo;r&&r.id===a.id&&this.getLocalFile(e,r,n,()=>this.updateDocumentThumbnailBlob(i,o,a.id),()=>this.getRemoteFile(a.id,c.ob,s||t))}if(t.document){const r=t.document;r&&r.id===a.id&&this.getLocalFile(e,r,n,()=>this.updateDocumentBlob(i,o,a.id),()=>this.getRemoteFile(a.id,c.g,s||t))}},this.handleLocation=(e,t,a,n,s)=>{const i=s?s.chat_id:0,o=s?s.id:0,l=Object(r.o)(t);if(l){const r=this.getLocationFile(l);r&&r.id===a.id&&this.getLocalFile(e,r,n,()=>this.updateLocationBlob(i,o,a.id),()=>this.getRemoteFile(a.id,c.ob,s||t))}},this.handlePageBlockMap=(e,t,a,n,s)=>{const i=s?s.chat_id:0,o=s?s.id:0,l=t.location,d=Object(r.o)(l,c.i,c.h);if(d){const r=this.getLocationFile(d);r&&r.id===a.id&&this.getLocalFile(e,r,n,()=>this.updateLocationBlob(i,o,a.id),()=>this.getRemoteFile(a.id,c.ob,s||t))}},this.handlePhoto=(e,t,a,n,s)=>{const i=s?s.chat_id:0,o=s?s.id:0;if(t)for(let r=0;r<t.sizes.length;r++){const l=t.sizes[r];if(l){const r=l.photo;if(r&&r.id===a.id){this.getLocalFile(e,r,n,()=>this.updatePhotoBlob(i,o,a.id),()=>this.getRemoteFile(a.id,c.g,s||t));break}}}},this.handleSticker=(e,t,a,n,s)=>{const i=s?s.chat_id:0,o=s?s.id:0;if(t.thumbnail){const r=t.thumbnail.photo;r&&r.id===a.id&&this.getLocalFile(e,r,n,()=>this.updateStickerThumbnailBlob(i,o,a.id),()=>this.getRemoteFile(a.id,c.ob,s||t))}if(t.sticker){const r=t.sticker;r&&r.id===a.id&&this.getLocalFile(e,r,n,()=>this.updateStickerBlob(i,o,a.id),()=>this.getRemoteFile(a.id,c.g,s||t))}},this.handleVoiceNote=(e,t,a,n,s)=>{const i=s?s.chat_id:0,o=s?s.id:0;if(t.voice){const r=t.voice;r&&r.id===a.id&&this.getLocalFile(e,r,n,()=>this.updateVoiceNoteBlob(i,o,a.id),()=>this.getRemoteFile(a.id,c.g,s||t))}},this.handleVideoNote=(e,t,a,n,s)=>{const i=s?s.chat_id:0,o=s?s.id:0;if(t.thumbnail){const r=t.thumbnail.photo;r&&r.id===a.id&&this.getLocalFile(e,r,n,()=>this.updateVideoNoteThumbnailBlob(i,o,a.id),()=>this.getRemoteFile(a.id,c.ob,s||t))}if(t.video){const r=t.video;r&&r.id===a.id&&this.getLocalFile(e,r,n,()=>this.updateVideoNoteBlob(i,o,a.id),()=>this.getRemoteFile(a.id,c.g,s||t))}},this.handleVideo=(e,t,a,n,s)=>{const i=s?s.chat_id:0,o=s?s.id:0;if(t.thumbnail){const r=t.thumbnail.photo;r&&r.id===a.id&&this.getLocalFile(e,r,n,()=>this.updateVideoThumbnailBlob(i,o,a.id),()=>this.getRemoteFile(a.id,c.ob,s||t))}if(t.video){const r=t.video;r&&r.id===a.id&&this.getLocalFile(e,r,n,()=>this.updateVideoBlob(i,o,a.id),()=>this.getRemoteFile(a.id,c.g,s||t))}},this.deleteLocalFile=(e,t)=>{},this.get=e=>this.items.get(e),this.set=e=>{this.items.set(e.id,e)},this.getBlob=e=>this.blobItems.get(e),this.setBlob=(e,t)=>{this.blobItems.set(e,t)},this.deleteBlob=e=>{this.blobItems.delete(e)},this.getLocationFile=e=>{const t=this.locationItems.get(e);return this.get(t)},this.setLocationFile=(e,t)=>{this.locationItems.set(e,t.id),this.set(t)},this.getDataUrl=e=>e&&this.dataUrls.has(e)?this.dataUrls.get(e):null,this.setDataUrl=(e,t)=>{this.dataUrls.set(e,t)},this.deleteDataUrl=e=>{this.dataUrls.delete(e)},this.getBlobUrl=e=>{if(!e)return null;if(this.urls.has(e))return this.urls.get(e);const t=URL.createObjectURL(e);return this.urls.set(e,t),t},this.deleteBlobUrl=e=>{this.urls.has(e)&&this.urls.delete(e)},this.updatePhotoBlob=(e,t,a)=>{this.emit("clientUpdatePhotoBlob",{chatId:e,messageId:t,fileId:a})},this.updateAudioThumbnailBlob=(e,t,a)=>{l.a.clientUpdate({"@type":"clientUpdateAudioThumbnailBlob",chatId:e,messageId:t,fileId:a})},this.updateAudioBlob=(e,t,a)=>{l.a.clientUpdate({"@type":"clientUpdateAudioBlob",chatId:e,messageId:t,fileId:a})},this.updateVoiceNoteBlob=(e,t,a)=>{this.emit("clientUpdateVoiceNoteBlob",{chatId:e,messageId:t,fileId:a})},this.updateVideoNoteThumbnailBlob=(e,t,a)=>{this.emit("clientUpdateVideoNoteThumbnailBlob",{chatId:e,messageId:t,fileId:a})},this.updateVideoNoteBlob=(e,t,a)=>{this.emit("clientUpdateVideoNoteBlob",{chatId:e,messageId:t,fileId:a})},this.updateAnimationThumbnailBlob=(e,t,a)=>{this.emit("clientUpdateAnimationThumbnailBlob",{chatId:e,messageId:t,fileId:a})},this.updateAnimationBlob=(e,t,a)=>{this.emit("clientUpdateAnimationBlob",{chatId:e,messageId:t,fileId:a})},this.updateDocumentBlob=(e,t,a)=>{l.a.clientUpdate({"@type":"clientUpdateDocumentBlob",chatId:e,messageId:t,fileId:a})},this.updateVideoThumbnailBlob=(e,t,a)=>{this.emit("clientUpdateVideoThumbnailBlob",{chatId:e,messageId:t,fileId:a})},this.updateVideoBlob=(e,t,a)=>{this.emit("clientUpdateVideoBlob",{chatId:e,messageId:t,fileId:a})},this.updateStickerThumbnailBlob=(e,t,a)=>{this.emit("clientUpdateStickerThumbnailBlob",{chatId:e,messageId:t,fileId:a})},this.updateStickerBlob=(e,t,a)=>{this.emit("clientUpdateStickerBlob",{chatId:e,messageId:t,fileId:a})},this.updateLocationBlob=(e,t,a)=>{this.emit("clientUpdateLocationBlob",{chatId:e,messageId:t,fileId:a})},this.updateDocumentThumbnailBlob=(e,t,a)=>{this.emit("clientUpdateDocumentThumbnailBlob",{chatId:e,messageId:t,fileId:a})},this.reset(),this.addTdLibListener()}initDB(e){var t=this;return Object(i.a)(s.a.mark((function a(){var n;return s.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!t.db){a.next=3;break}return e&&e(),a.abrupt("return");case 3:if(!t.initiatingDB){a.next=6;break}return e&&t.callbacks.push(e),a.abrupt("return");case 6:return e&&t.callbacks.push(e),t.initiatingDB=!0,a.next=10,t.openDB().catch(e=>console.log("[FileStore] initDB error",e));case 10:if(t.db=a.sent,t.initiatingDB=!1,t.callbacks.length){for(n=0;n<t.callbacks.length;n++)t.callbacks[n]();t.callbacks=[]}case 13:case"end":return a.stop()}}),a)})))()}openDB(){return new Promise((e,t)=>{const a=window.indexedDB.open("tdlib");a.onsuccess=()=>e(a.result),a.onerror=()=>t(a.error)})}getStore(){}getReadWriteStore(){}getLocalFile(e,t,a,n,o){var r=this;return(t=this.get(t.id)||t)&&t.local&&!t.local.is_downloading_completed?void o():void function(){var e=Object(i.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.a.send({"@type":"readFile",file_id:t.id});case 2:a=e.sent,r.setBlob(t.id,a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(t).then(n,o)}getRemoteFile(e,t,a){const n=this.downloads.get(e)||[];n.some(e=>e===a)||(n.push(a),this.downloads.set(e,n),l.a.send({"@type":"downloadFile",file_id:e,priority:t}))}cancelGetRemoteFile(e,t){if(this.downloads.has(e)){if(t){const a=this.downloads.get(e).filter(e=>e!==t);this.downloads.set(e,a)}else this.downloads.delete(e);l.a.send({"@type":"cancelDownloadFile",file_id:e,only_if_pending:!1})}}uploadFile(e,t){if(this.uploads.has(e)){this.uploads.get(e).push(t)}else this.uploads.set(e,[t]);console.log("[perf] uploadFile file_id="+e)}cancelUploadFile(e,t){this.uploads.has(e)&&(this.uploads.delete(e),console.log("cancel_upload_message id="+t.id),l.a.send({"@type":"deleteMessages",chat_id:t.chat_id,message_ids:[t.id],revoke:!0}))}updateUserPhotoBlob(e,t){this.emit("clientUpdateUserBlob",{userId:e,fileId:t})}updateChatPhotoBlob(e,t){this.emit("clientUpdateChatBlob",{chatId:e,fileId:t})}}const h=new d;window.file=h,t.a=h},function(e,t,a){"use strict";a.d(t,"F",(function(){return G})),a.d(t,"x",(function(){return ue})),a.d(t,"p",(function(){return me})),a.d(t,"o",(function(){return ge})),a.d(t,"g",(function(){return b})),a.d(t,"v",(function(){return W})),a.d(t,"u",(function(){return $})),a.d(t,"D",(function(){return te})),a.d(t,"a",(function(){return ee})),a.d(t,"w",(function(){return se})),a.d(t,"E",(function(){return ie})),a.d(t,"q",(function(){return ce})),a.d(t,"r",(function(){return de})),a.d(t,"s",(function(){return he})),a.d(t,"t",(function(){return Se})),a.d(t,"y",(function(){return B})),a.d(t,"B",(function(){return fe})),a.d(t,"z",(function(){return pe})),a.d(t,"A",(function(){return R})),a.d(t,"C",(function(){return re})),a.d(t,"G",(function(){return Z})),a.d(t,"b",(function(){return q})),a.d(t,"h",(function(){return Q})),a.d(t,"i",(function(){return Y})),a.d(t,"n",(function(){return be})),a.d(t,"j",(function(){return Ce})),a.d(t,"d",(function(){return ye})),a.d(t,"e",(function(){return ve})),a.d(t,"k",(function(){return Ee})),a.d(t,"f",(function(){return Ue})),a.d(t,"l",(function(){return J})),a.d(t,"m",(function(){return K})),a.d(t,"c",(function(){return Me}));var n=a(7),s=a.n(n),i=a(11),o=a(18),r=a(280),c=a(288),l=a(281),d=a(14),h=a(39),u=a(278),p=a(110),m=a(72),g=a(2);function f(e){return e?e<1024?"".concat(e," B"):e<1048576?"".concat((e/1024).toFixed(1)," KB"):e<1073741824?"".concat((e/1024/1024).toFixed(1)," MB"):"".concat((e/1024/1024/1024).toFixed(1)," GB"):"0 B"}function b(e){if(!e)return"";let t=e.size;return t?f(t):""}function C(e,t){if("undefined"!==typeof window.navigator.msSaveBlob)window.navigator.msSaveBlob(e,t);else{let a=window.URL.createObjectURL(e),n=document.createElement("a");n.style.display="none",n.href=a,n.setAttribute("download",t),"undefined"===typeof n.download&&n.setAttribute("target","_blank"),document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(a)}}function y(e,t,a){return v.apply(this,arguments)}function v(){return(v=Object(i.a)(s.a.mark((function e(t,a,n){var i,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return");case 2:if(n){e.next=4;break}return e.abrupt("return");case 4:if(n.length){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,g.a.send({"@type":"getMessages",chat_id:a,message_ids:n});case 8:for((i=e.sent).messages=i.messages.map((e,t)=>e||{"@type":"deletedMessage",chat_id:a,id:n[t],content:null}),p.a.setItems(i.messages),o=n.length-1;o>=0;o--)p.a.emit("getMessageResult",p.a.get(a,n[o]));E(u.a.getStore(),i.messages);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(e,t){for(let a=t.length-1;a>=0;a--){const n=t[a];if(!n)continue;const s=n.content;if(s)switch(s["@type"]){case"messageAnimation":M(e,s.animation,n);break;case"messageAudio":S(e,s.audio,n);break;case"messageChatChangePhoto":D(e,s.photo,n);break;case"messageDocument":_(e,s.document,n);break;case"messageGame":O(e,s.game,n);break;case"messagePhoto":D(e,s.photo,n);break;case"messageSticker":R(e,s.sticker,n);break;case"messageText":{const t=s.web_page;if(!t)break;const a=t.animation,i=t.audio,o=t.document,r=t.photo,c=t.sticker,l=t.video,d=t.video_note;if(r){D(e,r,n);break}if(a){M(e,a,n);break}if(i){S(e,i,n);break}if(o){_(e,o,n);break}if(c){R(e,c,n);break}if(l){A(e,l,n);break}if(d){z(e,d,n);break}break}case"messageVideo":A(e,s.video,n);break;case"messageVideoNote":z(e,s.video_note,n);break}}}function U(e,t,a,n=!0){if(!t)return;let s=t.audio;if(!s)return;s=u.a.get(s.id)||s;const i=s,o=i.id,r=i.size;if(u.a.getBlob(o))return;const c=a?a.chat_id:0,l=a?a.id:0;u.a.getLocalFile(e,s,null,()=>u.a.updateAudioBlob(c,l,o),()=>{(!n||r&&r<d.X)&&u.a.getRemoteFile(o,d.g,a||t)})}function S(e,t,a){if(!t)return!1;const n=t.album_cover_thumbnail;if(!n)return!1;let s=n.photo;if(!s)return!1;s=u.a.get(s.id)||s;const i=s.id;if(u.a.getBlob(s.id))return!0;const o=a?a.chat_id:0,r=a?a.id:0;return u.a.getLocalFile(e,s,null,()=>u.a.updateAudioThumbnailBlob(o,r,i),()=>u.a.getRemoteFile(i,d.ob,a||t)),!0}function k(e,t,a,n=!0){if(!t)return;let s=t.animation;if(!s)return;s=u.a.get(s.id)||s;const i=s,o=i.id,r=i.size;if(u.a.getBlob(o))return;const c=a?a.chat_id:0,l=a?a.id:0;u.a.getLocalFile(e,s,null,()=>u.a.updateAnimationBlob(c,l,o),()=>{(!n||r&&r<d.W)&&u.a.getRemoteFile(o,d.g,a||t)})}function M(e,t,a){if(!t)return!1;const n=t.thumbnail;if(!n)return!1;let s=n.photo;if(!s)return!1;s=u.a.get(s.id)||s;const i=s.id;if(u.a.getBlob(s.id))return!0;const o=a?a.chat_id:0,r=a?a.id:0;return u.a.getLocalFile(e,s,null,()=>u.a.updateAnimationThumbnailBlob(o,r,i),()=>u.a.getRemoteFile(i,d.ob,a||t)),!0}function I(e,t,a){if(!t)return;if(!a)return;const n=t.user_id,s=m.a.get(n);s&&oe(e,s)}function w(e,t,a,n=!0){if(!t)return;let s=t.document;if(!s)return;s=u.a.get(s.id)||s;const i=s,o=i.id,r=i.size;if(u.a.getBlob(o))return;const c=a?a.chat_id:0,l=a?a.id:0;u.a.getLocalFile(e,s,null,()=>u.a.updateDocumentBlob(c,l,o),()=>{(!n||r&&r<d.Y)&&u.a.getRemoteFile(o,d.g,a||t)})}function _(e,t,a){if(!t)return!1;const n=t.thumbnail;if(!n)return!1;let s=n.photo;if(!s)return!1;s=u.a.get(s.id)||s;const i=s.id;if(u.a.getBlob(s.id))return!0;const o=a?a.chat_id:0,r=a?a.id:0;return u.a.getLocalFile(e,s,null,()=>u.a.updateDocumentThumbnailBlob(o,r,i),()=>u.a.getRemoteFile(i,d.ob,a||t)),!0}function x(e,t,a,n=!0){if(!t)return;k(e,t.animation,a,n)}function O(e,t,a){if(!t)return!1;const n=t.photo;return M(e,t.animation,a)||D(e,n,a),!0}function T(){return(T=Object(i.a)(s.a.mark((function e(t,a,n){var i,o,r,c,h,p;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return");case 2:if(i=a.location,o=Object(l.o)(i,d.i,d.h)){e.next=6;break}return e.abrupt("return");case 6:if(r=u.a.getLocationFile(o)){e.next=13;break}return e.next=10,g.a.send({"@type":"getMapThumbnailFile",location:i,width:d.i,height:d.h,zoom:d.q,scale:d.o,chat_id:n?n.chat_id:0});case 10:r=e.sent,u.a.setLocationFile(o,r),t=u.a.getStore();case 13:if(r=u.a.get(r.id)||r,c=r.id,!u.a.getBlob(r.id)){e.next=18;break}return e.abrupt("return");case 18:h=n?n.chat_id:0,p=n?n.id:0,u.a.getLocalFile(t,r,null,()=>u.a.updateLocationBlob(h,p,c),()=>u.a.getRemoteFile(c,d.g,n||a));case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function L(e,t,a){return P.apply(this,arguments)}function P(){return(P=Object(i.a)(s.a.mark((function e(t,a,n){var i,o,r,c,h;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return");case 2:if(i=Object(l.o)(a)){e.next=5;break}return e.abrupt("return");case 5:if(o=u.a.getLocationFile(i)){e.next=12;break}return e.next=9,g.a.send({"@type":"getMapThumbnailFile",location:a,width:d.p,height:d.n,zoom:d.q,scale:d.o,chat_id:n?n.chat_id:0});case 9:o=e.sent,u.a.setLocationFile(i,o),t=u.a.getStore();case 12:if(o=u.a.get(o.id)||o,r=o.id,!u.a.getBlob(o.id)){e.next=17;break}return e.abrupt("return");case 17:c=n?n.chat_id:0,h=n?n.id:0,u.a.getLocalFile(t,o,null,()=>u.a.updateLocationBlob(c,h,r),()=>u.a.getRemoteFile(r,d.g,n||a));case 20:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(e,t,a){if(!t)return;const n=t.sizes;if(!n)return;const s=Object(o.m)(n,d.B);if(!s)return;let i=s.photo;if(!i)return;i=u.a.get(i.id)||i;const r=i.id;if(u.a.getBlob(r))return;const c=a?a.chat_id:0,l=a?a.id:0;u.a.getLocalFile(e,i,null,()=>u.a.updatePhotoBlob(c,l,r),()=>u.a.getRemoteFile(r,d.g,a||t))}function D(e,t,a,n=d.F){if(!t)return;const s=t.sizes;if(!s)return;const i=Object(o.j)(s,n);if(!i)return;let r=i.photo;if(!r)return;r=u.a.get(r.id)||r;const c=r.id;if(u.a.getBlob(c))return;const l=a?a.chat_id:0,h=a?a.id:0;u.a.getLocalFile(e,r,null,()=>u.a.updatePhotoBlob(l,h,c),()=>u.a.getRemoteFile(c,d.g,a||t))}function j(e,t,a){if(!t)return!1;if(!a)return!1;const n=Object(o.k)(t.sizes);if(!n)return!1;if(Object(o.j)(t.sizes)===n)return;let s=n.photo;if(!s)return!1;s=u.a.get(s.id)||s;const i=s.id;return u.a.getBlob(i)||u.a.getLocalFile(e,s,null,()=>u.a.updatePhotoBlob(a.chat_id,a.id,i),()=>u.a.getRemoteFile(i,d.ob,a)),!0}function B(e,t,a,n=!0){if(!t)return;let s=t.sticker;if(!s)return;s=u.a.get(s.id)||s;const i=s,o=i.id,r=i.size;if(u.a.getBlob(o))return;const c=a?a.chat_id:0,l=a?a.id:0;u.a.getLocalFile(e,s,null,()=>u.a.updateStickerBlob(c,l,o),()=>{(!n||r&&r<d.Z)&&u.a.getRemoteFile(o,d.g,a||t)})}function R(e,t,a){if(!t)return!1;const n=t.thumbnail;if(!n)return!1;let s=n.photo;if(!s)return!1;s=u.a.get(s.id)||s;const i=s.id;if(u.a.getBlob(i))return!0;const o=a?a.chat_id:0,r=a?a.id:0;return u.a.getLocalFile(e,s,null,()=>u.a.updateStickerThumbnailBlob(o,r,i),()=>u.a.getRemoteFile(i,d.ob,a||t)),!0}function F(e,t,a,n=!0){if(!t)return;let s=t.video;if(!s)return;s=u.a.get(s.id)||s;const i=s,o=i.id,r=i.size;if(u.a.getBlob(o))return;const c=a?a.chat_id:0,l=a?a.id:0;u.a.getLocalFile(e,s,null,()=>u.a.updateVideoBlob(c,l,o),()=>{(!n||r&&r<d.bb)&&u.a.getRemoteFile(o,d.g,a||t)})}function A(e,t,a){if(!t)return!1;const n=t.thumbnail;if(!n)return!1;let s=n.photo;if(!s)return!1;s=u.a.get(s.id)||s;const i=s.id;if(u.a.getBlob(i))return!0;const o=a?a.chat_id:0,r=a?a.id:0;return u.a.getLocalFile(e,s,null,()=>u.a.updateVideoThumbnailBlob(o,r,i),()=>u.a.getRemoteFile(i,d.ob,a||t)),!0}function V(e,t,a,n=!0){if(!t)return;let s=t.video;if(!s)return;s=u.a.get(s.id)||s;const i=s,o=i.id,r=i.size;if(u.a.getBlob(o))return;const c=a?a.chat_id:0,l=a?a.id:0;u.a.getLocalFile(e,s,null,()=>u.a.updateVideoNoteBlob(c,l,o),()=>{(!n||r&&r<d.ab)&&u.a.getRemoteFile(o,d.g,a||t)})}function z(e,t,a){if(!t)return!1;const n=t.thumbnail;if(!n)return!1;let s=n.photo;if(!s)return!1;s=u.a.get(s.id)||s;const i=s.id;if(u.a.getBlob(i))return!0;const o=a?a.chat_id:0,r=a?a.id:0;return u.a.getLocalFile(e,s,null,()=>u.a.updateVideoNoteThumbnailBlob(o,r,i),()=>u.a.getRemoteFile(i,d.ob,a||t)),!0}function H(e,t,a,n=!0){if(!t)return;let s=t.voice;if(!s)return;s=u.a.get(s.id)||s;const i=s,o=i.id,r=i.size;if(u.a.getBlob(o))return;const c=a?a.chat_id:0,l=a?a.id:0;u.a.getLocalFile(e,s,null,()=>u.a.updateVoiceNoteBlob(c,l,o),()=>{(!n||r&&r<d.cb)&&u.a.getRemoteFile(o,d.g,a||t)})}function W(e,t){const a=new Map;let n=0;const s=new Map;for(let i=t.length-1;i>=0;i--){const o=t[i];if(!o)continue;const r=o.chat_id,c=o.content,l=o.sender_user_id,d=o.reply_to_message_id;if(l&&a.set(l,l),d&&(n=r,s.set(d,d)),c)switch(c["@type"]){case"messageAnimation":{const t=c.animation;k(e,t,o),M(e,t,o);break}case"messageAudio":{const t=c.audio;U(e,t,o),S(e,t,o);break}case"messageChatChangePhoto":{const t=c.photo;D(e,t,o),N(e,t,o);break}case"messageContact":I(e,c.contact,o);break;case"messageDocument":{const t=c.document;w(e,t,o),_(e,t,o);break}case"messageGame":{const t=c.game;x(e,t,o),O(e,t,o);break}case"messageLocation":L(e,c.location,o);break;case"messageText":{const t=c.web_page;if(!t)break;const a=t.animation,n=t.audio,s=t.document,i=t.photo,r=t.sticker,l=t.video,d=t.video_note,h=t.voice_note;let u=!0;a&&(k(e,a,o),u=!M(e,a,o)),n&&(U(e,n,o),u=!S(e,n,o)),s&&(w(e,s,o),u=!_(e,s,o)),r&&(B(e,r,o),u=!R(e,r,o)),l&&(u=!A(e,l,o)),d&&(V(e,d,o),u=!z(e,d,o)),h&&H(e,h,o),u&&(N(e,i,o),D(e,i,o),j(e,i,o));break}case"messagePhoto":{const t=c.photo;N(e,t,o),D(e,t,o),j(e,t,o);break}case"messageSticker":{const t=c.sticker;B(e,t,o),R(e,t,o);break}case"messageVenue":L(e,c.venue.location,o);break;case"messageVideo":A(e,c.video,o);break;case"messageVideoNote":{const t=c.video_note;V(e,t,o),z(e,t,o);break}case"messageVoiceNote":H(e,c.voice_note,o);break}}re(e,[...a.keys()]),y(e,n,[...s.keys()])}function G(e,t){if(e)switch(e["@type"]){case"animation":!function(e,t){const a=t?t.chat_id:0,n=t?t.id:0;if(!e)return;const s=e.animation,i=e.file_name;if(!s)return;const o=s.id;Z(s,i||o,t||e,()=>u.a.updateAnimationBlob(a,n,o))}(e,t);break;case"document":!function(e,t){const a=t?t.chat_id:0,n=t?t.id:0;if(!e)return;const s=e.document,i=e.file_name;if(!s)return;const o=s.id;Z(s,i||o,t||e,()=>u.a.updateDocumentBlob(a,n,o))}(e,t);break;case"photo":!function(e,t){const a=t?t.chat_id:0,n=t?t.id:0;if(!e)return;const s=Object(o.m)(e.sizes,d.B);if(!s)return;const i=s.photo;if(!i)return;const r=i.id;Z(i,r+".jpg",t||e,()=>u.a.updatePhotoBlob(a,n,r))}(e,t);break;case"video":!function(e,t){const a=t?t.chat_id:0,n=t?t.id:0;if(!e)return;const s=e.video,i=e.file_name;if(!s)return;const o=s.id;Z(s,i||o,t||e,()=>u.a.updateVideoBlob(a,n,o))}(e,t)}}function Z(e,t,a,n){if(!e)return;if(!t)return;if(e.arr)return void function(e,t,a){let n=new Blob([e],{type:a||"application/octet-stream"});if("undefined"!==typeof window.navigator.msSaveBlob)window.navigator.msSaveBlob(n,t);else{let e=window.URL.createObjectURL(n),a=document.createElement("a");a.style.display="none",a.href=e,a.setAttribute("download",t),"undefined"===typeof a.download&&a.setAttribute("target","_blank"),document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(e)}}(e.arr,t);let s=u.a.getBlob(e.id)||e.blob;s?C(s,t):q(e,a,()=>{n&&n(),s=u.a.getBlob(e.id)||e.blob,s&&C(s,t)})}function q(e,t,a){if(!e)return;const n=e.id,s=e.local;if(!u.a.getBlob(n))if(s.is_downloading_completed){const n=u.a.getStore();u.a.getLocalFile(n,e,null,a,()=>{s.can_be_downloaded&&u.a.getRemoteFile(e.id,d.g,t)})}else s.can_be_downloaded&&u.a.getRemoteFile(n,d.g,t)}function K(e){if(!e)return[0,0,null];switch(e["@type"]){case"animation":{const t=e.thumbnail;if(t)return[t.width,t.height,t.photo];break}case"document":{const t=e.thumbnail;if(t)return[t.width,t.height,t.photo];break}case"photo":return J(e,d.F);case"video":{const t=e.thumbnail;if(t)return[t.width,t.height,t.photo];break}default:return[0,0,null]}return[0,0,null]}function Y(e,t){const a=p.a.get(e,t);if(!a)return[0,0,null];const n=a.content;if(!n)return[0,0,null];switch(n["@type"]){case"messageAnimation":{const e=n.animation;if(e&&e.thumbnail)return[e.thumbnail.width,e.thumbnail.height,e.thumbnail.photo];break}case"messageChatChangePhoto":return Q(e,t,d.F);case"messageDocument":{const e=n.document;if(e)return[50,50,e.document];break}case"messagePhoto":return Q(e,t,d.F);case"messageText":{const a=n.web_page;if(a){const n=a.animation,s=a.document,i=a.video,o=a.photo;if(n&&n.thumbnail)return[n.thumbnail.width,n.thumbnail.height,n.thumbnail.photo];if(s)return[50,50,s.document];if(i&&i.thumbnail)return[i.thumbnail.width,i.thumbnail.height,i.thumbnail.photo];if(o)return Q(e,t,d.F)}break}case"messageVideo":{const e=n.video;if(e.thumbnail)return[e.thumbnail.width,e.thumbnail.height,e.thumbnail.photo];break}default:return[0,0,null]}return[0,0,null]}function J(e,t){if(!t)return[0,0,null];switch(e["@type"]){case"animation":return[e.width,e.height,e.animation];case"photo":{const a=Object(o.m)(e.sizes,t);if(a)return[a.width,a.height,a.photo];break}case"document":return[50,50,document.document];case"video":return[e.width,e.height,e.video]}return[0,0,null]}function Q(e,t,a){if(!a)return[0,0,null];const n=p.a.get(e,t);if(!n)return[0,0,null];const s=n.content;if(!s)return[0,0,null];switch(s["@type"]){case"messageAnimation":{const e=s.animation;if(e)return[e.width,e.height,e.animation];break}case"messageChatChangePhoto":{const e=s.photo;if(e){const t=Object(o.m)(e.sizes,a);if(t)return[t.width,t.height,t.photo]}break}case"messageDocument":{const e=s.document;if(e)return[50,50,e.document];break}case"messagePhoto":{const e=s.photo;if(e){const t=Object(o.m)(e.sizes,a);if(t)return[t.width,t.height,t.photo]}break}case"messageText":{const e=s.web_page;if(e){const t=e.animation,n=e.document,s=e.photo,i=e.video;if(t)return[t.width,t.height,t.animation];if(n)return[50,50,n.document];if(s){const e=Object(o.m)(s.sizes,a);if(e)return[e.width,e.height,e.photo];break}if(i)return[i.width,i.height,i.video]}break}case"messageVideo":{const e=s.video;if(e)return[e.width,e.height,e.video];break}}return[0,0,null]}function X(e){if(e&&e.length)for(let t=0;t<e.length;t++){let a=e[t];const n=a.content;if(n)switch(n["@type"]){case"messagePhoto":{const e=n.photo;if(!e)break;const t=Object(o.m)(e.sizes,d.B);if(!t)break;const a=t.photo;if(a.blob||u.a.getBlob(a.id))return;u.a.cancelGetRemoteFile(a.id);break}case"messageVideo":{const e=n.video;if(!e)break;if(e.thumbnail){const t=e.thumbnail.photo;if(t.blob||u.a.getBlob(t.id))break;u.a.cancelGetRemoteFile(t.id)}const t=e.video;if(!t)break;if(t.blob||u.a.getBlob(t.id))break;u.a.cancelGetRemoteFile(t.id);break}case"messageText":{const e=a.content.web_page;if(e){const t=e.video;if(t){if(t.thumbnail){const e=t.thumbnail.photo;if(e.blob||u.a.getBlob(e.id))break;u.a.cancelGetRemoteFile(e.id)}const e=t.video;if(!e)break;if(e.blob||u.a.getBlob(e.id))break;u.a.cancelGetRemoteFile(e.id)}}break}}}}function $(e,t=!1){if(!e)return;if(!e.length)return;const a=u.a.getStore();for(let n=0;n<e.length;n++){let s=e[n];const i=s.content;if(i)switch(i["@type"]){case"messageAnimation":{const e=i.animation;k(a,e,s,t),M(a,e,s);break}case"messageChatChangePhoto":N(a,i.photo,s);break;case"messageDocument":w(a,i.document,s,t);break;case"messagePhoto":N(a,i.photo,s);break;case"messageText":{const e=s.content.web_page;if(!e)break;const n=e.animation,i=e.document,o=e.photo,r=e.video;let c=!0;n&&(k(a,n,s,t),c=!M(a,n,s)),i&&(w(a,i,s,t),c=!1),r&&(F(a,r,s,t),c=!A(a,r,s)),c&&N(a,o,s);break}case"messageVideo":{const e=i.video;A(a,e,s),F(a,e,s,t);break}}}}function ee(e,t){if(!t.length)return;const a=[];e>0&&a.push(t[e-1]),e<t.length-1&&a.push(t[e+1]),X([t[e]]),X(a)}function te(e,t){if(!t.length)return;const a=[];e>0&&a.push(t[e-1]),e<t.length-1&&a.push(t[e+1]),$([t[e]],!1),$(a,!0)}function ae(e,t,a){if(!t)return;const n=t.id;t=u.a.get(n)||t;const s=m.a.get(a);s&&(t.blob||u.a.getBlob(n)||u.a.getLocalFile(e,t,null,()=>u.a.updateUserPhotoBlob(a,n),()=>u.a.getRemoteFile(n,d.ob,s)))}function ne(e,t,a){if(!t)return;const n=t.id;t=u.a.get(n)||t;const s=h.a.get(a);s&&(u.a.getDataUrl(n)||t.blob||u.a.getBlob(n)||u.a.getLocalFile(e,t,null,()=>u.a.updateChatPhotoBlob(a,n),()=>u.a.getRemoteFile(n,d.ob,s)))}function se(e,t){if(!t)return;const a=u.a.getStore();t.forEach(t=>{switch(t["@type"]){case"chatPhoto":{const n=t,s=n.small,i=n.big;ne(a,s,e),ne(a,i,e);break}case"profilePhoto":{const n=Object(r.u)(e),s=t,i=s.small,o=s.big;ae(a,i,n),ae(a,o,n);break}case"userProfilePhoto":{if(!(t=Object(c.a)(t)))break;const n=Object(r.u)(e),s=t,i=s.small,o=s.big;ae(a,i,n),ae(a,o,n);break}}})}function ie(e,t,a){if(!a.length)return;const n=[];t>0&&n.push(a[t-1]),t<a.length-1&&n.push(a[t+1]),t>=0&&t<a.length&&n.push(a[t]),se(e,n)}function oe(e,t){const a=m.a.get(t);if(!a)return;const n=a.profile_photo;n&&ae(e,n.small,t)}function re(e,t){t&&t.forEach(t=>oe(e,t))}function ce(e,t){const a=h.a.get(t);a&&le(e,a.photo,a.id)}function le(e,t,a){if(!t)return;ne(e,t.small,a)}function de(e,t){t&&t.forEach(t=>ce(e,t))}function he(e,t){const a=h.a.get(t);if(!a)return;const n=a.draft_message;if(!n)return;const s=n.reply_to_message_id;s&&y(e,t,[s])}function ue(e,t){if(!t)return;fe(e,t.stickers)}function pe(e,t){if(!t)return;fe(e,t.stickers)}function me(e,t){t&&t.forEach(t=>{ge(e,t,!1)})}function ge(e,t,a=!1){if(t)switch(t.type["@type"]){case"backgroundTypeFill":break;case"backgroundTypePattern":{const n=t.document;n&&(_(e,n,null),a&&w(e,n,null,!1));break}case"backgroundTypeWallpaper":{const n=t.document;n&&(_(e,n,null),a&&w(e,n,null,!1));break}}}function fe(e,t){t&&t.forEach(t=>{R(e,t,null),t.is_animated&&B(e,t,null)})}function be(e){return e&&"image/gif"===e.toLowerCase()}function Ce(e){const t=e&&u.a.getDataUrl(e.id);if(t)return t;const a=ye(e);return u.a.getBlobUrl(a)||""}function ye(e){return e?u.a.getBlob(e.id)||e.blob:null}function ve(e){return e&&e.local&&e.local.is_downloading_active?f(e.local.downloaded_size):"0"}function Ee(e){return e&&e.remote&&e.remote.is_uploading_active?f(e.remote.uploaded_size):"0"}function Ue(e){if(!e)return"";const t=e.split(".");return 1===t.length||""===t[0]&&2===t.length?"":t.pop().toLowerCase()}function Se(e){if(!e)return;const t=e.page_blocks;if(!t)return;const a=u.a.getStore();t.forEach(e=>function e(t,a){if(!a)return;switch(a["@type"]){case"pageBlockAnchor":break;case"pageBlockAnimation":{const n=a.animation,s=a.caption;M(t,n,null),k(t,n,null),e(t,s);break}case"pageBlockAudio":{const n=a.audio,s=a.caption;S(t,n,null),U(t,n,null),e(t,s);break}case"pageBlockAuthorDate":{const e=a.author;ke(t,e);break}case"pageBlockBlockQuote":{const e=a.text,n=a.credit;ke(t,e),ke(t,n);break}case"pageBlockCaption":{const e=a.text,n=a.credit;ke(t,e),ke(t,n);break}case"pageBlockChatLink":{const e=a.photo;le(t,e,0);break}case"pageBlockCollage":{const n=a.page_blocks,s=a.caption;e(t,s),n.forEach(a=>e(t,a));break}case"pageBlockCover":{const n=a.cover;e(t,n);break}case"pageBlockDetails":{const n=a.header,s=a.page_blocks;e(t,n),s.forEach(a=>e(t,a));break}case"pageBlockDivider":break;case"pageBlockEmbedded":{const n=a.poster_photo,s=a.caption;D(t,n,null),e(t,s);break}case"pageBlockEmbeddedPost":{const n=a.author_photo,s=a.page_blocks,i=a.caption;D(t,n,null),s.forEach(a=>e(t,a)),e(t,i);break}case"pageBlockFooter":{const e=a.footer;ke(t,e);break}case"pageBlockHeader":{const e=a.header;ke(t,e);break}case"pageBlockKicker":{const e=a.kicker;ke(t,e);break}case"pageBlockList":a.items.forEach(a=>e(t,a));break;case"pageBlockListItem":a.page_blocks.forEach(a=>e(t,a));break;case"pageBlockMap":{const n=a.caption;!function(e,t,a){T.apply(this,arguments)}(t,a,null),e(t,n);break}case"pageBlockParagraph":{const e=a.text;ke(t,e);break}case"pageBlockPhoto":{const n=a.photo,s=a.caption;D(t,n,null,d.k),e(t,s);break}case"pageBlockPreformatted":{const e=a.text;ke(t,e);break}case"pageBlockPullQuote":{const e=a.text,n=a.credit;ke(t,e),ke(t,n);break}case"pageBlockRelatedArticles":{const n=a.header,s=a.articles;ke(t,n),s.forEach(a=>e(t,a));break}case"pageBlockRelatedArticle":{const e=a.photo;D(t,e,null);break}case"pageBlockSlideshow":{const n=a.page_blocks,s=a.caption;e(t,s),n.forEach(a=>e(t,a));break}case"pageBlockSubheader":{const e=a.subheader;ke(t,e);break}case"pageBlockSubtitle":{const e=a.subtitle;ke(t,e);break}case"pageBlockTable":{const n=a.caption,s=a.cells;ke(t,n),s.forEach(a=>a.forEach(a=>e(t,a)));break}case"pageBlockTableCell":{const e=a.text;ke(t,e);break}case"pageBlockTitle":{const e=a.title;ke(t,e);break}case"pageBlockVideo":{const n=a.video,s=a.caption;A(t,n,null),F(t,n,null),e(t,s);break}}}(a,e))}function ke(e,t){if(t)switch(t["@type"]){case"richTextAnchor":{const a=t.text;ke(e,a);break}case"richTextBold":{const a=t.text;ke(e,a);break}case"richTextEmailAddress":{const a=t.text;ke(e,a);break}case"richTextFixed":{const a=t.text;ke(e,a);break}case"richTextIcon":{const a=t.document;_(e,a,null),w(e,a,null,!1);break}case"richTextItalic":{const a=t.text;ke(e,a);break}case"richTextMarked":{const a=t.text;ke(e,a);break}case"richTextPhoneNumber":{const a=t.text;ke(e,a);break}case"richTextPlain":{const a=t.text;ke(e,a);break}case"richTexts":t.texts.forEach(t=>ke(e,t));break;case"richTextStrikethrough":{const a=t.text;ke(e,a);break}case"richTextSubscript":{const a=t.text;ke(e,a);break}case"richTextSuperscript":{const a=t.text;ke(e,a);break}case"richTextUnderline":{const a=t.text;ke(e,a);break}case"richTextUrl":{const a=t.text;ke(e,a);break}}}function Me(e){return new Promise(t=>{if(!e)return void t(null);const a=u.a.getBlob(e.id);if(!a)return void t(null);const n=new FileReader;n.onload=e=>t(JSON.parse(e.target.result)),n.onerror=()=>t(null),n.onabort=()=>t(null),n.readAsText(a)})}},function(e,t,a){"use strict";a.d(t,"h",(function(){return v})),a.d(t,"K",(function(){return E})),a.d(t,"g",(function(){return U})),a.d(t,"i",(function(){return S})),a.d(t,"Q",(function(){return K})),a.d(t,"V",(function(){return he})),a.d(t,"k",(function(){return ue})),a.d(t,"l",(function(){return pe})),a.d(t,"t",(function(){return k})),a.d(t,"X",(function(){return x})),a.d(t,"W",(function(){return O})),a.d(t,"q",(function(){return j})),a.d(t,"r",(function(){return D})),a.d(t,"z",(function(){return w})),a.d(t,"C",(function(){return I})),a.d(t,"B",(function(){return M})),a.d(t,"x",(function(){return _})),a.d(t,"y",(function(){return N})),a.d(t,"A",(function(){return P})),a.d(t,"n",(function(){return B})),a.d(t,"H",(function(){return F})),a.d(t,"I",(function(){return R})),a.d(t,"M",(function(){return L})),a.d(t,"v",(function(){return A})),a.d(t,"o",(function(){return V})),a.d(t,"j",(function(){return z})),a.d(t,"T",(function(){return H})),a.d(t,"R",(function(){return W})),a.d(t,"J",(function(){return G})),a.d(t,"O",(function(){return T})),a.d(t,"L",(function(){return Z})),a.d(t,"P",(function(){return ge})),a.d(t,"N",(function(){return fe})),a.d(t,"s",(function(){return q})),a.d(t,"w",(function(){return J})),a.d(t,"m",(function(){return Q})),a.d(t,"F",(function(){return $})),a.d(t,"G",(function(){return ae})),a.d(t,"U",(function(){return ee})),a.d(t,"E",(function(){return te})),a.d(t,"u",(function(){return ne})),a.d(t,"D",(function(){return se})),a.d(t,"p",(function(){return oe})),a.d(t,"S",(function(){return Y})),a.d(t,"a",(function(){return re})),a.d(t,"b",(function(){return ce})),a.d(t,"c",(function(){return me})),a.d(t,"d",(function(){return ie})),a.d(t,"e",(function(){return de})),a.d(t,"f",(function(){return le}));var n=a(7),s=a.n(n),i=a(11),o=a(30),r=(a(0),a(303)),c=a(288),l=a(112),d=a(39);var h=a(18),u=a(281),p=a(314),m=a(83);var g=a(14),f=a(296),b=a(116),C=a(72),y=a(2);function v(e){const t=d.a.get(e);return!!t&&t.pinned_message_id>0}function E(e){const t=d.a.get(e);if(!t)return!1;const a=t.chat_list;return!!a&&"chatListArchive"===a["@type"]}function U(e){const t=d.a.get(e);if(!t)return!1;const a=t.is_sponsored,n=t.chat_list;return!a&&(!!n&&("chatListMain"!==n["@type"]||!Y(e)&&e!==g.hb))}function S(e,t){if(!e&&!t)return!0;if(e&&!t)return!1;if(t&&!e)return!1;const a=e.input_message_text,n=e.reply_to_message_id,s=t.input_message_text;if(n!==t.reply_to_message_id)return!1;if(a["@type"]!==s["@type"])return!1;if("inputMessageText"!==a["@type"])return!0;const i=a.text,o=s.text;if(!i&&!o)return!0;if(i&&!o)return!1;if(o&&!i)return!1;const r=i.text,c=i.entities,l=o.text,d=o.entities;return r===l&&function(e,t){if(!e&&!t)return!0;if(e&&!t)return!1;if(t&&!e)return!1;if(e.length!==t.length)return!1;const a=new Map;return e.forEach(e=>{a.set("".concat(e.type["@type"],"_").concat(e.offset,"_").concat(e.length),e)}),t.every(e=>a.has("".concat(e.type["@type"],"_").concat(e.offset,"_").concat(e.length)))}(c,d)}function k(e){const t=d.a.get(e);if(!t)return null;if(!t.type)return null;let a=d.a.getTypingManager(t.id);if(!a)return null;switch(t.type["@type"]){case"chatTypePrivate":case"chatTypeSecret":{const e=function(e){if(!e)return null;if(e.actions.size>=1){switch(e.actions.values().next().value.action["@type"]){case"chatActionRecordingVideo":return"recording a video";case"chatActionRecordingVideoNote":return"recording a video message";case"chatActionRecordingVoiceNote":return"recording a voice message";case"chatActionStartPlayingGame":return"playing a game";case"chatActionUploadingDocument":return"sending a file";case"chatActionUploadingPhoto":return"sending a photo";case"chatActionUploadingVideo":return"sending a video";case"chatActionUploadingVideoNote":return"sending a video message";case"chatActionUploadingVoiceNote":return"sending a voice message";case"chatActionChoosingContact":case"chatActionChoosingLocation":case"chatActionTyping":default:return"typing"}}return null}(a);return e?e+"...":null}case"chatTypeBasicGroup":case"chatTypeSupergroup":{const e=function(e){if(!e)return null;let t=e.actions.size;if(t>2)return"".concat(t," people are typing");if(t>1){let s,i;var a,n=Object(o.a)(e.actions.keys());try{for(n.s();!(a=n.n()).done;){let e=a.value;if(s){if(!i){i=C.a.get(e);break}}else s=C.a.get(e)}}catch(r){n.e(r)}finally{n.f()}return s&&i?(s=s.first_name?s.first_name:s.second_name,i=i.first_name?i.first_name:i.second_name,s&&i?"".concat(s," and ").concat(i," are typing"):"".concat(t," people are typing")):"".concat(t," people are typing")}{let t;if(e.actions.size>=1){var s,i=Object(o.a)(e.actions.keys());try{for(i.s();!(s=i.n()).done;){let e=s.value;if(!t){t=C.a.get(e);break}}}catch(r){i.e(r)}finally{i.f()}if(!t)return"1 person is typing";if(t=t.first_name?t.first_name:t.second_name,!t)return"1 person is typing";switch(e.actions.values().next().value.action["@type"]){case"chatActionRecordingVideo":return"".concat(t," is recording a video");case"chatActionRecordingVideoNote":return"".concat(t," is recording a video message");case"chatActionRecordingVoiceNote":return"".concat(t," is recording a voice message");case"chatActionStartPlayingGame":return"".concat(t," is playing a game");case"chatActionUploadingDocument":return"".concat(t," is sending a file");case"chatActionUploadingPhoto":return"".concat(t," is sending a photo");case"chatActionUploadingVideo":return"".concat(t," is sending a video");case"chatActionUploadingVideoNote":return"".concat(t," is sending a video message");case"chatActionUploadingVoiceNote":return"".concat(t," is sending a voice message");case"chatActionChoosingContact":case"chatActionChoosingLocation":case"chatActionTyping":default:return"".concat(t," is typing")}}}return null}(a);return e?e+"...":null}}return null}function M(e,t=(e=>e)){return e?Object(p.b)(e)?null:e.sender_user_id?Object(c.c)(e.sender_user_id,null,t):null:null}function I(e,t=(e=>e)){if(!e)return null;if(Object(p.b)(e))return null;const a=d.a.get(e.chat_id);return a&&"chatTypeBasicGroup"!==a.type["@type"]&&"chatTypeSupergroup"!==a.type["@type"]?null:Object(c.e)(e.sender_user_id,t)}function w(e,t=(e=>e)){return e?I(e.last_message,t):null}function _(e,t=(e=>e)){if(!e)return null;const a=e.last_message;return a?Object(u.h)(a,t):null}function x(e){const t=d.a.get(e);return!!t&&t.unread_mention_count>0}function O(e){const t=d.a.get(e);if(!t)return!1;const a=t.is_marked_as_unread,n=t.unread_count,s=t.unread_mention_count;return n>1||1===n&&0===s||a&&0===n&&0===s}function T(e){const t=d.a.get(e);if(!t)return!1;const a=t.is_marked_as_unread,n=t.unread_count;t.unread_mention_count;return a||n>0}function L(e){return function(e){const t=d.a.get(e);if(!t)return 0;const a=t.notification_settings;if(!a)return 0;const n=a.use_default_mute_for,s=a.mute_for;if(n){const t=function(e){const t=d.a.get(e);if(!t)return null;switch(t.type["@type"]){case"chatTypePrivate":case"chatTypeSecret":return b.a.settings.get("notificationSettingsScopePrivateChats");case"chatTypeBasicGroup":case"chatTypeSupergroup":{let t=null;return t=G(e)?b.a.settings.get("notificationSettingsScopeChannelChats"):b.a.settings.get("notificationSettingsScopeGroupChats"),t}}return null}(e);return!!t&&t.mute_for}return s}(e)>0}function P(e){const t=new Date(1e3*e.date),a=new Date;if(a.setHours(0,0,0,0),t>a)return Object(r.a)(t,"H:MM");const n=new Date,s=n.getDay(),i=n.getDate()-s+(0===s?-6:1);return t>new Date(n.setDate(i))?Object(r.a)(t,"ddd"):Object(r.a)(t,"d.mm.yyyy")}function N(e){return e&&e.last_message&&e.last_message.date?he(e.id)?null:P(e.last_message):null}function D(e){const t=d.a.get(e);if(!t)return null;const a=t.type;if(!a)return null;switch(a["@type"]){case"chatTypeBasicGroup":{const t=f.a.get(a.basic_group_id);if(t)return function(e,t){if(!e)return null;const a=e.status,n=e.member_count;if(a&&("chatMemberStatusBanned"===a["@type"]||"chatMemberStatusLeft"===a["@type"]||"chatMemberStatusCreator"===a["@type"]&&!a.is_member))return"group is inaccessible";if(!n)return"0 members";if(1===n)return"1 member";const s=d.a.getOnlineMemberCount(t);return s>1?"".concat(n," members, ").concat(s," online"):"".concat(n," members")}(t,e);break}case"chatTypePrivate":case"chatTypeSecret":{const e=C.a.get(a.user_id);if(e)return Object(c.f)(e);break}case"chatTypeSupergroup":{const t=l.a.get(a.supergroup_id);if(t)return t.is_channel?function(e,t){if(!e)return"";let a=e.status,n=e.is_channel,s=e.member_count;if(!n)return"";if(a&&"chatMemberStatusBanned"===a["@type"])return"channel is inaccessible";if(!s){const t=l.a.getFullInfo(e.id);t&&(s=t.member_count)}if(!s)return"0 subscribers";if(1===s)return"1 subscriber";const i=d.a.getOnlineMemberCount(t);return i>1?"".concat(s," subscribers, ").concat(i," online"):"".concat(s," subscribers")}(t,e):function(e,t){if(!e)return null;let a=e.status,n=e.is_channel,s=e.member_count;if(a&&"chatMemberStatusBanned"===a["@type"])return n?"channel is inaccessible":"group is inaccessible";if(!s){const t=l.a.getFullInfo(e.id);t&&(s=t.member_count)}if(!s)return"0 members";if(1===s)return"1 member";const i=d.a.getOnlineMemberCount(t);return i>1?"".concat(s," members, ").concat(i," online"):"".concat(s," members")}(t,e);break}}return null}function j(e,t=!1){if(Y(e)&&t)return null;const a=k(e);return a||D(e)}function B(e,t){if(!e)return null;let a=e.title||t("HiddenName");if(0===a.length)return null;let n=Object(h.h)(a);return n&&n.length>0?n:e.title.charAt(0)}function R(e){const t=d.a.get(e);if(!t)return!1;if(!t.type)return!1;switch(t.type["@type"]){case"chatTypeBasicGroup":return!1;case"chatTypePrivate":case"chatTypeSecret":{const e=C.a.get(t.type.user_id);if(e)return Object(c.j)(e);break}case"chatTypeSupergroup":return!1}return!1}function F(e){return!k(e)&&R(e)}function A(e){const t=d.a.get(e);if(!t)return null;if(!t.type)return null;switch(t.type["@type"]){case"chatTypeBasicGroup":return null;case"chatTypePrivate":case"chatTypeSecret":{const e=C.a.get(t.type.user_id);if(e)return e.username;break}case"chatTypeSupergroup":{const e=l.a.get(t.type.supergroup_id);if(e)return e.username;break}}return null}function V(e){const t=d.a.get(e);if(!t)return null;if(!t.type)return null;switch(t.type["@type"]){case"chatTypeBasicGroup":return null;case"chatTypePrivate":case"chatTypeSecret":{const e=C.a.get(t.type.user_id);if(e)return Object(m.a)(e.phone_number);break}case"chatTypeSupergroup":return null}return null}function z(e){const t=d.a.get(e);if(!t)return null;if(!t.type)return null;switch(t.type["@type"]){case"chatTypeBasicGroup":{const e=f.a.getFullInfo(t.type.basic_group_id);if(e)return e.description;break}case"chatTypePrivate":case"chatTypeSecret":{const e=C.a.getFullInfo(t.type.user_id);if(e)return e.bio;break}case"chatTypeSupergroup":{const e=l.a.getFullInfo(t.type.supergroup_id);if(e)return e.description;break}}return null}function H(e){const t=d.a.get(e);if(!t)return!1;if(!t.type)return!1;switch(t.type["@type"]){case"chatTypeBasicGroup":case"chatTypeSupergroup":return!1;case"chatTypePrivate":case"chatTypeSecret":return!0}return!1}function W(e){const t=d.a.get(e);if(!t)return!1;if(!t.type)return!1;switch(t.type["@type"]){case"chatTypeBasicGroup":case"chatTypeSupergroup":return!0;case"chatTypePrivate":case"chatTypeSecret":return!1}return!1}function G(e){const t=d.a.get(e);if(!t)return!1;if(!t.type)return!1;switch(t.type["@type"]){case"chatTypeSupergroup":{const e=l.a.get(t.type.supergroup_id);return e&&e.is_channel}case"chatTypeBasicGroup":case"chatTypePrivate":case"chatTypeSecret":return!1}return!1}function Z(e){const t=d.a.get(e);if(!t)return!1;const a=t.type;if(!a)return!1;switch(a["@type"]){case"chatTypeSupergroup":{const e=l.a.get(a.supergroup_id);if(e&&e.status)switch(e.status["@type"]){case"chatMemberStatusAdministrator":return!0;case"chatMemberStatusBanned":return!1;case"chatMemberStatusCreator":return e.status.is_member;case"chatMemberStatusLeft":return!1;case"chatMemberStatusMember":return!0;case"chatMemberStatusRestricted":return e.status.is_member}break}case"chatTypeBasicGroup":{const e=f.a.get(a.basic_group_id);if(e&&e.status)switch(e.status["@type"]){case"chatMemberStatusAdministrator":return!0;case"chatMemberStatusBanned":return!1;case"chatMemberStatusCreator":return e.status.is_member;case"chatMemberStatusLeft":return!1;case"chatMemberStatusMember":return!0;case"chatMemberStatusRestricted":return e.status.is_member}break}case"chatTypePrivate":case"chatTypeSecret":return!0}return!1}function q(e,t=!1,a=(e=>e)){const n=d.a.get(e);return n?Y(e)&&t?a("SavedMessages"):n.title||a("HiddenName"):null}function K(e){const t=d.a.get(e);if(!t)return!1;switch(t.type["@type"]){case"chatTypeBasicGroup":case"chatTypeSupergroup":return!1;case"chatTypeSecret":case"chatTypePrivate":{const e=C.a.get(t.type.user_id);return e&&"userTypeDeleted"===e.type["@type"]}}return!1}function Y(e){const t=d.a.get(e);if(!t)return!1;switch(t.type["@type"]){case"chatTypeBasicGroup":case"chatTypeSupergroup":return!1;case"chatTypeSecret":case"chatTypePrivate":return C.a.getMyId()===t.type.user_id}return!1}function J(e){const t=[],a=d.a.get(e);if(!a)return t;switch(a.type["@type"]){case"chatTypeBasicGroup":{const e=f.a.getFullInfo(a.type.basic_group_id);if(e)return e.members||t;break}}return t}function Q(e){return X.apply(this,arguments)}function X(){return(X=Object(i.a)(s.a.mark((function e(t){var a,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=d.a.get(t)){e.next=3;break}return e.abrupt("return",null);case 3:if(n=a.type){e.next=6;break}return e.abrupt("return",null);case 6:e.t0=n["@type"],e.next="chatTypePrivate"===e.t0?9:"chatTypeSecret"===e.t0?12:"chatTypeBasicGroup"===e.t0?15:"chatTypeSupergroup"===e.t0?18:21;break;case 9:return e.next=11,y.a.send({"@type":"getUserFullInfo",user_id:n.user_id});case 11:return e.abrupt("return",e.sent);case 12:return e.next=14,y.a.send({"@type":"getUserFullInfo",user_id:n.user_id});case 14:return e.abrupt("return",e.sent);case 15:return e.next=17,y.a.send({"@type":"getBasicGroupFullInfo",basic_group_id:n.basic_group_id});case 17:return e.abrupt("return",e.sent);case 18:return e.next=20,y.a.send({"@type":"getSupergroupFullInfo",supergroup_id:n.supergroup_id});case 20:return e.abrupt("return",e.sent);case 21:return e.abrupt("return",null);case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $(e,t){const a=d.a.get(e);if(!a)return!1;const n=a.type;return n&&"chatTypeBasicGroup"===n["@type"]&&n.basic_group_id===t}function ee(e){const t=d.a.get(e);if(!t)return!1;const a=t.type;return a&&"chatTypeSupergroup"===a["@type"]}function te(e){const t=d.a.get(e);if(!t)return!1;const a=t.type;return a&&"chatTypeSupergroup"===a["@type"]?a.supergroup_id:0}function ae(e,t){const a=d.a.get(e);if(!a)return!1;const n=a.type;return ee(e)&&n.supergroup_id===t}function ne(e){const t=d.a.get(e);if(!t)return 0;const a=t.type;return!a||"chatTypePrivate"!==a["@type"]&&"chatTypeSecret"!==a["@type"]?0:a.user_id}function se(e){const t=d.a.get(e);if(!t)return null;if(H(e)){const t=C.a.get(ne(e));if(t)return t.profile_photo}return t.photo}function ie(e){const t=d.a.get(e);if(!t)return!1;const a=t.type,n=t.permissions;if(!a)return!1;if(!n)return!1;const s=n.can_send_media_messages;switch(a["@type"]){case"chatTypeBasicGroup":{const e=f.a.get(a.basic_group_id);if(!e)return!1;const t=e.status;if(!t)return!1;const n=t.is_member,s=t.permissions;switch(t["@type"]){case"chatMemberStatusAdministrator":return!0;case"chatMemberStatusBanned":return!1;case"chatMemberStatusCreator":return n;case"chatMemberStatusLeft":return!1;case"chatMemberStatusMember":return!0;case"chatMemberStatusRestricted":return n&&s&&s.can_send_media_messages}break}case"chatTypePrivate":case"chatTypeSecret":return s;case"chatTypeSupergroup":{const e=l.a.get(t.type.supergroup_id);if(!e)return!1;const a=e.status;if(!a)return!1;const n=a.is_member,i=a.permissions;switch(a["@type"]){case"chatMemberStatusAdministrator":return!0;case"chatMemberStatusBanned":return!1;case"chatMemberStatusCreator":return n;case"chatMemberStatusLeft":return!1;case"chatMemberStatusMember":return s&&!e.is_channel;case"chatMemberStatusRestricted":return s&&n&&i&&i.can_send_media_messages}}}return!1}function oe(e,t=!1,a=(e=>e)){if(Y(e)&&t)return a("SavedMessages");const n=d.a.get(e);if(!n)return null;if(!n.type)return null;switch(n.type["@type"]){case"chatTypeBasicGroup":case"chatTypeSupergroup":return n.title;case"chatTypePrivate":case"chatTypeSecret":return Object(c.e)(n.type.user_id,a)}return null}function re(e){const t=d.a.get(e);if(!t)return!1;if(!t.type)return!1;switch(t.type["@type"]){case"chatTypeBasicGroup":return!0;case"chatTypeSupergroup":{const e=l.a.get(t.type.supergroup_id);return!e||!Boolean(e.username)}case"chatTypePrivate":case"chatTypeSecret":return!0}return!1}function ce(e){return!Y(e)}function le(e){const t=d.a.get(e);if(!t)return!1;const a=t.type,n=t.permissions;if(!a)return!1;if(!n)return!1;const s=n.can_send_polls;switch(a["@type"]){case"chatTypeBasicGroup":{const e=f.a.get(a.basic_group_id);if(!e)return!1;const t=e.status;if(!t)return!1;const n=t.is_member,s=t.permissions;switch(t["@type"]){case"chatMemberStatusAdministrator":return!0;case"chatMemberStatusBanned":return!1;case"chatMemberStatusCreator":return n;case"chatMemberStatusLeft":return!1;case"chatMemberStatusMember":return!0;case"chatMemberStatusRestricted":return n&&s&&s.can_send_polls}break}case"chatTypePrivate":case"chatTypeSecret":return s;case"chatTypeSupergroup":{const e=l.a.get(a.supergroup_id);if(!e)return!1;const t=e.status;if(!t)return!1;const n=t.is_member,i=t.permissions;switch(t["@type"]){case"chatMemberStatusAdministrator":return!0;case"chatMemberStatusBanned":return!1;case"chatMemberStatusCreator":return n;case"chatMemberStatusLeft":return!1;case"chatMemberStatusMember":return s&&!e.is_channel;case"chatMemberStatusRestricted":return s&&n&&i&&i.can_send_polls}}}return!1}function de(e){const t=d.a.get(e);if(!t)return!1;const a=t.type,n=t.permissions;if(!a)return!1;if(!n)return!1;const s=n.can_send_messages;switch(a["@type"]){case"chatTypeBasicGroup":{const e=f.a.get(a.basic_group_id);if(!e)return!1;const t=e.status;if(!t)return!1;const n=t.is_member,s=t.permissions;switch(t["@type"]){case"chatMemberStatusAdministrator":return!0;case"chatMemberStatusBanned":return!1;case"chatMemberStatusCreator":return n;case"chatMemberStatusLeft":return!1;case"chatMemberStatusMember":return!0;case"chatMemberStatusRestricted":return n&&s&&s.can_send_messages}break}case"chatTypePrivate":case"chatTypeSecret":return s;case"chatTypeSupergroup":{const e=l.a.get(a.supergroup_id);if(!e)return!1;const t=e.status;if(!t)return!1;const n=t.is_member,i=t.permissions;switch(t["@type"]){case"chatMemberStatusAdministrator":return!0;case"chatMemberStatusBanned":return!1;case"chatMemberStatusCreator":return n;case"chatMemberStatusLeft":return!1;case"chatMemberStatusMember":return s&&!e.is_channel;case"chatMemberStatusRestricted":return s&&n&&i&&i.can_send_messages}}}return!1}function he(e){const t=d.a.get(e);return ue(e)&&0===t.unread_count&&0===t.unread_mention_count}function ue(e){const t=d.a.get(e);if(t){const e=t.draft_message;if(e){const t=e.input_message_text;if(t)return t.text}}return null}function pe(e){let t=0;const a=d.a.get(e);if(a){const e=a.draft_message;e&&(t=e.reply_to_message_id)}return t}function me(e){const t=d.a.get(e);if(!t)return!1;const a=t.type,n=t.permissions;if(!a)return!1;if(!n)return!1;const s=n.can_pin_messages;switch(a["@type"]){case"chatTypeBasicGroup":{const e=f.a.get(a.basic_group_id);if(!e)return!1;const t=e.status;if(!t)return!1;const n=t.is_member,s=t.permissions;switch(t["@type"]){case"chatMemberStatusAdministrator":return t.can_pin_messages;case"chatMemberStatusBanned":case"chatMemberStatusCreator":case"chatMemberStatusLeft":case"chatMemberStatusMember":return!1;case"chatMemberStatusRestricted":return n&&s&&s.can_pin_messages}break}case"chatTypePrivate":case"chatTypeSecret":return s;case"chatTypeSupergroup":{const e=l.a.get(a.supergroup_id);if(!e)return!1;const t=e.status;if(!t)return!1;const n=t.is_member,i=t.permissions;switch(t["@type"]){case"chatMemberStatusAdministrator":return s||t.can_pin_messages;case"chatMemberStatusBanned":return!1;case"chatMemberStatusCreator":return n;case"chatMemberStatusLeft":case"chatMemberStatusMember":return!1;case"chatMemberStatusRestricted":return s&&n&&i&&i.can_pin_messages}}}return!1}function ge(e){const t=d.a.get(e);if(!t)return!1;const a=t.type;if(!a)return!1;switch(t.type["@type"]){case"chatTypeBasicGroup":return!1;case"chatTypePrivate":case"chatTypeSecret":{const e=C.a.get(a.user_id);return e&&e.is_verified}case"chatTypeSupergroup":{const e=l.a.get(a.supergroup_id);return e&&e.is_verified}}return!1}function fe(e){const t=d.a.get(e);if(!t)return!1;if(!t.type)return!1;switch(t.type["@type"]){case"chatTypeBasicGroup":case"chatTypePrivate":return!1;case"chatTypeSecret":return!0;case"chatTypeSupergroup":return!1}return!1}},function(e,t,a){"use strict";a.d(t,"J",(function(){return j})),a.d(t,"I",(function(){return B})),a.d(t,"s",(function(){return ve})),a.d(t,"r",(function(){return Te})),a.d(t,"l",(function(){return Le})),a.d(t,"c",(function(){return Pe})),a.d(t,"O",(function(){return Ne})),a.d(t,"K",(function(){return De})),a.d(t,"H",(function(){return je})),a.d(t,"e",(function(){return Be})),a.d(t,"a",(function(){return Re})),a.d(t,"d",(function(){return Fe})),a.d(t,"b",(function(){return Ae})),a.d(t,"q",(function(){return Ve})),a.d(t,"x",(function(){return R})),a.d(t,"w",(function(){return H})),a.d(t,"m",(function(){return z})),a.d(t,"y",(function(){return W})),a.d(t,"h",(function(){return X})),a.d(t,"i",(function(){return G})),a.d(t,"j",(function(){return Z})),a.d(t,"E",(function(){return q})),a.d(t,"n",(function(){return K})),a.d(t,"v",(function(){return Y})),a.d(t,"f",(function(){return J})),a.d(t,"g",(function(){return Q})),a.d(t,"G",(function(){return $})),a.d(t,"D",(function(){return ye})),a.d(t,"L",(function(){return te})),a.d(t,"B",(function(){return ne})),a.d(t,"F",(function(){return ae})),a.d(t,"o",(function(){return ee})),a.d(t,"C",(function(){return se})),a.d(t,"p",(function(){return ie})),a.d(t,"z",(function(){return oe})),a.d(t,"A",(function(){return re})),a.d(t,"u",(function(){return ce})),a.d(t,"N",(function(){return Ce})),a.d(t,"t",(function(){return Ee})),a.d(t,"k",(function(){return Ue})),a.d(t,"M",(function(){return Se})),a.d(t,"P",(function(){return F}));var n=a(7),s=a.n(n),i=a(11),o=a(0),r=a.n(o),c=a(333),l=a.n(c),d=a(32),h=a(262),u=a(275),p=a(265),m=a(266),g=a(267),f=a(268),b=a(111),C=a(2),y=(a(370),a(280));class v extends r.a.Component{constructor(e){var t;super(e),t=this,this.handleClick=function(){var e=Object(i.a)(s.a.mark((function e(a){var n,i,o,r,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.stopPropagation(),a.preventDefault(),n=t.props,i=n.userId,o=n.username,r=n.popup,!i){e.next=7;break}Object(b.j)(i,r),e.next=12;break;case 7:if(!o){e.next=12;break}return e.next=10,C.a.send({"@type":"searchPublicChat",username:o}).catch(()=>{t.setState({error:!0})});case 10:(c=e.sent)&&(Object(y.R)(c.id)?Object(b.h)(c.id,null,!1):Object(b.h)(c.id,null,r));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleClose=()=>{this.setState({error:!1})},this.handleDialogClick=e=>{e.preventDefault(),e.stopPropagation()},this.state={}}static getDerivedStateFromProps(e,t){const a=e.userId,n=e.username;return t.prevUserId!==a||t.prevUsername!==n?{prevUserId:a,prevUsername:n,error:!1}:null}render(){const e=this.props,t=e.children,a=e.t,n=e.title,s=e.username,i=this.state.error;return r.a.createElement(r.a.Fragment,null,r.a.createElement("a",{title:n,onClick:this.handleClick},t),i&&r.a.createElement(u.a,{transitionDuration:0,open:!0,onClose:this.handleClose,onClick:this.handleDialogClick,"aria-labelledby":"confirm-dialog-title"},r.a.createElement(p.a,{id:"confirm-dialog-title"},a("Error")),r.a.createElement(m.a,{classes:{root:"safe-link-content-root"}},r.a.createElement(g.a,null,"Can't find username ".concat(s,"."))),r.a.createElement(f.a,null,r.a.createElement(h.a,{onClick:this.handleClose},a("Ok")))))}}v.defaultProps={popup:!0};var E=Object(d.d)()(v),U=(a(351),a(304)),S=a(303),k=a(18),M=a(279),I=a(282),w=a(317),_=a(314),x=a(288),O=a(14),T=a(9),L=a(39),P=a(278),N=a(110),D=a(72);function j(e,t){const a=N.a.get(e,t);if(!a)return!1;const n=a.content;if(!n)return!1;const s=n.caption;if(s&&s.text&&s.text.length>0)return!1;switch(n["@type"]){case"messageAnimation":case"messageLocation":case"messagePhoto":case"messageSticker":case"messageVideo":case"messageVideoNote":return!0}return!1}function B(e,t){const a=L.a.get(e);if(!a)return!1;const n=a.last_read_inbox_message_id,s=a.last_read_outbox_message_id,i=N.a.get(e,t);if(!i)return!1;const o=i.id,r=i.is_outgoing,c=Object(y.S)(e);return(!r||!c)&&(r?o>s:o>n)}function R(e,t=(e=>e)){if(!e)return null;const a=e.sender_user_id,n=e.chat_id;if(a){if(D.a.get(a))return Object(x.c)(a,null,t)}if(n){const e=L.a.get(n);if(e)return e.title}return null}function F(e,t,a){return t<0&&(t=0),t>e.length-1&&(t=e.length-1),a<t&&(a=t),a>e.length&&(a=e.length),e.substring(t,a)}function A(e){e.stopPropagation()}function V(e,t){e.stopPropagation(),e.preventDefault();const a=T.a.chatId;Object(b.l)(a,t)}function z(e,t=(e=>e)){if("formattedText"!==e["@type"])return null;const a=e.text,n=e.entities;if(!a)return null;if(!n)return a;let s=!1,i=[],o=0;for(let c=0;c<n.length;c++){const e=n[c],l=e.offset,d=e.length,h=e.type;if(o>l)continue;let u=F(a,o,l);const p=u.length;u&&(s&&u.length>0&&"\n"===u[0]&&(u=u.substr(1),s=!1),u&&i.push(u));const m=l;let g=F(a,l,l+d);switch(s&&g.length>0&&"\n"===g[0]&&(g=g.substr(1),s=!1),h["@type"]){case"textEntityTypeBold":i.push(r.a.createElement("strong",{key:m},g));break;case"textEntityTypeBotCommand":{const e=g.length>0&&"/"===g[0]?F(g,1):g;i.push(r.a.createElement("a",{key:m,onClick:A,href:"tg://bot_command?command=".concat(e,"&bot=")},g));break}case"textEntityTypeCashtag":i.push(r.a.createElement("a",{key:m,onClick:e=>V(e,g)},g));break;case"textEntityTypeCode":i.push(r.a.createElement("code",{key:m},g));break;case"textEntityTypeEmailAddress":i.push(r.a.createElement("a",{key:m,href:"mailto:".concat(g),onClick:A,target:"_blank",rel:"noopener noreferrer"},g));break;case"textEntityTypeHashtag":i.push(r.a.createElement("a",{key:m,onClick:e=>V(e,g)},g));break;case"textEntityTypeItalic":i.push(r.a.createElement("em",{key:m},g));break;case"textEntityTypeMentionName":i.push(r.a.createElement(E,{key:m,userId:h.user_id,title:Object(x.c)(h.user_id,null,t)},g));break;case"textEntityTypeMention":i.push(r.a.createElement(E,{key:m,username:g},g));break;case"textEntityTypePhoneNumber":i.push(r.a.createElement("a",{key:m,href:"tel:".concat(g),onClick:A},g));break;case"textEntityTypePre":i.push(r.a.createElement("pre",{key:m},g)),s=!0;break;case"textEntityTypePreCode":i.push(r.a.createElement("pre",{key:m},r.a.createElement("code",null,g))),s=!0;break;case"textEntityTypeTextUrl":{const e=h.url?h.url:g;i.push(r.a.createElement(U.a,{key:m,url:e},g));break}case"textEntityTypeUrl":i.push(r.a.createElement(U.a,{key:m,url:g},g));break;default:i.push(g)}o+=p+e.length}if(o<a.length){let e=a.substring(o);s&&e.length>0&&"\n"===e[0]&&(e=e.substr(1)),e&&i.push(e)}return i}function H(e,t,a=(e=>e)){if(!e)return null;let n=[];const s=e.content;if(!s)return[...n,t];const i=s.text,o=s.caption;if(i&&"formattedText"===i["@type"]&&i.text)n=z(i,a);else if(o&&"formattedText"===o["@type"]&&o.text){const e=z(o,a);e&&(n=n.concat(e))}return n&&n.length>0?[...n,t]:[]}function W(e){return e&&e.content?e.content.web_page:null}function G(e){if(!e)return null;const t=new Date(1e3*e);return Object(S.a)(t,"H:MM")}function Z(e){if(!e)return null;const t=new Date(1e3*e);return Object(S.a)(t,"H:MM:ss d.mm.yyyy")}function q(e){if(!e)return!1;const t=e.origin;if(!t)return!1;switch(t["@type"]){case"messageForwardOriginUser":return!1;case"messageForwardOriginHiddenUser":return!0;case"messageForwardOriginChannel":return!1}return!1}function K(e,t=(e=>e)){if(!e)return"";const a=e.origin;if(!a)return"";switch(a["@type"]){case"messageForwardOriginUser":{const e=a.sender_user_id;return Object(x.c)(e,null,t)}case"messageForwardOriginHiddenUser":return a.sender_name;case"messageForwardOriginChannel":{const e=a.chat_id,n=a.author_signature;return Object(y.s)(e,!1,t)+(n?" (".concat(n,")"):"")}}return""}function Y(e){return e?e.sender_user_id:null}function J(e,t){if(0===e.messages.length)return;if(0===t.length)return;const a=t.reduce((function(e,t){return e.set(t.id,t.id),e}),new Map);e.messages=e.messages.filter(e=>!a.has(e.id))}function Q(e){return e.filter(e=>"messageChatUpgradeTo"!==e.content["@type"])}function X(e,t=(e=>e)){if(!e)return null;const a=e.content;if(!a)return null;let n="";if(a.caption&&a.caption.text&&(n=", ".concat(a.caption.text)),e.ttl>0)return Object(_.a)(e);switch(a["@type"]){case"messageAnimation":return t("AttachGif")+n;case"messageAudio":return t("AttachMusic")+n;case"messageBasicGroupChatCreate":return Object(_.a)(e);case"messageCall":return t("Call")+n;case"messageChatAddMembers":case"messageChatChangePhoto":case"messageChatChangeTitle":case"messageChatDeleteMember":case"messageChatDeletePhoto":case"messageChatJoinByLink":case"messageChatSetTtl":case"messageChatUpgradeFrom":case"messageChatUpgradeTo":return Object(_.a)(e);case"messageContact":return t("AttachContact")+n;case"messageContactRegistered":case"messageCustomServiceAction":return Object(_.a)(e);case"messageDocument":{const e=a.document;return e&&e.file_name?e.file_name+n:t("AttachDocument")+n}case"messageExpiredPhoto":return t("AttachPhoto")+n;case"messageExpiredVideo":return t("AttachVideo")+n;case"messageGame":return t("AttachGame")+n;case"messageGameScore":case"messageInvoice":return Object(_.a)(e);case"messageLocation":return t("AttachLocation")+n;case"messagePassportDataReceived":case"messagePassportDataSent":case"messagePaymentSuccessful":case"messagePaymentSuccessfulBot":return Object(_.a)(e);case"messagePhoto":return t("AttachPhoto")+n;case"messagePoll":return"\ud83d\udcca "+(a.poll.question||t("Poll"))+n;case"messagePinMessage":case"messageScreenshotTaken":return Object(_.a)(e);case"messageSticker":{const e=a.sticker;let s="";return e&&e.emoji&&(s=e.emoji),t("AttachSticker")+(s?" ".concat(s):"")+n}case"messageSupergroupChatCreate":return Object(_.a)(e);case"messageText":return a.text.text+n;case"messageUnsupported":return Object(_.a)(e);case"messageVenue":return t("AttachLocation")+n;case"messageVideo":return t("AttachVideo")+n;case"messageVideoNote":return t("AttachRound")+n;case"messageVoiceNote":return t("AttachAudio")+n;case"messageWebsiteConnected":return Object(_.a)(e);default:return t("UnsupportedAttachment")}}function $(e){return!!e&&"messagePhoto"===e["@type"]}function ee(e,t=O.p,a=O.n,n=O.q,s=O.o){if(!e)return null;const i=e.longitude,o=e.latitude;return"loc=".concat(o,",").concat(i,"&size=").concat(t,",").concat(a,"&scale=").concat(s,"&zoom=").concat(n)}function te(e,t){const a=N.a.get(e,t);if(!a)return!1;const n=a.content;if(!n)return!1;switch(n["@type"]){case"messageVideo":return!0;case"messageText":{const e=n.web_page;return Boolean(e.video)}default:return!1}}function ae(e,t){const a=N.a.get(e,t);if(!a)return!1;const n=a.content;if(!n)return!1;switch(n["@type"]){case"messageDocument":{const e=n.document;if(!e)return!1;const t=e.file_name;return t&&t.toLowerCase().endsWith(".json")}case"messageText":{const e=n.web_page;if(!e)return!1;const t=e.document;if(!t)return!1;const a=t.file_name;return a&&a.toLowerCase().endsWith(".json")}default:return!1}}function ne(e,t){const a=N.a.get(e,t);if(!a)return!1;const n=a.content;if(!n)return!1;switch(n["@type"]){case"messageAnimation":return!0;case"messageText":{const e=n.web_page;return Boolean(e.animation)}default:return!1}}function se(e,t){const a=N.a.get(e,t);if(!a)return!0;const n=a.content;if(!n)return!0;switch(n["@type"]){case"messageVoiceNote":return n.is_listened;case"messageVideoNote":return n.is_viewed;default:return!0}}function ie(e,t=(e=>e)){if(!e)return null;const a=e.content;if(!a)return null;switch(a["@type"]){case"messageAudio":{const e=a.audio;if(e)return Object(I.c)(e);break}case"messageText":{const e=a.web_page;if(e){const t=e.audio;if(t)return Object(I.c)(t);break}}}return function(e,t=(e=>e)){if(!e)return null;const a=e.forward_info;if(a)switch(a["@type"]){case"messageForwardedFromUser":if(a.sender_user_id>0){if(D.a.get(a.sender_user_id))return Object(x.c)(a.sender_user_id,null,t)}break;case"messageForwardedPost":{const e=L.a.get(a.chat_id);if(e)return e.title;break}}return R(e,t)}(e,t)}function oe(e,t){const a=N.a.get(e,t);if(!a)return!1;const n=a.content;if(!n)return!1;switch(n["@type"]){case"messageAudio":if(n.audio)return!0;break;case"messageText":{const e=n.web_page;if(e){if(e.audio)return!0}break}}return!1}function re(e,t){const a=N.a.get(e,t);if(!a)return!1;const n=a.content;if(!n)return!1;switch(n["@type"]){case"messageVideoNote":if(n.video_note)return!0;break;case"messageText":{const e=n.web_page;if(e){if(e.video_note)return!0}break}}return!1}function ce(e,t){const a=N.a.get(e,t);if(!a)return null;const n=a.content;if(!n)return null;switch(n["@type"]){case"messageAudio":if(n.audio)return{"@type":"searchMessagesFilterAudio"};break;case"messageVoiceNote":if(n.voice_note)return{"@type":"searchMessagesFilterVoiceNote"};break;case"messageVideoNote":if(n.video_note)return null;break;case"messageText":{const e=n.web_page;if(e){const t=e.audio,a=e.voice_note,n=e.video_note;if(t)return null;if(a)return null;if(n)return null;break}}}return null}function le(e,t,a){if(!e)return;if(!t)return;const n=t.chat_id,s=t.id;let i=e.animation;i&&(i=P.a.get(i.id)||i,a&&i.local.is_downloading_active?P.a.cancelGetRemoteFile(i.id,t):a&&i.remote.is_uploading_active?P.a.cancelUploadFile(i.id,t):(C.a.clientUpdate({"@type":"clientUpdateActiveAnimation",chatId:n,messageId:s}),C.a.send({"@type":"openMessageContent",chat_id:n,message_id:s}),Object(b.p)({chatId:n,messageId:s})))}function de(e,t,a){if(!e)return;if(!t)return;const n=t.chat_id,s=t.id;let i=e.audio;i&&(i=P.a.get(i.id)||i,a&&i.local.is_downloading_active?P.a.cancelGetRemoteFile(i.id,t):a&&i.remote.is_uploading_active?P.a.cancelUploadFile(i.id,t):(Object(M.b)(i,t,()=>P.a.updateAudioBlob(n,s,i.id)),C.a.send({"@type":"openMessageContent",chat_id:n,message_id:s}),C.a.clientUpdate({"@type":"clientUpdateMediaActive",chatId:n,messageId:s})))}function he(e,t,a){if(!e)return;if(!t)return;const n=t.chat_id,s=t.id;let i=e.document;i&&(i=P.a.get(i.id)||i,a&&i.local.is_downloading_active?P.a.cancelGetRemoteFile(i.id,t):a&&i.remote.is_uploading_active?P.a.cancelUploadFile(i.id,t):(C.a.send({"@type":"openMessageContent",chat_id:n,message_id:s}),ae(n,s)?(C.a.send({"@type":"openMessageContent",chat_id:n,message_id:s}),Object(b.p)({chatId:n,messageId:s})):Object(M.G)(i,e.file_name,t)))}function ue(e,t,a){if(!e)return;if(!t)return;const n=t.chat_id,s=t.id,i=Object(k.j)(e.sizes);if(!i)return;let o=i.photo;o&&(o=P.a.get(o.id)||o,a&&o.local.is_downloading_active?P.a.cancelGetRemoteFile(o.id,t):a&&o.remote.is_uploading_active?P.a.cancelUploadFile(o.id,t):(Object(M.b)(o,t,()=>P.a.updatePhotoBlob(n,s,o.id)),C.a.send({"@type":"openMessageContent",chat_id:n,message_id:s}),Object(b.p)({chatId:n,messageId:s})))}function pe(e,t,a){return me.apply(this,arguments)}function me(){return(me=Object(i.a)(s.a.mark((function e(t,a,n){var i,o,r,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:if(a){e.next=4;break}return e.abrupt("return");case 4:if(i=a.chat_id,o=a.id,C.a.send({"@type":"openMessageContent",chat_id:i,message_id:o}),r=t.set_id){e.next=9;break}return e.abrupt("return");case 9:return e.next=11,C.a.send({"@type":"getStickerSet",set_id:r});case 11:if(c=e.sent){e.next=14;break}return e.abrupt("return");case 14:C.a.clientUpdate({"@type":"clientUpdateStickerSet",stickerSet:c});case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ge(e,t,a){if(!e)return;if(!t)return;const n=t.chat_id,s=t.id;let i=e.video;i&&(i=P.a.get(i.id)||i,a&&i.local.is_downloading_active?P.a.cancelGetRemoteFile(i.id,t):a&&i.remote.is_uploading_active?P.a.cancelUploadFile(i.id,t):(C.a.send({"@type":"openMessageContent",chat_id:n,message_id:s}),Object(b.p)({chatId:n,messageId:s})))}function fe(e,t,a){if(!e)return;if(!t)return;const n=t.chat_id,s=t.id;let i=e.video;i&&(i=P.a.get(i.id)||i,a&&i.local.is_downloading_active?P.a.cancelGetRemoteFile(i.id,t):a&&i.remote.is_uploading_active?P.a.cancelUploadFile(i.id,t):(Object(M.b)(i,t,()=>P.a.updateVideoNoteBlob(n,s,i.id)),C.a.send({"@type":"openMessageContent",chat_id:n,message_id:s}),C.a.clientUpdate({"@type":"clientUpdateMediaActive",chatId:n,messageId:s})))}function be(e,t,a){if(!e)return;if(!t)return;const n=t.chat_id,s=t.id;let i=e.voice;i&&(i=P.a.get(i.id)||i,a&&i.local.is_downloading_active?P.a.cancelGetRemoteFile(i.id,t):a&&i.remote.is_uploading_active?P.a.cancelUploadFile(i.id,t):(Object(M.b)(i,t,()=>P.a.updateVoiceNoteBlob(n,s,i.id)),C.a.send({"@type":"openMessageContent",chat_id:n,message_id:s}),C.a.clientUpdate({"@type":"clientUpdateMediaActive",chatId:n,messageId:s})))}function Ce(e,t,a=!0){const n=N.a.get(e,t);if(!n)return;const s=n.content;if(!s)return null;switch(s["@type"]){case"messageAnimation":{const e=s.animation;e&&le(e,n,a);break}case"messageAudio":{const e=s.audio;e&&de(e,n,a);break}case"messageChatChangePhoto":{const e=s.photo;e&&function(e,t,a){if(!e)return;if(!t)return;const n=t.chat_id,s=t.id,i=Object(k.j)(e.sizes);if(!i)return;let o=i.photo;o&&(o=P.a.get(o.id)||o,a&&o.local.is_downloading_active?P.a.cancelGetRemoteFile(o.id,t):a&&o.remote.is_uploading_active?P.a.cancelUploadFile(o.id,t):(Object(M.b)(o,t,()=>P.a.updatePhotoBlob(n,s,o.id)),C.a.send({"@type":"openMessageContent",chat_id:n,message_id:s}),Object(b.p)({chatId:n,messageId:s})))}(e,n,a);break}case"messageContact":{const e=s.contact;e&&function(e,t,a){if(!e)return;if(!t)return;const n=t.chat_id,s=t.id;C.a.send({"@type":"openMessageContent",chat_id:n,message_id:s}),Object(b.j)(e.user_id,!0)}(e,n);break}case"messageDocument":{const e=s.document;e&&he(e,n,a);break}case"messageGame":{const e=s.game;e&&function(e,t,a){if(!e)return;if(!t)return;const n=t.chat_id,s=t.id,i=e.animation;if(i){let e=i.animation;if(!e)return;if(e=P.a.get(e.id)||e,a&&e.local.is_downloading_active)return void P.a.cancelGetRemoteFile(e.id,t);if(a&&e.remote.is_uploading_active)return void P.a.cancelUploadFile(e.id,t);Object(M.b)(e,t,()=>P.a.updateAnimationBlob(n,s,e.id))}C.a.send({"@type":"openMessageContent",chat_id:n,message_id:s}),C.a.clientUpdate({"@type":"clientUpdateActiveAnimation",chatId:n,messageId:s})}(e,n,a);break}case"messagePhoto":{const e=s.photo;e&&ue(e,n,a);break}case"messageSticker":{const e=s.sticker;e&&pe(e,n,a);break}case"messageText":{const e=s.web_page;if(e){const t=e.animation,s=e.audio,i=e.document,o=e.photo,r=e.sticker,c=e.video,l=e.video_note,d=e.voice_note;t&&le(t,n,a),s&&de(s,n,a),i&&he(i,n,a),r&&pe(r,n,a),c&&ge(c,n,a),l&&fe(l,n,a),d&&be(d,n,a),o&&ue(o,n,a)}break}case"messageVideo":{const e=s.video;e&&ge(e,n,a);break}case"messageVideoNote":{const e=s.video_note;e&&fe(e,n,a);break}case"messageVoiceNote":{const e=s.voice_note;e&&be(e,n,a);break}}}function ye(e){return e&&"deletedMessage"===e["@type"]}function ve(e,t){const a=N.a.get(e,t);if(!a)return;const n=a.content;if(!n)return null;switch(n["@type"]){case"messageAnimation":{const e=n.animation;return e&&e.minithumbnail||null}case"messageAudio":return null;case"messageChatChangePhoto":{const e=n.photo;return e&&e.minithumbnail||null}case"messageDocument":{const e=n.document;return e&&e.minithumbnail||null}case"messageGame":{const e=n.game;if(!e)return null;const t=e.animation,a=e.photo;if(t){const e=t.minithumbnail;if(e)return e}return a&&a.minithumbnail||null}case"messagePhoto":{const e=n.photo;return e&&e.minithumbnail||null}case"messageSticker":return null;case"messageText":{const e=n.web_page;if(e){const t=e.animation,a=e.audio,n=e.document,s=e.photo,i=e.sticker,o=e.video,r=e.video_note;if(s)return s.minithumbnail||null;if(t){return t.minithumbnail||null}if(a)return null;if(n){return n.minithumbnail||null}if(i)return null;if(o){return o.minithumbnail||null}if(r){return r.minithumbnail||null}}break}case"messageVideo":{const e=n.video;return e&&e.minithumbnail||null}case"messageVideoNote":{const e=n.video_note;return e&&e.minithumbnail||null}}return null}function Ee(e,t){const a=N.a.get(e,t);if(!a)return;const n=a.content;if(!n)return null;switch(n["@type"]){case"messageAnimation":{const e=n.animation;return e&&e.thumbnail||null}case"messageAudio":{const e=n.audio;return e&&e.album_cover_thumbnail||null}case"messageChatChangePhoto":{const e=n.photo;return e?Object(k.j)(e.sizes):null}case"messageDocument":{const e=n.document;return e&&e.thumbnail||null}case"messageGame":{const e=n.game;if(!e)return null;const t=e.animation,a=e.photo;if(t){const e=t.thumbnail;if(e)return e}return a?Object(k.j)(a.sizes):null}case"messagePhoto":{const e=n.photo;return e?Object(k.j)(e.sizes):null}case"messageSticker":{const e=n.sticker;return e&&e.thumbnail||null}case"messageText":{const e=n.web_page;if(e){const t=e.animation,a=e.audio,n=e.document,s=e.photo,i=e.sticker,o=e.video,r=e.video_note;if(s)return Object(k.j)(s.sizes);if(t){return t.thumbnail||null}if(a){return a.album_cover_thumbnail||null}if(n){return n.thumbnail||null}if(i){return i.thumbnail||null}if(o){return o.thumbnail||null}if(r){return r.thumbnail||null}}break}case"messageVideo":{const e=n.video;return e&&e.thumbnail||null}case"messageVideoNote":{const e=n.video_note;return e&&e.thumbnail||null}}return null}function Ue(e,t){const a=N.a.get(e,t);if(!a)return 0;const n=a.content;if(!n)return 0;if("messageText"!==n["@type"])return 0;const s=n.text;if(!s)return;if("formattedText"!==s["@type"])return 0;const i=s.text,o=s.entities;if(!i)return 0;if(o&&o.length>0)return 0;let r,c=0,d=0;const h=l()();do{if(r=h.exec(i),r){if(d+=1,c!==r.index){d=0;break}if(d>3){d=0;break}c=h.lastIndex}if(!r&&c!==i.length){d=0;break}}while(r);return d}function Se(e,t){return e.id-t.id}function ke(e,t){if(!t)return!1;if(!t.length)return!1;for(let a=0;a<t.length;a++)if(e>=t[a].offset&&e<t[a].offset+t[a].length)return!0;return!1}function Me(e,t,a){if(!a)return!1;if(!a.length)return!1;for(let n=0;n<a.length;n++)if(e<=a[n].offset&&a[n].offset+a[n].length-1<=t)return!0;return!1}function Ie(e,t,a){return!ke(e,a)&&!ke(t,a)&&!Me(e,t,a)}function we(e,t,a){a&&a.length&&a.forEach(a=>{a.offset>e&&(a.offset-=t)})}function _e(e,t,a){a&&a.length&&a.forEach(a=>{a.offset>e&&(a.offset+=t)})}function xe(e,t,a){if(a&&a.length)for(let n=0;n<a.length;n++){const s=a[n],i=s.offset,o=s.offset+s.length-1;(e<=i&&i<=t||e<=o&&o<=t||i<e&&t>o)&&a.splice(n--,1)}}function Oe(e,t,a,n){const s=document.createTextNode(a.substr(e,t));n.push(s)}function Te(e,t,a=(e=>e)){if(!e)return[];t=(t||[]).sort((e,t)=>e.offset-t.offset!==0?e.offset-t.offset:t.length-e.length);let n=[],s=0,i=null;return t.forEach(t=>{if(t.offset-s>0&&(Oe(s,t.offset-s,e,n),s=t.offset),!i||!ke(t.offset,[i])){switch(t.type["@type"]){case"textEntityTypeBold":{const a=document.createElement("b");a.innerText=e.substr(t.offset,t.length),n.push(a);break}case"textEntityTypeBotCommand":case"textEntityTypeCashtag":Oe(t.offset,t.length,e,n);break;case"textEntityTypeCode":{const a=document.createTextNode("`"+e.substr(t.offset,t.length)+"`");n.push(a);break}case"textEntityTypeEmailAddress":case"textEntityTypeHashtag":Oe(t.offset,t.length,e,n);break;case"textEntityTypeItalic":{const a=document.createElement("i");a.innerText=e.substr(t.offset,t.length),n.push(a);break}case"textEntityTypeMention":Oe(t.offset,t.length,e,n);break;case"textEntityTypeMentionName":try{const s=t.type.user_id;if(D.a.get(s)){const i=document.createElement("a");i.title=Object(x.c)(s,null,a),i.dataset.userId=s,i.innerText=e.substr(t.offset,t.length),n.push(i)}else Oe(t.offset,t.length,e,n)}catch(o){Oe(t.offset,t.length,e,n)}break;case"textEntityTypePhoneNumber":Oe(t.offset,t.length,e,n);break;case"textEntityTypePre":{const a=document.createTextNode("```"+e.substr(t.offset,t.length)+"```");n.push(a);break}case"textEntityTypePreCode":{const a=document.createTextNode("```"+e.substr(t.offset,t.length)+"```");n.push(a);break}case"textEntityTypeTextUrl":try{const a=t.type.url,s=document.createElement("a");s.href=Object(w.a)(a,!1),s.title=Object(w.a)(a,!1),s.target="_blank",s.rel="noopener noreferrer",s.innerText=e.substr(t.offset,t.length),n.push(s)}catch(r){Oe(t.offset,t.length,e,n)}break;case"textEntityTypeUrl":default:Oe(t.offset,t.length,e,n)}i=t,s+=t.length}}),s<e.length&&Oe(s,e.length-s,e,n),n}function Le(e){const t=[];if(!e)return{text:e,entities:t};e=e.split("<br>").join("\n");let a=-1,n=0,s=-1,i=!1;const o=(new DOMParser).parseFromString(e,"text/html");let r=0,c=0,l="";for(o.body.childNodes.forEach(e=>{const a=e.textContent,n=e.nodeName;if(c=a.length,l+=a,Ie(r,r+c-1,t))switch(n){case"#text":r+=c;break;case"A":e.dataset.userId?t.push({"@type":"textEntity",offset:r,length:c,type:{"@type":"textEntityTypeMentionName",user_id:e.dataset.userId},textContent:l.substring(r,r+c)}):e.href&&t.push({"@type":"textEntity",offset:r,length:c,type:{"@type":"textEntityTypeTextUrl",url:e.href},textContent:l.substring(r,r+c)}),r+=c;break;case"B":case"STRONG":t.push({"@type":"textEntity",offset:r,length:c,type:{"@type":"textEntityTypeBold"},textContent:l.substring(r,r+c)}),r+=c;break;case"BR":break;case"CODE":t.push({"@type":"textEntity",offset:r,length:c,type:{"@type":"textEntityTypeCode"},textContent:l.substring(r,r+c)}),r+=c;break;case"I":case"EM":t.push({"@type":"textEntity",offset:r,length:c,type:{"@type":"textEntityTypeItalic"},textContent:l.substring(r,r+c)}),r+=c;break;case"PRE":t.push({"@type":"textEntity",offset:r,length:c,type:{"@type":"textEntityTypePre"},textContent:l.substring(r,r+c)}),r+=c;break;default:r+=c}}),e=l;-1!==(a=e.indexOf(i?"```":"`",n));)if(-1===s)i=e.length-a>2&&"`"===e[a+1]&&"`"===e[a+2],s=a,n=a+(i?3:1);else{for(let t=a+(i?3:1);t<e.length&&"`"===e[t];t++)a++;if(n=a+(i?3:1),i){let i=e.substring(0,s),o=e.substring(s+3,a),l=e.substring(a+3,e.length);if(o.length>0){r=s,c=a-s-3;const d={"@type":"textEntity",offset:r,length:c,language:"",type:{"@type":"textEntityTypePre"},textContent:(e=i+o+l).substring(r,r+c)};if(xe(r,r+c-1+6),we(r+c,6,t),t.push(d),n-=6,i.length>0){const a=i[i.length-1];"\n"!==a&&(" "===a||"\xa0"===a?(i=i.substr(0,i.length-1)+"\n",e=i+o+l):(i+="\n",e=i+o+l,_e(r-1,1,t),n+=1))}if(l.length>0){const a=l[0];"\n"!==a&&(" "===a||"\xa0"===a?(l="\n"+l.substr(1),e=i+o+l):(l="\n"+l,e=i+o+l,_e(r+c-1,1,t),n+=1))}o.length>2&&"\n"===o[0]&&(o=o.substring(1),e=i+o+l,d.length-=1,d.textContent=o,we(d.offset+d.length-1,1,t),n-=1),o.length>2&&"\n"===o[o.length-1]&&(o=o.substring(0,o.length-1),e=i+o+l,d.length-=1,d.textContent=o,we(d.offset+d.length-1,1,t),n-=1)}}else if(s+1!==a){r=s,c=a-s-1,e=e.substring(0,s)+e.substring(s+1,a)+e.substring(a+1,e.length);const i={"@type":"textEntity",offset:r,length:c,type:{"@type":"textEntityTypeCode"},textContent:e.substring(r,r+c)};xe(r,r+c-1+2),we(r+c,2,t),t.push(i),n-=2}s=-1,i=!1}if(-1!==s&&i&&(r=s,c=1,Ie(r,r+c+2-1,t))){e=e.substring(0,s)+e.substring(s+2,e.length);const a={"@type":"textEntity",offset:r,length:c,type:{"@type":"textEntityTypeCode"},textContent:e.substring(r,r+c)};xe(r,r+c-1+2),we(r+c,2,t),t.push(a)}for(let d=0;d<2;d++){n=0,s=-1;const i=0===d?"**":"__",o=0===d?"*":"_";for(;-1!==(a=e.indexOf(i,n));)if(-1===s){const i=0===a?" ":e[a-1];ke(a,t)||" "!==i&&"\xa0"!==i&&"\n"!==i||(s=a),n=a+2}else{for(let t=a+2;t<e.length&&e[t]===o;t++)a++;if(n=a+2,ke(a,t)||Me(s,a,t)){s=-1;continue}if(s+2!==a){r=s,c=a-s-2,e=e.substring(0,s)+e.substring(s+2,a)+e.substring(a+2,e.length);const i={"@type":"textEntity",offset:r,length:c,language:"",type:{"@type":0===d?"textEntityTypeBold":"textEntityTypeItalic"},textContent:e.substring(r,r+c)};we(r+c,4,t),t.push(i),n-=4}s=-1}}return{text:e,entities:t}}function Pe(e,t){const a=N.a.get(e,t);return!!a&&a.can_be_edited}function Ne(e,t){const a=N.a.get(e,t);if(!a)return!1;const n=a.forward_info,s=a.content;return n&&s&&"messageSticker"!==s["@type"]&&"messageAudio"!==s["@type"]}function De(e,t){const a=N.a.get(e,t);if(!a)return!1;const n=a.content;return n&&"messageText"===n["@type"]}function je(e,t){const a=L.a.get(e);return!!a&&a.pinned_message_id===t}function Be(e,t){const a=N.a.get(e,t);if(!a)return!1;const n=a.content;if(!n)return;if("messagePoll"!==n["@type"])return;const s=n.poll;if(!s)return!1;const i=s.type,o=s.is_closed,r=s.options;return!!i&&("pollTypeRegular"===i["@type"]&&(!o&&r.some(e=>e.is_chosen||e.is_being_chosen)))}function Re(e,t){const a=N.a.get(e,t);if(!a)return!1;const n=a.content,s=a.can_be_edited;return n&&"messagePoll"===n["@type"]?s:void 0}function Fe(e,t){const a=N.a.get(e,t);return a&&a.can_be_forwarded}function Ae(e,t){const a=N.a.get(e,t);return a&&(a.can_be_deleted_only_for_self||a.can_be_deleted_for_all_users)}function Ve(e,t){const a=N.a.get(e,t);if(!a)return null;const n=a.content;if(!n)return null;switch(n["@type"]){case"messageAnimation":{const e=n.animation;if(!e)return null;const t=e.width,a=e.height,s=e.thumbnail,i={width:t,height:a}||s;if(!i)return null;const o=Object(k.g)(i,O.D,!1);return o?{width:o.width}:null}case"messagePhoto":{const e=n.photo;if(!e)return null;const t=Object(k.m)(e.sizes,O.F);if(!t)return null;const a=Object(k.g)(t,O.D,!1);return a?{width:a.width}:null}case"messageVideo":{const e=n.video;if(!e)return null;const t=e.thumbnail,a={width:e.width,height:e.height}||t;if(!a)return null;const s=Object(k.g)(a,O.D);return s?{width:s.width}:null}}return null}},function(e,t,a){"use strict";a.d(t,"d",(function(){return H})),a.d(t,"l",(function(){return W})),a.d(t,"m",(function(){return G})),a.d(t,"k",(function(){return Z})),a.d(t,"c",(function(){return q})),a.d(t,"a",(function(){return K})),a.d(t,"b",(function(){return Y})),a.d(t,"j",(function(){return J})),a.d(t,"i",(function(){return Q})),a.d(t,"e",(function(){return te})),a.d(t,"f",(function(){return ae})),a.d(t,"g",(function(){return ne})),a.d(t,"h",(function(){return ie}));var n=a(7),s=a.n(n),i=a(11),o=a(44),r=a(14),c=a(110),l=a(312),d=a(318),h=a(0),u=a.n(h),p=a(109),m=a.n(p),g=a(228),f=a(340),b=a.n(f),C=a(18);a(389);class y extends u.a.Component{render(){const e=this.props,t=e.chatId,a=e.messageId,n=e.duration,s=(e.openMedia,e.title),i=e.meta,o=H(t,a),r=Object(C.e)(Math.floor(n||0));return u.a.createElement("div",{className:m()("document",{"media-title":s})},u.a.createElement(g.a,{color:"primary","aria-label":"Call"},u.a.createElement(b.a,{fontSize:"large"})),u.a.createElement("div",{className:"document-content"},u.a.createElement("div",{className:"document-title"},o),u.a.createElement("div",{className:"document-action"},r,i)))}}var v=y,E=a(32),U=a(299),S=a(83),k=a(288),M=a(72);a(390);class I extends u.a.Component{render(){const e=this.props,t=e.contact,a=e.title,n=e.openMedia,s=e.meta,i=e.caption,o=e.t;if(!t)return null;const r=t.user_id,c=t.first_name,l=t.last_name,d=t.phone_number,h=M.a.get(r)||{"@type":"user",type:{"@type":"userTypeRegular"},id:r,first_name:c,last_name:l},p=Object(k.c)(r,h,o),g=Object(S.a)(d);return u.a.createElement("div",{className:m()("contact",{"media-title":a})},u.a.createElement("div",{className:"contact-tile"},u.a.createElement(U.a,{userId:r,firstName:c,lastName:l})),u.a.createElement("div",{className:"contact-content"},u.a.createElement("div",{className:"contact-name"},r>0?u.a.createElement("a",{onClick:n},p):u.a.createElement("span",null,p)),u.a.createElement("div",{className:"contact-phone"},g,!i&&s)))}}var w=Object(E.d)()(I),_=a(352),x=a(300),O=a(281),T=a(279);a(394);class L extends u.a.Component{constructor(...e){super(...e),this.getContent=()=>{const e=this.props,t=e.chatId,a=e.messageId,n=e.game,s=e.size,i=e.displaySize,o=e.openMedia;if(!n)return null;const r=n.photo,c=n.animation;if(c){if(Object(T.j)(c.animation)||c.thumbnail)return u.a.createElement(l.a,{chatId:t,messageId:a,animation:c,openMedia:o})}if(r){let e={width:0,height:0};const n=Object(C.m)(r.sizes,s);if(n){const t=Object(C.g)(n,i);t&&(e.width=t.width,e.height=t.height)}return u.a.createElement(x.a,{chatId:t,messageId:a,photo:r,style:e,openMedia:o})}return null}}render(){const e=this.props,t=e.game,a=e.t;if(!t)return null;const n=t.title,s=t.text,i=t.description,o=Object(O.m)(s,a);return u.a.createElement("div",{className:"game"},u.a.createElement("div",{className:"border"}),u.a.createElement("div",{className:"game-wrapper"},n&&u.a.createElement("div",{className:"game-title"},n),o&&u.a.createElement("div",{className:"game-text"},o),i&&u.a.createElement("div",{className:"game-description"},i),this.getContent()))}}L.defaultProps={size:r.F,displaySize:r.D};var P=Object(E.d)()(L),N=a(322),D=a(351),j=a(294);a(399);class B extends u.a.Component{render(){const e=this.props,t=e.chatId,a=e.messageId,n=e.venue,s=e.openMedia,i=e.meta,o=e.title,r=e.caption;if(!n)return null;const c=n.title,l=n.address,d=n.location;if(!d)return null;const h=d.longitude,p=d.latitude,m="https://maps.google.com/?q=".concat(p,",").concat(h);return u.a.createElement("div",{className:"venue"},u.a.createElement(N.a,{type:"venue",chatId:t,messageId:a,location:d,openMedia:s,title:o,caption:r}),u.a.createElement("div",{className:"venue-content"},u.a.createElement("a",{href:m,target:"_blank",rel:"noopener noreferrer"},u.a.createElement("div",{className:"venue-title"},c)),u.a.createElement("div",{className:"venue-subtitle"},l,!r&&i)))}}var R=B,F=a(323),A=a(341),V=a(353),z=a(278);function H(e,t){const a=c.a.get(e,t);if(!a)return null;const n=a.content,s=a.is_outgoing;if("messageCall"!==n["@type"])return null;const i=n.discard_reason;n.duration;return s?"callDiscardReasonMissed"===i["@type"]?"Cancelled Call":"Outgoing Call":"callDiscardReasonMissed"===i["@type"]?"Missed Call":"callDiscardReasonDeclined"===i["@type"]?"Declined Call":"Incoming Call"}function W(e,t){const a=c.a.get(e,t);if(a){switch(a.content["@type"]){case"messageAnimation":case"messageAudio":case"messageDocument":case"messagePhoto":case"messageVideo":return!0}return!1}}function G(e,t,a){if(!e)return!1;if(!e.is_animated)return!1;const n=c.a.get(t,a);if(n){if(n.sending_state&&!e.set_id)return!1}return!0}function Z(e,t=r.nb){return!!e&&Math.max(e.width,e.height)<t}function q(e){if(!e)return null;const t=e.file_name,a=e.title,n=e.performer,s=a?a.trim():"",i=n?n.trim():"";return s||i?"".concat(i||"Unknown Artist"," \u2014 ").concat(s||"Unknown Track"):t}function K(e){if(!e)return null;const t=e.file_name,a=e.title,n=e.performer,s=a?a.trim():"",i=n?n.trim():"";return s||i?"".concat(i||"Unknown Artist"):t}function Y(e){if(!e)return null;const t=e.title;return(t?t.trim():"")||"Unknown Track"}function J(e){return e.reduce((e,t)=>e.concat(t.stickers),[])}function Q(e,t,a){const n=[],s=function(e,t,a){const n=t.findIndex(t=>t.id===e.set_id);if(-1===n)return[-1,-1];const s=t[n].stickers.findIndex(t=>t.sticker.id===e.sticker.id);if(-1===s)return[-1,-1];let i=0;for(let o=0;o<n;o++)i+=Math.ceil(t[o].stickers.length/a);return[i+Math.floor(s/a),s%a]}(e,t,a),i=Object(o.a)(s,2),r=i[0],c=i[1];if(-1===r)return[];if(-1===c)return[];const l=r-2,d=r-1,h=r+1,u=r+2,p=c-1,m=c+1;let g=d<0,f=l<0;if(!g){if(p>=0){let e=X(d,p,t,a);-1===e&&(g=!0,e=f?-1:X(l,p,t,a),f=-1===e),-1!==e&&n.push(e)}let e=g?-1:X(d,c,t,a);if(-1===e&&(g=!0,e=f?-1:X(l,c,t,a),f=-1===e),-1!==e&&n.push(e),m<a){let e=g?-1:X(d,m,t,a);-1===e&&(e=f?-1:X(l,m,t,a)),-1!==e&&n.push(e)}}if(p>=0){const e=X(r,p,t,a);-1!==e&&n.push(e)}if(m<a){const e=X(r,m,t,a);-1!==e&&n.push(e)}let b=t.reduce((e,t)=>e+Math.ceil(t.stickers.length/a),0),C=h>=b,y=h>=b;if(!C){if(p>=0){let e=X(h,p,t,a);-1===e&&(C=!0,e=y?-1:X(u,p,t,a),y=-1===e),-1!==e&&n.push(e)}let e=C?-1:X(h,c,t,a);if(-1===e&&(C=!0,e=y?-1:X(u,c,t,a),y=-1===e),-1!==e&&n.push(e),m<a){let e=C?-1:X(h,m,t,a);-1===e&&(e=y?-1:X(u,m,t,a)),-1!==e&&n.push(e)}}const v=J(t);return n.map(e=>v[e])}function X(e,t,a,n){let s=-1,i=0,o=-1;for(let l=0;l<a.length;l++){if(i+=Math.ceil(a[l].stickers.length/n),i>e){o=l;break}}if(-1===o)return s;let r=e,c=t;for(let l=0;l<o;l++){r-=Math.ceil(a[l].stickers.length/n)}if(s=n*r+c,s>=a[o].stickers.length)return-1;for(let l=0;l<o;l++)s+=a[l].stickers.length;return s}function $(e){if(!e)return null;const t=e.photo,a=e.width,n=e.height;return t?{"@type":"inputThumbnail",thumbnail:{"@type":"inputFileId",id:t.id},width:a,height:n}:null}function ee(e){return e?{"@type":"formattedText",text:e,entities:null}:null}function te(e,t){if(!e)return null;switch(e["@type"]){case"animation":{const a=e.animation,n=e.thumbnail,s=e.width,i=e.height,o=e.duration;return{"@type":"inputMessageAnimation",animation:{"@type":"inputFileId",id:a.id},thumbnail:$(n),duration:o,width:s,height:i,caption:ee(t)}}case"audio":{const a=e.audio,n=e.album_cover_thumbnail,s=e.title,i=e.performer,o=e.duration;return{"@type":"inputMessageAudio",audio:{"@type":"inputFileId",id:a.id},album_cover_thumbnail:$(n),duration:o,title:s,performer:i,caption:ee(t)}}case"contact":return{"@type":"inputMessageContact",contact:e};case"document":{const a=e.document,n=e.thumbnail;return{"@type":"inputMessageDocument",document:{"@type":"inputFileId",id:a.id},thumbnail:$(n),caption:ee(t)}}case"game":case"invoice":return null;case"location":return{"@type":"inputMessageLocation",location:e,live_period:0};case"photo":{const a=e.sizes;if(!a.length)return null;const n=a[0],s=a[a.length-1];if(!s)return null;const i=s.photo,o=s.width,r=s.height;return{"@type":"inputMessagePhoto",photo:{"@type":"inputFileId",id:i.id},thumbnail:$(n),added_sticker_file_ids:[],width:o,height:r,caption:ee(t),ttl:0}}case"poll":return null;case"sticker":{const a=e.sticker,n=e.thumbnail,s=e.width,i=e.height;return{"@type":"inputMessageSticker",sticker:{"@type":"inputFileId",id:a.id},thumbnail:$(n),width:s,height:i,caption:ee(t)}}case"venue":return{"@type":"inputMessageVenue",venue:e};case"video":{const a=e.video,n=e.thumbnail,s=e.width,i=e.height,o=e.duration,r=e.supports_streaming;return{"@type":"inputMessageVideo",video:{"@type":"inputFileId",id:a.id},thumbnail:$(n),added_sticker_file_ids:[],duration:o,width:s,height:i,supports_streaming:r,caption:ee(t),ttl:0}}case"videoNote":{const t=e.video,a=e.thumbnail,n=e.duration,s=e.length;return{"@type":"inputMessageVideoNote",video:{"@type":"inputFileId",id:t.id},thumbnail:$(a),duration:n,length:s,ttl:0}}case"voiceNote":{const t=e.voice,a=e.duration,n=e.waveform;return{"@type":"inputMessageVideoNote",voice_note:{"@type":"inputFileId",id:t.id},duration:a,waveform:n}}}return null}function ae(e,t,a=!1,n=!1,s=null){if(!e)return null;const i=e.chat_id,o=e.id,r=e.content;if(!r)return null;switch(r["@type"]){case"messageAnimation":return u.a.createElement(l.a,{type:"message",title:a,caption:n,chatId:i,messageId:o,animation:r.animation,openMedia:t});case"messageAudio":return u.a.createElement(d.a,{title:a,caption:n,chatId:i,messageId:o,audio:r.audio,openMedia:t,meta:s});case"messageCall":return u.a.createElement(v,{title:a,caption:n,chatId:i,messageId:o,duraton:r.duration,discardReason:r.discard_reason,openMedia:t,meta:s});case"messageContact":return u.a.createElement(w,{title:a,caption:n,chatId:i,messageId:o,contact:r.contact,openMedia:t,meta:s});case"messageDocument":return u.a.createElement(_.a,{title:a,caption:n,chatId:i,messageId:o,document:r.document,openMedia:t,meta:s});case"messageGame":return u.a.createElement(P,{chatId:i,messageId:o,game:r.game,openMedia:t});case"messageLocation":return u.a.createElement(N.a,{type:"message",title:a,caption:n,chatId:i,messageId:o,location:r.location,openMedia:t});case"messagePhoto":return u.a.createElement(x.a,{type:"message",title:a,caption:n,chatId:i,messageId:o,photo:r.photo,openMedia:t});case"messagePoll":return u.a.createElement(D.a,{chatId:i,messageId:o,poll:r.poll,openMedia:t,meta:s});case"messageSticker":return u.a.createElement(j.b,{chatId:i,messageId:o,sticker:r.sticker,source:j.a.MESSAGE,openMedia:t});case"messageText":return null;case"messageVenue":return u.a.createElement(R,{type:"message",title:a,caption:n,chatId:i,messageId:o,venue:r.venue,openMedia:t,meta:s});case"messageVideo":return u.a.createElement(F.a,{type:"message",title:a,caption:n,chatId:i,messageId:o,video:r.video,openMedia:t});case"messageVideoNote":return u.a.createElement(A.a,{type:"message",title:a,caption:n,chatId:i,messageId:o,videoNote:r.video_note,openMedia:t});case"messageVoiceNote":return u.a.createElement(V.a,{type:"message",title:a,caption:n,chatId:i,messageId:o,voiceNote:r.voice_note,openMedia:t,meta:s});default:return["[".concat(r["@type"],"]"),s]}}function ne(e){return se.apply(this,arguments)}function se(){return(se=Object(i.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:return a=-Object(C.l)(1,1e6),z.a.setBlob(a,t),e.abrupt("return",{"@type":"messageDocument",document:{"@type":"document",file_name:t.name,mime_type:t.type,minithumbnail:null,thumbnail:null,document:{"@type":"file",id:a,size:t.size,expected_size:t.expected_size,local:{is_downloading_completed:!0}}}});case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ie(e){return oe.apply(this,arguments)}function oe(){return(oe=Object(i.a)(s.a.mark((function e(t){var a,n,i,r,c,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:if(!t.type.startsWith("image")){e.next=15;break}return e.next=5,Object(C.w)(t);case 5:return a=e.sent,n=Object(o.a)(a,2),i=n[0],r=n[1],c=-Object(C.l)(1,1e6),z.a.setBlob(c,t),l={"@type":"photoSize",photo:{"@type":"file",id:c,size:t.size,expected_size:t.expected_size,local:{is_downloading_completed:!0}},width:i,height:r},e.abrupt("return",{"@type":"messagePhoto",photo:{"@type":"photo",has_stickers:!1,minithumbnail:null,sizes:[l]}});case 15:return e.abrupt("return",null);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},,,function(e,t,a){"use strict";var n=a(0),s=a.n(n),i=a(38);t.a=Object(i.a)(s.a.createElement("path",{d:"M5.29289322,5.29289322 C5.68341751,4.90236893 6.31658249,4.90236893 6.70710678,5.29289322 L6.70710678,5.29289322 L12,10.585 L17.2928932,5.29289322 C17.6834175,4.90236893 18.3165825,4.90236893 18.7071068,5.29289322 C19.0976311,5.68341751 19.0976311,6.31658249 18.7071068,6.70710678 L13.415,12 L18.7071068,17.2928932 C19.0675907,17.6533772 19.0953203,18.2206082 18.7902954,18.6128994 L18.7071068,18.7071068 C18.3165825,19.0976311 17.6834175,19.0976311 17.2928932,18.7071068 L17.2928932,18.7071068 L12,13.415 L6.70710678,18.7071068 C6.31658249,19.0976311 5.68341751,19.0976311 5.29289322,18.7071068 C4.90236893,18.3165825 4.90236893,17.6834175 5.29289322,17.2928932 L10.585,12 L5.29289322,6.70710678 C4.93240926,6.34662282 4.90467972,5.77939176 5.20970461,5.38710056 Z"}),"Close")},,function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(7),s=a.n(n),i=a(11),o=a(17),r=a(281),c=a(14),l=a(110),d=a(2),h=a(18);const u=Object.freeze({NONE:"NONE",REPEAT:"REPEAT",REPEAT_ONE:"REPEAT_ONE"});class p extends o.a{constructor(){var e;super(),e=this,this.reset=()=>{this.playlist=null,this.message=null,this.time=null,this.videoStream=null,this.instantView=null,this.pageBlock=null},this.addTdLibListener=()=>{d.a.on("update",this.onUpdate),d.a.on("clientUpdate",this.onClientUpdate)},this.removeTdLibListener=()=>{d.a.off("update",this.onUpdate),d.a.off("clientUpdate",this.onClientUpdate)},this.onUpdate=function(){var t=Object(i.a)(s.a.mark((function t(a){var n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=a["@type"],t.next="updateAuthorizationState"===t.t0?3:12;break;case 3:if(n=a.authorization_state){t.next=6;break}return t.abrupt("break",13);case 6:t.t1=n["@type"],t.next="authorizationStateClosed"===t.t1?9:11;break;case 9:return e.reset(),t.abrupt("break",11);case 11:case 12:return t.abrupt("break",13);case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.close=()=>{d.a.clientUpdate({"@type":"clientUpdateMediaClose"})},this.onClientUpdate=e=>{switch(e["@type"]){case"clientUpdateMediaClose":this.reset(),this.emit(e["@type"],e);break;case"clientUpdateMediaActive":{const t=e.chatId,a=e.messageId,n=e.instantView,s=e.pageBlock,i=l.a.get(t,a);if(i)return this.message=i,this.emit(e["@type"],e),void this.getPlaylist(t,a);n&&s&&(this.instantView=n,this.pageBlock=s,this.emit(e["@type"],e));break}case"clientUpdateMediaVolume":{const t=e.volume;this.volume=t,this.savePlayerSettings(),this.emit(e["@type"],e);break}case"clientUpdateMediaRepeat":{const t=e.repeat;this.repeat=t,this.emit(e["@type"],e);break}case"clientUpdateMediaShuffle":{const t=e.shuffle;this.shuffle=t,this.emit(e["@type"],e);break}case"clientUpdateMediaPlaybackRate":{const t=e.playbackRate;this.playbackRate=t,this.savePlayerSettings(),this.emit(e["@type"],e);break}case"clientUpdateMediaPlay":this.playing=!0,this.emit(e["@type"],e);break;case"clientUpdateMediaTitleMouseOver":this.emit(e["@type"],e);break;case"clientUpdateMediaPause":this.playing=!1,this.emit(e["@type"],e);break;case"clientUpdateMediaStop":this.emit(e["@type"],e);break;case"clientUpdateMediaNext":this.emit(e["@type"],e),this.moveToNextMedia(!1);break;case"clientUpdateMediaPrev":this.emit(e["@type"],e),this.moveToPrevMedia();break;case"clientUpdateMediaEnding":this.emit(e["@type"],e);break;case"clientUpdateMediaEnd":this.emit(e["@type"],e),e.moveNext&&this.moveToNextMedia(!0)||this.close();break;case"clientUpdateMediaTime":{const t=e.duration,a=e.currentTime,n=e.timestamp;this.time={currentTime:a,duration:t,timestamp:n},this.emit(e["@type"],e);break}case"clientUpdateMediaCaptureStream":this.videoStream=e.stream,this.emit(e["@type"],e);break;case"clientUpdateMediaViewerPlay":case"clientUpdateMediaViewerPause":case"clientUpdateMediaViewerEnded":case"clientUpdateMediaPlaylistLoading":case"clientUpdateMediaPlaylistPrev":case"clientUpdateMediaPlaylist":case"clientUpdateMediaPlaylistNext":this.emit(e["@type"],e)}},this.moveToPrevMedia=()=>{if(!this.playlist)return;if(!this.message)return;const e=this.message,t=e.chat_id,a=e.id,n=this.playlist.messages;if(!n)return;const s=n.findIndex(e=>e.chat_id===t&&e.id===a);if(-1!==s&&s+1<n.length){const e=n[s+1];Object(r.N)(e.chat_id,e.id,!1)}},this.moveToNextMedia=e=>{if(!this.playlist)return!1;if(!this.message)return!1;const t=this.message,a=t.chat_id,n=t.id,s=this.playlist.messages;if(!s)return!1;const i=s.findIndex(e=>e.chat_id===a&&e.id===n);if(-1===i)return!1;let o=-1;if(e)switch(this.repeat){case u.NONE:o=this.shuffle?Object(h.l)(0,s.length):i-1;break;case u.REPEAT_ONE:o=i;break;case u.REPEAT:o=this.shuffle?Object(h.l)(0,s.length):i-1>=0?i-1:s.length-1}else o=i-1;if(o>=0){const e=s[o];return Object(r.N)(e.chat_id,e.id,!1),!0}return!1},this.getPlaylist=function(){var t=Object(i.a)(s.a.mark((function t(a,n){var i,o,c,h,u;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(i=e.playlist)){t.next=5;break}if(!(o=i.messages)||-1===o.findIndex(e=>e.chat_id===a&&e.id===n)){t.next=5;break}return t.abrupt("return");case 5:if(d.a.clientUpdate({"@type":"clientUpdateMediaPlaylistLoading",chatId:a,messageId:n}),c=Object(r.u)(a,n)){t.next=11;break}return e.playlist={chatId:a,messageId:n,totalCount:1,messages:[l.a.get(a,n)]},d.a.clientUpdate({"@type":"clientUpdateMediaPlaylist",playlist:e.playlist}),t.abrupt("return");case 11:return t.next=13,d.a.send({"@type":"searchChatMessages",chat_id:a,query:"",sender_user_id:0,from_message_id:n,offset:-50,limit:100,filter:c});case 13:h=t.sent,l.a.setItems(h.messages),u=h.total_count,o=h.messages,e.playlist={chatId:a,messageId:n,totalCount:u,messages:o},d.a.clientUpdate({"@type":"clientUpdateMediaPlaylist",playlist:e.playlist});case 18:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}();const t=this.loadPlayerSettings(),a=t.playbackRate,n=t.volume;this.playbackRate=a,this.volume=n,this.repeat=u.NONE,this.shuffle=!1,this.reset(),this.addTdLibListener()}loadPlayerSettings(){const e=localStorage.getItem("player")||{};let t=e.playbackRate,a=e.volume;return t=t&&Number(t)>=1&&Number(t)<=2?Number(t):c.I,a=a&&Number(a)>=0&&Number(a)<=1?Number(a):c.L,{playbackRate:t,volume:a}}savePlayerSettings(){const e=this.volume,t=this.playbackRate;localStorage.setItem("player",JSON.stringify({volume:e,playbackRate:t}))}}const m=new p;window.player=m,t.b=m},function(e,t,a){"use strict";a.d(t,"h",(function(){return f})),a.d(t,"f",(function(){return r})),a.d(t,"j",(function(){return c})),a.d(t,"c",(function(){return l})),a.d(t,"i",(function(){return h})),a.d(t,"d",(function(){return u})),a.d(t,"g",(function(){return p})),a.d(t,"a",(function(){return m})),a.d(t,"b",(function(){return g})),a.d(t,"e",(function(){return d}));var n=a(303),s=a(18),i=a(14),o=a(72);function r(e){if(!e)return null;if(!e.status)return null;if(e.id===i.hb)return"service notifications";if(e.type&&"userTypeBot"===e.type["@type"])return"bot";switch(e.status["@type"]){case"userStatusEmpty":return"last seen a long time ago";case"userStatusLastMonth":return"last seen within a month";case"userStatusLastWeek":return"last seen within a week";case"userStatusOffline":{let t=e.status.was_online;if(!t)return"offline";const a=new Date,s=new Date(1e3*t);if(s>a)return"last seen just now";let i=new Date(a-s);if(i.getTime()/1e3<60)return"last seen just now";if(i.getTime()/1e3<3600){const e=Math.floor(i.getTime()/1e3/60);return"last seen ".concat(1===e?"1 minute":e+" minutes"," ago")}const o=new Date;if(o.setHours(0,0,0,0),s>o){if(i.getTime()/1e3<21600){const e=Math.floor(i.getTime()/1e3/60/60);return"last seen ".concat(1===e?"1 hour":e+" hours"," ago")}return"last seen today at ".concat(Object(n.a)(s,"H:MM"))}let r=new Date;return r.setDate(a.getDate()-1),o.setHours(0,0,0,0),s>r?"last seen yesterday at ".concat(Object(n.a)(s,"H:MM")):"last seen ".concat(Object(n.a)(s,"dd.mm.yyyy"))}case"userStatusOnline":return"online";case"userStatusRecently":return"last seen recently"}return null}function c(e){if(!e)return!1;const t=e.id,a=e.status,n=e.type;return!!a&&(!!n&&(t!==i.hb&&("userStatusOnline"===a["@type"]&&"userTypeBot"!==n["@type"])))}function l(e,t,a=(e=>e)){if(!(t=o.a.get(e)||t))return null;const n=t,s=n.type,i=n.first_name,r=n.last_name;if(!s)return null;switch(s["@type"]){case"userTypeBot":case"userTypeRegular":if(i&&r)return"".concat(i," ").concat(r);if(i)return i;if(r)return r;case"userTypeDeleted":case"userTypeUnknown":return a("HiddenName")}return null}function d(e,t=(e=>e)){const a=o.a.get(e);if(!a)return null;const n=a.type,s=a.first_name,i=a.last_name;if(!n)return null;switch(n["@type"]){case"userTypeBot":case"userTypeRegular":if(s)return s;if(i)return i;case"userTypeDeleted":case"userTypeUnknown":return t("HiddenName")}return null}function h(e){const t=o.a.getFullInfo(e);return!!t&&t.is_blocked}function u(e,t,a,n){const i=o.a.get(e);if(!i&&!t&&!a)return null;const r=l(e,null,n)||"".concat(t," ").concat(a).trim(),c=Object(s.h)(r);if(c&&c.length>0)return c;i&&(t=i.first_name,a=i.last_name);const d=Object(s.f)(t)||t.charAt(0);if(d)return d;const h=Object(s.f)(a)||a.charAt(0);return h||""}function p(e){if(!e)return 0;if(!e.status)return 0;if("userTypeBot"===e.type["@type"])return 0;switch(e.status["@type"]){case"userStatusEmpty":return 1;case"userStatusLastMonth":return 10;case"userStatusLastWeek":return 100;case"userStatusOffline":return e.status.was_online;case"userStatusOnline":return e.status.expires;case"userStatusRecently":return 1e3}}function m(e){if(!e)return null;const t=e.id,a=e.sizes;return a&&a.length?{"@type":"profilePhoto",id:t,small:Object(s.m)(a,i.eb).photo,big:Object(s.m)(a,i.db).photo}:null}function g(e){if(!e)return null;const t=e.added_date;if(!t)return null;const a=new Date(1e3*t);return Object(n.a)(a,"H:MM:ss d.mm.yyyy")}function f(e){const t=o.a.get(e);return t&&"userTypeDeleted"===t.type["@type"]}},,,,,function(e,t,a){"use strict";var n=a(44),s=a(0),i=a.n(s),o=a(109),r=a.n(o),c=a(565),l=a(285),d=a(14),h=a(278);a(384);class u extends i.a.Component{constructor(e){super(e),this.onUpdateFile=e=>{const t=this.state.file,a=e.file;t&&t.id===a.id&&(this.fileEquals(a,t)||this.setState({file:a,prevFile:t}))},this.isDownloading=(e,t)=>{if(!this.props.download)return!1;const a=t&&t.local&&t.local.is_downloading_active,n=e&&e.local&&e.local.is_downloading_active;return a||n},this.isUploading=(e,t)=>{if(!this.props.upload)return!1;const a=t&&t.remote&&t.remote.is_uploading_active,n=e&&e.remote&&e.remote.is_uploading_active;return a||n},this.getProgressParams=(e,t)=>{const a=e.local,n=e.remote;let s=!1,i=!1,o=!1,r=0,c=0;return this.isDownloading(e,t)?(s=t&&t.local&&t.local.is_downloading_active,i=a.is_downloading_active,o=a.is_downloading_completed,r=a.downloaded_size,c=e.size):this.isUploading(e,t)&&(s=t&&t.remote&&t.remote.is_uploading_active,i=n.is_uploading_active,o=n.is_uploading_completed,r=n.uploaded_size,c=e.size),[s,i,o,r,c]},this.completeAnimation=!1;const t=this.props.file;this.state={prevPropsFile:t,prevFile:null,file:h.a.get(t.id)||t}}static getDerivedStateFromProps(e,t){const a=e.file,n=t.prevPropsFile;return a&&n&&a.id!==n.id?{prevPropsFile:a,prevFile:null,file:h.a.get(a.id)||a}:null}shouldComponentUpdate(e,t){const a=this.props,n=a.download,s=a.upload,i=a.icon,o=a.thumbnailSrc;if(e.thumbnailSrc!==o)return!0;if(e.icon!==i)return!0;if(this.isDownloading(t.file,t.prevFile)&&!n)return!1;if(this.isUploading(t.file,t.prevFile)&&!s)return!1;const r=t.file?t.file.local:null,c=t.file?t.file.idb_key:null,l=this.state.prevFile?this.state.prevFile.local:null,d=this.state.prevFile?this.state.prevFile.idb_key:null,h=l&&r&&!l.is_downloading_completed&&r.is_downloading_completed,u=c&&!d;return(t.file.id!==this.state.file.id||!h||!u)&&(t.file!==this.state.file||t.prevFile!==this.state.prevFile)}componentDidMount(){this.mount=!0,h.a.on("updateFile",this.onUpdateFile)}componentWillUnmount(){this.mount=!1,h.a.off("updateFile",this.onUpdateFile)}fileEquals(e,t){if(e===t&&null===e)return!0;if(null!==e&&null===t)return!1;if(null===e&&null!==t)return!1;const a=e.local,n=e.remote,s=t.local,i=t.remote;return a.can_be_deleted===s.can_be_deleted&&(a.can_be_downloaded===s.can_be_downloaded&&(a.download_offset===s.download_offset&&(a.downloaded_prefix_size===s.downloaded_prefix_size&&(a.downloaded_size===s.downloaded_size&&(a.is_downloading_active===s.is_downloading_active&&(a.is_downloading_completed===s.is_downloading_completed&&(a.path===s.path&&(n.id===i.id&&(n.is_uploading_active===i.is_uploading_active&&(n.is_uploading_completed===i.is_uploading_completed&&n.uploaded_size===i.uploaded_size))))))))))}render(){let e=this.props,t=e.thumbnailSrc,a=e.cancelButton,s=e.zIndex,o=e.icon,h=e.completeIcon;const u=this.state,p=u.file,m=u.prevFile;if(!p)return null;const g=this.getProgressParams(p,m),f=Object(n.a)(g,5),b=f[0],C=f[1],y=f[2],v=f[3],E=f[4];let U=C,S=0;C&&(S=v&&E?100-(E-v)/E*100:1),b&&!C&&(this.completeAnimation=!0,S=y?100:0,U=!0,setTimeout(()=>{this.completeAnimation=!1,this.mount&&this.setState({prevFile:null})},d.c));const k={zIndex:s,background:t||"undefined"===typeof t?"rgba(0, 0, 0, 0.25)":null};return p&&p.local&&(p.local.is_downloading_completed||p.idb_key||p.local.is_uploading_completed)&&!this.completeAnimation&&!C?h?i.a.createElement("div",{className:r()("file-progress","file-progress-complete"),style:k},h):null:U||this.completeAnimation?i.a.createElement("div",{className:"file-progress",style:k},i.a.createElement(c.a,{className:"file-progress-indicator",classes:{circle:"file-progress-circle"},variant:"static",value:S,size:48,thickness:2}),a&&i.a.createElement(l.a,null)):o?i.a.createElement("div",{className:"file-progress",style:k},o):null}}u.defaultProps={cancelButton:!1,download:!0,upload:!1},t.a=u},function(e,t,a){"use strict";a.d(t,"a",(function(){return w}));var n=a(78),s=a(7),i=a.n(s),o=a(11),r=a(0),c=a.n(r),l=a(109),d=a.n(l),h=a(282),u=a(18),p=a(279);function m(){return"$"+Math.random().toString(36).slice(2,10)}var g=a(397);const f=new(a.n(g).a),b=new Map;function C(e){return y.apply(this,arguments)}function y(){return(y=Object(o.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=m(),e.abrupt("return",new Promise((e,n)=>{b.set(a,{resolve:e,reject:n}),f.postMessage({key:a,blob:t})}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}f.onmessage=e=>{const t=e.data;if(!t)return;const a=t.key,n=t.error,s=t.result,i=t.msg,o=b.get(a),r=o.resolve,c=o.reject;b.delete(a),n?c(i):r(s)};var v=a(14),E=a(9),U=a(278),S=a(305),k=a(110),M=a(295);a(398);const I=c.a.lazy(()=>Promise.all([a.e(1),a.e(0)]).then(a.bind(null,579))),w=Object.freeze({HINTS:"HINTS",MESSAGE:"MESSAGE",PICKER_HEADER:"PICKER_HEADER",PICKER:"PICKER",PREVIEW:"PREVIEW",STICKER_SET:"STICKER_SET",UNKNOWN:"UNKNOWN"});class _ extends c.a.Component{constructor(e){var t;super(e),t=this,this.onClientUpdateInstantViewContent=e=>{this.openIV=Boolean(S.a.getCurrent()),this.startStopAnimation()},this.onClientUpdateDialogChatId=e=>{this.dialogChatId=E.a.dialogChatId,this.startStopAnimation()},this.onClientUpdateMediaViewerContent=e=>{this.openMediaViewer=Boolean(E.a.mediaViewerContent),this.startStopAnimation()},this.onClientUpdateProfileMediaViewerContent=e=>{this.openProfileMediaViewer=Boolean(E.a.profileMediaViewerContent),this.startStopAnimation()},this.onClientUpdateStickerPreview=e=>{this.stickerPreview=e.sticker,this.startStopAnimation()},this.onClientUpdateMessagesInView=e=>{const t=this.props,a=t.chatId,n=t.messageId,s="".concat(a,"_").concat(n);this.inView=e.messages.has(s),this.startStopAnimation()},this.onClientUpdateStickerSet=e=>{const t=e.stickerSet;this.openedStickerSet=t,this.startStopAnimation()},this.onClientUpdateFocusWindow=e=>{const t=e.focused,a=this.props,n=a.chatId,s=a.messageId,i=a.sticker;Object(h.m)(i,n,s)&&(this.windowFocused=t,this.startStopAnimation())},this.onClientUpdateStickerBlob=e=>{const t=this.props.sticker,a=t.sticker,n=t.is_animated,s=e.fileId;a&&a.id===s&&(n?this.loadContent():this.forceUpdate())},this.onClientUpdateStickerThumbnailBlob=e=>{const t=this.props.sticker.thumbnail;if(!t)return;const a=e.fileId;t.photo&&t.photo.id===a&&this.forceUpdate()},this.loadContent=Object(o.a)(i.a.mark((function e(){var a,n,s,o,r,c,l,d,u,m,g,f;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.props,n=a.chatId,s=a.messageId,o=a.sticker,r=a.autoplay,c=a.play,l=o.is_animated,d=o.sticker,u=Object(h.m)(o,n,s),l){e.next=5;break}return e.abrupt("return");case 5:if(u){e.next=7;break}return e.abrupt("return");case 7:if(c){e.next=9;break}return e.abrupt("return");case 9:if(m=Object(p.d)(d)){e.next=12;break}return e.abrupt("return");case 12:return g=null,e.prev=13,e.next=16,C(m);case 16:if(f=e.sent){e.next=19;break}return e.abrupt("return");case 19:g=JSON.parse(f),e.next=25;break;case 22:e.prev=22,e.t0=e.catch(13),console.log("[Sticker] loadContent error",e.t0);case 25:if(g){e.next=27;break}return e.abrupt("return");case 27:r?t.setState({animationData:g}):t.animationData=g;case 28:case"end":return e.stop()}}),e,null,[[13,22]])}))),this.handleMouseEnter=e=>{const t=this.animationData;t&&this.setState({animationData:t},()=>{this.handleAnimationMouseEnter()})},this.handleAnimationMouseEnter=()=>{if(this.props.autoplay)return;this.entered=!0,this.lottieRef.current&&(this.loopCount=0,this.startStopAnimation())},this.handleAnimationLoopComplete=()=>{if(this.props.autoplay)return;if(this.lottieRef.current&&(this.entered||(this.loopCount+=1),this.loopCount>2)){this.state.animationData&&this.setState({animationData:null})}},this.handleAnimationMouseOut=()=>{this.entered=!1},this.lottieRef=c.a.createRef(),this.windowFocused=window.hasFocus,this.inView=!1,this.stickerPreview=M.a.stickerPreview,this.openMediaViewer=Boolean(E.a.mediaViewerContent),this.openProfileMediaViewer=Boolean(E.a.profileMediaViewerContent),this.openIV=Boolean(S.a.getCurrent()),this.dialogChatId=E.a.dialogChatId,this.state={animationDate:null,hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){console.log("[Sticker] render error",e,t)}shouldComponentUpdate(e,t,a){const n=this.props,s=n.chatId,i=n.messageId,o=n.sticker,r=n.blur,c=n.displaySize;return this.state.animationData!==t.animationData||(s!==e.chatId||(i!==e.messageId||(o!==e.sticker||(r!==e.blur||c!==e.displaySize))))}componentDidUpdate(e,t,a){e.sticker!==this.props.sticker&&this.loadContent()}componentDidMount(){this.loadContent(),E.a.on("clientUpdateDialogChatId",this.onClientUpdateDialogChatId),E.a.on("clientUpdateFocusWindow",this.onClientUpdateFocusWindow),E.a.on("clientUpdateMediaViewerContent",this.onClientUpdateMediaViewerContent),E.a.on("clientUpdateProfileMediaViewerContent",this.onClientUpdateProfileMediaViewerContent),S.a.on("clientUpdateInstantViewContent",this.onClientUpdateInstantViewContent),U.a.on("clientUpdateStickerThumbnailBlob",this.onClientUpdateStickerThumbnailBlob),U.a.on("clientUpdateStickerBlob",this.onClientUpdateStickerBlob),k.a.on("clientUpdateMessagesInView",this.onClientUpdateMessagesInView),M.a.on("clientUpdateStickerPreview",this.onClientUpdateStickerPreview),M.a.on("clientUpdateStickerSet",this.onClientUpdateStickerSet)}componentWillUnmount(){E.a.off("clientUpdateDialogChatId",this.onClientUpdateDialogChatId),E.a.off("clientUpdateFocusWindow",this.onClientUpdateFocusWindow),E.a.off("clientUpdateMediaViewerContent",this.onClientUpdateMediaViewerContent),E.a.off("clientUpdateProfileMediaViewerContent",this.onClientUpdateProfileMediaViewerContent),S.a.off("clientUpdateInstantViewContent",this.onClientUpdateInstantViewContent),U.a.off("clientUpdateStickerThumbnailBlob",this.onClientUpdateStickerThumbnailBlob),U.a.off("clientUpdateStickerBlob",this.onClientUpdateStickerBlob),k.a.off("clientUpdateMessagesInView",this.onClientUpdateMessagesInView),M.a.off("clientUpdateStickerPreview",this.onClientUpdateStickerPreview),M.a.off("clientUpdateStickerSet",this.onClientUpdateStickerSet)}startStopAnimation(){const e=this.props.autoplay,t=this.lottieRef.current;if(t){if(this.windowFocused&&!this.stickerPreview&&!this.openMediaViewer&&!this.openProfileMediaViewer&&!this.openIV&&!this.dialogChatId){if(this.entered)return t.play(),void(this.pause=!1);if(!this.openedStickerSet){if(this.paused)return t.play(),void(this.paused=!1);if(e&&this.inView)return t.play(),void(this.paused=!1)}}this.paused=t.pause()}}render(){const e=this.props,t=e.chatId,a=e.messageId,s=e.autoplay,i=e.className,o=e.displaySize,r=e.blur,l=e.sticker,m=e.style,g=e.openMedia,f=e.preview,b=l.thumbnail,C=l.sticker,y=l.width,v=l.height,E=this.state,U=E.animationData,S=E.hasError,k=Object(h.m)(l,t,a),M=Object(p.j)(b?b.photo:null),w=Object(p.j)(C),_=Object(h.k)(b);if(S){const e={width:o,height:o};return c.a.createElement("div",{className:d()("sticker",i),style:e,onClick:g},c.a.createElement("img",{className:d()("sticker-image",{"media-blurred":_&&r}),draggable:!1,src:M,alt:""}))}let x=null;const O=Object(u.g)({width:y,height:v},o);O&&(x=k?c.a.createElement(c.a.Fragment,null,U?c.a.createElement(c.a.Suspense,{fallback:null},c.a.createElement(I,{ref:this.lottieRef,options:{autoplay:s,loop:!0,animationData:U,renderer:"svg",rendererSettings:{preserveAspectRatio:"xMinYMin slice",clearCanvas:!1,progressiveLoad:!0,hideOnTransparent:!0,className:"lottie-svg"}},eventListeners:[{eventName:"loopComplete",callback:this.handleAnimationLoopComplete}],onMouseOut:this.handleAnimationMouseOut})):c.a.createElement("img",{className:d()("sticker-image",{"media-blurred":_&&r}),draggable:!1,src:M,alt:""})):c.a.createElement(c.a.Fragment,null,w&&!f?c.a.createElement("img",{className:"sticker-image",draggable:!1,src:w,alt:""}):c.a.createElement("img",{className:d()("sticker-image",{"media-blurred":_&&r}),draggable:!1,src:M,alt:""})));const T=Object(n.a)({width:O?O.width:0,height:O?O.height:0},m);return c.a.createElement("div",{className:d()("sticker",i),style:T,onClick:g,onMouseEnter:this.handleMouseEnter},x)}}_.defaultProps={chatId:0,messageId:0,openMedia:()=>{},autoplay:!0,play:!0,blur:!0,displaySize:v.jb,preview:!1,source:w.UNKNOWN};t.b=_},function(e,t,a){"use strict";var n=a(17),s=a(2);class i extends n.a{constructor(){super(),this.reset=()=>{this.stickerSet=null,this.hint=null,this.animationData=new WeakMap},this.onUpdate=e=>{switch(e["@type"]){case"updateAuthorizationState":{const t=e.authorization_state;if(!t)break;switch(t["@type"]){case"authorizationStateClosed":this.reset()}break}case"updateInstalledStickerSets":{const t=e.sticker_set_ids;if(this.stickerSet){const e=this.stickerSet,a=e.id,n=e.is_installed;n!==t.some(e=>e===a)&&(this.stickerSet=Object.assign({},this.stickerSet,{is_installed:!n}))}this.emit("updateInstalledStickerSets",e);break}case"updateRecentStickers":this.emit("updateRecentStickers",e)}},this.onClientUpdate=e=>{switch(e["@type"]){case"clientUpdateStickerSend":this.emit("clientUpdateStickerSend",e);break;case"clientUpdateLocalStickersHint":{const t=e.hint;this.hint=t,this.emit("clientUpdateLocalStickersHint",e);break}case"clientUpdateRemoteStickersHint":{const t=e.hint;this.hint&&this.hint.timestamp===t.timestamp&&(this.hint=Object.assign({},this.hint,{foundStickers:t.stickers})),this.emit("clientUpdateRemoteStickersHint",e);break}case"clientUpdateStickerSet":{const t=e.stickerSet;this.stickerSet=t,this.emit("clientUpdateStickerSet",e);break}case"clientUpdateStickerSetPosition":this.emit("clientUpdateStickerSetPosition",e);break;case"clientUpdateStickerPreview":this.emit("clientUpdateStickerPreview",e)}},this.addTdLibListener=()=>{s.a.on("update",this.onUpdate),s.a.on("clientUpdate",this.onClientUpdate)},this.removeTdLibListener=()=>{s.a.off("update",this.onUpdate),s.a.off("clientUpdate",this.onClientUpdate)},this.reset(),this.addTdLibListener()}getAnimationData(e){return this.animationData.get(e)}setAnimationData(e,t){this.animationData.set(e,t)}}const o=new i;window.sticker=o,t.a=o},function(e,t,a){"use strict";var n=a(17),s=a(2);class i extends n.a{constructor(){super(),this.reset=()=>{this.items=new Map,this.fullInfoItems=new Map},this.onUpdate=e=>{switch(e["@type"]){case"updateAuthorizationState":{const t=e.authorization_state;if(!t)break;switch(t["@type"]){case"authorizationStateClosed":this.reset()}break}case"updateBasicGroup":this.set(e.basic_group),this.emit(e["@type"],e);break;case"updateBasicGroupFullInfo":this.setFullInfo(e.basic_group_id,e.basic_group_full_info),this.emit(e["@type"],e)}},this.onClientUpdate=e=>{},this.addTdLibListener=()=>{s.a.on("update",this.onUpdate),s.a.on("clientUpdate",this.onClientUpdate)},this.removeTdLibListener=()=>{s.a.off("update",this.onUpdate),s.a.off("clientUpdate",this.onClientUpdate)},this.reset(),this.addTdLibListener()}get(e){return this.items.get(e)}set(e){this.items.set(e.id,e)}getFullInfo(e){return this.fullInfoItems.get(e)}setFullInfo(e,t){this.fullInfoItems.set(e,t)}}const o=new i;window.basicgroup=o,t.a=o},,,function(e,t,a){"use strict";var n=a(0),s=a.n(n),i=a(109),o=a.n(i),r=a(32),c=a(288),l=a(279),d=a(72),h=a(39),u=a(278),p=(a(375),a(332));class m extends n.Component{constructor(e){super(e),this.onClientUpdateUserBlob=e=>{this.props.userId===e.userId&&(this.state.loaded?this.setState({loaded:!1}):this.forceUpdate())},this.onClientUpdateChatBlob=e=>{const t=this.props.userId,a=e.chatId,n=h.a.get(a);if(n&&n.type)switch(n.type["@type"]){case"chatTypeBasicGroup":case"chatTypeSupergroup":return;case"chatTypePrivate":case"chatTypeSecret":if(n.type.user_id!==t)return;this.state.loaded?this.setState({loaded:!1}):this.forceUpdate()}},this.onUpdateChatPhoto=e=>{const t=this.props.userId,a=e.chat_id,n=e.photo,s=h.a.get(a);if(s&&s.type)switch(s.type["@type"]){case"chatTypeBasicGroup":case"chatTypeSupergroup":return;case"chatTypePrivate":case"chatTypeSecret":if(s.type.user_id!==t)return;if(this.state.loaded?this.setState({loaded:!1}):this.forceUpdate(),n){const e=u.a.getStore();Object(l.q)(e,s)}}},this.onUpdateChatTitle=e=>{const t=this.props.userId,a=h.a.get(e.chat_id);if(a&&a.type)switch(a.type["@type"]){case"chatTypeBasicGroup":case"chatTypeSupergroup":return;case"chatTypePrivate":case"chatTypeSecret":if(a.type.user_id!==t&&!a.photo)return;this.forceUpdate()}},this.handleSelect=e=>{const t=this.props,a=t.userId,n=t.onSelect;n&&(e.stopPropagation(),n(a))},this.handleLoad=()=>{this.setState({loaded:!0})},this.state={loaded:!1}}shouldComponentUpdate(e,t){return e.userId!==this.props.userId||t.loaded!==this.state.loaded}componentDidMount(){u.a.on("clientUpdateUserBlob",this.onClientUpdateUserBlob),u.a.on("clientUpdateChatBlob",this.onClientUpdateChatBlob),h.a.on("updateChatPhoto",this.onUpdateChatPhoto),h.a.on("updateChatTitle",this.onUpdateChatTitle)}componentWillUnmount(){u.a.off("clientUpdateUserBlob",this.onClientUpdateUserBlob),u.a.off("clientUpdateChatBlob",this.onClientUpdateChatBlob),h.a.off("updateChatPhoto",this.onUpdateChatPhoto),h.a.off("updateChatTitle",this.onUpdateChatTitle)}render(){const e=this.props,t=e.className,a=e.userId,n=e.fistName,i=e.lastName,r=e.onSelect,h=e.small,u=e.dialog,m=e.poll,g=e.t,f=this.state.loaded,b=d.a.get(a);if(!b&&!n&&!i)return null;if(Object(c.h)(a))return s.a.createElement("div",{className:o()(t,"user-tile","tile_color_0",{pointer:r},{"tile-dialog":u},{"tile-small":h},{"tile-poll":m}),onClick:this.handleSelect},s.a.createElement("div",{className:"tile-photo"},s.a.createElement("div",{className:"tile-saved-messages"},s.a.createElement(p.a,{fontSize:"default"}))));const C=Object(c.d)(a,n,i,g),y=Object(l.j)(b&&b.profile_photo?b.profile_photo.small:null),v=y&&f,E="tile_color_".concat(Math.abs(a)%8+1);return s.a.createElement("div",{className:o()(t,"user-tile",{[E]:!v},{pointer:r},{"tile-dialog":u},{"tile-small":h},{"tile-poll":m}),onClick:this.handleSelect},!v&&s.a.createElement("div",{className:"tile-photo"},s.a.createElement("span",{className:"tile-text"},C)),y&&s.a.createElement("img",{className:"tile-photo",src:y,onLoad:this.handleLoad,draggable:!1,alt:""}))}}t.a=Object(r.d)()(m)},function(e,t,a){"use strict";var n=a(78),s=a(0),i=a.n(s),o=a(109),r=a.n(o),c=a(293),l=a(18),d=a(279),h=a(282),u=a(14),p=a(278);a(393);class m extends i.a.Component{constructor(e){super(e),this.onClientUpdatePhotoBlob=e=>{const t=this.state,a=t.photoSize,n=t.thumbSize,s=e.fileId;(a&&a.photo&&a.photo.id===s||n&&n.photo&&n.photo.id===s)&&this.forceUpdate()},this.state={}}static getDerivedStateFromProps(e,t){const a=e.photo,n=e.size,s=e.thumbnailSize;return a!==t.prevPhoto?{prevPhoto:a,photoSize:Object(l.m)(a.sizes,n),thumbSize:Object(l.m)(a.sizes,s),minithumbnail:a?a.minithumbnail:null}:null}componentDidMount(){p.a.on("clientUpdatePhotoBlob",this.onClientUpdatePhotoBlob)}componentWillUnmount(){p.a.off("clientUpdatePhotoBlob",this.onClientUpdatePhotoBlob)}render(){const e=this.props,t=e.className,a=e.displaySize,s=e.openMedia,o=e.showProgress,u=e.title,p=e.caption,m=e.type,g=e.style,f=this.state,b=f.thumbSize,C=f.photoSize,y=f.minithumbnail;if(!C)return null;const v=y?"data:image/jpeg;base64, "+y.data:null,E=Object(d.j)(b?b.photo:null),U=Object(d.j)(C.photo),S=!E&&v||Object(h.k)(b),k=Object(l.g)(C,a,!1);if(!k)return null;const M=Object(n.a)({width:k.width,height:k.height},g),I=Boolean(U||E||v);return i.a.createElement("div",{className:r()(t,"photo",{"photo-big":"message"===m,"photo-title":u,"photo-caption":p,pointer:s}),style:M,onClick:s},I&&i.a.createElement("img",{className:r()("photo-image",{"media-blurred":!U&&S,"media-mini-blurred":!U&&!E&&S}),draggable:!1,src:U||E||v,alt:""}),o&&i.a.createElement(c.a,{file:C.photo,download:!0,upload:!0,cancelButton:!0}))}}m.defaultProps={size:u.F,thumbnailSize:u.G,displaySize:u.D,showProgress:!0},t.a=m},,,function(e,t,a){"use strict";const n=function(){const e=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZWN]|"[^"]*"|'[^']*'/g,t=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,a=/[^-+\dA-Z]/g;return function(c,l,d,h){if(1!==arguments.length||"string"!==r(c)||/\d/.test(c)||(l=c,c=void 0),(c=c||new Date)instanceof Date||(c=new Date(c)),isNaN(c))throw TypeError("Invalid date");var u=(l=String(n.masks[l]||l||n.masks.default)).slice(0,4);"UTC:"!==u&&"GMT:"!==u||(l=l.slice(4),d=!0,"GMT:"===u&&(h=!0));var p=d?"getUTC":"get",m=c[p+"Date"](),g=c[p+"Day"](),f=c[p+"Month"](),b=c[p+"FullYear"](),C=c[p+"Hours"](),y=c[p+"Minutes"](),v=c[p+"Seconds"](),E=c[p+"Milliseconds"](),U=d?0:c.getTimezoneOffset(),S=i(c),k=o(c),M={d:m,dd:s(m),ddd:n.i18n.dayNames[g],dddd:n.i18n.dayNames[g+7],m:f+1,mm:s(f+1),mmm:n.i18n.monthNames[f],mmmm:n.i18n.monthNames[f+12],yy:String(b).slice(2),yyyy:b,h:C%12||12,hh:s(C%12||12),H:C,HH:s(C),M:y,MM:s(y),s:v,ss:s(v),l:s(E,3),L:s(Math.round(E/10)),t:C<12?n.i18n.timeNames[0]:n.i18n.timeNames[1],tt:C<12?n.i18n.timeNames[2]:n.i18n.timeNames[3],T:C<12?n.i18n.timeNames[4]:n.i18n.timeNames[5],TT:C<12?n.i18n.timeNames[6]:n.i18n.timeNames[7],Z:h?"GMT":d?"UTC":(String(c).match(t)||[""]).pop().replace(a,""),o:(U>0?"-":"+")+s(100*Math.floor(Math.abs(U)/60)+Math.abs(U)%60,4),S:["th","st","nd","rd"][m%10>3?0:(m%100-m%10!=10)*m%10],W:S,N:k};return l.replace(e,(function(e){return e in M?M[e]:e.slice(1,e.length-1)}))}}();function s(e,t){for(e=String(e),t=t||2;e.length<t;)e="0"+e;return e}function i(e){var t=new Date(e.getFullYear(),e.getMonth(),e.getDate());t.setDate(t.getDate()-(t.getDay()+6)%7+3);var a=new Date(t.getFullYear(),0,4);a.setDate(a.getDate()-(a.getDay()+6)%7+3);var n=t.getTimezoneOffset()-a.getTimezoneOffset();t.setHours(t.getHours()-n);var s=(t-a)/6048e5;return 1+Math.floor(s)}function o(e){var t=e.getDay();return 0===t&&(t=7),t}function r(e){return null===e?"null":void 0===e?"undefined":"object"!==typeof e?typeof e:Array.isArray(e)?"array":{}.toString.call(e).slice(8,-1).toLowerCase()}n.masks={default:"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:sso",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'",expiresHeaderFormat:"ddd, dd mmm yyyy HH:MM:ss Z"},n.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"],timeNames:["a","p","am","pm","A","P","AM","PM"]},t.a=n},function(e,t,a){"use strict";var n=a(7),s=a.n(n),i=a(11),o=a(0),r=a.n(o),c=a(32),l=a(262),d=a(275),h=a(265),u=a(266),p=a(267),m=a(268),g=a(317),f=a(110),b=a(2),C=(a(383),a(111));class y extends r.a.Component{constructor(e){var t;super(e),t=this,this.handleClick=e=>{e.preventDefault(),e.stopPropagation(),this.setState({confirm:!0})},this.handleDialogClick=e=>{e.preventDefault(),e.stopPropagation()},this.handleClose=()=>{this.setState({confirm:!1})},this.handleDone=e=>{this.handleClose();const t=this.props,a=t.url,n=t.onClick;if(a)if(n)n(e);else{const e=window.open();e.opener=null,e.location=a}},this.handleSafeClick=function(){var e=Object(i.a)(s.a.mark((function e(a){var n,i,o,r,c,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.stopPropagation(),n=t.props,i=n.onClick,o=n.url,!t.isTelegramLink(o)){e.next=19;break}return a.preventDefault(),e.prev=4,e.next=7,b.a.send({"@type":"getMessageLinkInfo",url:o});case 7:if(r=e.sent,f.a.setItems([r.message]),c=r.chat_id,l=r.message,!c){e.next=13;break}return Object(C.h)(c,l?l.id:null),e.abrupt("return");case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(4),console.log("[safeLink] messageLinkInfo error",e.t0);case 18:i&&i(a);case 19:i&&(a.preventDefault(),i(a));case 20:case"end":return e.stop()}}),e,null,[[4,15]])})));return function(t){return e.apply(this,arguments)}}(),this.state={}}static getDerivedStateFromProps(e,t){const a=e.displayText,n=e.mail,s=e.url;return t.prevUrl!==s||t.prevDisplayText!==a?{prevUrl:s,prevDisplayText:a,safe:Object(g.c)(a,s),decodedUrl:Object(g.a)(s,n),href:Object(g.b)(s,n),confirm:!1}:null}isTelegramLink(e){if(!e)return!1;const t=e.toLowerCase().replace("https://","").replace("http://","");return t.startsWith("t.me")||t.startsWith("tg://")}render(){const e=this.props,t=e.className,a=e.children,n=e.t,s=e.url,i=this.state,o=i.confirm,c=i.decodedUrl,g=i.href,f=i.safe;return s&&c?r.a.createElement(r.a.Fragment,null,f?r.a.createElement("a",{className:t,href:g,title:c,target:"_blank",rel:"noopener noreferrer",onClick:this.handleSafeClick},a||s):r.a.createElement(r.a.Fragment,null,r.a.createElement("a",{className:t,title:c,onClick:this.handleClick},a||s),o&&r.a.createElement(d.a,{transitionDuration:0,open:o,onClose:this.handleClose,onClick:this.handleDialogClick,"aria-labelledby":"confirm-dialog-title"},r.a.createElement(h.a,{id:"confirm-dialog-title"},n("Confirm")),r.a.createElement(u.a,{classes:{root:"safe-link-content-root"}},r.a.createElement(p.a,null,"Open this link?\n\n".concat(c))),r.a.createElement(m.a,null,r.a.createElement(l.a,{onClick:this.handleClose},n("Cancel")),r.a.createElement(l.a,{onClick:this.handleDone,color:"primary"},n("Open")))))):null}}t.a=Object(c.d)()(y)},function(e,t,a){"use strict";var n=a(17),s=a(2);class i extends n.a{constructor(){super(),this.reset=()=>{this.items=[]},this.onUpdate=e=>{switch(e["@type"]){case"updateAuthorizationState":{const t=e.authorization_state;if(!t)break;switch(t["@type"]){case"authorizationStateClosed":this.reset()}break}}},this.onClientUpdate=e=>{switch(e["@type"]){case"clientUpdateBlocksInView":this.emit("clientUpdateBlocksInView",e);break;case"clientUpdateInstantViewContent":{const t=e.content;t?this.items.push(t.instantView):this.items=[],this.emit("clientUpdateInstantViewContent",e);break}case"clientUpdateInstantViewUrl":this.emit("clientUpdateInstantViewUrl",e);break;case"clientUpdateInstantViewViewerContent":{const t=e.content;this.viewerContent=t,this.emit("clientUpdateInstantViewViewerContent",e);break}case"clientUpdatePrevInstantView":{if(this.items.length<=1)return;this.items.pop();const e=this.items.pop();s.a.clientUpdate({"@type":"clientUpdateInstantViewContent",content:{instantView:e}});break}}},this.addTdLibListener=()=>{s.a.on("update",this.onUpdate),s.a.on("clientUpdate",this.onClientUpdate)},this.removeTdLibListener=()=>{s.a.off("update",this.onUpdate),s.a.off("clientUpdate",this.onClientUpdate)},this.reset(),this.addTdLibListener()}hasPrev(){return this.items.length>1}getCurrent(){return this.items.length>0?this.items[this.items.length-1]:null}}const o=new i;window.instantView=o,t.a=o},function(e,t,a){"use strict";var n=a(0),s=a.n(n),i=a(38);t.a=Object(i.a)(s.a.createElement("path",{d:"M5,19 L19,19 C19.5522847,19 20,19.4477153 20,20 C20,20.5128358 19.6139598,20.9355072 19.1166211,20.9932723 L19,21 L5,21 C4.44771525,21 4,20.5522847 4,20 C4,19.4871642 4.38604019,19.0644928 4.88337887,19.0067277 L5,19 L19,19 L5,19 Z M11.8833789,3.00672773 L12,3 C12.5128358,3 12.9355072,3.38604019 12.9932723,3.88337887 L13,4 L13,13.585 L16.2928932,10.2928932 C16.6533772,9.93240926 17.2206082,9.90467972 17.6128994,10.2097046 L17.7071068,10.2928932 C18.0675907,10.6533772 18.0953203,11.2206082 17.7902954,11.6128994 L17.7071068,11.7071068 L12.7071068,16.7071068 C12.3466228,17.0675907 11.7793918,17.0953203 11.3871006,16.7902954 L11.2928932,16.7071068 L6.29289322,11.7071068 C5.90236893,11.3165825 5.90236893,10.6834175 6.29289322,10.2928932 C6.65337718,9.93240926 7.22060824,9.90467972 7.61289944,10.2097046 L7.70710678,10.2928932 L11,13.585 L11,4 C11,3.48716416 11.3860402,3.06449284 11.8833789,3.00672773 L12,3 L11.8833789,3.00672773 Z"}),"Download")},function(e,t,a){"use strict";var n=a(0),s=a.n(n),i=a(32),o=a(109),r=a.n(o),c=a(288),l=a(280),d=a(111),h=a(72),u=a(39);a(405);class p extends s.a.Component{constructor(...e){super(...e),this.handleSelect=e=>{const t=this.props,a=t.chatId,n=t.userId,s=t.openUser,i=t.openChat;return s&&n?(e.stopPropagation(),void Object(d.j)(n,!0)):i&&a?(e.stopPropagation(),void Object(d.h)(a,null,!0)):void 0}}render(){const e=this.props,t=e.t,a=e.chatId,n=e.userId,i=e.openUser,o=e.openChat;if(h.a.get(n)){const e=Object(l.T)(a)?"message-author-color":"user_color_".concat(Math.abs(n)%8+1),o=r()([e],"message-author"),d=Object(c.c)(n,null,t);return i?s.a.createElement("a",{className:o,onClick:this.handleSelect},d):s.a.createElement(s.a.Fragment,null,d)}if(u.a.get(a)){const e=r()("message-author-color","message-author"),n=Object(l.s)(a,!1,t);return o?s.a.createElement("a",{className:e,onClick:this.handleSelect},n):s.a.createElement(s.a.Fragment,null,n)}return null}}p.defaultProps={openUser:!1,openChat:!1},t.a=Object(i.d)()(p)},,,,function(e,t,a){"use strict";var n=a(0),s=a.n(n),i=a(32),o=a(299),r=a(336),c=a(288),l=a(72);a(378);class d extends s.a.Component{constructor(e){super(e),this.handleClick=()=>{const e=this.props,t=e.userId,a=e.onSelect;a&&a(t)},this.state={user:l.a.get(e.userId)}}shouldComponentUpdate(e,t){return e.userId!==this.props.userId}render(){const e=this.props,t=e.userId,a=e.t,n=e.showStatus,i=Object(c.c)(t,null,a);return s.a.createElement("div",{className:"user",onClick:this.handleClick},s.a.createElement("div",{className:"user-wrapper"},s.a.createElement(o.a,{userId:t}),s.a.createElement("div",{className:"user-inner-wrapper"},s.a.createElement("div",{className:"tile-first-row"},s.a.createElement("div",{className:"user-title"},i)),n&&s.a.createElement("div",{className:"tile-second-row"},s.a.createElement(r.a,{userId:t})))))}}d.defaultProps={showStatus:!0},t.a=Object(i.d)()(d)},function(e,t,a){"use strict";var n=a(78),s=a(0),i=a.n(s),o=a(109),r=a.n(o),c=a(32),l=a(293),d=a(18),h=a(282),u=a(279),p=a(14),m=a(9),g=a(278),f=a(305),b=a(110);a(385);class C extends i.a.Component{constructor(e){super(e),this.startStopPlayer=()=>{const e=this.videoRef.current;e&&(this.windowFocused&&(this.inView&&!this.openMediaViewer&&!this.openProfileMediaViewer&&!this.openIV||this.ivInView&&!this.openIVMedia)?e.play():e.pause())},this.onClientUpdateInstantViewContent=e=>{this.openIV=Boolean(f.a.getCurrent()),this.startStopPlayer()},this.onClientUpdateProfileMediaViewerContent=e=>{this.openProfileMediaViewer=Boolean(m.a.profileMediaViewerContent),this.startStopPlayer()},this.onClientUpdateMediaViewerContent=e=>{this.openMediaViewer=Boolean(m.a.mediaViewerContent),this.startStopPlayer()},this.onClientUpdateInstantViewViewerContent=e=>{this.openIVMedia=Boolean(f.a.viewerContent),this.startStopPlayer()},this.onClientUpdateFocusWindow=e=>{this.windowFocused=e.focused,this.startStopPlayer()},this.onClientUpdateMessagesInView=e=>{const t=this.props,a=t.chatId,n=t.messageId,s="".concat(a,"_").concat(n);this.inView=e.messages.has(s),this.startStopPlayer()},this.onClientUpdateBlocksInView=e=>{const t=this.props.pageBlock;t&&(this.ivInView=e.blocks.has(t),this.startStopPlayer())},this.onClientUpdateAnimationBlob=e=>{const t=this.props.animation.animation,a=e.fileId;t&&t.id===a&&this.forceUpdate(()=>{this.startStopPlayer()})},this.onClientUpdateAnimationThumbnailBlob=e=>{const t=this.props.animation.thumbnail;if(!t)return;const a=e.fileId;t.photo&&t.photo.id===a&&this.forceUpdate()},this.videoRef=i.a.createRef(),this.setPlayerParams()}setPlayerParams(){this.windowFocused=window.hasFocus,this.inView=!1,this.openMediaViewer=Boolean(m.a.mediaViewerContent),this.openProfileMediaViewer=Boolean(m.a.profileMediaViewerContent),this.openIV=Boolean(f.a.getCurrent()),this.ivInView=!1,this.openIVMedia=Boolean(f.a.viewerContent)}componentDidUpdate(e,t,a){e.animation!==this.props.animation&&this.setPlayerParams()}componentDidMount(){g.a.on("clientUpdateAnimationThumbnailBlob",this.onClientUpdateAnimationThumbnailBlob),g.a.on("clientUpdateAnimationBlob",this.onClientUpdateAnimationBlob),m.a.on("clientUpdateFocusWindow",this.onClientUpdateFocusWindow),m.a.on("clientUpdateMediaViewerContent",this.onClientUpdateMediaViewerContent),m.a.on("clientUpdateProfileMediaViewerContent",this.onClientUpdateProfileMediaViewerContent),b.a.on("clientUpdateMessagesInView",this.onClientUpdateMessagesInView),f.a.on("clientUpdateInstantViewContent",this.onClientUpdateInstantViewContent),f.a.on("clientUpdateInstantViewViewerContent",this.onClientUpdateInstantViewViewerContent),f.a.on("clientUpdateBlocksInView",this.onClientUpdateBlocksInView)}componentWillUnmount(){g.a.off("clientUpdateAnimationThumbnailBlob",this.onClientUpdateAnimationThumbnailBlob),g.a.off("clientUpdateAnimationBlob",this.onClientUpdateAnimationBlob),m.a.off("clientUpdateFocusWindow",this.onClientUpdateFocusWindow),m.a.off("clientUpdateMediaViewerContent",this.onClientUpdateMediaViewerContent),m.a.off("clientUpdateProfileMediaViewerContent",this.onClientUpdateProfileMediaViewerContent),b.a.off("clientUpdateMessagesInView",this.onClientUpdateMessagesInView),f.a.off("clientUpdateInstantViewContent",this.onClientUpdateInstantViewContent),f.a.off("clientUpdateInstantViewViewerContent",this.onClientUpdateInstantViewViewerContent),f.a.off("clientUpdateBlocksInView",this.onClientUpdateBlocksInView)}render(){const e=this.props,t=e.displaySize,a=e.openMedia,s=e.t,o=e.title,c=e.caption,p=e.type,m=e.style,g=this.props.animation,f=g.minithumbnail,b=g.thumbnail,C=g.animation,y=g.mime_type,v=g.width,E=g.height,U=Object(d.g)({width:v,height:E}||b,t,!1);if(!U)return null;const S=Object(n.a)({width:U.width,height:U.height},m),k=f?"data:image/jpeg;base64, "+f.data:null,M=Object(u.j)(b?b.photo:null),I=Object(u.j)(C),w=M?Object(h.k)(b):Boolean(k),_=Object(u.n)(y);return i.a.createElement("div",{className:r()("animation",{"animation-big":"message"===p,"animation-title":o,"media-title":o,"animation-caption":c,pointer:a}),style:S,onClick:a},I?_?i.a.createElement("img",{className:"animation-preview",src:I,alt:""}):i.a.createElement("video",{ref:this.videoRef,className:"media-viewer-content-animation",src:I,poster:M||k,muted:!0,autoPlay:!0,loop:!0,playsInline:!0,width:S.width,height:S.height}):i.a.createElement(i.a.Fragment,null,i.a.createElement("img",{className:r()("animation-preview",{"media-blurred":w,"media-mini-blurred":!I&&!M&&w}),src:M||k,alt:""}),i.a.createElement("div",{className:"animation-meta"},Object(u.g)(C))),i.a.createElement(l.a,{file:C,download:!0,upload:!0,cancelButton:!0,icon:i.a.createElement("div",{className:"animation-play"},s("AttachGif"))}))}}C.defaultProps={size:p.F,displaySize:p.D,iv:!1},t.a=Object(c.d)()(C)},function(e,t,a){"use strict";var n=a(0),s=a.n(n),i=a(38);t.a=Object(i.a)(s.a.createElement("path",{transform:"translate(-12.000000, -12.000000)",d:"M19.3717789,13.8876217 L33.8466511,23.2537154 C34.2588127,23.5204082 34.3767385,24.0707284 34.1100457,24.48289 C34.0418356,24.5883056 33.9520666,24.6780745 33.8466511,24.7462846 L19.3717789,34.1123783 C18.9596173,34.3790711 18.4092971,34.2611454 18.1426043,33.8489838 C18.0495218,33.705129 18,33.5374371 18,33.3660938 L18,14.6339062 C18,14.1429865 18.3979691,13.7450173 18.8888889,13.7450173 C19.0602323,13.7450173 19.2279241,13.7945391 19.3717789,13.8876217 Z"}),"PlayArrow")},function(e,t,a){"use strict";a.d(t,"b",(function(){return h})),a.d(t,"a",(function(){return u}));var n=a(0),s=a.n(n);var i=new class{constructor(){this.list=new Map([["AED","\u062f.\u0625"],["AFN","\u060b"],["ARS","$"],["AUD","$"],["AZN","\u20bc"],["BND","B$"],["BRL","R$"],["CAD","$"],["CHF","Fr"],["CLP","$"],["CNY","\xa5"],["COP","$"],["EGP","E\xa3"],["EUR","\u20ac"],["GBP","\xa3"],["HKD","$"],["IDR","Rp"],["ILS","\u20aa"],["INR","\u20b9"],["ISK","kr"],["JPY","\xa5"],["KRW","\u20a9"],["KZT","\u20b8"],["MXN","$"],["MYR","RM"],["NOK","kr"],["NZD","$"],["PHP","\u20b1"],["RUB","\u20bd"],["SAR","SR"],["SEK","kr"],["SGD","$"],["TRY","\u20ba"],["TTD","$"],["TWD","$"],["TZS","TSh"],["UAH","\u20b4"],["UGX","USh"],["USD","$"],["UYU","$"],["VND","\u20ab"],["YER","\ufdfc"],["ZAR","R"],["IRR","\ufdfc"],["IQD","\u0639.\u062f"],["VEF","Bs.F."]])}get(e){return this.list.get(e)}set(e,t){this.list.set(e,t)}getPow(e){return"CLF"===e?4:["BHD","IQD","JOD","KWD","LYD","OMR","TND"].includes(e)?3:["BIF","BYR","CLP","CVE","DJF","GNF","ISK","JPY","KMF","KRW","MGA","PYG","RWF","UGX","UYI","VND","VUV","XAF","XOF","XPF"].includes(e)?0:"MRO"===e?1:2}getString(e,t){const a=(e/Math.pow(10,this.getPow(t))).toFixed(2);return"".concat(a," ").concat(this.get(t))}},o=a(307),r=a(39),c=a(72),l=a(110);let d=new Map;function h(e){return!!e&&(!!e.content&&(d.has(e.content["@type"])||e.ttl>0))}function u(e,t=!1){if(!e)return null;if(!e.content)return null;const a=e.sender_user_id===c.a.getMyId(),n=r.a.get(e.chat_id),d="chatTypeSupergroup"===n.type["@type"]&&n.type.is_channel,u=e.ttl,p=e.sender_user_id,m=e.content;if(u>0)switch(m["@type"]){case"messagePhoto":return a?"You sent a self-destructing photo. Please view it on your mobile":s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{userId:p,openUser:t})," sent a self-destructing photo. Please view it on your mobile");case"messageVideo":return a?"You sent a self-destructing video. Please view it on your mobile":s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{userId:p,openUser:t})," sent a self-destructing video. Please view it on your mobile");default:return a?"You sent a self-destructing message. Please view it on your mobile":s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{userId:p,openUser:t})," sent a self-destructing message. Please view it on your mobile")}switch(m["@type"]){case"messageBasicGroupChatCreate":{const n=r.a.get(e.chat_id).title;return a?"You created group \xab".concat(n,"\xbb"):s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{userId:p,openUser:t})," created group \xab".concat(n,"\xbb"))}case"messageChatAddMembers":{const n=m.member_user_ids.map(e=>s.a.createElement(o.a,{key:e,userId:e,openUser:t})).reduce((e,t,a,n)=>{const s=a===n.length-1?" and ":", ";return null===e?[t]:[...e,s,t]},null);return a?1===m.member_user_ids.length&&m.member_user_ids[0]===c.a.getMyId()?"You joined the group":s.a.createElement(s.a.Fragment,null,"You added ",n):1===m.member_user_ids.length&&m.member_user_ids[0]===e.sender_user_id?s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{userId:p,openUser:t})," joined the group"):s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{userId:p,openUser:t})," added ",n)}case"messageChatChangePhoto":return d?"Channel photo updated":a?"You updated group photo":s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{userId:p,openUser:t})," updated group photo");case"messageChatChangeTitle":{const e=m.title;return d?"Channel name was changed to \xab".concat(e,"\xbb"):a?"You changed group name to \xab".concat(e,"\xbb"):s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{userId:p,openUser:t})," changed group name to \xab".concat(e,"\xbb"))}case"messageChatDeleteMember":return a?m.user_id===c.a.getMyId()?"You left the group":s.a.createElement(s.a.Fragment,null,"You removed ",s.a.createElement(o.a,{userId:m.user_id,openUser:t})):m.user_id===p?s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{userId:p,openUser:t})," left the group"):s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{userId:p,openUser:t})," removed ",s.a.createElement(o.a,{userId:m.user_id,openUser:t}));case"messageChatDeletePhoto":return d?"Channel photo removed":a?"You removed group photo":s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{userId:p,openUser:t})," removed group photo");case"messageChatJoinByLink":return a?"You joined the group via invite link":s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{userId:p,openUser:t})," joined the group via invite link");case"messageChatSetTtl":{const e=m.ttl,n=function(e){if(e<60){const t=1===e?"second":"seconds";return"".concat(e," ").concat(t)}if(e<3600){const t=1===Math.floor(e/60)?"minute":"minutes";return"".concat(e," ").concat(t)}if(e<86400){const t=1===Math.floor(e/60/60)?"hour":"hours";return"".concat(e," ").concat(t)}if(e<604800){const t=1===Math.floor(e/60/60/24)?"day":"days";return"".concat(e," ").concat(t)}return 604800===e?"1 week":"".concat(e," seconds")}(e);return e<=0?a?"You disabled the self-destruct timer":s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{userId:p,openUser:t})," disabled the self-destruct timer"):a?"You set the self-destruct timer to ".concat(n):s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{userId:p,openUser:t})," set the self-destruct timer to ".concat(n))}case"messageChatUpgradeFrom":return"The group was upgraded to a supergroup";case"messageChatUpgradeTo":return"Group migrated to a supergroup";case"messageContactRegistered":return s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{userId:p,openUser:t})," just joined Telegram");case"messageCustomServiceAction":return m.text;case"messageGameScore":{const n=l.a.get(e.chat_id,m.game_message_id);if(n&&n.content&&"messageGame"===n.content["@type"]&&n.content.game){const e=n.content.game;return a?"You scored ".concat(m.score," in \xab").concat(e.title,"\xbb"):s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{userId:n.sender_user_id,openUser:t})," scored ".concat(m.score," in \xab").concat(e.title,"\xbb"))}return a?"You scored ".concat(m.score):s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{userId:p,openUser:t})," scored ".concat(m.score))}case"messagePassportDataReceived":return"Telegram Passport data received";case"messagePassportDataSent":{const a=r.a.get(e.chat_id),n=m.types.map(e=>function(e){switch(e["@type"]){case"passportElementTypeAddress":return"Address";case"passportElementTypeBankStatement":return"Bank Statement";case"passportElementTypeDriverLicense":return"Driver Licence";case"passportElementTypeEmailAddress":return"Email";case"passportElementTypeIdentityCard":return"Identity Card";case"passportElementTypeInternalPassport":return"Internal Passport";case"passportElementTypePassport":return"Passport";case"passportElementTypePassportRegistration":return"Passport Registration";case"passportElementTypePersonalDetails":return"Personal details";case"passportElementTypePhoneNumber":return"Phone Number";case"passportElementTypeRentalAgreement":return"Tenancy Agreement";case"passportElementTypeTemporaryRegistration":return"Temporary Registration";case"passportElementTypeUtilityBill":return"Utility Bill"}return""}(e)).reduce((e,t)=>null===e?[t]:[...e,", ",t],null);return s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{userId:a.type.user_id,openUser:t})," received the following documents: ",n)}case"messagePaymentSuccessful":{const a=r.a.get(e.chat_id),n=l.a.get(e.chat_id,m.invoice_message_id);if(n&&n.content&&"messageInvoice"===n.content["@type"]&&n.content.invoice){const e=n.content.invoice;return s.a.createElement(s.a.Fragment,null,"You have just successfully transferred ".concat(i.getString(m.total_amount,m.currency)," to "),s.a.createElement(o.a,{userId:a.type.user_id,openUser:t})," for ".concat(e.title))}return s.a.createElement(s.a.Fragment,null,"You have just successfully transferred ".concat(i.getString(m.total_amount,m.currency)," to "),s.a.createElement(o.a,{userId:a.type.user_id,openUser:t}))}case"messagePaymentSuccessfulBot":return"Payment successful";case"messagePinMessage":{const a=function(e,t){if(!e)return null;const a=e.chat_id,n=e.sender_user_id;if(0!==n)return s.a.createElement(o.a,{userId:n,openUser:t});const i=r.a.get(a);return i?i.title:null}(e,t),n=l.a.get(e.chat_id,m.message_id);if(!n||!n.content)return s.a.createElement(s.a.Fragment,null,a," pinned a message");let i=" pinned a message";if(h(n))i=" pinned a service message";else switch(n.content["@type"]){case"messageAnimation":i=" pinned a GIF";break;case"messageAudio":i=" pinned a track";break;case"messageCall":i=" pinned a call";break;case"messageContact":i=" pinned a contact";break;case"messageDocument":i=" pinned a file";break;case"messageExpiredPhoto":i=" pinned a photo";break;case"messageExpiredVideo":i=" pinned a video";break;case"messageGame":i=" pinned a game";break;case"messageInvoice":i=" pinned an invoice";break;case"messageLocation":i=" pinned a map";break;case"messagePhoto":i=" pinned a photo";break;case"messagePoll":i=" pinned a poll";break;case"messageSticker":i=" pinned a sticker";break;case"messageText":{const e=16,t=n.content.text.text;i=t.length<=e?" pinned \xab".concat(t,"\xbb"):" pinned \xab".concat(t.substring(0,e),"...\xbb");break}case"messageUnsupported":i=" pinned unsupported message";break;case"messageVenue":i=" pinned a venue";break;case"messageVideo":i=" pinned a video";break;case"messageVideoNote":i=" pinned a video message";break;case"messageVoiceNote":i=" pinned a voice message"}return s.a.createElement(s.a.Fragment,null,a,i)}case"messageScreenshotTaken":return a?"You took a screenshot!":s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{userId:p,openUser:t})," took a screenshot!");case"messageSupergroupChatCreate":{const e=m.title;return d?"Channel created":a?"You created group \xab".concat(e,"\xbb"):s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{userId:p,openUser:t})," created group \xab".concat(e,"\xbb"))}case"messageUnsupported":return"Unsupported message";case"messageWebsiteConnected":return"You allowed this bot to message you when you logged in on ".concat(m.domain_name,".")}return"[".concat(e.content["@type"],"]")}d.set("messageBasicGroupChatCreate","messageBasicGroupChatCreate"),d.set("messageChatAddMembers","messageChatAddMembers"),d.set("messageChatChangePhoto","messageChatChangePhoto"),d.set("messageChatChangeTitle","messageChatChangeTitle"),d.set("messageChatDeleteMember","messageChatDeleteMember"),d.set("messageChatDeletePhoto","messageChatDeletePhoto"),d.set("messageChatJoinByLink","messageChatJoinByLink"),d.set("messageChatSetTtl","messageChatSetTtl"),d.set("messageChatUpgradeFrom","messageChatUpgradeFrom"),d.set("messageChatUpgradeTo","messageChatUpgradeTo"),d.set("messageContactRegistered","messageContactRegistered"),d.set("messageCustomServiceAction","messageCustomServiceAction"),d.set("messageGameScore","messageGameScore"),d.set("messagePassportDataReceived","messagePassportDataReceived"),d.set("messagePassportDataSent","messagePassportDataSent"),d.set("messagePaymentSuccessful","messagePaymentSuccessful"),d.set("messagePaymentSuccessfulBot","messagePaymentSuccessfulBot"),d.set("messagePinMessage","messagePinMessage"),d.set("messageScreenshotTaken","messageScreenshotTaken"),d.set("messageSupergroupChatCreate","messageSupergroupChatCreate"),d.set("messageUnsupported","messageUnsupported"),d.set("messageWebsiteConnected","messageWebsiteConnected")},,,function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return o})),a.d(t,"d",(function(){return h}));var n=a(339);function s(e,t){return e?t?e.startsWith("mailto:")?e:"mailto:"+e:e.startsWith("http")?e:"http://"+e:null}function i(e,t){return(!e||e===t)&&!function(e){return!!e&&r.test(e)}(t)}function o(e,t){if(!e)return null;const a=s(e,t);try{let e=decodeURI(a);const t=e.match(/^https?:\/\/([^\/:?#]+)(?:[\/:?#]|$)/i)[1];return e=e.replace(t,n.a.ToUnicode(t)),e}catch(i){console.log("SafeLink.getDecodedUrl error ",e,i)}return null}const r=/\u202e/;const c=new RegExp("(?:([a-zA-Z]+):\\/\\/)((?:[A-Za-z\xd0\x90-\xd0\xaf\xd0\x81\xd0\xb0-\xd1\x8f\xd1\x910-9\\-\\_]+\\.){0,10}([A-Za-z\xd1\x80\xd1\x84\\-\\d]{2,22})(\\:\\d+)?)"),l=new RegExp("(?:([a-zA-Z]+):\\/\\/)?((?:[A-Za-z\xd0\x90-\xd0\xaf\xd0\x81\xd0\xb0-\xd1\x8f\xd1\x910-9\\-\\_]+\\.){1,10}([A-Za-z\xd1\x80\xd1\x84\\-\\d]{2,22})(\\:\\d+)?)"),d=new RegExp("^([a-zA-Z]+):\\/\\/");function h(e){const t=e.trim();if(!t)return null;const a=t.match(c);if(!a){const e=t.match(l);return e&&0===e.index?"http://"+t:null}if(0!==a.index)return null;const n=t.match(d);return n&&function(e){return["http","https","tg"].some(t=>0===e.toLowerCase().indexOf(t))}(n[0])?t:null}},function(e,t,a){"use strict";var n=a(0),s=a.n(n),i=a(109),o=a.n(i),r=a(306),c=a(313),l=a(319),d=a(320),h=a(321),u=a(282),p=a(287);a(388);class m extends s.a.Component{constructor(e){super(e),this.onClientUpdateMediaEnd=e=>{const t=this.props,a=t.chatId,n=t.messageId;a===e.chatId&&n===e.messageId&&this.setState({active:!1,playing:!1,currentTime:0})},this.onClientUpdateMediaPlay=e=>{const t=this.props,a=t.chatId,n=t.messageId;t.playing;a===e.chatId&&n===e.messageId?this.setState({playing:!0}):this.setState({playing:!1})},this.onClientUpdateMediaPause=e=>{const t=this.props,a=t.chatId,n=t.messageId;a===e.chatId&&n===e.messageId&&this.setState({playing:!1})},this.onClientUpdateMediaActive=e=>{const t=this.props,a=t.chatId,n=t.messageId;a===e.chatId&&n===e.messageId?this.state.active||this.setState({active:!0,currentTime:0,playing:!0}):this.state.active&&this.setState({active:!1,currentTime:0,playing:!1})};const t=e.chatId,a=e.messageId,n=p.b.time,s=p.b.message,i=p.b.playing,o=s&&s.chat_id===t&&s.id===a;this.state={active:o,playing:!!o&&i,currentTime:o&&n?n.currentTime:0,duration:o&&n?n.duration:0}}shouldComponentUpdate(e,t,a){const n=this.state,s=n.active,i=n.playing,o=n.currentTime,r=n.duration;return t.active!==s||(t.playing!==i||(t.currentTime!==o||t.duration!==r))}componentDidMount(){p.b.on("clientUpdateMediaActive",this.onClientUpdateMediaActive),p.b.on("clientUpdateMediaPlay",this.onClientUpdateMediaPlay),p.b.on("clientUpdateMediaPause",this.onClientUpdateMediaPause),p.b.on("clientUpdateMediaEnd",this.onClientUpdateMediaEnd)}componentWillUnmount(){p.b.off("clientUpdateMediaActive",this.onClientUpdateMediaActive),p.b.off("clientUpdateMediaPlay",this.onClientUpdateMediaPlay),p.b.off("clientUpdateMediaPause",this.onClientUpdateMediaPause),p.b.off("clientUpdateMediaEnd",this.onClientUpdateMediaEnd)}render(){const e=this.props,t=e.chatId,a=e.messageId,n=e.audio,i=e.openMedia,p=e.title,m=e.meta,g=e.caption,f=this.state.playing;if(!n)return null;const b=n.album_cover_thumbnail,C=n.duration,y=n.audio,v=Object(u.a)(n),E=Object(u.b)(n);return s.a.createElement("div",{className:o()("audio","document",{"media-title":p})},s.a.createElement(d.a,{thumbnail:b,file:y,openMedia:i,icon:s.a.createElement(r.a,null),completeIcon:f?s.a.createElement(l.a,null):s.a.createElement(c.a,null)}),s.a.createElement("div",{className:"document-content"},s.a.createElement("div",{className:"document-title"},s.a.createElement("a",{className:"document-name",onClick:i,title:v},v)),s.a.createElement("div",{className:"audio-action"},E),s.a.createElement(h.a,{chatId:t,messageId:a,duration:C,file:y,meta:g?null:m})))}}t.a=m},function(e,t,a){"use strict";var n=a(0),s=a.n(n),i=a(38);t.a=Object(i.a)(s.a.createElement("path",{transform:"translate(-15.000000, -15.000000)",d:"M23,16 C23.5522847,16 24,16.4477153 24,17 L24,37 C24,37.5522847 23.5522847,38 23,38 L18,38 C17.4477153,38 17,37.5522847 17,37 L17,17 C17,16.4477153 17.4477153,16 18,16 L23,16 Z M36,16 C36.5522847,16 37,16.4477153 37,17 L37,37 C37,37.5522847 36.5522847,38 36,38 L31,38 C30.4477153,38 30,37.5522847 30,37 L30,17 C30,16.4477153 30.4477153,16 31,16 L36,16 Z"}),"Pause")},function(e,t,a){"use strict";var n=a(0),s=a.n(n),i=a(109),o=a.n(i),r=a(293),c=a(279),l=a(278);a(386);class d extends s.a.Component{constructor(...e){super(...e),this.state={loaded:!1},this.onClientUpdateDocumentThumbnailBlob=e=>{const t=this.props.thumbnail;if(!t)return;const a=t.photo;if(!a)return;const n=e.fileId;a.id===n&&this.forceUpdate()},this.handleLoad=()=>{this.setState({loaded:!0})}}componentDidMount(){l.a.on("clientUpdateDocumentThumbnailBlob",this.onClientUpdateDocumentThumbnailBlob),l.a.on("clientUpdateAudioThumbnailBlob",this.onClientUpdateDocumentThumbnailBlob)}componentWillUnmount(){l.a.off("clientUpdateDocumentThumbnailBlob",this.onClientUpdateDocumentThumbnailBlob),l.a.off("clientUpdateAudioThumbnailBlob",this.onClientUpdateDocumentThumbnailBlob)}render(){const e=this.props,t=e.minithumbnail,a=e.thumbnail,n=e.file,i=e.icon,l=e.completeIcon,d=e.openMedia,h=this.state.loaded,u=t?"data:image/jpeg;base64, "+t.data:null,p=Object(c.j)(a?a.photo:null),m=p&&h,g=p||u;return s.a.createElement("div",{className:o()("document-tile",{"document-tile-image":!g},{pointer:d}),onClick:d},n&&s.a.createElement(r.a,{file:n,thumbnailSrc:g,download:!0,upload:!0,cancelButton:!0,zIndex:1,icon:i,completeIcon:"function"===typeof l?l(g):l}),g&&s.a.createElement("img",{className:"tile-photo",src:g,onLoad:this.handleLoad,draggable:!1,alt:""}),!m&&s.a.createElement("div",{className:"document-tile-background"}))}}t.a=d},function(e,t,a){"use strict";var n=a(0),s=a.n(n),i=a(279),o=a(18),r=a(278),c=a(287);a(387);class l extends s.a.Component{constructor(e){super(e),this.onClientUpdateMediaEnd=e=>{const t=this.props,a=t.chatId,n=t.messageId,s=t.duration,i=this.state,o=(i.active,i.file);a===e.chatId&&n===e.messageId&&this.setState({active:!1,currentTime:0,timeString:this.getTimeString(0,s,!1,o)})},this.onClientUpdateMediaTime=e=>{const t=this.props,a=t.chatId,n=t.messageId,s=t.duration,i=this.state,o=i.active,r=i.file;if(a===e.chatId&&n===e.messageId){const t=e.duration>=0&&e.duration<1/0?e.duration:s;this.setState({currentTime:e.currentTime,duration:t,timeString:this.getTimeString(e.currentTime,t,o,r)})}},this.onClientUpdateMediaActive=e=>{const t=this.props,a=t.chatId,n=t.messageId,s=t.duration,i=this.state,o=i.active,r=i.currentTime,c=i.file;a===e.chatId&&n===e.messageId?this.setState({active:!0,currentTime:o?r:0,timeString:this.getTimeString(o?r:0,s,!0,c)}):o&&this.setState({active:!1,currentTime:0,timeString:this.getTimeString(0,s,!1,c)})},this.onUpdateFile=e=>{const t=this.state.file,a=e.file;t&&t.id===a.id&&this.setState({file:a,prevFile:t})},this.getTimeString=(e,t,a,n)=>{const s=n.local&&n.local.is_downloading_completed,i=(n.remote&&n.remote.is_uploading_completed,Object(o.e)(Math.floor(t||0))),r=Object(o.e)(Math.floor(e||0));return a&&s?"".concat(r,"/").concat(i):"".concat(i)};const t=c.b.message,a=c.b.time,n=this.props,s=n.chatId,i=n.messageId,l=n.duration,d=n.file,h=t&&t.chat_id===s&&t.id===i,u=h&&a?a.currentTime:0,p=h&&a&&a.duration?a.duration:l,m=r.a.get(d.id)||d;this.state={active:h,currentTime:u,duration:p,timeString:this.getTimeString(u,l,h,m),prevFile:null,file:m}}shouldComponentUpdate(e,t){const a=this.props.theme,n=this.state,s=n.active,i=n.timeString,o=n.file,r=n.prevFile;return e.theme!==a||(t.timeString!==i||(t.active!==s||(t.file!==o||t.prevFile!==r)))}componentDidMount(){r.a.on("updateFile",this.onUpdateFile),c.b.on("clientUpdateMediaActive",this.onClientUpdateMediaActive),c.b.on("clientUpdateMediaTime",this.onClientUpdateMediaTime),c.b.on("clientUpdateMediaEnd",this.onClientUpdateMediaEnd)}componentWillUnmount(){r.a.off("updateFile",this.onUpdateFile),c.b.off("clientUpdateMediaActive",this.onClientUpdateMediaActive),c.b.off("clientUpdateMediaTime",this.onClientUpdateMediaTime),c.b.off("clientUpdateMediaEnd",this.onClientUpdateMediaEnd)}render(){const e=this.props,t=e.title,a=e.meta,n=this.state,o=n.active,r=n.file,c=n.timeString;if(!r)return null;const l=r.local&&r.local.is_downloading_active,d=r.remote&&r.remote.is_uploading_active,h=r.local&&r.local.is_downloading_completed,u=(r.remote&&r.remote.is_uploading_completed,Object(i.g)(r));let p=null;l?p=Object(i.e)(r):d&&(p=Object(i.k)(r));const m=p?"".concat(p,"/").concat(u):"".concat(u);return s.a.createElement("div",{className:"audio-action"},!o&&s.a.createElement("span",null,t),!h&&s.a.createElement("span",null,"".concat(m,", ")),s.a.createElement("span",null,c),a)}}t.a=l},function(e,t,a){"use strict";var n=a(78),s=a(0),i=a.n(s),o=a(109),r=a.n(o),c=a(396),l=a.n(c),d=a(281),h=a(279),u=a(14),p=a(278);a(395);class m extends i.a.Component{constructor(...e){super(...e),this.onClientUpdateLocationBlob=e=>{const t=e.fileId,a=this.props,n=a.location,s=a.width,i=a.height,o=a.zoom,r=a.scale,c=Object(d.o)(n,s,i,o,r),l=p.a.getLocationFile(c);l&&l.id===t&&this.forceUpdate()},this.handleClick=e=>{e.stopPropagation()}}componentDidMount(){p.a.on("clientUpdateLocationBlob",this.onClientUpdateLocationBlob)}componentWillUnmount(){p.a.off("clientUpdateLocationBlob",this.onClientUpdateLocationBlob)}render(){const e=this.props,t=e.location,a=e.width,s=e.height,o=e.zoom,c=e.scale,u=e.type,m=e.style,g=e.title,f=e.caption;if(!t)return null;const b=Object(d.o)(t,a,s,o,c),C=p.a.getLocationFile(b),y=Object(h.j)(C),v=t.longitude,E=t.latitude,U="https://maps.google.com/?q=".concat(E,",").concat(v),S=Object(n.a)({width:a,height:s},m);return i.a.createElement("div",{className:r()("location",{"location-message":"message"===u,"location-venue":"venue"===u,"location-title":g,"location-caption":f}),style:S},i.a.createElement("a",{href:U,target:"_blank",rel:"noopener noreferrer",onClick:this.handleClick},i.a.createElement("div",{className:"location-wrapper"},i.a.createElement("img",{className:"location-image",draggable:!1,alt:U,src:y}),i.a.createElement("div",{className:"location-icon"},i.a.createElement(l.a,{fontSize:"large",color:"primary"})))))}}m.defaultProps={width:u.p,height:u.n,zoom:u.q,scale:u.o},t.a=m},function(e,t,a){"use strict";var n=a(78),s=a(0),i=a.n(s),o=a(109),r=a.n(o),c=a(313),l=a(18),d=a(279),h=a(282),u=a(14),p=a(278);a(400);class m extends i.a.Component{constructor(...e){super(...e),this.onClientUpdateVideoThumbnailBlob=e=>{const t=this.props.video.thumbnail,a=e.fileId;t&&t.photo&&t.photo.id===a&&this.forceUpdate()}}componentDidMount(){p.a.on("clientUpdateVideoThumbnailBlob",this.onClientUpdateVideoThumbnailBlob)}componentWillUnmount(){p.a.off("clientUpdateVideoThumbnailBlob",this.onClientUpdateVideoThumbnailBlob)}render(){const e=this.props,t=e.displaySize,a=e.openMedia,s=e.title,o=e.caption,u=e.type,p=e.style,m=this.props.video,g=m.minithumbnail,f=m.thumbnail,b=m.video,C=m.width,y=m.height,v=m.duration,E=Object(l.g)({width:C,height:y}||f,t);if(!E)return null;const U=Object(n.a)({width:E.width,height:E.height},p),S=g?"data:image/jpeg;base64, "+g.data:null,k=Object(d.j)(f?f.photo:null),M=k?Object(h.k)(f):Boolean(S);return i.a.createElement("div",{className:r()("video",{"video-big":"message"===u,"video-title":s,"video-caption":o,pointer:a}),style:U,onClick:a},i.a.createElement("img",{className:r()("video-preview",{"media-blurred":M,"media-mini-blurred":!k&&M}),src:k||S,alt:""}),i.a.createElement("div",{className:"video-play"},i.a.createElement(c.a,null)),i.a.createElement("div",{className:"video-meta"},Object(l.e)(v)+" "+Object(d.g)(b)))}}m.defaultProps={size:u.F,displaySize:u.D},t.a=m},function(e,t,a){"use strict";var n=a(0),s=a.n(n),i=a(281),o=a(110);class r extends s.a.Component{constructor(e){super(e),this.onUpdateMessageContentOpened=e=>{const t=this.props,a=t.chatId,n=t.messageId;a===e.chat_id&&n===e.message_id&&this.setState({isOpened:Object(i.C)(a,n)})};const t=this.props,a=t.chatId,n=t.messageId;this.state={isOpened:Object(i.C)(a,n)}}componentDidMount(){o.a.on("updateMessageContentOpened",this.onUpdateMessageContentOpened)}componentWillUnmount(){o.a.off("updateMessageContentOpened",this.onUpdateMessageContentOpened)}render(){const e=this.props,t=e.icon,a=e.openedIcon;return this.state.isOpened?a:t}}r.defaultProps={icon:null,openedIcon:null},t.a=r},function(e,t,a){"use strict";var n=a(0),s=a.n(n),i=a(294),o=a(14),r=a(2);a(527);class c extends s.a.Component{constructor(...e){super(...e),this.state={emoji:null,prevPropsSticker:null},this.loadStickerEmojis=e=>{const t=e.sticker.id;r.a.send({"@type":"getStickerEmojis",sticker:{"@type":"inputFileId",id:t}}).then(t=>{this.props.sticker===e&&this.setState({emoji:t.emojis.join(" ")})})}}static getDerivedStateFromProps(e,t){const a=e.sticker,n=t.prevPropsSticker;return a&&n?{prevPropsSticker:a,emoji:null}:null}componentDidUpdate(e,t,a){const n=this.props.sticker;n&&n!==e.sticker&&this.loadStickerEmojis(n)}componentDidMount(){const e=this.props.sticker;e&&this.loadStickerEmojis(e)}render(){const e=this.props.sticker,t=this.state.emoji;return e?s.a.createElement("div",{className:"sticker-preview"},s.a.createElement("div",{className:"sticker-preview-emoji"},t),s.a.createElement(i.b,{sticker:e,displaySize:o.lb,source:i.a.PREVIEW})):null}}t.a=c},,,,,,,function(e,t,a){"use strict";var n=a(0),s=a.n(n),i=a(38);t.a=Object(i.a)(s.a.createElement("g",{transform:"translate(3.000000, 0.600000)"},s.a.createElement("path",{d:"M9,0 C13.9705627,-9.13077564e-16 18,4.02943725 18,9 L18,23 L18,23 L15,20 L12,23 L9,20 L6,23 L3,20 L0,23 L0,9 C-6.08718376e-16,4.02943725 4.02943725,9.13077564e-16 9,0 Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinejoin:"round",fill:"none"}),s.a.createElement("circle",{cx:"5",cy:"9",r:"2"}),s.a.createElement("circle",{cx:"13",cy:"9",r:"2"})),"DeletedAccount")},,,function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return i})),a.d(t,"c",(function(){return o}));var n=a(2);function s(e,t,a){n.a.send({"@type":"setPollAnswer",chat_id:e,message_id:t,option_ids:a})}function i(e,t){n.a.send({"@type":"setPollAnswer",chat_id:e,message_id:t,option_ids:[]})}function o(e,t){n.a.send({"@type":"stopPoll",chat_id:e,message_id:t,reply_markup:null})}},function(e,t,a){"use strict";var n=a(0),s=a.n(n),i=a(109),o=a.n(i),r=a(288),c=a(72);a(377);class l extends s.a.Component{constructor(e){super(e),this.onUpdateUserStatus=e=>{const t=this.props.userId,a=c.a.get(t);t===e.user_id&&this.setState({status:Object(r.f)(a),isAccent:Object(r.j)(a)})};const t=this.props.userId,a=c.a.get(t);this.state={prevUserId:t,status:Object(r.f)(a),isAccent:Object(r.j)(a)}}static getDerivedStateFromProps(e,t){if(e.userId!==t.prevUserId){const t=e.userId,a=c.a.get(t);return{prevUserId:t,status:Object(r.f)(a),isAccent:Object(r.j)(a)}}return null}shouldComponentUpdate(e,t){const a=this.props.userId,n=this.state,s=n.status,i=n.isAccent;return e.userId!==a||(t.status!==s||t.isAccent!==i)}componentDidMount(){c.a.on("updateUserStatus",this.onUpdateUserStatus)}componentWillUnmount(){c.a.off("updateUserStatus",this.onUpdateUserStatus)}render(){const e=this.state,t=e.status,a=e.isAccent;return s.a.createElement("div",{className:o()("user-content","dialog-content",{"user-status-accent":a})},t)}}t.a=l},function(e,t,a){"use strict";var n=a(78),s=a(17),i=a(2),o=a(338);class r extends s.a{constructor(){super(),this.reset=()=>{this.poll=null},this.onUpdate=e=>{switch(e["@type"]){case"updateAuthorizationState":{const t=e.authorization_state;if(!t)break;switch(t["@type"]){case"authorizationStateClosed":this.reset()}break}}},this.onClientUpdate=e=>{switch(e["@type"]){case"clientUpdateClosePollResults":this.emit("clientUpdateClosePollResults",e);break;case"clientUpdateNewPoll":this.set({type:{"@type":"pollTypeRegular",allow_multiple_answers:!1},id:Date.now(),question:"",options:[],is_anonymous:!0}),this.emit("clientUpdateNewPoll",e);break;case"clientUpdatePollChangeAnonymous":{const t=this.poll,a=t&&t.is_anonymous;this.assign(this.poll,{is_anonymous:!a}),this.emit("clientUpdatePollChangeAnonymous",e);break}case"clientUpdatePollChangeAllowMultipleAnswers":{const t=this.poll,a=t.type;if("pollTypeRegular"===a["@type"]){const e=t&&t.type.allow_multiple_answers,s=Object(n.a)({},a,{allow_multiple_answers:!e});this.assign(this.poll,{type:s})}this.emit("clientUpdatePollChangeAllowMultipleAnswers",e);break}case"clientUpdatePollChangeType":if("pollTypeRegular"===this.poll.type["@type"]){const e={"@type":"pollTypeQuiz",correct_option_id:-1};this.assign(this.poll,{type:e})}else{const e={"@type":"pollTypeRegular",allow_multiple_answers:!1};this.assign(this.poll,{type:e})}this.emit("clientUpdatePollChangeType",e);break;case"clientUpdatePollChooseOption":{const t=e.id,a=this.poll.options;this.assign(this.poll,{options:a.map(e=>e.id===t?Object(n.a)({},e,{is_chosen:!0}):Object(n.a)({},e,{is_chosen:!1}))}),this.emit("clientUpdatePollChooseOption",e);break}case"clientUpdatePollQuestion":{const t=e.question;this.assign(this.poll,{question:t}),this.emit("clientUpdatePollQuestion",e);break}case"clientUpdatePollOption":{const t=e.id,a=e.text,s=this.poll.options;this.assign(this.poll,{options:s.map(e=>e.id===t?Object(n.a)({},e,{text:a}):Object(n.a)({},e))}),this.emit("clientUpdatePollOption",e);break}case"clientUpdateNewPollOption":{const t=e.option,a=this.poll.options;this.assign(this.poll,{options:[...a,t]}),this.emit("clientUpdateNewPollOption",e);break}case"clientUpdateDeletePollOption":{const t=e.id,a=this.poll.options;this.assign(this.poll,{options:a.filter(e=>e.id!==t)}),this.emit("clientUpdateDeletePollOption",e);break}case"clientUpdateDeletePoll":this.set(null),this.emit("clientUpdateDeletePoll",e)}},this.addTdLibListener=()=>{i.a.on("update",this.onUpdate),i.a.on("clientUpdate",this.onClientUpdate)},this.removeTdLibListener=()=>{i.a.off("update",this.onUpdate),i.a.off("clientUpdate",this.onClientUpdate)},this.reset(),this.addTdLibListener()}assign(e,t){this.set(Object.assign({},e,t))}set(e){this.poll=e}getInputMessagePoll(){if(!this.poll)return null;if(!Object(o.b)(this.poll))return null;const e=this.poll,t=e.question,a=e.options,n=e.type,s=e.is_anonymous;return"pollTypeQuiz"===n["@type"]&&(n.correct_option_id=a.findIndex(e=>e.is_chosen),-1===n.correct_option_id)?null:{"@type":"inputMessagePoll",question:t,options:a.filter(e=>Boolean(e.text)).map(e=>e.text),is_anonymous:s,type:n,is_closed:!1}}}const c=new r;window.poll=c,t.a=c},function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return o}));var n=a(14);function s(e){if(!e)return!1;const t=e.question,a=e.options;if(!function(e){return!!e&&e.length<=n.R}(t))return!1;const s=a.filter(e=>Boolean(e.text));return!(s.length<=1)&&s.every(i)}function i(e){return!!e&&(!!e.text&&e.text.length<=n.O)}function o(e){if(!e)return!1;const t=e.question,a=e.options;return!!t||a.some(e=>Boolean(e.text))}},function(e,t,a){"use strict";const n=new function(){this.utf16={decode:function(e){for(var t,a,n=[],s=0,i=e.length;s<i;){if(55296===(63488&(t=e.charCodeAt(s++)))){if(a=e.charCodeAt(s++),55296!==(64512&t)||56320!==(64512&a))throw new RangeError("UTF-16(decode): Illegal UTF-16 sequence");t=((1023&t)<<10)+(1023&a)+65536}n.push(t)}return n},encode:function(e){for(var t,a=[],n=0,s=e.length;n<s;){if(55296===(63488&(t=e[n++])))throw new RangeError("UTF-16(encode): Illegal UTF-16 value");t>65535&&(t-=65536,a.push(String.fromCharCode(t>>>10&1023|55296)),t=56320|1023&t),a.push(String.fromCharCode(t))}return a.join("")}};var e=2147483647;function t(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function a(e,t,a){var n;for(e=a?Math.floor(e/700):e>>1,e+=Math.floor(e/t),n=0;e>455;n+=36)e=Math.floor(e/35);return Math.floor(n+36*e/(e+38))}this.decode=function(t,n){var s,i,o,r,c,l,d,h,u,p,m,g,f,b,C=[],y=[],v=t.length;for(s=128,o=0,r=72,(c=t.lastIndexOf("-"))<0&&(c=0),l=0;l<c;++l){if(n&&(y[C.length]=t.charCodeAt(l)-65<26),t.charCodeAt(l)>=128)throw new RangeError("Illegal input >= 0x80");C.push(t.charCodeAt(l))}for(d=c>0?c+1:0;d<v;){for(h=o,u=1,p=36;;p+=36){if(d>=v)throw RangeError("punycode_bad_input(1)");if((m=(b=t.charCodeAt(d++))-48<10?b-22:b-65<26?b-65:b-97<26?b-97:36)>=36)throw RangeError("punycode_bad_input(2)");if(m>Math.floor((e-o)/u))throw RangeError("punycode_overflow(1)");if(o+=m*u,m<(g=p<=r?1:p>=r+26?26:p-r))break;if(u>Math.floor(e/(36-g)))throw RangeError("punycode_overflow(2)");u*=36-g}if(r=a(o-h,i=C.length+1,0===h),Math.floor(o/i)>e-s)throw RangeError("punycode_overflow(3)");s+=Math.floor(o/i),o%=i,n&&y.splice(o,0,t.charCodeAt(d-1)-65<26),C.splice(o,0,s),o++}if(n)for(o=0,f=C.length;o<f;o++)y[o]&&(C[o]=String.fromCharCode(C[o]).toUpperCase().charCodeAt(0));return this.utf16.encode(C)},this.encode=function(n,s){var i,o,r,c,l,d,h,u,p,m,g,f;s&&(f=this.utf16.decode(n));var b=(n=this.utf16.decode(n.toLowerCase())).length;if(s)for(d=0;d<b;d++)f[d]=n[d]!=f[d];var C,y,v=[];for(i=128,o=0,l=72,d=0;d<b;++d)n[d]<128&&v.push(String.fromCharCode(f?(C=n[d],y=f[d],(C-=(C-97<26)<<5)+((!y&&C-65<26)<<5)):n[d]));for(r=c=v.length,c>0&&v.push("-");r<b;){for(h=e,d=0;d<b;++d)(g=n[d])>=i&&g<h&&(h=g);if(h-i>Math.floor((e-o)/(r+1)))throw RangeError("punycode_overflow (1)");for(o+=(h-i)*(r+1),i=h,d=0;d<b;++d){if((g=n[d])<i&&++o>e)return Error("punycode_overflow(2)");if(g==i){for(u=o,p=36;!(u<(m=p<=l?1:p>=l+26?26:p-l));p+=36)v.push(String.fromCharCode(t(m+(u-m)%(36-m),0))),u=Math.floor((u-m)/(36-m));v.push(String.fromCharCode(t(u,s&&f[d]?1:0))),l=a(o,r+1,r==c),o=0,++r}}++o,++i}return v.join("")},this.ToASCII=function(e){for(var t=e.split("."),a=[],s=0;s<t.length;++s){var i=t[s];a.push(i.match(/[^A-Za-z0-9-]/)?"xn--"+n.encode(i):i)}return a.join(".")},this.ToUnicode=function(e){for(var t=e.split("."),a=[],s=0;s<t.length;++s){var i=t[s];a.push(i.match(/^xn--/)?n.decode(i.slice(4)):i)}return a.join(".")}};t.a=n},,function(e,t,a){"use strict";var n=a(0),s=a.n(n),i=a(109),o=a.n(i),r=a(342),c=a.n(r),l=a(306),d=a(565),h=a(293),u=a(324),p=a(279),m=a(282),g=a(18),f=a(14),b=a(287),C=a(278),y=a(110),v=a(9),E=(a(401),a(305));const U={circle:"video-note-progress-circle"};class S extends s.a.Component{constructor(e){super(e),this.startStopPlayer=()=>{const e=this.videoRef.current;if(e)if(!this.inView||!this.windowFocused||this.openMediaViewer||this.openProfileMediaViewer||this.openIV){if(this.state.active)return;e.pause()}else e.play()},this.onClientUpdateInstantViewContent=e=>{this.openIV=Boolean(E.a.getCurrent()),this.startStopPlayer()},this.onClientUpdateProfileMediaViewerContent=e=>{this.openProfileMediaViewer=Boolean(v.a.profileMediaViewerContent),this.startStopPlayer()},this.onClientUpdateMediaViewerContent=e=>{this.openMediaViewer=Boolean(v.a.mediaViewerContent),this.startStopPlayer()},this.onClientUpdateFocusWindow=e=>{this.windowFocused=e.focused,this.startStopPlayer()},this.onClientUpdateMessagesInView=e=>{const t=this.props,a=t.chatId,n=t.messageId,s="".concat(a,"_").concat(n);this.inView=e.messages.has(s),this.startStopPlayer()},this.onClientUpdateMediaCaptureStream=e=>{const t=this.props,a=t.chatId,n=t.messageId;if(a===e.chatId&&n===e.messageId){this.videoRef.current&&this.setState({srcObject:e.stream},()=>{this.updateVideoSrc()})}},this.onClientUpdateMediaTime=e=>{const t=this.props,a=t.chatId,n=t.messageId;if(a===e.chatId&&n===e.messageId){this.videoRef.current&&this.setState({currentTime:e.currentTime,videoDuration:e.duration})}},this.onClientUpdateMediaEnd=e=>{const t=this.props,a=t.chatId,n=t.messageId;a===e.chatId&&n===e.messageId&&this.setState({active:!1,srcObject:null,currentTime:0},()=>{const e=this.videoRef.current;e&&(this.updateVideoSrc(),window.hasFocus||e.pause())})},this.onClientUpdateMediaActive=e=>{const t=this.props,a=t.chatId,n=t.messageId;this.props.videoNote.video;a===e.chatId&&n===e.messageId?this.state.active||this.setState({active:!0,currentTime:null}):this.state.active&&this.setState({active:!1,srcObject:null,currentTime:0},()=>{const e=this.videoRef.current;e&&(this.updateVideoSrc(),window.hasFocus||e.pause())})},this.onClientUpdateVideoNoteBlob=e=>{const t=this.props.videoNote.video,a=e.fileId;t&&t.id===a&&this.setState({src:Object(p.j)(t)},()=>{this.updateVideoSrc()})},this.onClientUpdateVideoNoteThumbnailBlob=e=>{const t=this.props.videoNote.thumbnail;if(!t)return;const a=e.fileId;t.photo&&t.photo.id===a&&this.forceUpdate()},this.handleCanPlay=()=>{},this.videoRef=s.a.createRef();const t=e.chatId,a=e.messageId,n=e.videoNote.video,i=b.b.time,o=b.b.message,r=b.b.videoStream,c=o&&o.chat_id===t&&o.id===a;this.state={active:c,srcObject:c?r:null,src:Object(p.j)(n),currentTime:c&&i?i.currentTime:0,videoDuration:c&&i?i.duration:0},this.windowFocused=window.hasFocus,this.inView=!1,this.openMediaViewer=Boolean(v.a.mediaViewerContent),this.openProfileMediaViewer=Boolean(v.a.profileMediaViewerContent),this.openIV=Boolean(E.a.getCurrent())}updateVideoSrc(){const e=this.state,t=e.srcObject,a=e.src,n=this.videoRef.current;if(!n)return;if(t)return void(n.srcObject=t);const s=n.srcObject;if(s){s.getTracks().forEach(e=>{e.stop()})}n.srcObject&&(n.srcObject=null),n.src!==a&&(n.src=a)}componentDidMount(){this.updateVideoSrc(),C.a.on("clientUpdateVideoNoteThumbnailBlob",this.onClientUpdateVideoNoteThumbnailBlob),C.a.on("clientUpdateVideoNoteBlob",this.onClientUpdateVideoNoteBlob),y.a.on("clientUpdateMessagesInView",this.onClientUpdateMessagesInView),v.a.on("clientUpdateFocusWindow",this.onClientUpdateFocusWindow),v.a.on("clientUpdateMediaViewerContent",this.onClientUpdateMediaViewerContent),v.a.on("clientUpdateProfileMediaViewerContent",this.onClientUpdateProfileMediaViewerContent),E.a.on("clientUpdateInstantViewContent",this.onClientUpdateInstantViewContent),b.b.on("clientUpdateMediaActive",this.onClientUpdateMediaActive),b.b.on("clientUpdateMediaCaptureStream",this.onClientUpdateMediaCaptureStream),b.b.on("clientUpdateMediaTime",this.onClientUpdateMediaTime),b.b.on("clientUpdateMediaEnd",this.onClientUpdateMediaEnd)}componentWillUnmount(){C.a.off("clientUpdateVideoNoteThumbnailBlob",this.onClientUpdateVideoNoteThumbnailBlob),C.a.off("clientUpdateVideoNoteBlob",this.onClientUpdateVideoNoteBlob),y.a.off("clientUpdateMessagesInView",this.onClientUpdateMessagesInView),v.a.off("clientUpdateFocusWindow",this.onClientUpdateFocusWindow),v.a.off("clientUpdateMediaViewerContent",this.onClientUpdateMediaViewerContent),v.a.off("clientUpdateProfileMediaViewerContent",this.onClientUpdateProfileMediaViewerContent),E.a.off("clientUpdateInstantViewContent",this.onClientUpdateInstantViewContent),b.b.off("clientUpdateMediaActive",this.onClientUpdateMediaActive),b.b.off("clientUpdateMediaCaptureStream",this.onClientUpdateMediaCaptureStream),b.b.off("clientUpdateMediaTime",this.onClientUpdateMediaTime),b.b.off("clientUpdateMediaEnd",this.onClientUpdateMediaEnd)}render(){const e=this.props,t=(e.displaySize,e.chatId),a=e.messageId,n=e.openMedia,i=this.state,r=i.active,f=i.currentTime,b=i.videoDuration,C=this.props.videoNote,v=C.minithumbnail,E=C.thumbnail,S=C.video,k=C.duration;if(!y.a.get(t,a))return null;const M={width:200,height:200};if(!M)return null;const I=v?"data:image/jpeg;base64, "+v.data:null,w=Object(p.j)(E?E.photo:null),_=Object(p.j)(S),x=w?Object(m.k)(E):Boolean(I);let O=0;if(b&&f){O=(f+.25)/b*100}return s.a.createElement("div",{className:o()("video-note",{"video-note-playing":r}),style:M,onClick:n},_?s.a.createElement(s.a.Fragment,null,s.a.createElement("video",{ref:this.videoRef,className:o()("media-viewer-content-image","video-note-round"),poster:w||I,muted:!0,autoPlay:!0,loop:!0,playsInline:!0,width:M.width,height:M.height,onCanPlay:this.handleCanPlay}),s.a.createElement("div",{className:"video-note-player"},s.a.createElement("div",{className:"video-note-progress"},s.a.createElement(d.a,{classes:U,variant:"static",value:O,size:200,thickness:1})),s.a.createElement("div",{className:"animation-meta"},Object(g.e)(r?Math.floor(f):k),s.a.createElement(u.a,{chatId:t,messageId:a,icon:"\xa0\u2022"})),s.a.createElement("div",{className:"video-note-muted"},s.a.createElement(c.a,null)))):s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"video-note-round"},s.a.createElement("img",{className:o()("animation-preview",{"media-blurred":x,"media-mini-blurred":!_&&!w&&x}),style:M,src:w||I,alt:""})),s.a.createElement("div",{className:"animation-meta"},Object(g.e)(k)+" "+Object(p.g)(S),s.a.createElement(u.a,{chatId:t,messageId:a,icon:"\xa0\u2022"})),s.a.createElement("div",{className:"video-note-muted"},s.a.createElement(c.a,null))),s.a.createElement(h.a,{file:S,download:!0,upload:!0,cancelButton:!0,icon:s.a.createElement(l.a,null)}))}}S.defaultProps={size:f.F,displaySize:f.D},t.a=S},,function(e,t,a){"use strict";var n=a(0),s=a.n(n),i=a(306),o=a(313),r=a(319),c=a(320),l=a(287);a(402);class d extends s.a.Component{constructor(e){super(e),this.onClientUpdateMediaEnd=e=>{const t=this.props,a=t.chatId,n=t.messageId;a===e.chatId&&n===e.messageId&&this.setState({active:!1,playing:!1,currentTime:0})},this.onClientUpdateMediaPlay=e=>{const t=this.props,a=t.chatId,n=t.messageId;a===e.chatId&&n===e.messageId?this.setState({playing:!0}):this.setState({playing:!1})},this.onClientUpdateMediaPause=e=>{const t=this.props,a=t.chatId,n=t.messageId;a===e.chatId&&n===e.messageId&&this.setState({playing:!1})},this.onClientUpdateMediaActive=e=>{const t=this.props,a=t.chatId,n=t.messageId;a===e.chatId&&n===e.messageId?this.state.active||this.setState({active:!0,currentTime:0,playing:!0}):this.state.active&&this.setState({active:!1,currentTime:0,playing:!1})};const t=e.chatId,a=e.messageId,n=l.b.time,s=l.b.message,i=l.b.playing,o=s&&s.chat_id===t&&s.id===a;this.state={active:o,playing:!!o&&i,currentTime:o&&n?n.currentTime:0,duration:o&&n?n.duration:0}}componentDidMount(){l.b.on("clientUpdateMediaActive",this.onClientUpdateMediaActive),l.b.on("clientUpdateMediaPlay",this.onClientUpdateMediaPlay),l.b.on("clientUpdateMediaPause",this.onClientUpdateMediaPause),l.b.on("clientUpdateMediaEnd",this.onClientUpdateMediaEnd)}componentWillUnmount(){l.b.off("clientUpdateMediaActive",this.onClientUpdateMediaActive),l.b.off("clientUpdateMediaPlay",this.onClientUpdateMediaPlay),l.b.off("clientUpdateMediaPause",this.onClientUpdateMediaPause),l.b.off("clientUpdateMediaEnd",this.onClientUpdateMediaEnd)}render(){const e=this.props,t=e.file,a=e.openMedia,n=this.state.playing;return s.a.createElement(c.a,{thumbnail:null,file:t,openMedia:a,icon:s.a.createElement(i.a,null),completeIcon:n?s.a.createElement(r.a,null):s.a.createElement(o.a,null)})}}t.a=d},function(e,t,a){},function(e,t,a){"use strict";var n=a(0),s=a.n(n),i=a(38);t.a=Object(i.a)(s.a.createElement("path",{d:"M12,1 C18.0751322,1 23,5.92486775 23,12 C23,18.0751322 18.0751322,23 12,23 C5.92486775,23 1,18.0751322 1,12 C1,5.92486775 5.92486775,1 12,1 Z M12,3 C7.02943725,3 3,7.02943725 3,12 C3,16.9705627 7.02943725,21 12,21 C16.9705627,21 21,16.9705627 21,12 C21,7.02943725 16.9705627,3 12,3 Z M6.66607426,13.6501686 C7.13342047,13.4117012 7.7055954,13.5972442 7.94406273,14.0645904 C8.71613228,15.5776856 10.2710663,16.5499921 12,16.5499921 C13.7262991,16.5499921 15.2792455,15.5806677 16.0525854,14.0711462 C16.2918118,13.6041881 16.8642875,13.419575 17.3312456,13.6588014 C17.7982037,13.8980278 17.9828168,14.4705034 17.7435904,14.9374615 C16.6482438,17.0755242 14.4462205,18.4499921 12,18.4499921 C9.55003677,18.4499921 7.34521255,17.0713067 6.2516524,14.928157 C6.01318507,14.4608108 6.19872805,13.8886359 6.66607426,13.6501686 Z M8.75,8 C9.44035594,8 10,8.67157288 10,9.5 C10,10.3284271 9.44035594,11 8.75,11 C8.05964406,11 7.5,10.3284271 7.5,9.5 C7.5,8.67157288 8.05964406,8 8.75,8 Z M15.25,8 C15.9403559,8 16.5,8.67157288 16.5,9.5 C16.5,10.3284271 15.9403559,11 15.25,11 C14.5596441,11 14,10.3284271 14,9.5 C14,8.67157288 14.5596441,8 15.25,8 Z"}),"Smile")},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,function(e,t,a){"use strict";var n=a(0),s=a.n(n),i=a(32),o=a(262);class r{constructor(e){this.fireworks=e,this.type=0,this.colorType=0,this.side=0,this.typeSize=4,this.xFinished=!1,this.finishedStart=!1,this.x=0,this.y=0,this.rotation=0,this.moveX=0,this.moveY=0}draw(e){e.fillStyle=this.colorType,0===this.type?(e.beginPath(),e.arc(this.x,this.y,this.typeSize,0,2*Math.PI,!1),e.fill()):(e.save(),e.translate(this.x,this.y),e.rotate(this.rotation*Math.PI/180),function(e,t,a,n,s,i,o,r){if("undefined"===typeof r&&(r=!0),"undefined"===typeof i&&(i=5),"number"===typeof i)i={tl:i,tr:i,br:i,bl:i};else{var c={tl:0,tr:0,br:0,bl:0};for(var l in c)i[l]=i[l]||c[l]}e.beginPath(),e.moveTo(t+i.tl,a),e.lineTo(t+n-i.tr,a),e.quadraticCurveTo(t+n,a,t+n,a+i.tr),e.lineTo(t+n,a+s-i.br),e.quadraticCurveTo(t+n,a+s,t+n-i.br,a+s),e.lineTo(t+i.bl,a+s),e.quadraticCurveTo(t,a+s,t,a+s-i.bl),e.lineTo(t,a+i.tl),e.quadraticCurveTo(t,a,t+i.tl,a),e.closePath(),o&&e.fill(),r&&e.stroke()}(e,-this.typeSize,-2,2*this.typeSize,4,2,!0,!1),e.restore())}update(e){const t=e/16;if(this.x+=this.moveX*t,this.y+=this.moveY*t,0!==this.xFinished){const e=.5;1===this.xFinished?(this.moveX+=e*t*.05,this.moveX>=e&&(this.xFinished=2)):(this.moveX-=e*t*.05,this.moveX<=-e&&(this.xFinished=1))}else 0===this.side?this.moveX>0&&(this.moveX-=.05*t,this.moveX<=0&&(this.moveX=0,this.xFinished=this.finishedStart)):this.moveX<0&&(this.moveX+=.05*t,this.moveX>=0&&(this.moveX=0,this.xFinished=this.finishedStart));const a=this.moveY<-.5;return this.moveY>-.5?this.moveY+=1/3*t*this.fireworks.speedCoef:this.moveY+=1/3*t,a&&this.moveY>-.5&&this.fireworks.fallingDownCount++,1===this.type&&(this.rotation+=10*t,this.rotation>360&&(this.rotation-=360)),this.y>=this.fireworks.getMeasuredHeight()}}function c(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e))+e}class l{constructor(e){this.context=e,this.particlesCount=60,this.fallParticlesCount=30,this.particles=[],this.speedCoef=1,this.fallingDownCount=0}getMeasuredHeight(){return this.context.canvas.clientHeight}getMeasuredWidth(){return this.context.canvas.clientWidth}createParticle(e){const t=new r(this);if(t.colorType=l.colors[c(0,l.colors.length)],t.type=c(0,2),t.side=c(0,2),t.finishedStart=1+c(0,2),0===t.type?t.typeSize=4+2*Math.random():t.typeSize=4+4*Math.random(),e)t.y=-Math.random()*this.getMeasuredHeight()*1.2,t.x=5+c(0,this.getMeasuredWidth()-10),t.xFinished=t.finishedStart;else{const e=4+c(0,10),a=this.getMeasuredHeight()/4;0===t.side?t.x=-e:t.x=this.getMeasuredWidth()+e,t.rotation=360*Math.random(),t.moveX=(0===t.side?1:-1)*(1.2+4*Math.random()),t.moveY=-(4+4*Math.random()),t.y=a/2+c(0,2*a)}return t}start(){if(!this.started){this.particles=[],this.started=!0,this.startedFall=!1,this.fallingDownCount=0,this.speedCoef=1,this.lastUpdateTime=0;for(let e=0;e<this.particlesCount;e++)this.particles.push(this.createParticle(!1));this.draw()}}startFall(){if(!this.startedFall){this.startedFall=!0;for(let e=0;e<this.fallParticlesCount;e++)this.particles.push(this.createParticle(!0))}}draw(){const e=Date.now();let t=e-this.lastUpdateTime;this.lastUpdateTime=e,t>18&&(t=16),this.context.clearRect(0,0,this.getMeasuredWidth(),this.getMeasuredHeight());for(let a=0,n=this.particles.length;a<n;a++){const e=this.particles[a];e.draw(this.context),e.update(t)&&(this.particles.splice(a,1),a--,n--)}this.fallingDownCount>=this.particlesCount/2&&this.speedCoef>.2&&(this.startFall(),this.speedCoef-=t/16*.15,this.speedCoef<.2&&(this.speedCoef=.2)),this.particles.length?window.requestAnimationFrame(()=>this.draw()):(this.started=!1,this.context.clearRect(0,0,this.getMeasuredWidth(),this.getMeasuredHeight()))}}l.colors=["#E8BC2C","#D0049E","#02CBFE","#5723FD","#FE8C27","#6CB859"];class d extends s.a.Component{constructor(e){super(e),this.onResize=()=>{const e=this.canvasRef.current;e&&(e.setAttribute("width",this.parentNode.clientWidth+18),e.setAttribute("height",this.parentNode.clientHeight+12))},this.canvasRef=s.a.createRef()}componentDidMount(){this.attachToParent()}componentWillUnmount(){this.detachFromParent()}attachToParent(){const e=this.canvasRef.current;if(!e)return;const t=e.parentNode;t&&(this.parentNode=t,e.setAttribute("width",this.parentNode.clientWidth+18),e.setAttribute("height",this.parentNode.clientHeight+12),window.addEventListener("resize",this.onResize))}detachFromParent(){const e=this.canvasRef.current;e&&e.parentNode&&(this.parentNode=null,window.removeEventListener("resize",this.onResize))}start(){const e=this.canvasRef.current.getContext("2d");new l(e).start()}render(){return s.a.createElement("canvas",{ref:this.canvasRef,style:{zIndex:2,position:"absolute",left:0,top:0,width:"100%",height:"100%",pointerEvents:"none"}})}}var h=d,u=a(109),p=a.n(u),m=a(566),g=a(38),f=Object(g.a)(s.a.createElement("path",{d:"M4.70710678,12.2928932 C4.31658249,11.9023689 3.68341751,11.9023689 3.29289322,12.2928932 C2.90236893,12.6834175 2.90236893,13.3165825 3.29289322,13.7071068 L8.29289322,18.7071068 C8.68341751,19.0976311 9.31658249,19.0976311 9.70710678,18.7071068 L20.7071068,7.70710678 C21.0976311,7.31658249 21.0976311,6.68341751 20.7071068,6.29289322 C20.3165825,5.90236893 19.6834175,5.90236893 19.2928932,6.29289322 L9,16.5857864 L4.70710678,12.2928932 Z"}),"Check"),b=a(285),C=a(583),y=a(565),v=a(372),E=a.n(v);a(371);class U extends s.a.Component{render(){const e=this.props,t=e.chosen,a=e.beingChosen,n=e.hidden,i=e.onChange;return s.a.createElement("div",{className:p()("poll-radio",{"poll-radio-hidden":n})},s.a.createElement(C.a,{color:"primary",classes:{root:"poll-radio-root",colorPrimary:"message-control",disabled:"message-control-disabled"},TouchRippleProps:{classes:{child:"touch-ripple-current-color"}},checked:t||a,onChange:i,checkedIcon:s.a.createElement(E.a,{classes:{root:a?"poll-radio-icon":null}})}),a&&s.a.createElement(y.a,{size:20,thickness:4.4,classes:{root:"poll-radio-progress-root",colorPrimary:"message-control"}}))}}var S=U,k=a(14);a(373);class M extends s.a.Component{constructor(e){super(e),this.updateAnimation=()=>{this.stopAnimation(),this.handle=requestAnimationFrame(this.onAnimationFrame)},this.stopAnimation=()=>{this.handle&&(cancelAnimationFrame(this.handle),this.handle=null)},this.onAnimationFrame=()=>{const e=this.state,t=e.startTime,a=e.from,n=e.to,s=Date.now()-t;if(s>=k.b)this.setState({animated:n}),this.stopAnimation();else{const e=a+Math.floor((n-a)*s/k.b);this.setState({animated:e}),this.handle=requestAnimationFrame(this.onAnimationFrame)}},this.handle=null;const t=e.value;this.state={from:t,to:t,animated:t,prevPropsValue:t}}shouldComponentUpdate(e,t,a){const n=this.props,s=n.closed,i=n.theme,o=n.value,r=this.state.animated;return s!==e.closed||(i!==e.theme||(o!==e.value||r!==t.animated))}static getDerivedStateFromProps(e,t){return e.value!==t.prevPropsValue?{startTime:Date.now(),from:t.animated,to:e.value,prevPropsValue:e.value}:null}componentDidUpdate(e,t,a){e.value!==this.props.value&&this.updateAnimation()}componentWillUnmount(){this.stopAnimation()}render(){const e=this.props,t=(e.chosen,e.closed,e.onClick,this.state.animated);return s.a.createElement("div",{className:"poll-percentage"},s.a.createElement(s.a.Fragment,null,t+"%"))}}var I=M;a(374);class w extends s.a.Component{constructor(...e){super(...e),this.getTitleString=(e,t=(e=>e))=>this.props.canBeSelected?null:e?1===e?"1 vote":e+" votes":t("NoVotes").toLowerCase(),this.handleClick=e=>{const t=this.props,a=t.canBeSelected,n=t.onVote;a&&(e.stopPropagation(),n())}}render(){const e=this.props,t=e.option,a=e.onChange,n=e.canBeSelected,i=e.closed,o=e.maxVoterCount,r=e.t,c=e.type,l=e.isCorrect;if(!t)return null;const d=t.text,h=t.voter_count,u=t.vote_percentage,g=t.is_chosen,C=t.isMultiChoosen,y=t.is_being_chosen;let v=1.5;return h&&(v=h/o*100),s.a.createElement("div",{className:"poll-option",onClick:this.handleClick},s.a.createElement("div",{className:p()("poll-option-wrapper",n?"poll-option-unselected":"poll-option-selected")},s.a.createElement("div",{className:"poll-option-text-wrapper",title:this.getTitleString(h,r)},s.a.createElement(I,{value:u,chosen:g,closed:i}),s.a.createElement(S,{hidden:!n,chosen:g||C,beingChosen:y,onChange:a}),(g||l)&&s.a.createElement("div",{className:p()("poll-option-mark",{"poll-option-mark-correct":"correct"===c},{"poll-option-mark-incorrect":"incorrect"===c})},"incorrect"===c?s.a.createElement(b.a,{className:"poll-option-mark-icon"}):s.a.createElement(f,{className:"poll-option-mark-icon"})),s.a.createElement("div",{className:"poll-option-text"},d))),s.a.createElement(m.a,{classes:{root:"poll-option-progress-root",bar:p()("poll-option-progress-bar",{"poll-option-progress-bar-correct":"correct"===c},{"poll-option-progress-bar-incorrect":"incorrect"===c})},color:"primary",variant:"determinate",value:n?0:Math.max(1.5,v)}))}}var _=Object(i.d)()(w),x=a(299),O=a(335),T=a(110),L=a(2),P=(a(376),a(275)),N=a(265),D=a(266),j=a(7),B=a.n(j),R=a(11),F=a(567),A=a(311);a(379),a(336);class V extends s.a.Component{render(){const e=this.props,t=e.index,a=e.showStatus,n="".concat(20+10*Math.sin(t),"%"),i="".concat(30+10*Math.cos(t),"%");return s.a.createElement("div",{className:"user-placeholder"},s.a.createElement("div",{className:"user-wrapper"},s.a.createElement("div",{className:"user-placeholder-tile"}),s.a.createElement("div",{className:"user-placeholder-inner-wrapper"},s.a.createElement("div",{className:"tile-first-row"},s.a.createElement("div",{className:"dialog-placeholder-title",style:{width:n}}),s.a.createElement("div",{className:"dialog-placeholder-title",style:{width:i,marginLeft:8}})),a&&s.a.createElement("div",{className:"tile-second-row"},s.a.createElement("div",{className:"dialog-placeholder-content",style:{width:i}})))))}}V.defaultProps={showStatus:!0};var z=V,H=a(111);a(380);class W extends s.a.Component{constructor(...e){super(...e),this.onClick=()=>{const e=this.props.userId;e&&(Object(H.j)(e,!0),setTimeout(()=>{L.a.clientUpdate({"@type":"clientUpdateClosePollResults"})},0))}}render(){const e=this.props,t=e.index,a=e.userId,n=a?s.a.createElement(A.a,{userId:a,showStatus:!1}):s.a.createElement(z,{index:t,showStatus:!1});return s.a.createElement(F.a,{button:!0,className:"user-list-item",onClick:this.onClick},n)}}var G=W,Z=a(279),q=a(278);a(72),a(381);class K extends s.a.Component{constructor(e){super(e),this.handleShowMore=()=>{const e=this.props.option,t=this.state.count,a=t,n=Math.min(e.voter_count,t+k.V);this.setState({offset:a,count:n},()=>{this.updateVoters(a,n,!0)})},this.handleCollapse=e=>{e.preventDefault(),e.stopPropagation();const t=this.props.option,a=t&&t.voter_count<=k.T?t.voter_count:k.T-k.U;this.setState({voters:this.state.voters.slice(0,a),offset:0,count:a})};const t=this.props.option,a=t&&t.voter_count<=k.T?t.voter_count:k.T-k.U;this.state={voters:[],offset:0,count:a}}updateVoters(e,t,a){var n=this;return Object(R.a)(B.a.mark((function s(){var i,o,r,c,l,d,h,u,p;return B.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(i=n.props,o=i.chatId,r=i.messageId,c=i.optionId,l=i.option,d=n.state.voters,!(t<=0)){s.next=4;break}return s.abrupt("return");case 4:return h=t-e,s.next=7,L.a.send({"@type":"getPollVoters",chat_id:o,message_id:r,option_id:c,offset:e,limit:h});case 7:if(u=s.sent,n.props.option===l){s.next=10;break}return s.abrupt("return");case 10:p=q.a.getStore(),Object(Z.C)(p,u.user_ids),n.setState({voters:[...d,...u.user_ids]},Object(R.a)(B.a.mark((function s(){var i;return B.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:u.user_ids.length<h&&a&&(i=e+u.user_ids.length,n.updateVoters(i,t,!1));case 1:case"end":return s.stop()}}),s)}))));case 13:case"end":return s.stop()}}),s)})))()}componentDidMount(){const e=this.state,t=e.offset,a=e.count;this.updateVoters(t,a,!0)}render(){const e=this.props,t=e.option,a=e.isQuiz,n=e.t,i=this.state,r=i.voters,c=i.count,l=t.text,d=t.voter_count,h=t.vote_percentage;if(0===d)return null;const u=[];for(let o=0;o<c;o++){const e=o<r.length?r[o]:null;u.push(s.a.createElement(G,{key:"".concat(o,"_userId=").concat(e),index:o,userId:e}))}const p="".concat(d,a?1!==d?" answers":" answer":1!==d?" votes":" vote");let m=null;const g=d-c;if(g>0){const e="".concat(g,a?1!==g?" answers":" answer":1!==g?" votes":" vote");m=s.a.createElement(o.a,{classes:{root:"poll-option-results-button"},color:"primary",fullWidth:!0,onClick:this.handleShowMore},n("ShowVotesOT").replace("%1$d",e))}const f=c>k.T-k.U&&d>k.T;return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"poll-option-results-caption"},s.a.createElement("div",{className:"poll-option-results-answer"},"".concat(l," \u2014 ").concat(h,"%")),f?s.a.createElement("a",{onClick:this.handleCollapse},n("PollCollapse")):s.a.createElement("div",{className:"poll-option-results-count"},p)),u,m)}}var Y=Object(i.d)()(K),J=a(337);a(382);class Q extends s.a.Component{constructor(...e){super(...e),this.onClientUpdateClosePollResults=e=>{(0,this.props.onClose)()},this.handleClose=e=>{e.preventDefault(),e.stopPropagation(),(0,this.props.onClose)()},this.handleClick=e=>{e.preventDefault(),e.stopPropagation()},this.handleContextMenu=e=>{e.preventDefault(),e.stopPropagation()}}componentDidMount(){J.a.on("clientUpdateClosePollResults",this.onClientUpdateClosePollResults)}componentWillUnmount(){J.a.off("clientUpdateClosePollResults",this.onClientUpdateClosePollResults)}render(){const e=this.props,t=e.chatId,a=e.messageId,n=e.poll,i=e.t;if(!n)return;const o=n.options,r=n.type,c=n.question,l=r&&"pollTypeQuiz"===r["@type"];return s.a.createElement(P.a,{classes:{root:"chat-info-dialog-root",container:"chat-info-dialog-container",paper:"chat-info-dialog-paper"},transitionDuration:0,open:!0,onClick:this.handleClick,onContextMenu:this.handleContextMenu,onClose:this.handleClose,"aria-labelledby":"poll-results-title"},s.a.createElement(N.a,{id:"poll-results-title"},i(l?"QuizAnswers":"PollResults")),s.a.createElement(D.a,{classes:{root:"poll-results-content"}},s.a.createElement("div",{className:"poll-results-question"},c),o.map((e,n)=>s.a.createElement(Y,{key:n,isQuiz:l,chatId:t,messageId:a,optionId:n,option:e}))))}}var X=Object(i.d)()(Q);class $ extends s.a.Component{constructor(e){super(e),this.getTotalVoterCountString=(e,t=(e=>e))=>e?1===e?"1 answer":e+" answers":t("NoVotes"),this.handleSubmit=e=>{e.preventDefault(),e.stopPropagation();const t=this.props,a=t.chatId,n=t.messageId,s=t.poll;if(!s)return;const i=s.type;if(!i)return;if(this.viewResults(s))return;if(!i.allow_multiple_answers)return;const o=[];s.options.forEach((e,t)=>{e.isMultiChoosen&&o.push(t)}),o.length&&Object(O.b)(a,n,o)},this.handleVote=e=>{const t=this.props,a=t.chatId,n=t.messageId,s=t.poll;if(!s)return;const i=s.type;i&&("pollTypeRegular"===i["@type"]&&i.allow_multiple_answers?(s.options[e].isMultiChoosen=!s.options[e].isMultiChoosen,this.forceUpdate()):Object(O.b)(a,n,[e]))},this.handleOpenResults=e=>{e.preventDefault(),e.stopPropagation();const t=this.props.poll;this.setState({viewResultsPoll:t})},this.handleCloseResults=()=>{this.setState({viewResultsPoll:null})},this.fireworksRef=s.a.createRef(),this.state={}}componentDidUpdate(e,t,a){const n=this.props,s=n.chatId,i=n.messageId,o=n.poll;if(o&&"pollTypeQuiz"===o.type["@type"]){if(-1===e.poll.type.correct_option_id&&-1!==o.type.correct_option_id){const e=this.fireworksRef.current;if(!e)return;o.options[o.type.correct_option_id].is_chosen?e.start():L.a.clientUpdate({"@type":"clientUpdateMessageShake",chatId:s,messageId:i})}}}viewResults(e){if(!e)return!1;const t=e.options,a=e.is_closed;return!e.is_anonymous&&(a||t.some(e=>e.is_chosen))}getOptionType(e,t){const a=["regular","correct","incorrect"];if(!t)return a[0];const n=t.options[e];if(!n)return a[0];if(!n.is_chosen)return a[0];const s=t.type;if(!s)return a[0];if("pollTypeQuiz"!==s["@type"])return a[0];const i=s.correct_option_id;return-1===i?a[0]:i===e?a[1]:a[2]}getOptionIsCorrect(e,t){if(!t)return!1;if(!t.options[e])return!1;const a=t.type;if(!a)return!1;if("pollTypeQuiz"!==a["@type"])return!1;const n=a.correct_option_id;return-1!==n&&n===e}render(){const e=this.props,t=e.chatId,a=e.messageId,n=e.poll,i=e.t,r=e.meta,c=this.state.viewResultsPoll,l=n.question,d=n.options,u=n.total_voter_count,p=n.type,m=n.is_closed,g=n.is_anonymous,f=n.recent_voter_user_ids;let b=i("FinalResults");if(!m)switch(p["@type"]){case"pollTypeRegular":b=i(g?"AnonymousPoll":"PublicPoll");break;case"pollTypeQuiz":b=i(g?"AnonymousQuizPoll":"QuizPoll")}if(!T.a.get(t,a))return null;const C=p&&"pollTypeQuiz"===p["@type"],y=!m&&d.every(e=>!e.is_chosen),v=!m&&d.some(e=>e.is_chosen),E=Math.max(...d.map(e=>e.voter_count)),U=this.viewResults(n),S=p.allow_multiple_answers&&!v||U,k=U||d.some(e=>e.isMultiChoosen);let M=[];return f&&(M=f.map(e=>s.a.createElement(x.a,{key:e,poll:!0,userId:e}))),s.a.createElement("div",{className:"poll"},C&&s.a.createElement(h,{ref:this.fireworksRef}),s.a.createElement("div",{className:"poll-question"},s.a.createElement("div",{className:"poll-question-title"},l),s.a.createElement("div",{className:"poll-question-subtitle"},s.a.createElement("span",{style:{marginRight:6}},b),M)),s.a.createElement("div",{className:"poll-options"},d.map((e,t)=>s.a.createElement(_,{key:t,type:this.getOptionType(t,n),isCorrect:this.getOptionIsCorrect(t,n),option:e,canBeSelected:y,closed:m,maxVoterCount:E,onVote:()=>this.handleVote(t)}))),S?s.a.createElement(o.a,{fullWidth:!0,color:"primary",classes:{root:"poll-button",textPrimary:"message-control",disabled:"message-control-disabled"},TouchRippleProps:{classes:{child:"touch-ripple-current-color"}},disabled:!k,onClick:U?this.handleOpenResults:this.handleSubmit},i(U?"PollViewResults":"PollSubmitVotes")):s.a.createElement("div",{className:"poll-total-count"},this.getTotalVoterCountString(u,i),r),Boolean(c)&&s.a.createElement(X,{chatId:t,messageId:a,poll:c,onClose:this.handleCloseResults}))}}t.a=Object(i.d)()($)},function(e,t,a){"use strict";var n=a(0),s=a.n(n),i=a(109),o=a.n(i),r=a(306),c=a(38),l=Object(c.a)(s.a.createElement("g",{fillRule:"evenodd"},s.a.createElement("path",{d:"M6,0 L33.5147186,0 C35.1060176,6.45011102e-15 36.632141,0.632141042 37.7573593,1.75735931 L52.2426407,16.2426407 C53.367859,17.367859 54,18.8939824 54,20.4852814 L54,48 C54,51.3137085 51.3137085,54 48,54 L6,54 C2.6862915,54 4.05812251e-16,51.3137085 0,48 L0,6 C-4.05812251e-16,2.6862915 2.6862915,6.08718376e-16 6,0 Z"}),s.a.createElement("path",{d:"M33.5147186,0 C35.1060176,6.45011102e-15 36.632141,0.632141042 37.7573593,1.75735931 L52.2426407,16.2426407 C53.367859,17.367859 54,18.8939824 54,20.4852814 L54,22 C54,19.790861 52.209139,18 50,18 L40,18 C37.790861,18 36,16.209139 36,14 L36,4 C36,1.790861 34.209139,-3.88578059e-16 32,0 L33.5147186,0 Z",fill:"#000000",style:{mixBlendMode:"normal"},opacity:"0.15"})),"Document"),d=a(320),h=a(279),u=a(278);a(391);class p extends s.a.Component{constructor(e){super(e),this.onUpdateFile=e=>{const t=this.state.file,a=e.file;t&&t.id===a.id&&this.setState({file:a,prevFile:t})};const t=this.props.file;this.state={prevPropsFile:t,prevFile:null,file:u.a.get(t.id)||t}}componentDidMount(){u.a.on("updateFile",this.onUpdateFile)}componentWillUnmount(){u.a.off("updateFile",this.onUpdateFile)}static getDerivedStateFromProps(e,t){const a=e.file,n=t.prevPropsFile;return a&&n&&a.id!==n.id?{prevPropsFile:a,prevFile:null,file:u.a.get(a.id)||a}:null}shouldComponentUpdate(e,t){const a=this.props.theme,n=this.state,s=n.file,i=n.prevFile;return e.theme!==a||(t.file!==s||t.prevFile!==i)}render(){const e=this.props.meta,t=this.state.file;if(!t)return null;const a=t.local&&t.local.is_downloading_active,n=t.remote&&t.remote.is_uploading_active,i=Object(h.g)(t);let o=null;a?o=Object(h.e)(t):n&&(o=Object(h.k)(t));const r=o?"".concat(o,"/").concat(i):"".concat(i);return s.a.createElement("div",{className:"document-action"},s.a.createElement("span",null,r),e)}}var m=p;a(392);class g extends s.a.Component{render(){const e=this.props,t=e.document,a=e.openMedia,n=e.width,i=e.height,c=e.meta,u=e.title,p=e.caption;if(!t)return null;const g=t.minithumbnail,f=t.thumbnail,b=t.file_name,C=t.document,y=n&&i?{width:n,height:i}:null;return s.a.createElement("div",{className:o()("document",{"media-title":u}),style:y},s.a.createElement(d.a,{minithumbnail:g,thumbnail:f,file:C,openMedia:a,icon:s.a.createElement(r.a,null),completeIcon:e=>e?null:s.a.createElement("div",{className:"document-tile-complete-icon"},s.a.createElement(l,{className:"document-tile-icon-fill",viewBox:"0 0 54 54"}),s.a.createElement("div",{className:"document-tile-file-ext"},Object(h.f)(b)))}),s.a.createElement("div",{className:"document-content"},s.a.createElement("div",{className:"document-title"},s.a.createElement("a",{className:"document-name",onClick:a,title:b,"data-name":b,"data-ext":"."+Object(h.f)(b)},b)),s.a.createElement(m,{file:C,meta:p?null:c})))}}t.a=g},function(e,t,a){"use strict";var n=a(0),s=a.n(n),i=a(109),o=a.n(i),r=a(321),c=a(343),l=a(324),d=a(584),h=a(14),u=a(287);a(403);class p extends s.a.Component{constructor(e){super(e),this.reset=()=>{const e=this.props.duration;1===this.state.value?(this.setState({active:!1,currentTime:0}),setTimeout(()=>{this.state.currentTime||this.setState({value:this.getValue(0,e,!1)})},h.J)):this.setState({active:!1,currentTime:0,value:this.getValue(0,e,!1)})},this.onClientUpdateMediaEnd=e=>{const t=this.props,a=t.chatId,n=t.messageId;a===e.chatId&&n===e.messageId&&this.reset()},this.onClientUpdateMediaTime=e=>{const t=this.props,a=t.chatId,n=t.messageId,s=t.duration,i=this.state.active;if(a===e.chatId&&n===e.messageId){const t=e.duration>=0&&e.duration<1/0?e.duration:s,a=this.getValue(e.currentTime,t,i);this.setState({currentTime:e.currentTime,duration:t,value:a})}},this.onClientUpdateMediaActive=e=>{const t=this.props,a=t.chatId,n=t.messageId,s=t.duration,i=this.state,o=i.active,r=i.currentTime;if(a===e.chatId&&n===e.messageId){const t=e.duration>=0&&e.duration<1/0?e.duration:s,a=this.getValue(o?r:0,t,!0);this.setState({active:!0,currentTime:o?r:0,value:a})}else o&&this.reset()},this.getValue=(e,t,a)=>a?e/t:0;const t=u.b.message,a=u.b.time,n=this.props,s=n.chatId,i=n.messageId,o=n.duration,r=t&&t.chat_id===s&&t.id===i,c=r&&a?a.currentTime:0,l=r&&a&&a.duration?a.duration:o;this.state={active:r,currentTime:c,duration:l,value:this.getValue(c,l,r)}}shouldComponentUpdate(e,t){const a=this.state,n=a.active,s=a.value;return t.value!==s||t.active!==n}componentDidMount(){u.b.on("clientUpdateMediaActive",this.onClientUpdateMediaActive),u.b.on("clientUpdateMediaTime",this.onClientUpdateMediaTime),u.b.on("clientUpdateMediaEnd",this.onClientUpdateMediaEnd)}componentWillUnmount(){u.b.off("clientUpdateMediaActive",this.onClientUpdateMediaActive),u.b.off("clientUpdateMediaTime",this.onClientUpdateMediaTime),u.b.off("clientUpdateMediaEnd",this.onClientUpdateMediaEnd)}render(){const e=this.state.value;return s.a.createElement("div",{className:"voice-note-slider"},s.a.createElement(d.a,{className:"voice-note-slider-component",classes:{track:"voice-note-slider-track",thumb:"voice-note-slider-thumb"},min:0,max:1,value:e}))}}var m=p;a(404);class g extends s.a.Component{render(){const e=this.props,t=e.chatId,a=e.messageId,n=e.voiceNote,i=e.openMedia,d=e.title,h=e.meta,u=e.caption;if(!n)return null;const p=n.duration,g=n.voice;return s.a.createElement("div",{className:o()("voice-note","document",{"media-title":d})},s.a.createElement(c.a,{chatId:t,messageId:a,file:g,openMedia:i}),s.a.createElement("div",{className:"voice-note-content"},s.a.createElement(m,{chatId:t,messageId:a,duration:p,file:g}),s.a.createElement("div",{className:"voice-note-meta"},s.a.createElement(r.a,{chatId:t,messageId:a,duration:p,file:g}),s.a.createElement(l.a,{chatId:t,messageId:a,icon:"\xa0\u2022"}),!u&&h)))}}t.a=g},,,,,,,,,,,,,,,,,function(e,t,a){},function(e,t,a){},,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,function(e,t,a){e.exports=function(){return new Worker(a.p+"4221aafc2192988eda31.worker.js")}},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,,function(e,t,a){},,,,function(e,t,a){},,,,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,,,,,,function(e,t,a){},function(e,t,a){},,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,function(e,t,a){},function(e,t,a){},,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,,function(e,t,a){},function(e,t,a){},,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){"use strict";a.r(t);var n=a(7),s=a.n(n),i=a(11),o=a(0),r=a.n(o),c=a(109),l=a.n(c),d=a(60),h=a(135),u=a(298),p=a(14);var m=function(e){class t extends r.a.Component{render(){return r.a.createElement(u.SnackbarProvider,{maxSnack:p.r},r.a.createElement(e,this.props))}}return t.displayName="WithSnackbarNotifications(".concat(Object(d.b)(e),")"),t},g=a(44),f=a(32),b=a(262),C=a(228),y=a(275),v=a(268),E=a(265),U=a(285),S=a(38),k=Object(S.a)(r.a.createElement("path",{d:"M17,2 C19.209139,2 21,3.790861 21,6 L21,20.2543508 C21,21.3589203 20.1045695,22.2543871 19,22.2543871 C18.5225775,22.2543871 18.0609035,22.0835665 17.6984173,21.772864 L12,16.8885064 L6.30158275,21.772864 C5.46293106,22.4917083 4.2003311,22.3945852 3.4814868,21.5559335 C3.17078432,21.1934473 3,20.7317733 3,20.2543508 L3,6 C3,3.790861 4.790861,2 7,2 L17,2 Z M17,4 L7,4 C5.8954305,4 5,4.8954305 5,6 L5,20.2543508 L10.6984173,15.3699931 C11.4473967,14.7280108 12.5526033,14.7280108 13.3015827,15.3699931 L19,20.2543508 L19,6 C19,4.8954305 18.1045695,4 17,4 Z"}),"Saved"),M=a(332),I=a(288),w=a(280),_=a(72);a(406);class x extends r.a.Component{constructor(e){super(e),this.onUpdateUserStatus=e=>{const t=this.state.userId;if(e.user_id!==t)return;const a=_.a.get(t);a&&this.setState({online:Object(I.j)(a)})};const t=Object(w.u)(e.chatId),a=_.a.get(t);this.state={userId:t,online:Object(I.j)(a)}}componentDidMount(){_.a.on("updateUserStatus",this.onUpdateUserStatus)}componentWillUnmount(){_.a.off("updateUserStatus",this.onUpdateUserStatus)}render(){const e=this.props,t=e.size,a=e.borderSize;return this.state.online?r.a.createElement("div",{className:"online-status",style:{width:t,height:t}},r.a.createElement("div",{className:"online-status-icon",style:{padding:a}},r.a.createElement("div",{className:"online-status-indicator"}))):null}}x.defaultProps={size:14,borderSize:2};var O=x,T=a(279),L=a(39),P=a(278);a(407);class N extends o.Component{constructor(e){super(e),this.onFastUpdatingComplete=e=>{this.forceUpdate()},this.onClientUpdateChatBlob=e=>{this.props.chatId===e.chatId&&(this.state.loaded?this.setState({loaded:!1}):this.forceUpdate())},this.onUpdateChatPhoto=e=>{const t=this.props.chatId,a=e.chat_id,n=e.photo;if(a===t&&(this.state.loaded?this.setState({loaded:!1}):this.forceUpdate(),n)){const e=P.a.getStore();Object(T.q)(e,t)}},this.onUpdateChatTitle=e=>{const t=this.props.chatId;e.chat_id===t&&this.forceUpdate()},this.handleSelect=e=>{const t=this.props,a=t.chatId,n=t.onSelect;n&&(e.stopPropagation(),n(a))},this.handleLoad=()=>{this.setState({loaded:!0})},this.state={loaded:!1}}shouldComponentUpdate(e,t){const a=this.props.chatId,n=this.state.loaded;return e.chatId!==a||t.loaded!==n}componentDidMount(){L.a.on("clientUpdateFastUpdatingComplete",this.onFastUpdatingComplete),L.a.on("updateChatPhoto",this.onUpdateChatPhoto),L.a.on("updateChatTitle",this.onUpdateChatTitle),P.a.on("clientUpdateChatBlob",this.onClientUpdateChatBlob)}componentWillUnmount(){L.a.off("clientUpdateFastUpdatingComplete",this.onFastUpdatingComplete),L.a.off("updateChatPhoto",this.onUpdateChatPhoto),L.a.off("updateChatTitle",this.onUpdateChatTitle),P.a.off("clientUpdateChatBlob",this.onClientUpdateChatBlob)}render(){const e=this.props,t=e.chatId,a=e.showOnline,n=e.showSavedMessages,s=e.onSelect,i=e.small,o=e.dialog,c=e.big,d=e.size,h=e.t,u=this.state.loaded;let p=null;if(d&&(p={width:d,height:d}),Object(w.Q)(t))return r.a.createElement("div",{className:l()("chat-tile",{"tile-small":i},{"tile-dialog":o},{"tile-big":c}),style:p,onClick:this.handleSelect},r.a.createElement("div",{className:l()("tile-photo","tile_color_0",{pointer:s})},r.a.createElement("div",{className:"tile-saved-messages"},r.a.createElement(M.a,{fontSize:c?"large":"default"}))));if(Object(w.S)(t)&&n)return r.a.createElement("div",{className:l()("chat-tile",{"tile-small":i},{"tile-dialog":o},{"tile-big":c}),style:p,onClick:this.handleSelect},r.a.createElement("div",{className:l()("tile-photo","tile_color_4",{pointer:s})},r.a.createElement("div",{className:"tile-saved-messages"},r.a.createElement(k,{fontSize:c?"large":"default"}))));const m=L.a.get(t);if(!m)return null;const g=m.photo,f=Object(w.n)(m,h),b=Object(T.j)(g?g.small:null),C=b&&u,y="tile_color_".concat(Math.abs(t)%8+1);return r.a.createElement("div",{className:l()("chat-tile",{[y]:!C},{pointer:s},{"tile-dialog":o},{"tile-small":i},{"tile-big":c}),style:p,onClick:this.handleSelect},!C&&r.a.createElement("div",{className:"tile-photo"},r.a.createElement("span",{className:"tile-text"},f)),b&&r.a.createElement("img",{className:"tile-photo",src:b,onLoad:this.handleLoad,draggable:!1,alt:""}),a&&Object(w.T)(t)&&r.a.createElement(O,{chatId:t}))}}N.defaultProps={showSavedMessages:!0,showOnline:!1};var D=Object(f.d)()(N);a(408);class j extends r.a.Component{render(){const e=this.props,t=e.chatId,a=e.selected,n=e.onSelect,s=e.t,i=Object(w.p)(t,!0,s);return r.a.createElement("div",{className:l()("forward-target-chat",{"forward-target-chat-selected":a}),onClick:n},r.a.createElement("div",{className:"forward-target-chat-tile"},r.a.createElement("div",{className:"forward-target-chat-tile-wrapper"},r.a.createElement(D,{chatId:t})),a&&r.a.createElement("div",{className:"forward-target-chat-selection"}),r.a.createElement("div",{className:l()("forward-target-chat-mark",a?"forward-target-chat-mark-selected":"forward-target-chat-mark-unselected")}),r.a.createElement("div",{className:"forward-target-chat-mark-icon"})),r.a.createElement("div",{className:"forward-target-chat-title"},i))}}var B=Object(f.d)()(j);function R(e){let t;try{t=document.createElement("textarea"),t.value=e,t.style.all="unset",t.style.position="fixed",t.style.top=0,t.style.clip="rect(0, 0, 0, 0)",t.style.whiteSpace="pre",t.style.webkitUserSelect="text",t.style.MozUserSelect="text",t.style.msUserSelect="text",t.style.userSelect="text",document.body.appendChild(t),t.select(),document.execCommand("copy")||console.error("unable to copy using execCommand")}catch(a){}finally{t&&document.body.removeChild(t)}}var F=a(62);let A=null;function V(e){if(!e)return!1;const t=e.value;return!!t&&"ru"===t.value}function z(e){if(!e)return null;if(!e.length)return null;const t=F.a.get("language_pack_id"),a=F.a.get("suggested_language_pack_id");if(!(V(t)||V(a)))return null;A=A||new Map([["q","\u0439"],["w","\u0446"],["e","\u0443"],["r","\u043a"],["t","\u0435"],["y","\u043d"],["u","\u0433"],["i","\u0448"],["o","\u0449"],["p","\u0437"],["[","\u0445"],["]","\u044a"],["a","\u0444"],["s","\u044b"],["d","\u0432"],["f","\u0430"],["g","\u043f"],["h","\u0440"],["j","\u043e"],["k","\u043b"],["l","\u0434"],[";","\u0436"],["'","\u044d"],["\\","\u0451"],["z","\u044f"],["x","\u0447"],["c","\u0441"],["v","\u043c"],["b","\u0438"],["n","\u0442"],["m","\u044c"],[",","\u0431"],[".","\u044e"]]);let n="";for(let s=0;s<e.length;s++){if(!A.has(e[s]))return null;n+=A.get(e[s])}return""===n?null:n}let H=null;function W(e){if(!e)return null;if(!e.length)return null;H=H||new Map([["\u0439","q"],["\u0446","w"],["\u0443","e"],["\u043a","r"],["\u0435","t"],["\u043d","y"],["\u0433","u"],["\u0448","i"],["\u0449","o"],["\u0437","p"],["\u0445","["],["\u044a","]"],["\u0444","a"],["\u044b","s"],["\u0432","d"],["\u0430","f"],["\u043f","g"],["\u0440","h"],["\u043e","j"],["\u043b","k"],["\u0434","l"],["\u0436",";"],["\u044d","'"],["\u0451","\\"],["\u044f","z"],["\u0447","x"],["\u0441","c"],["\u043c","v"],["\u0438","b"],["\u0442","n"],["\u044c","m"],["\u0431",","],["\u044e","."]]);let t="";for(let a=0;a<e.length;a++){if(!H.has(e[a]))return null;t+=H.get(e[a])}return""===t?null:t}var G=a(111),Z=a(9),q=a(110),K=a(2);a(409);class Y extends r.a.Component{constructor(e){var t;super(e),t=this,this.loadContent=Object(i.a)(s.a.mark((function e(){var a,n,i,o,r,c,l,d;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.getPublicMessageLink(),a=[],n=K.a.send({"@type":"getChats",offset_order:"9223372036854775807",offset_chat_id:0,limit:100}),a.push(n),i=K.a.send({"@type":"createPrivateChat",user_id:_.a.getMyId(),force:!0}),a.push(i),e.next=8,Promise.all(a.map(e=>e.catch(e=>null)));case 8:o=e.sent,r=Object(g.a)(o,2),c=r[0],l=r[1],t.setState({chatIds:c.chat_ids,savedMessages:l}),d=P.a.getStore(),Object(T.r)(d,c.chat_ids);case 15:case"end":return e.stop()}}),e)}))),this.getPublicMessageLink=Object(i.a)(s.a.mark((function e(){var a,n,i,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.props,n=a.chatId,i=a.messageIds,n){e.next=3;break}return e.abrupt("return");case 3:if(i){e.next=5;break}return e.abrupt("return");case 5:if(!(i.length>1)){e.next=7;break}return e.abrupt("return");case 7:if(Object(w.U)(n)){e.next=9;break}return e.abrupt("return");case 9:if(Object(w.v)(n)){e.next=11;break}return e.abrupt("return");case 11:return e.next=13,K.a.send({"@type":"getPublicMessageLink",chat_id:n,message_id:i[0],for_album:!1});case 13:o=e.sent,t.setState({publicMessageLink:o});case 15:case"end":return e.stop()}}),e)}))),this.handleClose=()=>{K.a.clientUpdate({"@type":"clientUpdateForward",info:null})},this.handleCopyLink=()=>{const e=this.props.t,t=this.state.publicMessageLink;if(!t)return;if(!t.link)return;const a="copy_link_".concat(t.link),n=e("LinkCopied");R(t.link),this.handleScheduledAction(a,n,null)},this.handleScheduledAction=(e,t,a)=>{if(!e)return;const n=this.props.enqueueSnackbar;if(!n)return;Z.a.addScheduledAction(e,p.y+300,a)&&n(t,{autoHideDuration:p.y,action:[r.a.createElement(C.a,{key:"close","aria-label":"Close",color:"inherit",className:"notification-close-button",onClick:()=>Z.a.removeScheduledAction(e)},r.a.createElement(U.a,null))]})},this.getForwardPhotoSize=(e,t)=>{if(1!==t.length)return null;const a=q.a.get(e,t[0]);if(!a)return null;const n=a.can_be_forwarded,s=a.content;if(!n&&"messageChatChangePhoto"===s["@type"]){const e=s.photo;if(!e)return null;const t=e.sizes;if(t&&t.length)return t[t.length-1]}return null},this.handleSend=()=>{this.handleClose(),Object(G.a)();const e=this.props,t=e.chatId,a=e.messageIds,n=e.inputMessageContent;if(!t&&!a&&!n)return;const s=this.getInnerText(this.messageRef.current);this.targetChats.forEach(e=>{if(n)return s&&("caption"in n?n.caption={"@type":"formattedText",text:s,entities:null}:K.a.send({"@type":"sendMessage",chat_id:e,reply_to_message_id:0,disable_notifications:!1,from_background:!1,reply_markup:null,input_message_content:{"@type":"inputMessageText",text:{"@type":"formattedText",text:s,entities:null},disable_web_page_preview:!1,clear_draft:!1}})),void K.a.send({"@type":"sendMessage",chat_id:e,reply_to_message_id:0,disable_notifications:!1,from_background:!1,reply_markup:null,input_message_content:n});const i=this.getForwardPhotoSize(t,a);if(i){const t=i.width,a=i.height,n=i.photo;K.a.send({"@type":"sendMessage",chat_id:e,reply_to_message_id:0,disable_notifications:!1,from_background:!1,reply_markup:null,input_message_content:{"@type":"inputMessagePhoto",photo:{"@type":"inputFileId",id:n.id},thumbnail:null,added_sticker_file_ids:[],width:t,height:a,caption:{"@type":"formattedText",text:s,entities:null},ttl:0}})}else s&&K.a.send({"@type":"sendMessage",chat_id:e,reply_to_message_id:0,disable_notifications:!1,from_background:!1,reply_markup:null,input_message_content:{"@type":"inputMessageText",text:{"@type":"formattedText",text:s,entities:null},disable_web_page_preview:!1,clear_draft:!1}}),K.a.send({"@type":"forwardMessages",chat_id:e,from_chat_id:t,message_ids:a,disable_notifications:!1,from_background:!1,as_album:!1})})},this.handleChangeSelection=e=>{this.targetChats.has(e)?this.targetChats.delete(e):this.targetChats.set(e,e),this.forceUpdate()},this.getInnerText=e=>{const t=e.innerHTML;return"<br>"!==t&&"<div><br></div>"!==t||(e.innerHTML=null),e.innerText},this.handleSearchKeyDown=e=>{13===e.keyCode&&e.preventDefault()},this.handleSearchKeyUp=Object(i.a)(s.a.mark((function e(){var a,n,i,o,r,c,l,d,h,u,p;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.state,n=a.chatIds,i=a.savedMessages,o=t.searchRef.current){e.next=4;break}return e.abrupt("return");case 4:if("<br>"!==(r=o.innerHTML)&&"<div><br></div>"!==r||(o.innerHTML=null),c=t.getInnerText(o).trim()){e.next=10;break}return t.setState({searchText:null,searchResults:[],globalSearchResults:[]}),e.abrupt("return");case 10:return l=W(c),d=z(c),h=i?[i.id].concat(n.filter(e=>e!==i.id&&Object(w.e)(e))):n,u=h.filter(e=>t.hasSearchText(e,c)||l&&t.hasSearchText(e,l)||d&&t.hasSearchText(e,d)),t.setState({searchText:c,searchResults:u}),e.next=17,K.a.send({"@type":"searchChatsOnServer",query:c,limit:100});case 17:if(p=e.sent,t.state.searchText===c){e.next=20;break}return e.abrupt("return");case 20:t.setState({globalSearchResults:p.chat_ids});case 21:case"end":return e.stop()}}),e)}))),this.handleSearchPaste=e=>{const t=e.clipboardData.getData("text/plain");t&&(e.preventDefault(),document.execCommand("insertText",!1,t))},this.handleMessageKeyUp=()=>{const e=this.messageRef.current;if(!e)return;const t=e.innerHTML;"<br>"!==t&&"<div><br></div>"!==t||(e.innerHTML=null)},this.handleMessagePaste=e=>{const t=e.clipboardData.getData("text/plain");t&&(e.preventDefault(),document.execCommand("insertText",!1,t))},this.hasSearchText=(e,t)=>{const a=this.props.t,n=this.state.savedMessages;if(n&&e===n.id){if(-1!==(Object(w.s)(e,!0,a)||"").toLocaleLowerCase().indexOf(t.toLowerCase()))return!0}return-1!==(Object(w.s)(e,!1,a)||"").toLocaleLowerCase().indexOf(t.toLowerCase())||-1!==(Object(w.v)(e)||"").toLocaleLowerCase().indexOf(t.toLowerCase())},this.setSearchFocus=()=>{setTimeout(()=>{if(this.searchRef.current){this.searchRef.current.focus()}},100)},this.state={chatIds:[],savedMessages:null},this.searchRef=r.a.createRef(),this.messageRef=r.a.createRef(),this.targetChats=new Map}componentDidMount(){this.loadContent(),this.setSearchFocus()}render(){const e=this.props.t,t=this.state,a=t.chatIds,n=t.searchText,s=t.searchResults,i=t.globalSearchResults,o=t.savedMessages,c=t.publicMessageLink,l=(o?[o.id].concat(a.filter(e=>e!==o.id&&Object(w.e)(e))):a).map(e=>r.a.createElement(B,{key:e,chatId:e,selected:this.targetChats.has(e),onSelect:()=>this.handleChangeSelection(e)})),d=new Map((s||[]).map(e=>[e,e])),h=(i||[]).filter(e=>e!==o.id&&Object(w.e)(e)&&!d.has(e)),u=(s||[]).concat(h).map(e=>r.a.createElement(B,{key:e,chatId:e,selected:this.targetChats.has(e),onSelect:()=>this.handleChangeSelection(e)}));return r.a.createElement(y.a,{open:!0,onClose:this.handleClose,"aria-labelledby":"forward-dialog-title","aria-describedby":"forward-dialog-description",className:"forward-dialog"},r.a.createElement(E.a,{id:"forward-dialog-title"},e("ShareSendTo")),r.a.createElement("div",{ref:this.searchRef,id:"forward-dialog-search",contentEditable:!0,suppressContentEditableWarning:!0,placeholder:e("Search"),onKeyDown:this.handleSearchKeyDown,onKeyUp:this.handleSearchKeyUp,onPaste:this.handleSearchPaste}),r.a.createElement("div",{className:"forward-dialog-content"},r.a.createElement("div",{className:"forward-dialog-list"},l),n&&r.a.createElement("div",{className:"forward-dialog-search-list"},u)),this.targetChats.size>0&&r.a.createElement("div",{ref:this.messageRef,id:"forward-dialog-message",contentEditable:!0,suppressContentEditableWarning:!0,placeholder:e("ShareComment"),onKeyUp:this.handleMessageKeyUp,onPaste:this.handleMessagePaste}),r.a.createElement(v.a,null,r.a.createElement(b.a,{onClick:this.handleClose,color:"primary"},e("Cancel")),this.targetChats.size>0&&r.a.createElement(b.a,{onClick:this.handleSend,color:"primary",autoFocus:!0},e("Send")),!this.targetChats.size&&c&&r.a.createElement(b.a,{onClick:this.handleCopyLink,color:"primary"},e("CopyLink"))))}}var J=Object(d.a)(Object(f.d)(),u.withSnackbar)(Y),Q=a(421),X=a.n(Q),$=a(427),ee=a.n($),te=a(340),ae=a.n(te),ne=a(572),se=a(422),ie=a.n(se),oe=a(424),re=a.n(oe),ce=Object(S.a)(r.a.createElement("path",{d:"M12.1715729,2 C12.9672223,2 13.7302841,2.31607052 14.2928932,2.87867966 L21.1213203,9.70710678 C21.6839295,10.2697159 22,11.0327777 22,11.8284271 L22,19 C22,20.6568542 20.6568542,22 19,22 L5,22 C3.34314575,22 2,20.6568542 2,19 L2,5 C2,3.34314575 3.34314575,2 5,2 L12.1715729,2 Z M11,4 L5,4 C4.44771525,4 4,4.44771525 4,5 L4,19 C4,19.5522847 4.44771525,20 5,20 L19,20 C19.5522847,20 20,19.5522847 20,19 L20,13 L14,13 C12.4023191,13 11.0963391,11.75108 11.0050927,10.1762728 L11,10 L11,4 Z M19.586,11 L13,4.414 L13,10 C13,10.5128358 13.3860402,10.9355072 13.8833789,10.9932723 L14,11 L19.586,11 Z"}),"Document2"),le=a(425),de=a.n(le),he=a(233),ue=a(567),pe=a(568),me=a(569),ge=a(426),fe=a.n(ge),be=Object(S.a)(r.a.createElement("path",{d:"M19,2 C20.6568542,2 22,3.34314575 22,5 L22,19 C22,20.6568542 20.6568542,22 19,22 L5,22 C3.34314575,22 2,20.6568542 2,19 L2,5 C2,3.34314575 3.34314575,2 5,2 L19,2 Z M8.95903938,14.4653367 L8.89694708,14.4202095 C8.68789701,14.291568 8.42133316,14.3352159 8.26303498,14.5116789 L8.2090719,14.5840012 L4.88033327,19.9929138 L4.93969424,19.9982115 L4.93969424,19.9982115 L12.446,20 L9.05890452,14.5810435 C9.0316623,14.5374559 8.99794603,14.4984621 8.95903938,14.4653367 L8.89694708,14.4202095 L8.95903938,14.4653367 Z M15.6580762,12.1926572 C15.4476303,12.0663122 15.1815603,12.1128758 15.0252035,12.2910614 L14.9720355,12.3639701 L12.551,16.396 L14.803,20 L19,20 C19.5410622,20 19.9817615,19.5702952 19.9994483,19.0335352 L15.8247114,12.3563345 C15.7828678,12.2893847 15.7257647,12.2332952 15.6580762,12.1926572 Z M19,4 L5,4 C4.44771525,4 4,4.44771525 4,5 L4,17.606 L6.50573804,13.5358344 C7.19919591,12.4089238 8.64230264,12.0252274 9.79631538,12.6320827 L9.94511393,12.7168756 C10.2187146,12.885239 10.4567799,13.1044297 10.6467737,13.3619985 L10.7549011,13.5210456 L11.361,14.492 L13.2573282,11.3345145 C13.9384069,10.2000794 15.3772263,9.80060652 16.5378139,10.3947912 L16.6875318,10.4779499 C16.9695672,10.6472749 17.2148477,10.8702509 17.409849,11.1335934 L17.5207081,11.2963367 L20,15.264 L20,5 C20,4.44771525 19.5522847,4 19,4 Z"}),"SharedMedia"),Ce=a(98),ye=a(423),ve=a.n(ye),Ee=a(311),Ue=Object(S.a)(r.a.createElement("path",{d:"M23,12L20.56,9.22L20.9,5.54L17.29,4.72L15.4,1.54L12,3L8.6,1.54L6.71,4.72L3.1,5.53L3.44,9.21L1,12L3.44,14.78L3.1,18.47L6.71,19.29L8.6,22.47L12,21L15.4,22.46L17.29,19.28L20.9,18.46L20.56,14.78L23,12M10,17L6,13L7.41,11.59L10,14.17L16.59,7.58L18,9L10,17Z"}),"Verified");a(410);class Se extends r.a.Component{constructor(...e){super(...e),this.onFastUpdatingComplete=e=>{this.forceUpdate()},this.onUpdateChatTitle=e=>{const t=this.props.chatId;e.chat_id===t&&this.forceUpdate()}}shouldComponentUpdate(e,t){const a=this.props,n=a.chatId,s=a.t;return e.chatId!==n||e.t!==s}componentDidMount(){L.a.on("clientUpdateFastUpdatingComplete",this.onFastUpdatingComplete),L.a.on("updateChatTitle",this.onUpdateChatTitle)}componentWillUnmount(){L.a.off("clientUpdateFastUpdatingComplete",this.onFastUpdatingComplete),L.a.off("updateChatTitle",this.onUpdateChatTitle)}render(){const e=this.props,t=e.t,a=e.chatId,n=e.showSavedMessages,s=Object(w.P)(a),i=Object(w.s)(a,n,t);return r.a.createElement("div",{className:"dialog-title"},r.a.createElement("span",{className:"dialog-title-span"},i),s&&r.a.createElement(Ue,{className:"dialog-title-icon"}))}}Se.defaultProps={showSavedMessages:!0};var ke=Object(f.d)()(Se),Me=a(296),Ie=a(112);a(411);class we extends r.a.Component{constructor(e){super(e),this.onUpdateUserStatus=e=>{const t=this.props.chatId,a=L.a.get(t);if(!a)return;if(!a.type)return;let n=!1;switch(a.type["@type"]){case"chatTypeBasicGroup":{const t=Me.a.getFullInfo(a.type.basic_group_id);if(t&&t.members){t.members.find(t=>t.user_id===e.user_id)&&(n=!0)}break}case"chatTypePrivate":case"chatTypeSecret":a.type.user_id===e.user_id&&(n=!0)}n&&this.updateSubtitle(t)},this.updateSubtitle=e=>{this.setState({subtitle:Object(w.r)(e),isAccent:Object(w.I)(e)})},this.onUpdateUserFullInfo=e=>{const t=this.props.chatId,a=L.a.get(t);if(!a)return;const n=a.type;n&&(!n||"chatTypePrivate"!==n["@type"]&&"chatTypeSecret"!==n["@type"]||n.user_id!==e.user_id||this.updateSubtitle(t))},this.onUpdateBasicGroupFullInfo=e=>{const t=this.props.chatId,a=L.a.get(t);if(!a)return;const n=a.type;n&&n&&"chatTypeBasicGroup"===n["@type"]&&n.basic_group_id===e.basic_group_id&&this.updateSubtitle(t)},this.onUpdateSupergroupFullInfo=e=>{const t=this.props.chatId,a=L.a.get(t);if(!a)return;const n=a.type;n&&n&&"chatTypeSupergroup"===n["@type"]&&n.supergroup_id===e.supergroup_id&&this.updateSubtitle(t)},this.onUpdateBasicGroup=e=>{const t=this.props.chatId,a=L.a.get(t);if(!a)return;const n=a.type;n&&n&&"chatTypeBasicGroup"===n["@type"]&&n.basic_group_id===e.basic_group.id&&this.updateSubtitle(t)},this.onUpdateSupergroup=e=>{const t=this.props.chatId,a=L.a.get(t);if(!a)return;const n=a.type;n&&n&&"chatTypeSupergroup"===n["@type"]&&n.supergroup_id===e.supergroup.id&&this.updateSubtitle(t)};const t=this.props.chatId;this.state={prevChatId:t,subtitle:Object(w.r)(t),isAccent:Object(w.I)(t)}}static getDerivedStateFromProps(e,t){if(e.chatId!==t.prevChatId){const t=e.chatId;return{prevChatId:t,subtitle:Object(w.r)(t),isAccent:Object(w.I)(t)}}return null}shouldComponentUpdate(e,t){const a=this.props.chatId,n=this.state,s=n.subtitle,i=n.isAccent;return e.chatId!==a||(t.subtitle!==s||t.isAccent!==i)}componentDidMount(){_.a.on("updateUserStatus",this.onUpdateUserStatus),Me.a.on("updateBasicGroup",this.onUpdateBasicGroup),Ie.a.on("updateSupergroup",this.onUpdateSupergroup),_.a.on("updateUserFullInfo",this.onUpdateUserFullInfo),Me.a.on("updateBasicGroupFullInfo",this.onUpdateBasicGroupFullInfo),Ie.a.on("updateSupergroupFullInfo",this.onUpdateSupergroupFullInfo)}componentWillUnmount(){_.a.off("updateUserStatus",this.onUpdateUserStatus),Me.a.off("updateBasicGroup",this.onUpdateBasicGroup),Ie.a.off("updateSupergroup",this.onUpdateSupergroup),_.a.off("updateUserFullInfo",this.onUpdateUserFullInfo),Me.a.off("updateBasicGroupFullInfo",this.onUpdateBasicGroupFullInfo),Ie.a.off("updateSupergroupFullInfo",this.onUpdateSupergroupFullInfo)}render(){const e=this.props.subtitle,t=this.state,a=t.subtitle,n=t.isAccent;return r.a.createElement("div",{className:l()("dialog-status",{"dialog-status-accent":n})},e?e+", ":null,a)}}var _e=we;a(412);class xe extends r.a.Component{constructor(e){super(e),this.handleClick=()=>{const e=this.props,t=e.chatId,a=e.onSelect;a&&a(t)};const t=this.props.chatId;this.state={chat:L.a.get(t)}}shouldComponentUpdate(e,t){return e.chatId!==this.props.chatId}render(){const e=this.props,t=e.chatId,a=e.subtitle,n=e.onTileSelect,s=e.showStatus,i=e.showSavedMessages,o=e.big,c=e.showTitle,d=Object(w.S)(t);return r.a.createElement("div",{className:l()("chat",{"chat-big":o}),onClick:this.handleClick},r.a.createElement("div",{className:"chat-wrapper"},r.a.createElement(D,{big:o,chatId:t,onSelect:n,showSavedMessages:i}),c&&r.a.createElement("div",{className:"chat-inner-wrapper"},r.a.createElement("div",{className:"tile-first-row"},r.a.createElement(ke,{chatId:t,showSavedMessages:i})),s&&(!d||!i)&&r.a.createElement("div",{className:"tile-second-row"},r.a.createElement(_e,{chatId:t,subtitle:a})))))}}xe.defaultProps={showSavedMessages:!0,showStatus:!0,showTitle:!0};var Oe=xe,Te=Object(S.a)(r.a.createElement("path",{d:"M4.29289322,11.2928932 L11.2928932,4.29289322 C11.6834175,3.90236893 12.3165825,3.90236893 12.7071068,4.29289322 C13.0675907,4.65337718 13.0953203,5.22060824 12.7902954,5.61289944 L12.7071068,5.70710678 L7.414,11 L19,11 C19.5128358,11 19.9355072,11.3860402 19.9932723,11.8833789 L20,12 C20,12.5128358 19.6139598,12.9355072 19.1166211,12.9932723 L19,13 L7.414,13 L12.7071068,18.2928932 C13.0675907,18.6533772 13.0953203,19.2206082 12.7902954,19.6128994 L12.7071068,19.7071068 C12.3466228,20.0675907 11.7793918,20.0953203 11.3871006,19.7902954 L11.2928932,19.7071068 L4.29289322,12.7071068 C3.93240926,12.3466228 3.90467972,11.7793918 4.20970461,11.3871006 L4.29289322,11.2928932 L11.2928932,4.29289322 L4.29289322,11.2928932 Z"}),"Back");a(413);class Le extends r.a.Component{constructor(e){super(e)}render(){const e=this.props,t=e.chatId,a=e.t,n=e.backButton,s=e.onClick,i=e.onClose;let o=a("ChatInfo");return Object(w.T)(t)?o=a("Info"):Object(w.J)(t)&&(o=a("ChannelInfo")),r.a.createElement("div",{className:"header-master"},n&&r.a.createElement(C.a,{className:"header-left-button",onClick:i},r.a.createElement(Te,null)),r.a.createElement("div",{className:"header-status grow cursor-pointer",onClick:s},r.a.createElement("span",{className:"header-status-content"},o)),!n&&r.a.createElement(C.a,{className:"header-right-button",onClick:i},r.a.createElement(U.a,null)))}}var Pe=Object(f.d)()(Le),Ne=a(570),De=a(415),je=a.n(De),Be=a(414),Re=a.n(Be),Fe=a(571),Ae=a(18),Ve=a(78);function ze(e,t){K.a.send({"@type":"setChatChatList",chat_id:e,chat_list:t})}function He(e,t){K.a.send({"@type":"toggleChatIsPinned",chat_id:e,is_pinned:t})}function We(e,t){K.a.send({"@type":"toggleChatIsMarkedAsUnread",chat_id:e,is_marked_as_unread:t})}function Ge(e,t){const a=L.a.get(e);if(!a)return;if(!a.notification_settings)return;if(Object(w.M)(e)===t)return;const n=t?p.v:p.w,s=Object(Ve.a)({},a.notification_settings,{use_default_mute_for:!1,mute_for:n});K.a.send({"@type":"setChatNotificationSettings",chat_id:e,notification_settings:s})}function Ze(e){return qe.apply(this,arguments)}function qe(){return(qe=Object(i.a)(s.a.mark((function e(t){var a,n,i,o,r,c,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(L.a.get(t)){e.next=3;break}return e.abrupt("return");case 3:return a=[],n=K.a.send({"@type":"getChatMessageCount",chat_id:t,filter:{"@type":"searchMessagesFilterPhoto"},return_local:!1}).then(e=>e?e.count:0).catch(()=>0),a.push(n),i=K.a.send({"@type":"getChatMessageCount",chat_id:t,filter:{"@type":"searchMessagesFilterVideo"},return_local:!1}).then(e=>e?e.count:0).catch(()=>0),a.push(i),o=K.a.send({"@type":"getChatMessageCount",chat_id:t,filter:{"@type":"searchMessagesFilterDocument"},return_local:!1}).then(e=>e?e.count:0).catch(()=>0),a.push(o),r=K.a.send({"@type":"getChatMessageCount",chat_id:t,filter:{"@type":"searchMessagesFilterAudio"},return_local:!1}).then(e=>e?e.count:0).catch(()=>0),a.push(r),c=K.a.send({"@type":"getChatMessageCount",chat_id:t,filter:{"@type":"searchMessagesFilterUrl"},return_local:!1}).then(e=>e?e.count:0).catch(()=>0),a.push(c),l=K.a.send({"@type":"getChatMessageCount",chat_id:t,filter:{"@type":"searchMessagesFilterVoiceNote"},return_local:!1}).then(e=>e?e.count:0).catch(()=>0),a.push(l),e.next=18,Promise.all(a);case 18:return e.abrupt("return",e.sent);case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ke=a(116);class Ye extends r.a.Component{constructor(e){super(e),this.onUpdateChatNotificationSettings=e=>{const t=e.chat_id,a=this.props.chatId;t&&t===a&&this.setState({isMuted:Object(w.M)(a)})},this.onUpdateScopeNotificationSettings=e=>{const t=this.props.chatId,a=L.a.get(t);switch(e.scope["@type"]){case"notificationSettingsScopeGroupChats":"chatTypeBasicGroup"!==a.type["@type"]&&"chatTypeSupergroup"!==a.type["@type"]||this.setState({isMuted:Object(w.M)(t)});break;case"notificationSettingsScopePrivateChats":"chatTypePrivate"!==a.type["@type"]&&"chatTypeSecret"!==a.type["@type"]||this.setState({isMuted:Object(w.M)(t)})}},this.handleSetChatNotifications=()=>{this.setState({isMuted:!this.state.isMuted}),this.debouncedSetChatNotificationSettings()},this.setChatNotificationSettings=()=>{Ge(this.props.chatId,this.state.isMuted)};const t=e.chatId;this.state={prevChatId:t,isMuted:Object(w.M)(t)},this.debouncedSetChatNotificationSettings=Object(Ae.c)(this.setChatNotificationSettings,p.z)}static getDerivedStateFromProps(e,t){if(e.chatId!==t.prevChatId){const t=e.chatId;return{prevChatId:t,isMuted:Object(w.M)(t)}}return null}componentDidMount(){L.a.on("updateChatNotificationSettings",this.onUpdateChatNotificationSettings),Ke.a.on("updateScopeNotificationSettings",this.onUpdateScopeNotificationSettings)}componentWillUnmount(){L.a.off("updateChatNotificationSettings",this.onUpdateChatNotificationSettings),Ke.a.off("updateScopeNotificationSettings",this.onUpdateScopeNotificationSettings)}}var Je=Ye;var Qe=Object(f.d)()(class extends Je{render(){const e=this.props.t,t=this.state.isMuted;return r.a.createElement(ue.a,{button:!0,className:"list-item",onClick:this.handleSetChatNotifications},r.a.createElement(pe.a,null,t?r.a.createElement(je.a,null):r.a.createElement(Re.a,null)),r.a.createElement(me.a,{primary:r.a.createElement(Ce.a,{variant:"inherit",noWrap:!0},e("Notifications"))}),r.a.createElement(Ne.a,null,r.a.createElement(Fe.a,{color:"primary",onChange:this.handleSetChatNotifications,checked:!t})))}}),Xe=a(417),$e=a.n(Xe),et=a(418),tt=a.n(et),at=a(419),nt=a.n(at),st=a(330);a(416);class it extends r.a.Component{constructor(e){super(e),this.handleMoreClick=()=>{this.setState({openMore:!this.state.openMore})},this.handleSendMessage=()=>{const e=Z.a.getChatId(),t=this.props.chatId;e===t||K.a.setChatId(t)},this.handleBlock=()=>{const e=this.state.chatId,t=L.a.get(e);if(!t)return;if(!t.type)return;const a=t.type.user_id;a&&K.a.send({"@type":Object(I.i)(a)?"unblockUser":"blockUser",user_id:a})};const t=this.props.chatId;this.state={prevChatId:t,openMore:!1}}static getDerivedStateFromProps(e,t){return e.chatId!==t.prevChatId?{prevChatId:e.chatId,openMore:!1}:null}render(){const e=this.props,t=e.t,a=e.chatId,n=this.state.openMore,s=L.a.get(a);if(!s)return null;const i=Object(w.R)(a);let o=!1;!i&&s.type&&(o=Object(I.i)(s.type.user_id));const c=Object(w.L)(a),l=Object(w.J)(a);return r.a.createElement(r.a.Fragment,null,r.a.createElement(ue.a,{button:!0,className:"list-item",onClick:this.handleMoreClick},r.a.createElement(pe.a,null,r.a.createElement($e.a,null)),r.a.createElement(me.a,{primary:r.a.createElement(Ce.a,{variant:"inherit",noWrap:!0},t("More"))}),n?r.a.createElement(tt.a,null):r.a.createElement(nt.a,null)),r.a.createElement(st.a,{in:n,timeout:"auto",unmountOnExit:!0},r.a.createElement(he.a,{component:"div",disablePadding:!0},!i&&r.a.createElement(r.a.Fragment,null,r.a.createElement(ue.a,{button:!0,className:"list-item",onClick:this.handleSendMessage},r.a.createElement(me.a,{inset:!0,primary:r.a.createElement(Ce.a,{variant:"inherit",noWrap:!0},t("SendMessage"))})),r.a.createElement(ue.a,{button:!0,className:"list-item",onClick:this.handleBlock},r.a.createElement(me.a,{inset:!0,primary:r.a.createElement(Ce.a,{color:"secondary",variant:"inherit",noWrap:!0},t(o?"Unblock":"BlockContact"))}))),i&&c&&r.a.createElement(ue.a,{button:!0,className:"list-item"},r.a.createElement(me.a,{inset:!0,primary:r.a.createElement(Ce.a,{color:"secondary",variant:"inherit",noWrap:!0},t(l?"LeaveChannel":"DeleteChat"))})),i&&!c&&r.a.createElement(ue.a,{button:!0,className:"list-item"},r.a.createElement(me.a,{inset:!0,primary:r.a.createElement(Ce.a,{color:"secondary",variant:"inherit",noWrap:!0},t("ReportChat"))})))))}}Object(f.d)()(it);var ot=a(83);a(420);class rt extends r.a.Component{constructor(e){super(e),this.onUpdateBasicGroupFullInfo=e=>{const t=L.a.get(this.props.chatId);t&&t.type&&"chatTypeBasicGroup"===t.type["@type"]&&t.type.basic_group_id===e.basic_group_id&&this.forceUpdate()},this.onUpdateSupergroupFullInfo=e=>{const t=L.a.get(this.props.chatId);t&&t.type&&"chatTypeSupergroup"===t.type["@type"]&&t.type.supergroup_id===e.supergroup_id&&this.forceUpdate()},this.onUpdateUserFullInfo=e=>{const t=L.a.get(this.props.chatId);t&&(!t.type||"chatTypePrivate"!==t.type["@type"]&&"chatTypeSecret"!==t.type["@type"]||t.type.user_id!==e.user_id||this.forceUpdate())},this.onUpdateUserStatus=e=>{this.members.has(e.user_id)&&this.forceUpdate()},this.loadContent=()=>{this.loadChatContents()},this.loadChatContents=()=>{const e=this.props,t=e.chatId,a=e.popup,n=P.a.getStore();Object(T.r)(n,[t]);const s=Object(w.w)(t).map(e=>e.user_id);Object(T.C)(n,s),a&&Object(w.m)(t)},this.handleUsernameHint=()=>{const e=this.props,t=e.t,a=e.chatId,n=Object(w.v)(a);if(!n)return;const s=F.a.get("t_me_url");R((s?s.value:"https://telegram.org/")+n);const i="".concat(a,"_copy_username"),o=t("TextCopied");this.handleScheduledAction(i,o,null)},this.handleScheduledAction=(e,t,a)=>{if(!e)return;const n=this.props.enqueueSnackbar;if(!n)return;Z.a.addScheduledAction(e,p.y+300,a)&&n(t,{autoHideDuration:p.y,action:[r.a.createElement(C.a,{key:"close","aria-label":"Close",color:"inherit",className:"notification-close-button",onClick:()=>Z.a.removeScheduledAction(e)},r.a.createElement(U.a,null))]})},this.handlePhoneHint=()=>{const e=this.props,t=e.t,a=e.chatId,n=Object(w.o)(a);if(!n)return;R(Object(ot.a)(n));const s="".concat(a,"_copy_phone"),i=t("PhoneCopied");this.handleScheduledAction(s,i,null)},this.handleHeaderClick=()=>{this.chatDetailsListRef.current.scrollTop=0},this.handleOpenViewer=()=>{const e=this.props,t=e.chatId,a=e.popup,n=L.a.get(t);n&&n.photo&&(Object(G.q)({chatId:t}),a&&K.a.clientUpdate({"@type":"clientUpdateDialogChatId",chatId:0}))},this.handleOpenChat=()=>{const e=this.props,t=e.chatId,a=e.popup;Object(G.h)(t,null,!1),a&&K.a.clientUpdate({"@type":"clientUpdateDialogChatId",chatId:0})},this.handleOpenUser=e=>{Object(G.j)(e,!0)},this.getContentHeight=()=>this.chatDetailsListRef?this.chatDetailsListRef.current.clientHeight:0,this.chatDetailsListRef=r.a.createRef();const t=this.props.chatId;this.members=new Map,this.state={prevChatId:t}}static getDerivedStateFromProps(e,t){return e.chatId!==t.prevChatId?{prevChatId:e.chatId}:null}getSnapshotBeforeUpdate(e,t){this.props.chatId;const a=this.chatDetailsListRef.current;return{scrollTop:a.scrollTop,scrollHeight:a.scrollHeight,offsetHeight:a.offsetHeight}}shouldComponentUpdate(e,t){const a=this.props,n=a.chatId,s=a.theme,i=a.counters,o=a.migratedCounters;return e.chatId!==n||(e.counters!==i||(e.migratedCounters!==o||e.theme!==s))}componentDidUpdate(e,t,a){const n=this.props.chatId;e.chatId!==n&&this.loadContent();const s=this.chatDetailsListRef.current,i=a.scrollTop;a.scrollHeight,a.offsetHeight;e.chatId===n?s.scrollTop=i:s.scrollTop=0}componentDidMount(){this.loadContent(),_.a.on("updateUserStatus",this.onUpdateUserStatus),_.a.on("updateUserFullInfo",this.onUpdateUserFullInfo),Me.a.on("updateBasicGroupFullInfo",this.onUpdateBasicGroupFullInfo),Ie.a.on("updateSupergroupFullInfo",this.onUpdateSupergroupFullInfo)}componentWillUnmount(){_.a.off("updateUserStatus",this.onUpdateUserStatus),_.a.off("updateUserFullInfo",this.onUpdateUserFullInfo),Me.a.off("updateBasicGroupFullInfo",this.onUpdateBasicGroupFullInfo),Ie.a.off("updateSupergroupFullInfo",this.onUpdateSupergroupFullInfo)}render(){const e=this.props,t=e.backButton,a=e.className,n=e.chatId,s=e.onClose,i=e.onOpenGroupInCommon,o=e.onOpenSharedAudios,c=e.onOpenSharedDocuments,d=e.onOpenSharedLinks,h=(e.onOpenSharedMedia,e.onOpenSharedPhotos),u=e.onOpenSharedVideos,p=e.onOpenSharedVoiceNotes,m=e.popup,f=e.t;let b=this.props,C=b.counters,y=b.migratedCounters;C=C||[0,0,0,0,0,0],y=y||[0,0,0,0,0,0];const v=C.map((e,t)=>e+y[t]),E=Object(g.a)(v,6),U=E[0],S=E[1],k=E[2],M=E[3],x=E[4],O=E[5],T=L.a.get(n);if(!T)return r.a.createElement("div",{className:"chat-details"},r.a.createElement(Pe,{onClose:s}),r.a.createElement("div",{ref:this.chatDetailsListRef,className:"chat-details-list"}));let P=0;if(Object(w.T)(n)){const e=_.a.getFullInfo(T.type.user_id);P=e?e.group_in_common_count:P}const N=Object(w.v)(n),D=Object(w.o)(n),j=Object(w.j)(n),B=Object(w.R)(n),R=Object(w.S)(n),F=Object(w.w)(n),A=[];this.members=new Map,F.forEach(e=>{const t=_.a.get(e.user_id);t&&(this.members.set(t.id,t.id),A.push(t))});const V=A.sort((e,t)=>Object(I.g)(t)-Object(I.g)(e)).map(e=>r.a.createElement(ue.a,{button:!0,className:"list-item",key:e.id},r.a.createElement(Ee.a,{userId:e.id,onSelect:this.handleOpenUser}))),z=T.photo,H=r.a.createElement(r.a.Fragment,null,r.a.createElement(Pe,{chatId:n,backButton:t,onClose:s,onClick:this.handleHeaderClick}),r.a.createElement("div",{ref:this.chatDetailsListRef,className:"chat-details-list"},r.a.createElement("div",{className:"chat-details-info"},r.a.createElement(Oe,{chatId:n,big:!0,showStatus:!0,showSavedMessages:!m,onTileSelect:z?this.handleOpenViewer:null})),(N||D||j)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(he.a,null,N&&r.a.createElement(ue.a,{button:!0,className:"list-item",onClick:this.handleUsernameHint},r.a.createElement(pe.a,null,r.a.createElement(X.a,null)),r.a.createElement(me.a,{primary:r.a.createElement(Ce.a,{variant:"inherit",noWrap:!0},N)})),D&&r.a.createElement(r.a.Fragment,null,r.a.createElement(ue.a,{button:!0,className:"list-item",onClick:this.handlePhoneHint},r.a.createElement(pe.a,null,r.a.createElement(ae.a,null)),r.a.createElement(me.a,{primary:r.a.createElement(Ce.a,{variant:"inherit",noWrap:!0},Object(ot.a)(D))}))),j&&r.a.createElement(ue.a,{className:"list-item"},r.a.createElement(pe.a,null,r.a.createElement(ie.a,{className:"chat-details-info-icon"})),r.a.createElement(me.a,{primary:j,style:{whiteSpace:"pre-wrap",wordWrap:"break-word"}})))),(!R||B||m&&!B)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(ne.a,null),r.a.createElement(he.a,null,!R&&r.a.createElement(Qe,{chatId:n}),m&&!B&&r.a.createElement(ue.a,{button:!0,className:"list-item",onClick:this.handleOpenChat},r.a.createElement(me.a,{inset:!0,primary:r.a.createElement(Ce.a,{color:"primary",variant:"inherit",noWrap:!0},f("SendMessage").toUpperCase())})))),(U>0||S>0||k>0||M>0||x>0||O>0||P>0)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(ne.a,null),r.a.createElement(he.a,null,U>0&&r.a.createElement(ue.a,{button:!0,className:"list-item",onClick:h},r.a.createElement(pe.a,null,r.a.createElement(be,null)),r.a.createElement(me.a,{primary:r.a.createElement(Ce.a,{variant:"inherit",noWrap:!0},1===U?"1 photo":"".concat(U," photos"))})),S>0&&r.a.createElement(ue.a,{button:!0,className:"list-item",onClick:u},r.a.createElement(pe.a,null,r.a.createElement(ve.a,null)),r.a.createElement(me.a,{primary:r.a.createElement(Ce.a,{variant:"inherit",noWrap:!0},1===S?"1 video":"".concat(S," videos"))})),k>0&&r.a.createElement(ue.a,{button:!0,className:"list-item",onClick:c},r.a.createElement(pe.a,null,r.a.createElement(ce,null)),r.a.createElement(me.a,{primary:r.a.createElement(Ce.a,{variant:"inherit",noWrap:!0},1===k?"1 file":"".concat(k," files"))})),M>0&&r.a.createElement(ue.a,{button:!0,className:"list-item",onClick:o},r.a.createElement(pe.a,null,r.a.createElement(re.a,null)),r.a.createElement(me.a,{primary:r.a.createElement(Ce.a,{variant:"inherit",noWrap:!0},1===M?"1 audio file":"".concat(M," audio files"))})),x>0&&r.a.createElement(ue.a,{button:!0,className:"list-item",onClick:d},r.a.createElement(pe.a,null,r.a.createElement(de.a,null)),r.a.createElement(me.a,{primary:r.a.createElement(Ce.a,{variant:"inherit",noWrap:!0},1===x?"1 shared link":"".concat(x," shared links"))})),O>0&&r.a.createElement(ue.a,{button:!0,className:"list-item",onClick:p},r.a.createElement(pe.a,null,r.a.createElement(fe.a,null)),r.a.createElement(me.a,{primary:r.a.createElement(Ce.a,{variant:"inherit",noWrap:!0},1===O?"1 voice message":"".concat(O," voice messages"))})),P>0&&r.a.createElement(ue.a,{button:!0,className:"list-item",onClick:i},r.a.createElement(pe.a,null,r.a.createElement(ee.a,null)),r.a.createElement(me.a,{primary:r.a.createElement(Ce.a,{variant:"inherit",noWrap:!0},1===P?"1 group in common":"".concat(P," groups in common"))})))),V.length>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement(ne.a,null),r.a.createElement(he.a,null,V))));return m?r.a.createElement(r.a.Fragment,null,H):r.a.createElement("div",{className:l()("chat-details",a)},H)}}var ct=Object(d.a)(Object(d.d)(),Object(f.d)(),u.withSnackbar,Object(d.c)())(rt);a(428);class lt extends r.a.Component{render(){const e=this.props.onClose;return r.a.createElement("div",{className:"header-master"},r.a.createElement(C.a,{className:"header-left-button",onClick:e},r.a.createElement(Te,null)),r.a.createElement("div",{className:"header-status grow cursor-pointer"},r.a.createElement("span",{className:"header-status-content"},"Groups in common")))}}var dt=lt;a(429);class ht extends r.a.Component{constructor(e){super(e),this.handleSelect=e=>{const t=this.props.popup;Object(G.h)(e),t&&K.a.clientUpdate({"@type":"clientUpdateDialogChatId",chatId:0})},this.state={chatIds:[]}}componentDidMount(){const e=this.props.chatId,t=Object(w.u)(e);t&&K.a.send({"@type":"getGroupsInCommon",user_id:t,offset_chat_id:0,limit:100}).then(e=>{const t=P.a.getStore();Object(T.r)(t,e.chat_ids),this.setState({chatIds:e.chat_ids})})}render(){const e=this.props,t=e.minHeight,a=e.onClose,n=e.popup,s=this.state.chatIds.map(e=>r.a.createElement(ue.a,{button:!0,key:e},r.a.createElement(Oe,{chatId:e,onSelect:this.handleSelect}))),i=r.a.createElement(r.a.Fragment,null,r.a.createElement(dt,{onClose:a}),r.a.createElement("div",{className:"groups-in-common-list",style:{minHeight:t}},s));return n?r.a.createElement(r.a.Fragment,null,i):r.a.createElement("div",{className:"groups-in-common"},i)}}ht.defaultProps={popup:!1,minHeight:0};var ut=ht,pt=a(4),mt=a.n(pt),gt=a(232),ft=a(573),bt=a(230);a(430);class Ct extends r.a.Component{constructor(...e){super(...e),this.handleOpenMessage=e=>{const t=this.props,a=t.chatId,n=t.messageId;(0,t.onClose)(e),Object(G.h)(a,n)},this.handleForward=e=>{const t=this.props,a=t.chatId,n=t.messageId;(0,t.onClose)(e),Object(G.e)(a,[n])},this.handleDelete=e=>{const t=this.props,a=t.chatId,n=t.messageId;(0,t.onClose)(e),Object(G.c)(a,[n])}}render(){const e=this.props,t=e.t,a=e.chatId,n=e.messageId,s=e.open,i=e.onClose,o=e.anchorPosition,c=e.showOpenMessage,l=q.a.get(a,n);if(!l)return null;const d=l.can_be_forwarded,h=l.can_be_deleted_only_for_self,u=l.can_be_deleted_for_all_users;return r.a.createElement(bt.a,{open:s,onClose:i,anchorReference:"anchorPosition",anchorPosition:o,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"},onMouseDown:e=>e.stopPropagation(),onClick:e=>e.stopPropagation()},r.a.createElement(gt.a,null,c&&r.a.createElement(ft.a,{onClick:this.handleOpenMessage},t("GoToMessage")),d&&r.a.createElement(ft.a,{onClick:this.handleForward},t("Forward")),(h||u)&&r.a.createElement(ft.a,{onClick:this.handleDelete},t("Delete"))))}}var yt=Object(f.d)()(Ct),vt=a(281),Et=a(282);a(431);class Ut extends r.a.Component{constructor(...e){var t;super(...e),t=this,this.state={contextMenu:!1,left:0,top:0},this.handleOpenContextMenu=function(){var e=Object(i.a)(s.a.mark((function e(a){var n,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a&&(a.preventDefault(),a.stopPropagation()),t.state.contextMenu?t.setState({contextMenu:!1}):(n=a.clientX,i=a.clientY,t.setState({contextMenu:!0,left:n,top:i}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleCloseContextMenu=e=>{e&&e.stopPropagation(),this.setState({contextMenu:!1})}}render(){const e=this.props,t=e.chatId,a=e.messageId,n=e.showOpenMessage,s=this.state,i=s.contextMenu,o=s.left,c=s.top,l=q.a.get(t,a);return l?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"shared-document",onContextMenu:this.handleOpenContextMenu},Object(Et.f)(l,()=>Object(vt.N)(t,a,!0))),r.a.createElement(yt,{chatId:t,messageId:a,anchorPosition:{top:c,left:o},open:i,showOpenMessage:n,onClose:this.handleCloseContextMenu})):null}}var St=Ut,kt=Object(S.a)(r.a.createElement("path",{d:"M9.5,3 C13.0898509,3 16,5.91014913 16,9.5 C16,10.9337106 15.5358211,12.2590065 14.7495478,13.3338028 L19.7071068,18.2928932 C20.0976311,18.6834175 20.0976311,19.3165825 19.7071068,19.7071068 C19.3466228,20.0675907 18.7793918,20.0953203 18.3871006,19.7902954 L18.2928932,19.7071068 L13.3338028,14.7495478 C12.2590065,15.5358211 10.9337106,16 9.5,16 C5.91014913,16 3,13.0898509 3,9.5 C3,5.91014913 5.91014913,3 9.5,3 Z M9.5,5 C7.01471863,5 5,7.01471863 5,9.5 C5,11.9852814 7.01471863,14 9.5,14 C11.9852814,14 14,11.9852814 14,9.5 C14,7.01471863 11.9852814,5 9.5,5 Z"}),"Search"),Mt=a(585);a(432);class It extends r.a.Component{constructor(e){super(e),this.handleSearch=()=>{if(this.searchInputRef.current){if(this.searchInputRef.current.innerText){this.searchInputRef.current.innerText="";const e=this.props.onSearch;if(!e)return;return void e("")}}const e=this.props.onCloseSearch,t=this.state.openSearch;this.setState({openSearch:!t}),e&&e()},this.handleKeyDown=e=>{13===e.keyCode&&e.preventDefault()},this.handleKeyUp=()=>{const e=this.searchInputRef.current;if(!e)return;const t=e.innerHTML;"<br>"!==t&&"<div><br></div>"!==t||(e.innerHTML=null);const a=e.innerText,n=this.props.onSearch;n&&n(a)},this.handlePaste=e=>{const t=e.clipboardData.getData("text/plain");t&&(e.preventDefault(),document.execCommand("insertText",!1,t))},this.searchInputRef=r.a.createRef(),this.state={openSearch:!1}}componentDidUpdate(e,t,a){const n=this.state.openSearch;n&&n!==e.openSearch&&setTimeout(()=>{this.searchInputRef.current&&this.searchInputRef.current.focus()},p.b)}render(){const e=this.props,t=e.t,a=e.title,n=e.onClick,s=e.onClose,i=e.onSearch,o=this.state.openSearch;return r.a.createElement("div",{className:"header-master"},o?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"header-search-input grow"},r.a.createElement("div",{id:"header-search-inputbox",ref:this.searchInputRef,placeholder:t("Search"),contentEditable:!0,suppressContentEditableWarning:!0,onKeyDown:this.handleKeyDown,onKeyUp:this.handleKeyUp,onPaste:this.handlePaste}))):r.a.createElement(r.a.Fragment,null,r.a.createElement(C.a,{className:"header-left-button",onClick:s},r.a.createElement(Te,null)),r.a.createElement("div",{className:"header-status grow cursor-pointer",onClick:n},r.a.createElement("span",{className:"header-status-content"},a))),Boolean(i)&&r.a.createElement(C.a,{className:"header-right-button",onMouseDown:this.handleSearch},r.a.createElement(Mt.a,{open:o,icon:r.a.createElement(kt,null),openIcon:r.a.createElement(U.a,null)})))}}var wt=Object(f.d)()(It);a(433);class _t extends r.a.Component{getListClassName(){return null}getSearchListClassName(){return null}constructor(e){var t;if(new.target===_t)throw new TypeError("Cannot construct SharedMediaBase instances directly");super(e),t=this,this.onUpdateMessageContent=e=>{const t=this.props,a=t.chatId,n=t.migratedChatId,s=this.state,i=s.items,o=s.migratedItems,r=e.chat_id,c=e.message_id,l=(e.old_content,e.new_content),d=q.a.get(r,c);if(r===a){if(!i.length)return;if(!Object(Ae.b)(c,i[0].id,i[i.length-1].id,!0))return;const e=i.findIndex(e=>e.id===c);this.isValidContent(l)?-1===e?this.setState({items:Object(Ae.o)(i,d,vt.M)}):this.setState({items:[...i.slice(0,e),d,...i.slice(e+1)]}):-1===e||this.setState({items:i.filter(e=>e.id!==c)})}else if(r===n){if(!o.length)return;if(!Object(Ae.b)(c,o[0].id,o[o.length-1].id,!0))return;const e=o.findIndex(e=>e.id===c);this.isValidContent(l)?-1===e?this.setState({migratedItems:Object(Ae.o)(o,d,vt.M)}):this.setState({migratedItems:[...o.slice(0,e),d,...o.slice(e+1)]}):-1===e||this.setState({migratedItems:o.filter(e=>e.id!==c)})}},this.onUpdateNewMessage=e=>{const t=this.props,a=t.chatId,n=t.migratedChatId,s=this.state,i=s.items,o=s.migratedItems,r=e.message,c=r.chat_id;if(c!==a)return;if(!this.isValidMessage(r))return;const l=P.a.getStore();Object(T.v)(l,[r]),c===a?this.setState({items:[r].concat(i)}):c===n&&this.setState({migratedItems:[r].concat(o)})},this.onUpdateDeleteMessages=e=>{const t=this.props,a=t.chatId,n=t.migratedChatId,s=this.state,i=s.items,o=s.migratedItems,r=e.chat_id,c=e.message_ids,l=new Map(c.map(e=>[e,e])),d=()=>{this.state.items.length+this.state.migratedItems.length<p.ib&&this.onLoadNext(this.params)};r===a?this.setState({items:i.filter(e=>!l.has(e.id))},d):r===n&&this.setState({migratedItems:o.filter(e=>!l.has(e.id))},d)},this.loadContent=()=>{this.params={loading:!1,completed:!1,migrateCompleted:!1,items:[],migratedItems:[],filter:this.getSearchFilter()},this.onLoadNext(this.params)},this.onLoadNext=function(){var e=Object(i.a)(s.a.mark((function e(a,n=!0){var i,o,r,c,l,d,h,u,m;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.props.chatId,o=a.completed,r=a.filter,c=a.items,!a.loading){e.next=4;break}return e.abrupt("return");case 4:if(!o){e.next=6;break}return e.abrupt("return");case 6:return l=c.length>0?c[c.length-1].id:0,a.loading=!0,e.next=10,K.a.send({"@type":"searchChatMessages",chat_id:i,query:"",sender_user_id:0,from_message_id:l,offset:0,limit:p.ib,filter:r}).finally(()=>{a.loading=!1});case 10:d=e.sent,K.a.send({"@type":"searchChatMessages",chat_id:i,query:"",sender_user_id:0,from_message_id:l,offset:0,limit:2*p.ib,filter:r}),h=d.messages,a.completed=0===h.length||0===h.total_count,a.items=c.concat(h.filter(t.isValidMessage)),u=n&&h.length>0&&h.length<p.ib,q.a.setItems(d.messages),m=P.a.getStore(),Object(T.v)(m,d.messages),t.setState({items:a.items}),a.completed?t.onLoadMigratedNext(a,!0):u&&t.onLoadNext(a,!1);case 21:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.onLoadMigratedNext=function(){var e=Object(i.a)(s.a.mark((function e(a,n=!0){var i,o,r,c,l,d,h,u,m,g;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.props.migratedChatId,o=a.filter,r=a.loading,c=a.migrateCompleted,l=a.migratedItems,i){e.next=4;break}return e.abrupt("return");case 4:if(!r){e.next=6;break}return e.abrupt("return");case 6:if(!c){e.next=8;break}return e.abrupt("return");case 8:return d=l.length>0?l[l.length-1].id:0,a.loading=!0,e.next=12,K.a.send({"@type":"searchChatMessages",chat_id:i,query:"",sender_user_id:0,from_message_id:d,offset:0,limit:p.ib,filter:o}).finally(()=>{a.loading=!1});case 12:if(h=e.sent,u=h.messages,a.migratedItems=l.concat(u.filter(t.isValidMessage)),a.migrateCompleted=0===u.length||0===u.total_count,m=n&&u.length>0&&u.length<p.ib,!a.migrateCompleted){e.next=19;break}return e.abrupt("return");case 19:q.a.setItems(u),g=P.a.getStore(),Object(T.v)(g,u),t.setState({migratedItems:a.migratedItems}),m&&t.onLoadMigratedNext(a,!1);case 24:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleScroll=()=>{if(!this.listRef)return;const e=this.listRef.current;if(!e)return;const t=this.params;e.scrollTop+e.offsetHeight>=e.scrollHeight-p.gb&&(t&&!t.completed?this.onLoadNext(t):this.onLoadMigratedNext(t))},this.handleHeaderClick=()=>{const e=this.listRef.current;e&&(e.scrollTop=0)},this.handleSearchScroll=()=>{if(!this.searchListRef)return;const e=this.searchListRef.current;if(!e)return;const t=this.searchParams;t&&e.scrollTop+e.offsetHeight>=e.scrollHeight-p.gb&&(t.completed?this.onSearchMigratedNext(t):this.onSearchNext(t))},this.onSearchNext=function(){var e=Object(i.a)(s.a.mark((function e(a,n=!0){var i,o,r,c,l,d,h,u,m,g,f;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.props.chatId,o=a.completed,r=a.filter,c=a.items,l=a.loading,d=a.query,!o){e.next=4;break}return e.abrupt("return");case 4:if(!l){e.next=6;break}return e.abrupt("return");case 6:return h=c.length>0?c[c.length-1].id:0,a.loading=!0,e.next=10,K.a.send({"@type":"searchChatMessages",chat_id:i,query:d,sender_user_id:0,from_message_id:h,offset:0,limit:p.ib,filter:r}).finally(()=>{a.loading=!1});case 10:if(u=e.sent,m=u.messages,a.items=c.concat(m.filter(t.isValidMessage)),a.completed=0===m.length||0===m.total_count,g=n&&m.length>0&&m.length<p.ib,t.searchParams===a){e.next=17;break}return e.abrupt("return");case 17:q.a.setItems(m),f=P.a.getStore(),Object(T.v)(f,m),t.setState({searchItems:a.items,searchMigratedItems:a.migratedItems}),a.completed?t.onSearchMigratedNext(a,!0):g&&t.onSearchNext(a,!1);case 22:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.onSearchMigratedNext=function(){var e=Object(i.a)(s.a.mark((function e(a,n=!0){var i,o,r,c,l,d,h,u,m,g,f;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.props.migratedChatId,o=a.filter,r=a.loading,c=a.migratedItems,l=a.migrateCompleted,d=a.query,i){e.next=4;break}return e.abrupt("return");case 4:if(!r){e.next=6;break}return e.abrupt("return");case 6:if(!l){e.next=8;break}return e.abrupt("return");case 8:return h=c.length>0?c[c.length-1].id:0,a.loading=!0,e.next=12,K.a.send({"@type":"searchChatMessages",chat_id:i,query:d,sender_user_id:0,from_message_id:h,offset:0,limit:p.ib,filter:o}).finally(()=>{a.loading=!1});case 12:if(u=e.sent,m=u.messages,a.migratedItems=c.concat(m.filter(t.isValidMessage)),a.migrateCompleted=0===m.length||0===m.total_count,g=n&&m.length>0&&m.length<p.ib,t.searchParams===a){e.next=19;break}return e.abrupt("return");case 19:q.a.setItems(m),f=P.a.getStore(),Object(T.v)(f,m),t.setState({searchItems:a.items,searchMigratedItems:a.migratedItems}),g&&t.onSearchMigratedNext(a,!1);case 24:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleSearch=function(){var e=Object(i.a)(s.a.mark((function e(a){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a?a.trim():""){e.next=4;break}return t.handleCloseSearch(),e.abrupt("return");case 4:t.searchParams={query:n,completed:!1,migrateCompleted:!1,items:[],migratedItems:[],filter:t.getSearchFilter()},t.onSearchNext(t.searchParams,!0);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleCloseSearch=()=>{this.searchParams=null,this.setState({searchItems:[],searchMigratedItems:[]})},this.isValidMessage=e=>!!e&&this.isValidContent(e.content),this.listRef=r.a.createRef(),this.searchListRef=r.a.createRef(),this.state={items:[],migratedItems:[],searchItems:[],searchMigratedItems:[]}}hasSearch(){return!0}isValidContent(e){throw new Error("Virtual method isValidContent is not implemented")}getItemTemplate(e){const t=this.props.migratedChatId,a=e.chat_id,n=e.id;return r.a.createElement(St,{key:"chat_id=".concat(a,"_message_id=").concat(n),chatId:a,messageId:n,showOpenMessage:a!==t})}getSearchFilter(){throw new Error("Virtual method getSearchFilter is not implemented")}getHeader(){throw new Error("Virtual method getHeader is not implemented")}componentDidMount(){this.loadContent(),q.a.on("updateDeleteMessages",this.onUpdateDeleteMessages),q.a.on("updateMessageContent",this.onUpdateMessageContent),q.a.on("updateNewMessage",this.onUpdateNewMessage)}componentWillUnmount(){q.a.off("updateDeleteMessages",this.onUpdateDeleteMessages),q.a.off("updateMessageContent",this.onUpdateMessageContent),q.a.off("updateNewMessage",this.onUpdateNewMessage)}render(){const e=this.props,t=e.minHeight,a=e.onClose,n=e.popup,s=this.state,i=s.items,o=s.migratedItems,c=s.searchItems,d=s.searchMigratedItems,h=this.searchParams,u=i.concat(o).map(e=>this.getItemTemplate(e)),p=c.concat(d).map(e=>this.getItemTemplate(e));return r.a.createElement(r.a.Fragment,null,r.a.createElement(wt,{title:this.getHeader(),onClick:this.handleHeaderClick,onClose:a,onSearch:this.hasSearch()?this.handleSearch:null,onCloseSearch:this.handleCloseSearch}),r.a.createElement("div",{ref:this.listRef,className:l()("shared-media-list",this.getListClassName()),onScroll:this.handleScroll,style:{minHeight:n?t:null}},u),Boolean(h)&&r.a.createElement("div",{ref:this.searchListRef,className:l()("shared-media-search-list",this.getSearchListClassName()),onScroll:this.handleSearchScroll},p))}}var xt=_t;a(434);class Ot extends xt{isValidContent(e){return e&&"messageAudio"===e["@type"]}getSearchFilter(){return{"@type":"searchMessagesFilterAudio"}}getHeader(){return(0,this.props.t)("AudioTitle")}}Ot.propTypes={chatId:mt.a.number.isRequired,migratedChatId:mt.a.number,onClose:mt.a.func.isRequired,popup:mt.a.bool,minHeight:mt.a.number},Ot.defaultProps={popup:!1,minHeight:0};var Tt=Object(f.d)()(Ot);a(435);class Lt extends xt{isValidContent(e){return e&&"messageDocument"===e["@type"]}getSearchFilter(){return{"@type":"searchMessagesFilterDocument"}}getHeader(){return(0,this.props.t)("DocumentsTitle")}}Lt.propTypes={chatId:mt.a.number.isRequired,migratedChatId:mt.a.number,onClose:mt.a.func.isRequired,popup:mt.a.bool,minHeight:mt.a.number},Lt.defaultProps={popup:!1,minHeight:0};var Pt=Object(f.d)()(Lt),Nt=a(300),Dt=a(304),jt=a(339);a(436);class Bt extends r.a.Component{constructor(...e){var t;super(...e),t=this,this.state={contextMenu:!1,left:0,top:0},this.handleOpenContextMenu=function(){var e=Object(i.a)(s.a.mark((function e(a){var n,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a&&(a.preventDefault(),a.stopPropagation()),t.state.contextMenu?t.setState({contextMenu:!1}):(n=a.clientX,i=a.clientY,t.setState({contextMenu:!0,left:n,top:i}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleCloseContextMenu=e=>{e&&e.stopPropagation(),this.setState({contextMenu:!1})}}isValidEntityType(e){return!!e&&("textEntityTypeUrl"===e.type["@type"]||"textEntityTypeTextUrl"===e.type["@type"]||"textEntityTypeEmailAddress"===e.type["@type"])}getTitleFromUrl(e){try{e=e.startsWith("http")?e:"http://"+e;const t=decodeURI(e),a=new URL(t).hostname.split("."),n=a.length>=2?a[a.length-2]:new URL(t).hostname;return jt.a.ToUnicode(n)}catch(t){console.error("url: "+e+"\n"+t)}return null}render(){const e=this.props,t=e.chatId,a=e.messageId,n=e.webPage,s=e.showOpenMessage,i=this.state,o=i.contextMenu,c=i.left,d=i.top,h=q.a.get(t,a);if(!h)return null;let u=null,p=n||{title:"",description:"",photo:null,url:""},m=p.display_url,g=p.description,f=p.photo,b=p.title,C=p.url;if(n)b=b||this.getTitleFromUrl(C),u=r.a.createElement(Dt.a,{className:"shared-link-url",url:C},m);else{const e=h.content.text;if(e){const t=e.entities;t&&t.length>0&&(u=t.filter(this.isValidEntityType).map(t=>{const a=Object(vt.P)(e.text,t.offset,t.offset+t.length);let n=a,s=!1;switch(t.type["@type"]){case"textEntityTypeTextUrl":{const e=t.type.url;e&&(n=e);break}case"textEntityTypeUrl":break;case"textEntityTypeEmailAddress":s=!0}return b=b||this.getTitleFromUrl(n)||" ",r.a.createElement(Dt.a,{className:"shared-link-url",url:n,mail:s},a)}))}}const y="tile_color_".concat(Math.abs(b.charCodeAt(0))%8+1);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"shared-link",onContextMenu:this.handleOpenContextMenu},r.a.createElement("div",{className:l()("shared-link-photo",y)},Object(Ae.f)(b),f&&r.a.createElement(Nt.a,{displaySize:90,chatId:t,messageId:a,photo:f,openMedia:vt.N,showProgress:!1,style:{width:48,height:48,position:"absolute",top:0,left:0}})),r.a.createElement("div",{className:"shared-link-content"},b&&r.a.createElement("div",{className:"web-page-title"},b),g&&r.a.createElement("div",{className:"web-page-description"},g),u)),r.a.createElement(yt,{chatId:t,messageId:a,anchorPosition:{top:d,left:c},open:o,showOpenMessage:s,onClose:this.handleCloseContextMenu}))}}var Rt=Bt;a(437);class Ft extends xt{isValidContent(e){if(!e)return!1;const t=e.web_page,a=e.text;if(t)return!0;if(!a)return!1;const n=a.entities;return!!n&&n.find(e=>"textEntityTypeUrl"===e.type["@type"]||"textEntityTypeTextUrl"===e.type["@type"]||"textEntityTypeEmailAddress"===e.type["@type"])}getSearchFilter(){return{"@type":"searchMessagesFilterUrl"}}getHeader(){return(0,this.props.t)("LinksTitle")}getItemTemplate(e){const t=this.props.migratedChatId,a=e.chat_id,n=e.content,s=e.id;return r.a.createElement(Rt,{key:"chat_id=".concat(a,"_message_id=").concat(s),chatId:a,messageId:s,webPage:n.web_page,openMedia:()=>Object(vt.N)(a,s,!1),showOpenMessage:a!==t})}}Ft.propTypes={chatId:mt.a.number.isRequired,migratedChatId:mt.a.number,onClose:mt.a.func.isRequired,popup:mt.a.bool,minHeight:mt.a.number},Ft.defaultProps={popup:!1,minHeight:0};var At=Object(f.d)()(Ft),Vt=a(581),zt=a(574);a(438);class Ht extends r.a.Component{constructor(e){super(e)}render(){const e=this.props.close;return r.a.createElement("div",{className:"header-master"},r.a.createElement(C.a,{className:"header-left-button",onClick:e},r.a.createElement(Te,null)),r.a.createElement("div",{className:"header-status grow cursor-pointer"},r.a.createElement("span",{className:"header-status-content"},"Shared Media")))}}var Wt=Ht;a(439);class Gt extends r.a.Component{constructor(...e){super(...e),this.state={value:0},this.handleChange=(e,t)=>{this.setState({value:t})}}render(){const e=this.props,t=e.onClose,a=e.popup,n=this.state.value,s=r.a.createElement(r.a.Fragment,null,r.a.createElement(Wt,{close:t}),r.a.createElement(Vt.a,{value:n,onChange:this.handleChange,indicatorColor:"primary",textColor:"primary",scrollable:!0,scrollButtons:"off",fullWidth:!0},r.a.createElement(zt.a,{label:"Media",style:{minWidth:"40px"}}),r.a.createElement(zt.a,{label:"Docs",style:{minWidth:"40px"}}),r.a.createElement(zt.a,{label:"Links",style:{minWidth:"40px"}}),r.a.createElement(zt.a,{label:"Audio",style:{minWidth:"40px"}})));return a?r.a.createElement(r.a.Fragment,null,s):r.a.createElement("div",{className:"shared-media"},s)}}Gt.defaultProps={popup:!1,minHeight:0};var Zt=Gt;a(440);class qt extends r.a.Component{constructor(e){var t;super(e),t=this,this.onClientUpdatePhotoBlob=e=>{const t=this.state,a=t.photoSize,n=t.thumbSize,s=e.fileId;(a&&a.photo&&a.photo.id===s||n&&n.photo&&n.photo.id===s)&&this.forceUpdate()},this.handleOpenContextMenu=function(){var e=Object(i.a)(s.a.mark((function e(a){var n,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a&&(a.preventDefault(),a.stopPropagation()),t.state.contextMenu?t.setState({contextMenu:!1}):(n=a.clientX,i=a.clientY,t.setState({contextMenu:!0,left:n,top:i}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleCloseContextMenu=e=>{e&&e.stopPropagation(),this.setState({contextMenu:!1})};const a=e.photo,n=e.size,o=e.thumbnailSize;this.state={contextMenu:!1,left:0,top:0,photoSize:Object(Ae.m)(a.sizes,n),thumbSize:Object(Ae.m)(a.sizes,o),minithumbnail:a.minithumbnail}}componentDidMount(){P.a.on("clientUpdatePhotoBlob",this.onClientUpdatePhotoBlob)}componentWillUnmount(){P.a.off("clientUpdatePhotoBlob",this.onClientUpdatePhotoBlob)}render(){const e=this.props,t=e.chatId,a=e.messageId,n=e.openMedia,s=e.showOpenMessage,i=e.style,o=this.state,c=o.minithumbnail,l=o.thumbSize,d=o.photoSize,h=o.contextMenu,u=o.left,p=o.top;if(!d)return null;const m=c?"data:image/jpeg;base64, "+c.data:null,g=Object(T.j)(l?l.photo:null),f=Object(T.j)(d.photo);m||Object(Et.k)(l);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"shared-photo",style:i,onClick:n,onContextMenu:this.handleOpenContextMenu},r.a.createElement("div",{className:"shared-photo-content",style:{backgroundImage:"url(".concat(g||m,")"),backgroundSize:"cover"}},f!==g&&r.a.createElement("div",{className:"shared-photo-main-content",style:{backgroundImage:"url(".concat(f,")")}}))),r.a.createElement(yt,{chatId:t,messageId:a,anchorPosition:{top:p,left:u},open:h,showOpenMessage:s,onClose:this.handleCloseContextMenu}))}}qt.defaultProps={size:p.F,thumbnailSize:p.G};var Kt=qt;a(441);class Yt extends xt{getListClassName(){return"shared-photos-list"}getSearchListClassName(){return"shared-photos-search-list"}isValidContent(e){return e&&"messagePhoto"===e["@type"]}getSearchFilter(){return{"@type":"searchMessagesFilterPhoto"}}getHeader(){return(0,this.props.t)("PhotosTitle")}getItemTemplate(e){const t=this.props.migratedChatId,a=e.chat_id,n=e.content,s=e.id;return r.a.createElement(Kt,{key:"chat_id=".concat(a,"_message_id=").concat(s),chatId:a,messageId:s,photo:n.photo,openMedia:()=>Object(vt.N)(a,s,!1),showOpenMessage:a!==t})}}Yt.propTypes={chatId:mt.a.number.isRequired,migratedChatId:mt.a.number,onClose:mt.a.func.isRequired,popup:mt.a.bool,minHeight:mt.a.number},Yt.defaultProps={popup:!1,minHeight:0};var Jt=Object(f.d)()(Yt);a(442);class Qt extends r.a.Component{constructor(...e){var t;super(...e),t=this,this.state={contextMenu:!1,left:0,top:0},this.onClientUpdateVideoThumbnailBlob=e=>{const t=this.props.video.thumbnail,a=e.fileId;t&&t.photo&&t.photo.id===a&&this.forceUpdate()},this.handleOpenContextMenu=function(){var e=Object(i.a)(s.a.mark((function e(a){var n,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a&&(a.preventDefault(),a.stopPropagation()),t.state.contextMenu?t.setState({contextMenu:!1}):(n=a.clientX,i=a.clientY,t.setState({contextMenu:!0,left:n,top:i}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleCloseContextMenu=e=>{e&&e.stopPropagation(),this.setState({contextMenu:!1})}}componentDidMount(){P.a.on("clientUpdateVideoThumbnailBlob",this.onClientUpdateVideoThumbnailBlob)}componentWillUnmount(){P.a.off("clientUpdateVideoThumbnailBlob",this.onClientUpdateVideoThumbnailBlob)}render(){const e=this.props,t=e.chatId,a=e.messageId,n=e.openMedia,s=e.style,i=e.showOpenMessage,o=this.props.video,c=o.minithumbnail,d=o.thumbnail,h=o.duration,u=this.state,m=u.contextMenu,g=u.left,f=u.top,b=c?"data:image/jpeg;base64, "+c.data:null,C=Object(T.j)(d?d.photo:null),y=C?Object(Et.k)(d,p.nb):Boolean(b);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"shared-photo",style:s,onClick:n,onContextMenu:this.handleOpenContextMenu},r.a.createElement("div",{className:"shared-video-wrapper"},r.a.createElement("div",{className:l()("shared-video-content",{"media-blurred":y,"media-mini-blurred":!C&&y}),style:{backgroundImage:"url(".concat(C||b,")")}}),r.a.createElement("div",{className:"shared-video-meta"},Object(Ae.e)(h)))),r.a.createElement(yt,{chatId:t,messageId:a,anchorPosition:{top:f,left:g},open:m,showOpenMessage:i,onClose:this.handleCloseContextMenu}))}}Qt.defaultProps={size:p.F,thumbnailSize:p.G};var Xt=Qt;a(443);class $t extends xt{getListClassName(){return"shared-photos-list"}getSearchListClassName(){return"shared-photos-search-list"}isValidContent(e){return e&&"messageVideo"===e["@type"]}getSearchFilter(){return{"@type":"searchMessagesFilterVideo"}}getHeader(){return(0,this.props.t)("VideosTitle")}getItemTemplate(e){const t=this.props.migratedChatId,a=e.chat_id,n=e.content,s=e.id;return r.a.createElement(Xt,{key:"chat_id=".concat(a,"_message_id=").concat(s),chatId:a,messageId:s,video:n.video,openMedia:()=>Object(vt.N)(a,s,!1),showOpenMessage:a!==t})}}$t.propTypes={chatId:mt.a.number.isRequired,migratedChatId:mt.a.number,onClose:mt.a.func.isRequired,popup:mt.a.bool,minHeight:mt.a.number},$t.defaultProps={popup:!1,minHeight:0};var ea=Object(f.d)()($t),ta=a(321),aa=a(324),na=a(307),sa=a(343);a(444);class ia extends r.a.Component{constructor(e){var t;super(e),t=this,this.handleOpenContextMenu=function(){var e=Object(i.a)(s.a.mark((function e(a){var n,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a&&(a.preventDefault(),a.stopPropagation()),t.state.contextMenu?t.setState({contextMenu:!1}):(n=a.clientX,i=a.clientY,t.setState({contextMenu:!0,left:n,top:i}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleCloseContextMenu=e=>{e&&e.stopPropagation(),this.setState({contextMenu:!1})},this.state={contextMenu:!1,left:0,top:0}}render(){const e=this.props,t=e.chatId,a=e.i18n,n=e.messageId,s=e.voiceNote,i=e.openMedia,o=e.showOpenMessage,c=this.state,l=c.contextMenu,d=c.left,h=c.top,u=q.a.get(t,n);if(!u)return null;if(!s)return null;const p=u.date,m=u.sender_user_id,g=new Date(1e3*p).toLocaleDateString([a.language],{day:"numeric",month:"short",year:"numeric",hour:"numeric",minute:"numeric",hour12:!1}),f=s.duration,b=s.voice;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"shared-voice-note",onContextMenu:this.handleOpenContextMenu},r.a.createElement(sa.a,{chatId:t,messageId:n,file:b,openMedia:i}),r.a.createElement("div",{className:"voice-note-content"},r.a.createElement(na.a,{chatId:t,messageId:n,userId:m}),r.a.createElement("div",{className:"voice-note-meta"},r.a.createElement(ta.a,{chatId:t,messageId:n,duration:f,file:b,title:"".concat(g,", ")}),r.a.createElement(aa.a,{chatId:t,messageId:n,icon:"\xa0\u2022"})))),r.a.createElement(yt,{chatId:t,messageId:n,anchorPosition:{top:h,left:d},open:l,showOpenMessage:o,onClose:this.handleCloseContextMenu}))}}var oa=Object(f.d)()(ia);a(445);class ra extends xt{isValidContent(e){return e&&"messageVoiceNote"===e["@type"]}getSearchFilter(){return{"@type":"searchMessagesFilterVoiceNote"}}getHeader(){return(0,this.props.t)("VoiceTitle")}hasSearch(){return!1}getItemTemplate(e){const t=this.props.migratedChatId,a=e.chat_id,n=e.content,s=e.id;return r.a.createElement(oa,{key:"chat_id=".concat(a,"_message_id=").concat(s),chatId:a,messageId:s,voiceNote:n.voice_note,openMedia:()=>Object(vt.N)(a,s,!1),showOpenMessage:a!==t})}}ra.propTypes={chatId:mt.a.number.isRequired,migratedChatId:mt.a.number,onClose:mt.a.func.isRequired,popup:mt.a.bool,minHeight:mt.a.number},ra.defaultProps={popup:!1,minHeight:0};var ca=Object(f.d)()(ra);a(446);class la extends r.a.Component{constructor(e){var t;super(e),t=this,this.onClientUpdateChatId=e=>{const t=this.props.popup,a=this.state.chatId;t||a!==e.nextChatId&&(this.sharedAudios=null,this.sharedDocuments=null,this.sharedLinks=null,this.sharedPhotos=null,this.sharedVideos=null,this.sharedVoiceNotes=null,this.setState({chatId:e.nextChatId,migratedChatId:0,userChatId:null,openGroupInCommon:!1,openSharedAudios:!1,openSharedDocuments:!1,openSharedLinks:!1,openSharedMedia:!1,openSharedPhotos:!1,openSharedVideos:!1,openSharedVoiceNotes:!1,counters:L.a.getCounters(e.nextChatId),migratedCounters:null}))},this.loadContent=e=>{this.loadChatCounters(e),this.loadMigratedCounters(e);const t=Object(w.D)(e);t&&Object(T.w)(e,[t])},this.loadChatCounters=function(){var e=Object(i.a)(s.a.mark((function e(a){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ze(a);case 2:if(n=e.sent,L.a.setCounters(a,n),a===t.state.chatId){e.next=6;break}return e.abrupt("return");case 6:t.setState({counters:n});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.loadMigratedCounters=function(){var e=Object(i.a)(s.a.mark((function e(a){var n,i,o,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(w.U)(a)){e.next=2;break}return e.abrupt("return");case 2:if(n=Ie.a.getFullInfo(Object(w.E)(a))){e.next=5;break}return e.abrupt("return");case 5:if(i=n.upgraded_from_basic_group_id){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,K.a.send({"@type":"createBasicGroupChat",basic_group_id:i,force:!0});case 10:if(o=e.sent){e.next=13;break}return e.abrupt("return");case 13:return e.next=15,Ze(o.id);case 15:if(r=e.sent,L.a.setCounters(o.id,r),t.state.chatId===a){e.next=19;break}return e.abrupt("return");case 19:t.setState({migratedChatId:o.id,migratedCounters:L.a.getCounters(o.id)});case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleOpenSharedMedia=()=>{this.setState({openSharedMedia:!0})},this.handleCloseSharedMedia=()=>{this.setState({openSharedMedia:!1})},this.handleOpenGroupInCommon=()=>{this.setState({openGroupInCommon:!0})},this.handleCloseGroupsInCommon=()=>{this.setState({openGroupInCommon:!1})},this.handleCloseChatDetails=()=>{const e=this.props.popup;this.state.userChatId?this.setState({userChatId:null}):e?K.a.clientUpdate({"@type":"clientUpdateDialogChatId",chatId:0}):Z.a.changeChatDetailsVisibility(!1)},this.handleOpenSharedDocuments=()=>{this.setState({openSharedDocuments:!0})},this.handleCloseSharedDocuments=()=>{this.setState({openSharedDocuments:!1})},this.handleOpenSharedAudios=()=>{this.setState({openSharedAudios:!0})},this.handleCloseSharedAudios=()=>{this.setState({openSharedAudios:!1})},this.handleOpenSharedVoiceNotes=()=>{this.setState({openSharedVoiceNotes:!0})},this.handleCloseSharedVoiceNotes=()=>{this.setState({openSharedVoiceNotes:!1})},this.handleOpenSharedLinks=()=>{this.setState({openSharedLinks:!0})},this.handleCloseSharedLinks=()=>{this.setState({openSharedLinks:!1})},this.handleOpenSharedPhotos=()=>{this.setState({openSharedPhotos:!0})},this.handleCloseSharedPhotos=()=>{this.setState({openSharedPhotos:!1})},this.handleOpenSharedVideos=()=>{this.setState({openSharedVideos:!0})},this.handleCloseSharedVideos=()=>{this.setState({openSharedVideos:!1})},this.detailsRef=r.a.createRef();const a=e.popup,n=Z.a.chatId,o=Z.a.dialogChatId;this.state={chatId:a?o:n,migratedChatId:0,userChatId:null,openGroupInCommon:!1,openSharedAudios:!1,openSharedDocuments:!1,openSharedLinks:!1,openSharedMedia:!1,openSharedPhotos:!1,openSharedVideos:!1,openSharedVoiceNotes:!1,counters:null,migratedCounters:null}}componentDidMount(){this.loadContent(this.state.chatId),Z.a.on("clientUpdateChatId",this.onClientUpdateChatId)}componentWillUnmount(){Z.a.off("clientUpdateChatId",this.onClientUpdateChatId)}componentDidUpdate(e,t,a){const n=this.state.chatId;n!==t.chatId&&this.loadContent(n)}render(){const e=this.props,t=(e.classes,e.className),a=e.popup,n=this.state,s=n.chatId,i=n.counters,o=n.migratedChatId,c=n.migratedCounters,d=n.userChatId,h=n.openSharedAudios,u=n.openSharedDocuments,p=n.openSharedLinks,m=n.openSharedMedia,g=n.openSharedPhotos,f=n.openSharedVideos,b=n.openSharedVoiceNotes,C=n.openGroupInCommon,y=s||d,v=this.detailsRef&&this.detailsRef.current?this.detailsRef.current.getContentHeight():0;let E=null;return m?E=r.a.createElement(Zt,{chatId:y,popup:a,minHeight:v,onClose:this.handleCloseSharedMedia}):h?(this.sharedAudios=this.sharedAudios||r.a.createElement(Tt,{chatId:y,migratedChatId:o,popup:a,minHeight:v,onClose:this.handleCloseSharedAudios}),E=this.sharedAudios):u?(this.sharedDocuments=this.sharedDocuments||r.a.createElement(Pt,{chatId:y,migratedChatId:o,popup:a,minHeight:v,onClose:this.handleCloseSharedDocuments}),E=this.sharedDocuments):p?(this.sharedLinks=this.sharedLinks||r.a.createElement(At,{chatId:y,migratedChatId:o,popup:a,minHeight:v,onClose:this.handleCloseSharedLinks}),E=this.sharedLinks):g?(this.sharedPhotos=this.sharedPhotos||r.a.createElement(Jt,{chatId:y,migratedChatId:o,popup:a,minHeight:v,onClose:this.handleCloseSharedPhotos}),E=this.sharedPhotos):f?(this.sharedVideos=this.sharedVideos||r.a.createElement(ea,{chatId:y,migratedChatId:o,popup:a,minHeight:v,onClose:this.handleCloseSharedVideos}),E=this.sharedVideos):b?(this.sharedVoiceNotes=this.sharedVoiceNotes||r.a.createElement(ca,{chatId:y,migratedChatId:o,popup:a,minHeight:v,onClose:this.handleCloseSharedVoiceNotes}),E=this.sharedVoiceNotes):E=C?r.a.createElement(ut,{chatId:y,popup:a,minHeight:v,onClose:this.handleCloseGroupsInCommon}):r.a.createElement(ct,{ref:this.detailsRef,chatId:y,popup:a,backButton:d===s,counters:i,migratedCounters:c,onOpenGroupInCommon:this.handleOpenGroupInCommon,onOpenSharedAudios:this.handleOpenSharedAudios,onOpenSharedDocuments:this.handleOpenSharedDocuments,onOpenSharedMedia:this.handleOpenSharedMedia,onOpenSharedLinks:this.handleOpenSharedLinks,onOpenSharedPhotos:this.handleOpenSharedPhotos,onOpenSharedVideos:this.handleOpenSharedVideos,onOpenSharedVoiceNotes:this.handleOpenSharedVoiceNotes,onClose:this.handleCloseChatDetails}),a?r.a.createElement(r.a.Fragment,null,E):r.a.createElement("div",{className:l()("chat-info",{"right-column":!a},t)},E)}}la.defaultProps={className:null,classes:null,popup:!1};var da=la,ha=a(448),ua=a.n(ha);a(447);class pa extends r.a.Component{constructor(...e){super(...e),this.handleSelect=e=>{0===e.button&&Object(G.g)()}}shouldComponentUpdate(e,t,a){const n=this.props,s=n.title,i=n.theme;return e.theme!==i||e.title!==s}render(){const e=this.props,t=e.t,a=e.title;return r.a.createElement("div",{ref:this.dialog,className:"dialog",onMouseDown:this.handleSelect,onContextMenu:this.handleContextMenu},r.a.createElement("div",{className:"dialog-wrapper"},r.a.createElement("div",{className:"chat-tile"},r.a.createElement("div",{className:"archive-tile-background tile-photo"},r.a.createElement("div",{className:"tile-saved-messages"},r.a.createElement(ua.a,{fontSize:"default"})))),r.a.createElement("div",{className:"dialog-inner-wrapper"},r.a.createElement("div",{className:"tile-first-row"},r.a.createElement("div",{className:"dialog-title"},r.a.createElement("span",{className:"dialog-title-span"},t("ArchivedChats")))),r.a.createElement("div",{className:"tile-second-row"},r.a.createElement("div",{className:"dialog-content"},a)))))}}Object(f.d)()(pa),a(449);class ma extends r.a.Component{constructor(...e){super(...e),this.onClientUpdateClearHistory=e=>{this.props.chatId===e.chatId&&(this.clearHistory=e.inProgress,this.forceUpdate())},this.onFastUpdatingComplete=e=>{this.forceUpdate()},this.onUpdate=e=>{this.props.chatId===e.chat_id&&this.forceUpdate()}}shouldComponentUpdate(e,t){const a=this.props,n=a.chatId,s=a.t;return e.chatId!==n||e.t!==s}componentDidMount(){L.a.on("clientUpdateFastUpdatingComplete",this.onFastUpdatingComplete),L.a.on("clientUpdateClearHistory",this.onClientUpdateClearHistory),L.a.on("updateChatDraftMessage",this.onUpdate),L.a.on("updateChatLastMessage",this.onUpdate),L.a.on("updateChatReadInbox",this.onUpdate),L.a.on("updateUserChatAction",this.onUpdate)}componentWillUnmount(){L.a.off("clientUpdateFastUpdatingComplete",this.onFastUpdatingComplete),L.a.off("clientUpdateClearHistory",this.onClientUpdateClearHistory),L.a.off("updateChatDraftMessage",this.onUpdate),L.a.off("updateChatLastMessage",this.onUpdate),L.a.off("updateChatReadInbox",this.onUpdate),L.a.off("updateUserChatAction",this.onUpdate)}render(){const e=this.props,t=e.chatId,a=e.t;if(this.clearHistory)return r.a.createElement("div",{className:"dialog-content"},"\xa0");const n=L.a.get(t);if(!n)return r.a.createElement("div",{className:"dialog-content"},"\xa0");let s=null;const i=Object(w.t)(t);if(i&&(s=r.a.createElement("span",{className:"dialog-content-accent"},i)),!s){const e=Object(w.k)(t);if(Object(w.V)(t)){const t=e.text||"\xa0";s=r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:"dialog-content-draft"},a("Draft")+": "),t)}}if(!s){const e=Object(w.x)(n,a)||"\xa0",t=Object(w.z)(n,a);s=r.a.createElement(r.a.Fragment,null,t&&r.a.createElement("span",{className:"dialog-content-accent"},t,": "),e)}return r.a.createElement("div",{className:"dialog-content"},s)}}var ga=Object(f.d)()(ma),fa=Object(S.a)(r.a.createElement("g",{strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.a.createElement("line",{x1:"10.5",y1:"13.5",x2:"7",y2:"17",id:"Path-51",strokeWidth:"1.66",strokeLinecap:"round"}),r.a.createElement("path",{d:"M15.2734195,6.29329584 L17.7068554,8.72673178 C18.0977149,9.11759123 18.0977149,9.7512996 17.7068554,10.142159 C17.6489915,10.200023 17.5842494,10.2505721 17.5140791,10.2926743 L15.0747102,11.7562956 C15.5465193,13.1717229 15.0755189,14.5863414 13.661709,16.0001513 L8,10.3384422 C9.41380985,8.92463237 10.8284284,8.45363199 12.2438557,8.92544107 L13.707477,6.48607217 C13.991869,6.01208547 14.6066564,5.85838861 15.0806431,6.14278063 C15.1508135,6.18488284 15.2155555,6.2354319 15.2734195,6.29329584 Z",strokeWidth:"1.66",strokeLinecap:"round",strokeLinejoin:"round"})),"Pin");a(450);class ba extends r.a.Component{constructor(...e){super(...e),this.onClientUpdateClearHistory=e=>{this.props.chatId===e.chatId&&(this.clearHistory=e.inProgress,this.forceUpdate())},this.onFastUpdatingComplete=e=>{this.forceUpdate()},this.onUpdate=e=>{const t=this.props.chatId;e.chat_id===t&&this.forceUpdate()},this.onUpdateScopeNotificationSettings=e=>{const t=this.props.chatId,a=L.a.get(t);if(a)switch(e.scope["@type"]){case"notificationSettingsScopeGroupChats":"chatTypeBasicGroup"!==a.type["@type"]&&"chatTypeSupergroup"!==a.type["@type"]||this.forceUpdate();break;case"notificationSettingsScopePrivateChats":"chatTypePrivate"!==a.type["@type"]&&"chatTypeSecret"!==a.type["@type"]||this.forceUpdate()}}}shouldComponentUpdate(e,t){const a=this.props.chatId;return e.chatId!==a}componentDidMount(){L.a.on("clientUpdateFastUpdatingComplete",this.onFastUpdatingComplete),L.a.on("clientUpdateClearHistory",this.onClientUpdateClearHistory),L.a.on("updateChatDraftMessage",this.onUpdate),L.a.on("updateChatIsMarkedAsUnread",this.onUpdate),L.a.on("updateChatIsPinned",this.onUpdate),L.a.on("updateChatNotificationSettings",this.onUpdate),L.a.on("updateChatReadInbox",this.onUpdate),L.a.on("updateChatLastMessage",this.onUpdate),L.a.on("updateChatReadOutbox",this.onUpdate),L.a.on("updateChatUnreadMentionCount",this.onUpdate),L.a.on("updateMessageMentionRead",this.onUpdate),Ke.a.on("updateScopeNotificationSettings",this.onUpdateScopeNotificationSettings)}componentWillUnmount(){L.a.off("clientUpdateFastUpdatingComplete",this.onFastUpdatingComplete),L.a.off("clientUpdateClearHistory",this.onClientUpdateClearHistory),L.a.off("updateChatDraftMessage",this.onUpdate),L.a.off("updateChatIsMarkedAsUnread",this.onUpdate),L.a.off("updateChatIsPinned",this.onUpdate),L.a.off("updateChatNotificationSettings",this.onUpdate),L.a.off("updateChatReadInbox",this.onUpdate),L.a.off("updateChatLastMessage",this.onUpdate),L.a.off("updateChatReadOutbox",this.onUpdate),L.a.off("updateChatUnreadMentionCount",this.onUpdate),L.a.off("updateMessageMentionRead",this.onUpdate),Ke.a.off("updateScopeNotificationSettings",this.onUpdateScopeNotificationSettings)}render(){if(this.clearHistory)return null;const e=this.props.chatId,t=L.a.get(e);if(!t)return null;const a=t.is_pinned,n=t.unread_count,s=Object(w.X)(e),i=Object(w.W)(e),o=Object(w.M)(e);return r.a.createElement(r.a.Fragment,null,!1,s&&r.a.createElement("div",{className:"dialog-badge"},r.a.createElement("div",{className:"dialog-badge-mention"},"@")),i&&r.a.createElement("div",{className:l()({"dialog-badge-muted":o},"dialog-badge")},r.a.createElement("span",{className:"dialog-badge-text"},n>0?n:"")),a&&!i&&!s&&r.a.createElement("div",{className:"dialog-badge-pinned"},r.a.createElement(fa,{className:"dialog-badge-pinned-icon"})))}}var Ca=ba,ya=Object(S.a)(r.a.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.a.createElement("g",{transform:"translate(-3.000000, 0.000000)",fill:"#E53935",fillRule:"nonzero"},r.a.createElement("path",{d:"M10,0.4 C13.6450793,0.4 16.6,3.35492065 16.6,7 C16.6,10.6450793 13.6450793,13.6 10,13.6 C6.35492065,13.6 3.4,10.6450793 3.4,7 C3.4,3.35492065 6.35492065,0.4 10,0.4 Z M10,9.25 C9.58578644,9.25 9.25,9.58578644 9.25,10 C9.25,10.4142136 9.58578644,10.75 10,10.75 C10.4142136,10.75 10.75,10.4142136 10.75,10 C10.75,9.58578644 10.4142136,9.25 10,9.25 Z M10,2.85 C9.64101491,2.85 9.35,3.14101491 9.35,3.5 L9.35,7.5 C9.35,7.85898509 9.64101491,8.15 10,8.15 C10.3589851,8.15 10.65,7.85898509 10.65,7.5 L10.65,3.5 C10.65,3.14101491 10.3589851,2.85 10,2.85 Z"}))),"Error"),va=Object(S.a)(r.a.createElement("g",{strokeWidth:"1",fill:"none",fillRule:"evenodd",strokeLinecap:"round",strokeLinejoin:"round"},r.a.createElement("g",{transform:"translate(-3.000000, 0.000000)"},r.a.createElement("circle",{strokeWidth:"1.2",cx:"10",cy:"7",r:"6"}),r.a.createElement("line",{x1:"10",y1:"3.5",x2:"10",y2:"7",strokeWidth:"1.3"}),r.a.createElement("line",{x1:"12",y1:"9",x2:"10",y2:"7",strokeWidth:"1.3"}))),"Pending"),Ea=Object(S.a)(r.a.createElement("path",{transform:"translate(-4.000000, -2.000000)",d:"M7.96833846,10.0490996 L14.5108251,2.571972 C14.7472185,2.30180819 15.1578642,2.27443181 15.428028,2.51082515 C15.6711754,2.72357915 15.717665,3.07747757 15.5522007,3.34307913 L15.4891749,3.428028 L8.48917485,11.428028 C8.2663359,11.6827011 7.89144111,11.7199091 7.62486888,11.5309823 L7.54038059,11.4596194 L4.54038059,8.45961941 C4.2865398,8.20577862 4.2865398,7.79422138 4.54038059,7.54038059 C4.7688373,7.31192388 5.12504434,7.28907821 5.37905111,7.47184358 L5.45961941,7.54038059 L7.96833846,10.0490996 L14.5108251,2.571972 L7.96833846,10.0490996 Z"}),"Sent"),Ua=Object(S.a)(r.a.createElement("path",{transform:"translate(-1.000000, -2.000000)",d:"M4.96833846,10.0490996 L11.5108251,2.571972 C11.7472185,2.30180819 12.1578642,2.27443181 12.428028,2.51082515 C12.6711754,2.72357915 12.717665,3.07747757 12.5522007,3.34307913 L12.4891749,3.428028 L5.48917485,11.428028 C5.2663359,11.6827011 4.89144111,11.7199091 4.62486888,11.5309823 L4.54038059,11.4596194 L1.54038059,8.45961941 C1.2865398,8.20577862 1.2865398,7.79422138 1.54038059,7.54038059 C1.7688373,7.31192388 2.12504434,7.28907821 2.37905111,7.47184358 L2.45961941,7.54038059 L4.96833846,10.0490996 L11.5108251,2.571972 L4.96833846,10.0490996 Z M9.96833846,10.0490996 L16.5108251,2.571972 C16.7472185,2.30180819 17.1578642,2.27443181 17.428028,2.51082515 C17.6711754,2.72357915 17.717665,3.07747757 17.5522007,3.34307913 L17.4891749,3.428028 L10.4891749,11.428028 C10.2663359,11.6827011 9.89144111,11.7199091 9.62486888,11.5309823 L9.54038059,11.4596194 L8.54038059,10.4596194 C8.2865398,10.2057786 8.2865398,9.79422138 8.54038059,9.54038059 C8.7688373,9.31192388 9.12504434,9.28907821 9.37905111,9.47184358 L9.45961941,9.54038059 L9.96833846,10.0490996 L16.5108251,2.571972 L9.96833846,10.0490996 Z"}),"Succeeded");a(451);class Sa extends r.a.Component{constructor(...e){super(...e),this.state={},this.onUpdateMessageSend=e=>{const t=this.props,a=t.chatId,n=t.messageId,s=e.old_message_id,i=e.message;if(n!==s)return;if(!i)return;const o=i.chat_id,r=i.id,c=i.sending_state;a===o&&(this.newMessageId=r,this.setState({sendingState:c}))},this.onUpdateChatReadOutbox=e=>{const t=this.props,a=t.chatId,n=t.messageId,s=e.chat_id,i=e.last_read_outbox_message_id,o=this.newMessageId;a===s&&(o&&o<=i||n<=i)&&this.setState({sendingState:null,unread:!1})}}static getDerivedStateFromProps(e,t){const a=e.chatId,n=e.messageId,s=q.a.get(a,n),i=s?s.sending_state:null;return a!==t.prevChatId||n!==t.prevMessageId?{prevChatId:a,prevMessageId:n,sendingState:i,unread:Object(vt.I)(a,n)}:null}componentDidMount(){L.a.on("updateChatReadOutbox",this.onUpdateChatReadOutbox),q.a.on("updateMessageSendFailed",this.onUpdateMessageSend),q.a.on("updateMessageSendSucceeded",this.onUpdateMessageSend)}componentWillUnmount(){L.a.off("updateChatReadOutbox",this.onUpdateChatReadOutbox),q.a.off("updateMessageSendFailed",this.onUpdateMessageSend),q.a.off("updateMessageSendSucceeded",this.onUpdateMessageSend)}render(){const e=this.state,t=e.sendingState;return e.unread?t?"messageSendingStateFailed"===t["@type"]?r.a.createElement(ya,{className:"status",viewBox:"0 0 14 14",style:{width:16,height:12,transform:"translate(0, 1px)"}}):r.a.createElement(va,{className:"status",viewBox:"0 0 14 14",style:{width:16,height:12,transform:"translate(0, 1px)",stroke:"currentColor"}}):r.a.createElement(Ea,{className:"status",viewBox:"0 0 12 10",style:{width:16,height:9}}):r.a.createElement(Ua,{className:"status",viewBox:"0 0 17 10",style:{width:16,height:9}})}}var ka=Sa;a(452);class Ma extends r.a.Component{constructor(...e){super(...e),this.onClientUpdateClearHistory=e=>{this.props.chatId===e.chatId&&(this.clearHistory=e.inProgress,this.forceUpdate())},this.onFastUpdatingComplete=e=>{this.forceUpdate()},this.onUpdate=e=>{this.props.chatId===e.chat_id&&this.forceUpdate()}}shouldComponentUpdate(e,t){const a=this.props.chatId;return e.chatId!==a}componentDidMount(){L.a.on("clientUpdateFastUpdatingComplete",this.onFastUpdatingComplete),L.a.on("clientUpdateClearHistory",this.onClientUpdateClearHistory),L.a.on("updateChatDraftMessage",this.onUpdate),L.a.on("updateChatLastMessage",this.onUpdate),L.a.on("updateChatReadInbox",this.onUpdate),L.a.on("updateChatUnreadMentionCount",this.onUpdate),L.a.on("updateMessageMentionRead",this.onUpdate)}componentWillUnmount(){L.a.off("clientUpdateFastUpdatingComplete",this.onFastUpdatingComplete),L.a.off("clientUpdateClearHistory",this.onClientUpdateClearHistory),L.a.off("updateChatDraftMessage",this.onUpdate),L.a.off("updateChatLastMessage",this.onUpdate),L.a.off("updateChatReadInbox",this.onUpdate),L.a.off("updateChatUnreadMentionCount",this.onUpdate),L.a.off("updateMessageMentionRead",this.onUpdate)}render(){if(this.clearHistory)return null;const e=this.props.chatId,t=L.a.get(e);if(!t)return null;const a=t.last_message;if(!a)return null;const n=Object(w.y)(t);if(!n)return null;const s=a.id,i=a.is_outgoing;return r.a.createElement("div",{className:"dialog-meta"},i&&r.a.createElement(r.a.Fragment,null,r.a.createElement(ka,{chatId:e,messageId:s}),r.a.createElement("span",null," ")),n)}}var Ia=Ma,wa=Object(S.a)(r.a.createElement("path",{d:"M16.5,1 C17.7590292,1 18.9445825,1.59277663 19.7,2.6 L19.7,2.6 L21.2,4.6 C21.7192885,5.29238468 22,6.13451915 22,7 L22,7 L22,8 C22,8.11615513 21.980196,8.22768478 21.9437804,8.33139667 C21.9809544,8.54881122 22,8.77218145 22,9 L22,18 C22,20.209139 20.209139,22 18,22 L6,22 C3.790861,22 2,20.209139 2,18 L2,9 C2,8.77218145 2.01904557,8.54881122 2.05563136,8.33139468 C2.01980398,8.22768478 2,8.11615513 2,8 L2,8 L2,7 C2,6.13451915 2.28071149,5.29238468 2.8,4.6 L2.8,4.6 L4.3,2.6 C5.05541753,1.59277663 6.24097079,1 7.5,1 L7.5,1 Z M18,7 L6,7 C4.8954305,7 4,7.8954305 4,9 L4,18 C4,19.1045695 4.8954305,20 6,20 L18,20 C19.1045695,20 20,19.1045695 20,18 L20,9 C20,7.8954305 19.1045695,7 18,7 Z M8.29289322,11.2928932 C8.68341751,10.9023689 9.31658249,10.9023689 9.70710678,11.2928932 L9.70710678,11.2928932 L12,13.5857864 L14.2928932,11.2928932 C14.6834175,10.9023689 15.3165825,10.9023689 15.7071068,11.2928932 C16.0976311,11.6834175 16.0976311,12.3165825 15.7071068,12.7071068 L15.7071068,12.7071068 L12.7071068,15.7071068 C12.3165825,16.0976311 11.6834175,16.0976311 11.2928932,15.7071068 L11.2928932,15.7071068 L8.29289322,12.7071068 C7.90236893,12.3165825 7.90236893,11.6834175 8.29289322,11.2928932 Z M16.5,3 L7.5,3 C6.87048539,3 6.27770876,3.29638831 5.9,3.8 L5.9,3.8 L4.88040369,5.15879948 C5.23567546,5.05542416 5.61136523,5 6,5 L18,5 C18.3882729,5 18.7636249,5.055321 19.1186039,5.15851085 L18.1,3.8 C17.7222912,3.29638831 17.1295146,3 16.5,3 L16.5,3 Z"}),"Archive"),_a=Object(S.a)(r.a.createElement("path",{d:"M16.5,1 C17.7590292,1 18.9445825,1.59277663 19.7,2.6 L19.7,2.6 L21.2,4.6 C21.7192885,5.29238468 22,6.13451915 22,7 L22,7 L22,8 C22,8.11615513 21.980196,8.22768478 21.9437804,8.33139667 C21.9809544,8.54881122 22,8.77218145 22,9 L22,18 C22,20.209139 20.209139,22 18,22 L6,22 C3.790861,22 2,20.209139 2,18 L2,9 C2,8.77218145 2.01904557,8.54881122 2.05563136,8.33139468 C2.01980398,8.22768478 2,8.11615513 2,8 L2,8 L2,7 C2,6.13451915 2.28071149,5.29238468 2.8,4.6 L2.8,4.6 L4.3,2.6 C5.05541753,1.59277663 6.24097079,1 7.5,1 L7.5,1 Z M18,7 L6,7 C4.8954305,7 4,7.8954305 4,9 L4,18 C4,19.1045695 4.8954305,20 6,20 L18,20 C19.1045695,20 20,19.1045695 20,18 L20,9 C20,7.8954305 19.1045695,7 18,7 Z M12.7071068,10.7928932 L15.7071068,13.7928932 C16.0976311,14.1834175 16.0976311,14.8165825 15.7071068,15.2071068 C15.3165825,15.5976311 14.6834175,15.5976311 14.2928932,15.2071068 L12,12.9142136 L9.70710678,15.2071068 C9.31658249,15.5976311 8.68341751,15.5976311 8.29289322,15.2071068 C7.90236893,14.8165825 7.90236893,14.1834175 8.29289322,13.7928932 L11.2928932,10.7928932 C11.6834175,10.4023689 12.3165825,10.4023689 12.7071068,10.7928932 Z M16.5,3 L7.5,3 C6.87048539,3 6.27770876,3.29638831 5.9,3.8 L5.9,3.8 L4.88040369,5.15879948 C5.23567546,5.05542416 5.61136523,5 6,5 L18,5 C18.3882729,5 18.7636249,5.055321 19.1186039,5.15851085 L18.1,3.8 C17.7222912,3.29638831 17.1295146,3 16.5,3 L16.5,3 Z"}),"Unarchive"),xa=Object(S.a)(r.a.createElement("path",{d:"M18.1483713,2 L18.2928313,2.00686658 C19.0534832,2.07955132 19.6483713,2.72030388 19.6483713,3.5 C19.6483713,3.93788733 19.4570272,4.35391161 19.1245584,4.6388849 L16.9591265,6.49496934 L16.5350978,11.1592857 L19.5076921,14.5034542 C20.0580691,15.1226284 20.002298,16.070737 19.3831238,16.621114 C19.1085471,16.8651821 18.7539493,17 18.3865781,17 L12.9994219,17 L13,22 C13,22.5128358 12.6139598,22.9355072 12.1166211,22.9932723 L12,23 C11.4477153,23 11,22.5522847 11,22 L11,22 L10.9994219,17 L5.61342192,17 C4.7849948,17 4.11342192,16.3284271 4.11342192,15.5 C4.11342192,15.1326288 4.24823977,14.7780309 4.49230794,14.5034542 L7.46490224,11.1592857 L7.04087348,6.49496934 L4.87544164,4.6388849 C4.24645288,4.09975168 4.17361057,3.1528017 4.7127438,2.52381294 C4.9977171,2.19134409 5.41374137,2 5.8516287,2 L18.1483713,2 Z M16.7967426,4 L7.20325741,4 L8.34245623,4.97645613 C8.73788815,5.31539777 8.98550756,5.79522213 9.0326599,6.31389784 L9.45668865,10.9782142 C9.50671685,11.5285243 9.32683472,12.0750103 8.95972088,12.4880133 L6.72684384,15 L17.2731562,15 L15.0402791,12.4880133 C14.6731653,12.0750103 14.4932831,11.5285243 14.5433113,10.9782142 L14.9673401,6.31389784 C15.0144924,5.79522213 15.2621119,5.31539777 15.6575438,4.97645613 L16.7967426,4 Z"}),"Pin2"),Oa=Object(S.a)(r.a.createElement("path",{d:"M13,20 C13.5522847,20 14,20.4477153 14,21 C14,21.5522847 13.5522847,22 13,22 L13,22 L11,22 C10.4477153,22 10,21.5522847 10,21 C10,20.4477153 10.4477153,20 11,20 L11,20 Z M3.30352462,2.28241931 C3.6998335,1.89776658 4.33292796,1.90721575 4.71758069,2.30352462 L4.71758069,2.30352462 L21.2175807,19.3035246 C21.6022334,19.6998335 21.5927842,20.332928 21.1964754,20.7175807 C20.8001665,21.1022334 20.167072,21.0927842 19.7824193,20.6964754 L19.7824193,20.6964754 L18.127874,18.9919007 C18.1241295,18.9923786 18.1203785,18.9928359 18.1166211,18.9932723 L18,19 L4,19 C3.23933773,19 2.77101468,18.1926118 3.11084891,17.5416503 L3.16794971,17.4452998 L5,14.6972244 L5,9 C5,7.98873702 5.21529462,7.00715088 5.62359521,6.10821117 L3.28241931,3.69647538 C2.89776658,3.3001665 2.90721575,2.66707204 3.30352462,2.28241931 Z M7.00817933,8.71121787 L7,9 L7,14.6972244 C7,15.0356672 6.91413188,15.3676193 6.75167088,15.6624466 L6.66410059,15.8066248 L5.86851709,17 L16.1953186,16.9999993 L7.16961011,7.7028948 C7.08210009,8.02986218 7.02771758,8.36725335 7.00817933,8.71121787 Z M12,2 C15.7854517,2 18.8690987,5.00478338 18.995941,8.75935025 L19,9 L19,12 C19,12.5522847 18.5522847,13 18,13 C17.4871642,13 17.0644928,12.6139598 17.0067277,12.1166211 L17,12 L17,9 C17,6.23857625 14.7614237,4 12,4 C11.3902636,4 10.7970241,4.10872043 10.239851,4.31831953 C9.72293204,4.51277572 9.14624852,4.25136798 8.95179232,3.734449 C8.75733613,3.21753002 9.01874387,2.6408465 9.53566285,2.4463903 C10.3171048,2.15242503 11.1488212,2 12,2 Z"}),"Mute"),Ta=Object(S.a)(r.a.createElement("path",{d:"M13,20 C13.5522847,20 14,20.4477153 14,21 C14,21.5522847 13.5522847,22 13,22 L13,22 L11,22 C10.4477153,22 10,21.5522847 10,21 C10,20.4477153 10.4477153,20 11,20 L11,20 Z M12,2 C15.8659932,2 19,5.13400675 19,9 L19,14.6972244 L20.8320503,17.4452998 C21.2750868,18.1098545 20.7986954,19 20,19 L4,19 C3.20130462,19 2.72491322,18.1098545 3.16794971,17.4452998 L5,14.6972244 L5,9 C5,5.13400675 8.13400675,2 12,2 Z M12,4 C9.23857625,4 7,6.23857625 7,9 L7,14.6972244 C7,15.0920743 6.88312395,15.4780897 6.66410059,15.8066248 L5.86851709,17 L18.1314829,17 L17.3358994,15.8066248 C17.1168761,15.4780897 17,15.0920743 17,14.6972244 L17,9 C17,6.23857625 14.7614237,4 12,4 Z"}),"Unmute"),La=Object(S.a)(r.a.createElement("path",{d:"M12,12 C15.9072418,12 18.715318,13.0364023 20.3351717,15.1788288 C20.7665758,15.7493929 21,16.4451545 21,17.1604559 L21,18.2857143 C21,19.7847729 19.7847729,21 18.2857143,21 L5.71428571,21 C4.21522711,21 3,19.7847729 3,18.2857143 L3,17.160494 C3,16.445199 3.23340019,15.7494497 3.66478123,15.178891 C5.28463457,13.0364199 8.09272555,12 12,12 Z M12,14 C8.66170181,14 6.44476079,14.8182362 5.26012276,16.3850773 C5.09133017,16.6083279 5,16.8805766 5,17.160494 L5,18.2857143 C5,18.6802034 5.31979661,19 5.71428571,19 L18.2857143,19 C18.6802034,19 19,18.6802034 19,18.2857143 L19,17.1604559 C19,16.8805572 18.9086617,16.6083073 18.7398491,16.38504 C17.5552048,14.8182236 15.3382718,14 12,14 Z M12,2 C14.209139,2 16,3.790861 16,6 C16,8.209139 14.209139,10 12,10 C9.790861,10 8,8.209139 8,6 C8,3.790861 9.790861,2 12,2 Z M12,4 C10.8954305,4 10,4.8954305 10,6 C10,7.1045695 10.8954305,8 12,8 C13.1045695,8 14,7.1045695 14,6 C14,4.8954305 13.1045695,4 12,4 Z"}),"User"),Pa=Object(S.a)(r.a.createElement("path",{d:"M8,13 C11.3229116,13 13.7530244,13.8337117 15.2223821,15.5699359 C15.724477,16.1632234 16,16.915291 16,17.6925226 L16,18.5 C16,19.8807119 14.8807119,21 13.5,21 L2.5,21 C1.11928813,21 0,19.8807119 0,18.5 L0,17.6925204 C0,16.9152876 0.275524605,16.1632192 0.777621166,15.569932 C2.24697824,13.8337108 4.67709024,13 8,13 Z M17.9515112,14.0335753 L18.0683205,14.0347288 C20.2213596,14.1802785 21.8813904,14.7876525 23.0130897,15.8958397 C23.5916808,16.4623828 23.9388003,17.2206225 23.9926356,18.0235027 L24,18.2434663 L24,18.75 C24,19.940864 23.0748384,20.9156449 21.9040488,20.9948092 L21.75,21 L19,21 C18.4477153,21 18,20.5522847 18,20 C18,19.4871642 18.3860402,19.0644928 18.8833789,19.0067277 L19,19 L21.75,19 C21.8683467,19 21.9674868,18.9177666 21.9933973,18.8073227 L22,18.75 L22,18.2434663 C22,17.8977921 21.8608093,17.5666871 21.6138154,17.3248364 C20.8641159,16.5907126 19.6490875,16.1461566 17.9334244,16.0301743 C17.3823973,15.9929238 16.9658991,15.5160306 17.0031496,14.9650035 C17.0377394,14.4533355 17.4514089,14.0576643 17.9515112,14.0335753 L17.9515112,14.0335753 Z M8,15 C5.21130036,15 3.33538166,15.6435809 2.30428673,16.861943 C2.10781409,17.0940989 2,17.3883868 2,17.6925212 L2,18.5 C2,18.7761424 2.22385763,19 2.5,19 L13.5,19 C13.7761424,19 14,18.7761424 14,18.5 L14,17.6925226 C14,17.3883883 13.8921864,17.0941004 13.6957148,16.8619448 C12.6646202,15.6435815 10.788701,15 8,15 Z M17,5 C18.9329966,5 20.5,6.56700338 20.5,8.5 C20.5,10.4329966 18.9329966,12 17,12 C15.0670034,12 13.5,10.4329966 13.5,8.5 C13.5,6.56700338 15.0670034,5 17,5 Z M8,3 C10.209139,3 12,4.790861 12,7 C12,9.209139 10.209139,11 8,11 C5.790861,11 4,9.209139 4,7 C4,4.790861 5.790861,3 8,3 Z M17,7 C16.1715729,7 15.5,7.67157288 15.5,8.5 C15.5,9.32842712 16.1715729,10 17,10 C17.8284271,10 18.5,9.32842712 18.5,8.5 C18.5,7.67157288 17.8284271,7 17,7 Z M8,5 C6.8954305,5 6,5.8954305 6,7 C6,8.1045695 6.8954305,9 8,9 C9.1045695,9 10,8.1045695 10,7 C10,5.8954305 9.1045695,5 8,5 Z"}),"Group"),Na=Object(S.a)(r.a.createElement("path",{d:"M7.41421356,19 L3.87781746,22.5363961 C3.44824074,22.9659728 2.75175926,22.9659728 2.32218254,22.5363961 C2.11589252,22.3301061 2,22.0503168 2,21.7585786 L2,6 C2,3.790861 3.790861,2 6,2 L18,2 C20.209139,2 22,3.790861 22,6 L22,15 C22,17.209139 20.209139,19 18,19 L7.41421356,19 Z M4,19.5857864 L6.20502525,17.3807612 C6.44882255,17.1369639 6.77948263,17 7.12426407,17 L18,17 C19.1045695,17 20,16.1045695 20,15 L20,6 C20,4.8954305 19.1045695,4 18,4 L6,4 C4.8954305,4 4,4.8954305 4,6 L4,19.5857864 Z"}),"Message"),Da=Object(S.a)(r.a.createElement("path",{d:"M6,2 L18,2 C20.1421954,2 21.8910789,3.68396847 21.9951047,5.80035966 L22,6 L22,10 C22,10.5522847 21.5522847,11 21,11 C20.4871642,11 20.0644928,10.6139598 20.0067277,10.1166211 L20,10 L20,6 C20,4.9456382 19.1841222,4.08183488 18.1492623,4.00548574 L18,4 L6,4 C4.9456382,4 4.08183488,4.81587779 4.00548574,5.85073766 L4,6 L4,19.5857864 L6.20502525,17.3807612 C6.41399436,17.1717921 6.68678103,17.0413128 6.97757724,17.0082977 L7.12426407,17 L13,17 C13.5522847,17 14,17.4477153 14,18 C14,18.5128358 13.6139598,18.9355072 13.1166211,18.9932723 L13,19 L7.41421356,19 L3.87781746,22.5363961 C3.44824074,22.9659728 2.75175926,22.9659728 2.32218254,22.5363961 C2.14536253,22.3595761 2.034957,22.1287566 2.00702113,21.8826983 L2,21.7585786 L2,6 C2,3.85780461 3.68396847,2.10892112 5.80035966,2.00489531 L6,2 L18,2 L6,2 Z M19,12 C21.209139,12 23,13.790861 23,16 C23,18.209139 21.209139,20 19,20 C16.790861,20 15,18.209139 15,16 C15,13.790861 16.790861,12 19,12 Z M19,14 C17.8954305,14 17,14.8954305 17,16 C17,17.1045695 17.8954305,18 19,18 C20.1045695,18 21,17.1045695 21,16 C21,14.8954305 20.1045695,14 19,14 Z"}),"Unread");a(453);class ja extends o.Component{constructor(e){var t;super(e),t=this,this.onClientUpdateChatId=e=>{const t=this.props.chatId;t!==e.previousChatId&&t!==e.nextChatId||this.forceUpdate()},this.handleSelect=e=>{0===e.button&&Object(G.h)(this.props.chatId)},this.handleContextMenu=function(){var e=Object(i.a)(s.a.mark((function e(a){var n,i,o,r,c,l,d,h;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a&&(a.preventDefault(),a.stopPropagation()),n=t.props.chatId,!t.state.contextMenu){e.next=7;break}t.setState({contextMenu:!1}),e.next=23;break;case 7:return i=new Date,ja.contextMenuId=i,o=a.clientX,r=a.clientY,c=L.a.get(n),l=c.is_pinned,e.next=15,t.canPinChats(n);case 15:if(e.t0=e.sent,e.t0){e.next=18;break}e.t0=l;case 18:if(d=e.t0,h=Object(w.g)(n),ja.contextMenuId===i){e.next=22;break}return e.abrupt("return");case 22:t.setState({contextMenu:!0,canTogglePin:d,canToggleArchive:h,left:o,top:r});case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleCloseContextMenu=e=>{e&&e.stopPropagation(),this.setState({contextMenu:!1})},this.handleMute=e=>{this.handleCloseContextMenu(e);const t=this.props.chatId;Ge(t,!Object(w.M)(t))},this.canPinChats=function(){var e=Object(i.a)(s.a.mark((function e(t){var a,n,i,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=Object(w.K)(t)?F.a.get("pinned_archived_chat_count_max"):F.a.get("pinned_chat_count_max")){e.next=3;break}return e.abrupt("return",!1);case 3:return n=Object(w.N)(t),e.next=6,K.a.send({"@type":"getChats",chat_list:Object(w.K)(t)?{"@type":"chatListArchive"}:{"@type":"chatListMain"},offset_order:"9223372036854775807",offset_chat_id:0,limit:a.value+10});case 6:return i=e.sent,o=i.chat_ids.reduce((e,t)=>{if(Object(w.N)(t)!==n)return e;const a=L.a.get(t);return e+(a&&a.is_pinned?1:0)},0),e.abrupt("return",o<a.value);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handlePin=function(){var e=Object(i.a)(s.a.mark((function e(a){var n,i,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.handleCloseContextMenu(a),n=t.props.chatId,i=L.a.get(n)){e.next=5;break}return e.abrupt("return");case 5:if((o=i.is_pinned)||t.canPinChats(n)){e.next=8;break}return e.abrupt("return");case 8:He(n,!o);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleArchive=function(){var e=Object(i.a)(s.a.mark((function e(a){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.handleCloseContextMenu(a),n=t.props.chatId,Object(w.g)(n)){e.next=4;break}return e.abrupt("return");case 4:ze(n,{"@type":Object(w.K)(n)?"chatListMain":"chatListArchive"});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getViewInfoTitle=()=>{const e=this.props,t=e.chatId,a=e.t,n=L.a.get(t);if(!n)return;const s=n.type;switch(s["@type"]){case"chatTypeBasicGroup":return a("ViewGroupInfo");case"chatTypePrivate":case"chatTypeSecret":return a("ViewProfile");case"chatTypeSupergroup":return s.is_channel?a("ViewChannelInfo"):a("ViewGroupInfo")}},this.handleViewInfo=e=>{this.handleCloseContextMenu(e);const t=this.props.chatId;Object(G.h)(t,null,!0)},this.handleRead=e=>{this.handleCloseContextMenu(e);const t=this.props.chatId;if(Object(w.O)(t)){const e=L.a.get(t);if(!e)return;const a=e.is_marked_as_unread,n=e.last_message;e.unread_count>0&&n?function(e,t,a){K.a.send({"@type":"viewMessages",chat_id:e,message_ids:t,force_read:a})}(t,[n.id],!0):a&&We(t,!1)}else We(t,!0)},this.dialog=r.a.createRef();const a=L.a.get(this.props.chatId);this.state={chat:a,contextMenu:!1,left:0,top:0}}shouldComponentUpdate(e,t){const a=this.props,n=a.chatId,s=a.t,i=a.hidden,o=a.isLastPinned,r=a.style,c=this.state.contextMenu;return e.chatId!==n||(e.t!==s||(e.hidden!==i||(e.isLastPinned!==o||(t.contextMenu!==c||!(!e.style||!r||r.top===e.style.top)))))}componentDidMount(){Z.a.on("clientUpdateChatId",this.onClientUpdateChatId)}componentWillUnmount(){Z.a.off("clientUpdateChatId",this.onClientUpdateChatId)}render(){const e=this.props,t=e.chatId,a=e.showSavedMessages,n=e.hidden,s=e.t,i=(e.isLastPinned,e.style),o=this.state,c=o.contextMenu,d=o.left,h=o.top,u=o.canToggleArchive,p=o.canTogglePin;if(n)return null;const m=L.a.get(t).is_pinned,g=Z.a.getChatId()===t,f=Object(w.M)(t),b=Object(w.O)(t),C=Object(w.K)(t);return r.a.createElement("div",{ref:this.dialog,className:l()(g?"dialog-active":"dialog",{"item-selected":g}),onMouseDown:this.handleSelect,onContextMenu:this.handleContextMenu,style:i},r.a.createElement("div",{className:"dialog-wrapper"},r.a.createElement(D,{chatId:t,dialog:!0,showSavedMessages:a,showOnline:!0}),r.a.createElement("div",{className:"dialog-inner-wrapper"},r.a.createElement("div",{className:"tile-first-row"},r.a.createElement(ke,{chatId:t}),r.a.createElement(Ia,{chatId:t})),r.a.createElement("div",{className:"tile-second-row"},r.a.createElement(ga,{chatId:t}),r.a.createElement(Ca,{chatId:t})))),r.a.createElement(bt.a,{open:c,onClose:this.handleCloseContextMenu,anchorReference:"anchorPosition",anchorPosition:{top:h,left:d},anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"},onMouseDown:e=>e.stopPropagation()},r.a.createElement(gt.a,{onClick:e=>e.stopPropagation()},u&&r.a.createElement(ft.a,{onClick:this.handleArchive},C?r.a.createElement(r.a.Fragment,null,r.a.createElement(pe.a,null,r.a.createElement(_a,null)),r.a.createElement(me.a,{primary:s("Unarchive")})):r.a.createElement(r.a.Fragment,null,r.a.createElement(pe.a,null,r.a.createElement(wa,null)),r.a.createElement(me.a,{primary:s("Archive")}))),p&&r.a.createElement(ft.a,{onClick:this.handlePin},m?r.a.createElement(r.a.Fragment,null,r.a.createElement(pe.a,null,r.a.createElement(xa,null)),r.a.createElement(me.a,{primary:s("UnpinFromTop")})):r.a.createElement(r.a.Fragment,null,r.a.createElement(pe.a,null,r.a.createElement(xa,null)),r.a.createElement(me.a,{primary:s("PinToTop")}))),r.a.createElement(ft.a,{onClick:this.handleViewInfo},Object(w.T)(t)?r.a.createElement(r.a.Fragment,null,r.a.createElement(pe.a,null,r.a.createElement(La,null)),r.a.createElement(me.a,{primary:this.getViewInfoTitle()})):r.a.createElement(r.a.Fragment,null,r.a.createElement(pe.a,null,r.a.createElement(Pa,null)),r.a.createElement(me.a,{primary:this.getViewInfoTitle()}))),r.a.createElement(ft.a,{onClick:this.handleMute},f?r.a.createElement(r.a.Fragment,null,r.a.createElement(pe.a,null,r.a.createElement(Ta,null)),r.a.createElement(me.a,{primary:s("ChatsUnmute")})):r.a.createElement(r.a.Fragment,null,r.a.createElement(pe.a,null,r.a.createElement(Oa,null)),r.a.createElement(me.a,{primary:s("ChatsMute")}))),r.a.createElement(ft.a,{onClick:this.handleRead},b?r.a.createElement(r.a.Fragment,null,r.a.createElement(pe.a,null,r.a.createElement(Na,null)),r.a.createElement(me.a,{primary:s("MarkAsRead")})):r.a.createElement(r.a.Fragment,null,r.a.createElement(pe.a,null,r.a.createElement(Da,null)),r.a.createElement(me.a,{primary:s("MarkAsUnread")}))))))}}ja.defaultProps={hidden:!1,showSavedMessages:!0};var Ba=Object(f.d)()(ja);a(454);class Ra extends r.a.Component{render(){const e=this.props,t=e.chatId,a=e.index,n=e.showTitle;let s=null;n&&(s=Object(w.s)(t,!0));const i="".concat(50+10*Math.sin(a),"%"),o="".concat(70+10*Math.cos(a),"%");return r.a.createElement("div",{className:"dialog-placeholder"},r.a.createElement("div",{className:"dialog-placeholder-wrapper"},r.a.createElement("div",{className:"dialog-placeholder-tile"}),r.a.createElement("div",{className:"dialog-placeholder-inner-wrapper"},r.a.createElement("div",{className:"tile-first-row"},n?s:r.a.createElement("div",{className:"dialog-placeholder-title",style:{width:i}})),r.a.createElement("div",{className:"tile-second-row"},r.a.createElement("div",{className:"dialog-placeholder-content",style:{width:o}})))))}}var Fa=Ra;const Aa=e=>({height:e,position:"relative"}),Va=(e,t)=>({height:t,left:0,right:0,top:t*e,position:"absolute"});class za extends r.a.Component{constructor(e){super(e),this.setViewportHeight=()=>{const e=this.props.source,t=this.state.scrollTop,a=this.listRef.current;if(!a)return;const n=parseFloat(window.getComputedStyle(a,null).getPropertyValue("height")),s=this.getRenderIds(e,n,t);this.setState(Object(Ve.a)({viewportHeight:n},s))},this.setScrollPosition=e=>{const t=this.props,a=t.source,n=t.rowHeight,s=t.onScroll,i=this.state,o=i.viewportHeight,r=i.scrollTop;if(Math.abs(e.target.scrollTop-r)>=n){const t=this.getRenderIds(a,o,e.target.scrollTop);this.setState(Object(Ve.a)({scrollTop:e.target.scrollTop},t))}s&&s(e)},this.isVisibleItem=(e,t,a)=>{const n=this.props,s=n.overScanCount,i=n.rowHeight;return e*i>a-s*i&&(e+1)*i<a+t+s*i},this.listRef=r.a.createRef(),this.state={scrollTop:0,renderIds:new Map,renderIdsList:[],viewportHeight:0}}componentDidUpdate(e,t,a){e.source!==this.props.source&&this.setViewportHeight()}shouldComponentUpdate(e,t,a){return!0}componentDidMount(){window.addEventListener("resize",this.setViewportHeight,!0);const e=this.listRef.current;e&&(e.addEventListener("scroll",this.setScrollPosition,!0),this.setViewportHeight())}getRenderIds(e,t,a){const n=new Map,s=[];return e.forEach((e,i)=>{this.isVisibleItem(i,t,a)&&(n.set(i,i),s.push(i))}),{renderIds:n,renderIdsList:s}}componentWillUnmount(){window.removeEventListener("resize",this.setViewportHeight);const e=this.listRef.current;e&&e.removeEventListener("scroll",this.setScrollPosition)}getListRenderIds(){return this.state.renderIds}getListRef(){return this.listRef}render(){const e=this.props,t=e.className,a=e.source,n=e.renderItem,s=e.rowHeight,i=this.state.renderIds,o=(a||[]).map((e,t)=>i.has(t)&&n({index:t,style:Va(t,s)}));return r.a.createElement("div",{ref:this.listRef,className:t},r.a.createElement("div",{style:Aa((a||[]).length*s)},o))}}za.defaultProps={source:[],rowHeight:72,overScanCount:5};var Ha=za;a(455);function Wa(e){if(e.nodeType===Node.TEXT_NODE)return e;for(let t=e.childNodes.length-1;t>=0;t--){const a=Wa(e.childNodes[t]);if(a)return a}return null}function Ga(e){if(!e)return;const t=Wa(e);if(t){const e=document.createRange();e.setStart(t,t.length),e.collapse(!0);const a=window.getSelection();a.removeAllRanges(),a.addRange(e)}e.focus()}function Za(e,t="smooth"){e&&(e.scrollTop=Math.min(e.scrollTop,100),setTimeout(()=>{e.scrollTo({top:0,behavior:t})},50))}class qa extends r.a.Component{shouldComponentUpdate(e,t,a){const n=this.props,s=n.chatId,i=n.style,o=n.hidden;return e.chatId!==s||(e.hidden!==o||e.style.top!==i.top)}render(){const e=this.props,t=e.chatId,a=e.hidden,n=e.style;return r.a.createElement("div",{className:"dialog-list-item",style:n},r.a.createElement(Ba,{chatId:t,hidden:a}))}}class Ka extends r.a.Component{constructor(e){var t;super(e),t=this,this.onClientUpdateLeaveChat=e=>{const t=e.inProgress,a=e.chatId;t?this.hiddenChats.set(a,a):this.hiddenChats.delete(a),this.forceUpdate()},this.onUpdateAuthorizationState=e=>{const t=e.authorization_state;this.setState({authorizationState:t},()=>this.loadFirstSlice())},this.onFastUpdatingComplete=e=>{this.onLoadNext(!0)},this.loadFirstSlice=Object(i.a)(s.a.mark((function e(){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.state.authorizationState,!Object(Ae.q)(a)){e.next=4;break}return e.next=4,P.a.initDB(()=>t.onLoadNext(!0));case 4:case"end":return e.stop()}}),e)}))),this.saveCache=()=>{const e=this.props.onSaveCache;e&&e()},this.onUpdateChatOrder=e=>{const t=this.props.type,a=this.state.chats;if(this.loading)return;const n=e.chat_id,s=e.order,i=L.a.get(n);if(!i||!i.chat_list||i.chat_list["@type"]!==t)return;const o=[],r=[];for(let c=0;c<a.length;c++){let e=L.a.get(a[c]);if(e&&"0"!==e.order)switch(e.type["@type"]){case"chatTypeBasicGroup":"chatMemberStatusLeft"!==Me.a.get(e.type.basic_group_id).status["@type"]&&r.push(e.id);break;case"chatTypePrivate":case"chatTypeSecret":r.push(e.id);break;case"chatTypeSupergroup":"chatMemberStatusLeft"!==Ie.a.get(e.type.supergroup_id).status["@type"]&&r.push(e.id);break}}if("0"===s)n!==Z.a.getChatId()||i.last_message||(K.a.setChatId(0),Z.a.changeChatDetailsVisibility(!1));else if(a.length>0){a.find(e=>e===n)||o.push(n)}else o.push(n);this.reorderChats(r,o,()=>{this.loadChatContents(o),this.saveCache()})},this.handleScroll=()=>{const e=this.listRef.current.getListRef().current;e&&(e.scrollTop<=p.fb?this.onLoadPrev():e.scrollTop+e.offsetHeight>=e.scrollHeight-e.offsetHeight&&this.onLoadNext())},this.renderItem=({index:e,style:t},a)=>{const n=a[e];return r.a.createElement(qa,{key:n,chatId:n,hidden:this.hiddenChats.has(n),style:t})},this.hiddenChats=new Map,this.listRef=r.a.createRef();const a=Z.a.authorizationState;this.state={authorizationState:a,offset:0,chats:null,fistSliceLoaded:!1}}shouldComponentUpdate(e,t){const a=this.props,n=a.theme,s=a.open,i=a.showArchive,o=a.archiveTitle,r=a.items,c=a.cacheItems,l=this.state,d=l.chats,h=l.offset;return e.theme!==n||(e.open!==s||(e.items!==r||(e.cacheItems!==c||(e.showArchive!==i||(e.archiveTitle!==o||(t.offset!==h||t.chats!==d))))))}getSnapshotBeforeUpdate(e,t){const a=this.listRef.current;return a?{scrollTop:a.scrollTop}:{scrollTop:0}}componentDidUpdate(e,t,a){if(!this.listRef.current)return;a.scrollTop}componentDidMount(){this.loadFirstSlice(),Z.a.on("updateAuthorizationState",this.onUpdateAuthorizationState),L.a.on("updateChatDraftMessage",this.onUpdateChatOrder),L.a.on("updateChatIsPinned",this.onUpdateChatOrder),L.a.on("updateChatIsSponsored",this.onUpdateChatOrder),L.a.on("updateChatLastMessage",this.onUpdateChatOrder),L.a.on("updateChatOrder",this.onUpdateChatOrder),L.a.on("clientUpdateFastUpdatingComplete",this.onFastUpdatingComplete),L.a.on("clientUpdateLeaveChat",this.onClientUpdateLeaveChat)}componentWillUnmount(){Z.a.off("updateAuthorizationState",this.onUpdateAuthorizationState),L.a.off("updateChatDraftMessage",this.onUpdateChatOrder),L.a.off("updateChatIsPinned",this.onUpdateChatOrder),L.a.off("updateChatIsSponsored",this.onUpdateChatOrder),L.a.off("updateChatLastMessage",this.onUpdateChatOrder),L.a.off("updateChatOrder",this.onUpdateChatOrder),L.a.off("clientUpdateFastUpdatingComplete",this.onFastUpdatingComplete),L.a.off("clientUpdateLeaveChat",this.onClientUpdateLeaveChat)}reorderChats(e,t=[],a){const n=e.concat(t).sort((e,t)=>Object(Ae.v)(L.a.get(t).order,L.a.get(e).order));Ka.isDifferentOrder(this.state.chats,n)?this.setState({chats:n},a):a&&a()}static isDifferentOrder(e,t){if(e.length===t.length){for(let a=0;a<e.length;a++)if(e[a]!==t[a])return!0;return!1}return!0}onLoadPrev(){this.setState({offset:Math.max(this.state.offset-p.e,0)})}onLoadNext(e=!1){var t=this;return Object(i.a)(s.a.mark((function a(){var n,i,o,r,c,l,d,h;return s.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=t.props.type,i=t.state,o=i.offset,!((r=i.chats)&&o+2*p.e<r.length)){a.next=5;break}return t.setState({offset:o+p.e}),a.abrupt("return");case 5:if(!t.loading){a.next=7;break}return a.abrupt("return");case 7:return c="9223372036854775807",l=0,!e&&r&&r.length>0&&(d=L.a.get(r[r.length-1]))&&(c=d.order,l=d.id),"chatListMain"===n&&console.log("[update] GETCHATS start"),t.loading=!0,a.next=14,K.a.send({"@type":"getChats",chat_list:{"@type":n},offset_chat_id:l,offset_order:c,limit:p.e}).finally(()=>{t.loading=!1,"chatListMain"===n&&console.log("[update] GETCHATS stop"),e&&K.a.clientUpdate({"@type":"clientUpdateDialogsReady"})});case 14:(h=a.sent).chat_ids.length>0&&h.chat_ids[0]===l&&h.chat_ids.shift(),e?t.replaceChats(h.chat_ids,()=>{t.loadChatContents(h.chat_ids),t.saveCache()}):t.appendChats(h.chat_ids,()=>{t.loadChatContents(h.chat_ids)});case 17:case"end":return a.stop()}}),a)})))()}loadChatContents(e){const t=P.a.getStore();Object(T.r)(t,e)}appendChats(e,t){if(0===e.length)return void(t&&t());const a=(this.state.chats||[]).concat(e);this.setState({chats:a,offset:a.length-2*p.e},t)}replaceChats(e,t){this.setState({chats:e,offset:0},t)}scrollToTop(){Za(this.listRef.current.getListRef().current)}render(){const e=this.props,t=e.type,a=e.open,n=e.cacheItems,s=(e.showArchive,e.archiveTitle,this.state),i=s.chats;s.offset;if(!a)return null;this.source=[];let o=null;if(i){let e=0;i.forEach(t=>{const a=L.a.get(t);a&&a.is_pinned&&(e=t)}),this.source=i}else if(n){let e=0;n.forEach(t=>{const a=L.a.get(t);a&&a.is_pinned&&(e=t)}),this.source=n.map(e=>e.id)}else"chatListMain"===t&&(o=Array.from(Array(10)).map((e,t)=>r.a.createElement(Fa,{key:t,index:t})));return r.a.createElement(Ha,{ref:this.listRef,className:"dialogs-list",source:this.source,rowHeight:76,overScanCount:20,renderItem:e=>this.renderItem(e,this.source),onScroll:this.handleScroll})}}var Ya=Ka;class Ja extends r.a.Component{render(){const e=this.props,t=e.t,a=e.innerListRef,n=e.items,s=e.cacheItems,i=e.onClose;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"header-master"},r.a.createElement(C.a,{className:"header-left-button",onClick:i},r.a.createElement(Te,null)),r.a.createElement("div",{className:"header-status grow cursor-pointer"},r.a.createElement("span",{className:"header-status-content"},t("ArchivedChats")))),r.a.createElement("div",{className:"dialogs-content"},r.a.createElement(Ya,{type:"chatListArchive",ref:a,cacheItems:s,open:!0,items:n})))}}var Qa=Object(f.d)()(Ja);class Xa{constructor(e){this.onKeyDown=e}}var $a=new class{constructor(){this.handleKeyDown=e=>{const t=this.handlers;if(!t.length)return;const a=t[t.length-1];if(a){const t=a.onKeyDown;t&&t(e)}},this.handlers=[],document.addEventListener("keydown",this.handleKeyDown)}add(e){this.handlers.push(e)}remove(e){const t=this.handlers.indexOf(e);-1!==t&&this.handlers.splice(t,1)}},en=Object(S.a)(r.a.createElement("path",{d:"M18,6.5 C18.5522847,6.5 19,6.94771525 19,7.5 L19,18 C19,19.6568542 17.6568542,21 16,21 L8,21 C6.34314575,21 5,19.6568542 5,18 L5,7.5 C5,6.94771525 5.44771525,6.5 6,6.5 L18,6.5 Z M17,8.5 L7,8.5 L7,18 C7,18.5522847 7.44771525,19 8,19 L16,19 C16.5522847,19 17,18.5522847 17,18 L17,8.5 Z M10,2 L14,2 C14.2210137,2 14.434484,2.07316447 14.6080295,2.20608063 L14.7071068,2.29289322 L15.415,3 L19,3 C19.5128358,3 19.9355072,3.38604019 19.9932723,3.88337887 L20,4 C20,4.51283584 19.6139598,4.93550716 19.1166211,4.99327227 L19,5 L5,5 C4.44771525,5 4,4.55228475 4,4 C4,3.48716416 4.38604019,3.06449284 4.88337887,3.00672773 L5,3 L8.584,3 L9.29289322,2.29289322 C9.44917353,2.1366129 9.65185492,2.03740171 9.86855602,2.00867243 L10,2 L14,2 L10,2 Z"}),"Delete");a(456);class tn extends r.a.PureComponent{constructor(...e){var t;super(...e),t=this,this.state={contextMenu:!1,top:0,left:0},this.handleContextMenu=function(){var e=Object(i.a)(s.a.mark((function e(a){var n,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a&&(a.preventDefault(),a.stopPropagation()),t.state.contextMenu?t.setState({contextMenu:!1}):(n=a.clientX,i=a.clientY,t.setState({contextMenu:!0,left:n,top:i}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleCloseContextMenu=e=>{e&&e.stopPropagation(),this.setState({contextMenu:!1})},this.handleDelete=e=>{this.handleCloseContextMenu(),(0,this.props.onDelete)()}}render(){const e=this.props,t=e.chatId,a=e.onSelect,n=e.showSavedMessages,s=e.t,i=this.state,o=i.contextMenu,c=i.top,l=i.left,d=Object(w.p)(t,n,s);return r.a.createElement(r.a.Fragment,null,r.a.createElement(ue.a,{button:!0,className:"top-chat",onClick:a,onContextMenu:this.handleContextMenu},r.a.createElement(D,{dialog:!0,chatId:t,showSavedMessages:n,showOnline:!0}),r.a.createElement("div",{className:"top-chat-title"},d)),r.a.createElement(bt.a,{open:o,onClose:this.handleCloseContextMenu,anchorReference:"anchorPosition",anchorPosition:{top:c,left:l},anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"},onMouseDown:e=>e.stopPropagation()},r.a.createElement(gt.a,{onClick:e=>e.stopPropagation()},r.a.createElement(ft.a,{onClick:this.handleDelete},r.a.createElement(pe.a,null,r.a.createElement(en,null)),r.a.createElement(me.a,{primary:s("Delete")})))))}}tn.defaultProps={showSavedMessages:!0};var an=Object(f.d)()(tn);a(457);class nn extends r.a.PureComponent{constructor(...e){var t;super(...e),t=this,this.state={contextMenu:!1,top:0,left:0},this.handleContextMenu=function(){var e=Object(i.a)(s.a.mark((function e(a){var n,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a&&(a.preventDefault(),a.stopPropagation()),t.state.contextMenu?t.setState({contextMenu:!1}):(n=a.clientX,i=a.clientY,t.setState({contextMenu:!0,left:n,top:i}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleCloseContextMenu=e=>{e&&e.stopPropagation(),this.setState({contextMenu:!1})},this.handleDelete=e=>{this.handleCloseContextMenu(),(0,this.props.onDelete)()}}render(){const e=this.props,t=e.t,a=e.chatId,n=e.onClick,s=this.state,i=s.contextMenu,o=s.top,c=s.left;return r.a.createElement(r.a.Fragment,null,r.a.createElement(ue.a,{button:!0,className:"recently-found-chat",onClick:n,onContextMenu:this.handleContextMenu},r.a.createElement(Oe,{chatId:a})),r.a.createElement(bt.a,{open:i,onClose:this.handleCloseContextMenu,anchorReference:"anchorPosition",anchorPosition:{top:o,left:c},anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"},onMouseDown:e=>e.stopPropagation()},r.a.createElement(gt.a,{onClick:e=>e.stopPropagation()},r.a.createElement(ft.a,{onClick:this.handleDelete},r.a.createElement(pe.a,null,r.a.createElement(en,null)),r.a.createElement(me.a,{primary:t("Delete")})))))}}var sn=Object(f.d)()(nn);a(458);class on extends r.a.Component{constructor(e){super(e),this.onClientUpdateChatId=e=>{const t=e.nextChatId,a=e.previousChatId;this.setState({nextChatId:t,previousChatId:a})},this.state={nextChatId:Z.a.getChatId(),previousChatId:null}}shouldComponentUpdate(e,t){const a=this.props.chatId;return t.nextChatId===a||t.previousChatId===a}componentDidMount(){Z.a.on("clientUpdateChatId",this.onClientUpdateChatId)}componentWillUnmount(){Z.a.off("clientUpdateChatId",this.onClientUpdateChatId)}render(){const e=this.props,t=e.chatId,a=e.onClick,n=this.state.nextChatId,s=Object(w.v)(t);return r.a.createElement(ue.a,{button:!0,className:l()("found-public-chat",{"item-selected":t===n}),onClick:a},r.a.createElement("div",{className:"found-public-chat-wrapper"},r.a.createElement(Oe,{chatId:t,subtitle:s?"@"+s:null})))}}var rn=on,cn=a(299);a(459);class ln extends r.a.Component{constructor(e){super(e),this.onClientUpdateChatId=e=>{this.setState(Object(Ve.a)({},e))},this.state={nextChatId:Z.a.getChatId(),nextMessageId:Z.a.getMessageId()}}shouldComponentUpdate(e,t){const a=this.props,n=a.chatId,s=a.messageId;return t.nextChatId===n&&t.nextMessageId===s||t.previousChatId===n&&t.previousMessageId===s}componentDidMount(){Z.a.on("clientUpdateChatId",this.onClientUpdateChatId)}componentWillUnmount(){Z.a.off("clientUpdateChatId",this.onClientUpdateChatId)}render(){const e=this.props,t=e.chatId,a=e.messageId,n=e.chatSearch,s=e.onClick,i=e.t,o=this.state.nextChatId,c=this.state.nextMessageId,d=q.a.get(t,a),h=d.sender_user_id,u=Object(w.A)(d),p=Object(w.C)(d,i),m=Object(w.B)(d,i),g=Object(vt.h)(d,i)||"\xa0",f=t===o&&a===c,b=h&&n?r.a.createElement(cn.a,{userId:h,dialog:!0}):r.a.createElement(D,{chatId:t,dialog:!0});return r.a.createElement(ue.a,{button:!0,className:l()("found-message",{"item-selected":f}),onClick:s},r.a.createElement("div",{className:"dialog-wrapper"},b,r.a.createElement("div",{className:"dialog-inner-wrapper"},r.a.createElement("div",{className:"tile-first-row"},n&&m?r.a.createElement("div",{className:"dialog-title"},m):r.a.createElement(ke,{chatId:t}),r.a.createElement("div",{className:"dialog-meta"},u)),r.a.createElement("div",{className:"tile-second-row"},r.a.createElement("div",{className:"dialog-content"},r.a.createElement(r.a.Fragment,null,!n&&p&&r.a.createElement("span",{className:"dialog-content-accent"},p,": "),g))))))}}var dn=Object(f.d)()(ln);a(460);var hn=function({command:e,multiline:t,onClick:a,children:n}){return r.a.createElement("div",{className:"section-header"},r.a.createElement("div",{className:l()("section-header-title",{"section-header-title-multiline":t})},n),Boolean(e)&&r.a.createElement("a",{onClick:a},e))};a(461);class un extends r.a.Component{constructor(e){var t;super(e),t=this,this.handleKeyDown=e=>{switch(e.key){case"Escape":e.preventDefault(),e.stopPropagation(),e.target.blur(),this.handleClose()}},this.concatSearchResults=e=>{const t=[],a=new Map;for(let n=0;n<e.length;n++){let s=e[n]&&e[n].chat_ids;if(s)for(let e=0;e<s.length;e++)a.has(s[e])||(a.set(s[e],s[e]),t.push(s[e]))}return t.sort((e,t)=>Object(Ae.v)(L.a.get(t).order,L.a.get(e).order)),t},this.searchText=function(){var e=Object(i.a)(s.a.mark((function e(a){var n,i,o,r,c,l,d,h,u,m,g,f,b,C,y,v,E,U,S,k,M,I,w,_,x,O,L,N,D,j,B;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.sessionId=new Date,t.text=a,n=t.sessionId,i=null,o=t.props.chatId,r=t.state.savedMessages,o){e.next=43;break}return c=[],l=K.a.send({"@type":"searchChats",query:a,limit:100}),c.push(l),(d=W(a))&&d!==a&&(h=K.a.send({"@type":"searchChats",query:d,limit:100}),c.push(h)),(u=z(a))&&u!==a&&(m=K.a.send({"@type":"searchChats",query:u,limit:100}),c.push(m)),e.next=16,Promise.all(c.map(e=>e.catch(e=>null)));case 16:if(g=e.sent,f=t.concatSearchResults(g),n===t.sessionId){e.next=20;break}return e.abrupt("return");case 20:if(r&&(b=t.props.t,C=a.toUpperCase(),((y=["SAVED MESSAGES",b("SavedMessages").toUpperCase()]).some(e=>e.includes(C))||d&&y.some(e=>e.includes(d.toUpperCase())))&&f.splice(0,0,r.id)),t.setState({top:null,recentlyFound:null,local:f}),i=P.a.getStore(),Object(T.r)(i,f),!((v=(v=a.trim()).startsWith("@")?v.substr(1):v).length>=p.rb)){e.next=42;break}return E=[],U=K.a.send({"@type":"searchPublicChats",query:v}),E.push(U),d&&(S=(S=d.trim()).startsWith("@")?S.substr(1):S).length>=p.rb&&S!==v&&(k=K.a.send({"@type":"searchPublicChats",query:S}),E.push(k)),e.next=33,Promise.all(E.map(e=>e.catch(e=>null)));case 33:if(M=e.sent,I=t.concatSearchResults(M),n===t.sessionId){e.next=37;break}return e.abrupt("return");case 37:t.setState({global:I}),i=P.a.getStore(),Object(T.r)(i,I),e.next=43;break;case 42:t.setState({global:null});case 43:if(w=[],!o){e.next=50;break}return e.next=47,K.a.send({"@type":"searchChatMessages",chat_id:o,query:a,sender_user_id:0,from_message_id:0,offset:0,limit:50,filter:null});case 47:w=e.sent,e.next=53;break;case 50:return e.next=52,K.a.send({"@type":"searchMessages",query:a,offset_date:0,offset_chat_id:0,offset_message_id:0,limit:50});case 52:w=e.sent;case 53:if(q.a.setItems(w.messages),_=null,o){e.next=67;break}return e.prev=56,e.next=59,K.a.send({"@type":"getMessageLinkInfo",url:a});case 59:x=e.sent,q.a.setItems([x.message]),_=x,e.next=67;break;case 64:e.prev=64,e.t0=e.catch(56),console.log("[se] searchText="+a+" messageLinkInfo error",e.t0);case 67:if(n===t.sessionId){e.next=69;break}return e.abrupt("return");case 69:for(t.setState({messages:w,linkMessage:_}),O=new Map,L=new Map,N=0;N<w.messages.length;N++)O.set(w.messages[N].chat_id,w.messages[N].chat_id),w.messages[N].sender_user_id&&L.set(w.messages[N].sender_user_id,w.messages[N].sender_user_id);_&&(j=(D=_).chat_id,B=D.sender_user_id,O.set(j,j),B&&L.set(B,B)),i=P.a.getStore(),Object(T.r)(i,[...O.keys()]),Object(T.C)(i,[...L.keys()]);case 77:case"end":return e.stop()}}),e,null,[[56,64]])})));return function(t){return e.apply(this,arguments)}}(),this.loadContent=Object(i.a)(s.a.mark((function e(){var a,n,i,o,r,c,l,d,h;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.props.chatId){e.next=4;break}return t.setState({top:null,recentlyFound:null,local:null,global:null,messages:null,linkMessage:null}),e.abrupt("return");case 4:return a=K.a.send({"@type":"getTopChats",category:{"@type":"topChatCategoryUsers"},limit:30}).catch(()=>({"@type":"chats",chat_ids:[]})),n=K.a.send({"@type":"searchChats",query:"",limit:100}).catch(()=>({"@type":"chats",chat_ids:[]})),i=K.a.send({"@type":"createPrivateChat",user_id:_.a.getMyId(),force:!0}).catch(e=>{}),e.next=9,Promise.all([a,n,i]);case 9:o=e.sent,r=Object(g.a)(o,3),c=r[0],l=r[1],d=r[2],t.setState({top:c,recentlyFound:l,savedMessages:d,local:null,global:null,messages:null,linkMessage:null}),h=P.a.getStore(),Object(T.r)(h,c.chat_ids),Object(T.r)(h,l.chat_ids);case 18:case"end":return e.stop()}}),e)}))),this.handleClearRecentlyFound=e=>{e.stopPropagation(),K.a.send({"@type":"clearRecentlyFoundChats"}),this.setState({recentlyFound:null})},this.handleSelectMessage=(e,t,a,n)=>{const s=this.props.onSelectMessage;a&&K.a.send({"@type":"addRecentlyFoundChat",chat_id:e}),s(e,t,n)},this.handleScroll=()=>{const e=this.listRef.current;e.scrollTop+e.offsetHeight>=e.scrollHeight-p.gb&&this.onLoadPrevious()},this.getOffset=e=>{const t=e?e.messages.length:0;return{offset_date:t>0?e.messages[t-1].date:0,offset_chat_id:t>0?e.messages[t-1].chat_id:0,offset_message_id:t>0?e.messages[t-1].id:0}},this.concatMessages=(e,t)=>t&&t.messages.length?e&&e.messages.length?{total_count:t.total_count,messages:e.messages.concat(t.messages)}:t:e,this.onLoadPrevious=Object(i.a)(s.a.mark((function e(){var a,n,i,o,r,c,l,d,h;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.loading){e.next=2;break}return e.abrupt("return");case 2:if(a=t.props.chatId,n=t.sessionId,i=t.state.messages,o=t.getOffset(i),t.loading=!0,r=[],!a){e.next=14;break}return e.next=11,K.a.send({"@type":"searchChatMessages",chat_id:a,query:t.text,sender_user_id:0,from_message_id:o.offset_message_id,limit:50,filter:null});case 11:r=e.sent,e.next=17;break;case 14:return e.next=16,K.a.send(Object(Ve.a)({"@type":"searchMessages",query:t.text},o,{limit:50}));case 16:r=e.sent;case 17:if(t.loading=!1,Object(vt.f)(r,i?i.messages:[]),q.a.setItems(r.messages),n===t.sessionId){e.next=22;break}return e.abrupt("return");case 22:for(t.setState({messages:t.concatMessages(i,r)}),c=new Map,l=new Map,d=0;d<r.messages.length;d++)c.set(r.messages[d].chat_id,r.messages[d].chat_id),r.messages[d].sender_user_id&&l.set(r.messages[d].sender_user_id,r.messages[d].sender_user_id);h=P.a.getStore(),Object(T.r)(h,[...c.keys()]),Object(T.C)(h,[...l.keys()]);case 29:case"end":return e.stop()}}),e)}))),this.handleTopChatsScroll=e=>{e.stopPropagation()},this.handleClose=()=>{(0,this.props.onClose)()},this.handleDeleteRecentlyFoundChat=function(){var e=Object(i.a)(s.a.mark((function e(a){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,K.a.send({"@type":"removeRecentlyFoundChat",chat_id:a});case 4:if(n=t.state.recentlyFound){e.next=7;break}return e.abrupt("return");case 7:t.setState({recentlyFound:Object(Ve.a)({},n,{chat_ids:n.chat_ids.filter(e=>e!==a)})});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleDeleteTopChat=function(){var e=Object(i.a)(s.a.mark((function e(a){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,K.a.send({"@type":"removeTopChat",chat_id:a,category:{"@type":"topChatCategoryUsers"}});case 4:if(n=t.state.top){e.next=7;break}return e.abrupt("return");case 7:t.setState({top:Object(Ve.a)({},n,{chat_ids:n.chat_ids.filter(e=>e!==a)})});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.keyboardHandler=new Xa(this.handleKeyDown),this.listRef=r.a.createRef(),this.state={}}componentDidMount(){const e=this.props.text;this.searchOrLoadContent(e),$a.add(this.keyboardHandler)}componentWillUnmount(){$a.add(this.keyboardHandler)}componentDidUpdate(e,t,a){const n=this.props,s=n.chatId,i=n.text;(e.text!==i||e.chatId!==s)&&this.searchOrLoadContent(i)}searchOrLoadContent(e){const t=e?e.trim():"";t?this.searchText(t):this.loadContent()}render(){const e=this.props,t=e.chatId,a=e.t,n=this.state,s=n.top,i=n.recentlyFound,o=n.local,c=n.global,l=n.messages,d=n.linkMessage,h=L.a.get(t),u=s&&s.chat_ids?s.chat_ids.map(e=>r.a.createElement(an,{key:e,chatId:e,onSelect:()=>this.handleSelectMessage(e,null,!1,!1),onDelete:()=>this.handleDeleteTopChat(e)})):[],p=i&&i.chat_ids?i.chat_ids.map(e=>r.a.createElement(sn,{key:e,chatId:e,onClick:()=>this.handleSelectMessage(e,null,!0,!1),onDelete:()=>this.handleDeleteRecentlyFoundChat(e)})):[],m=o?o.map(e=>r.a.createElement(sn,{key:e,chatId:e,onClick:()=>this.handleSelectMessage(e,null,!0,!1)})):[],g=new Map,f=c?c.map(e=>(g.set(e,e),r.a.createElement(rn,{key:e,chatId:e,onClick:()=>this.handleSelectMessage(e,null,!0,!0)}))):[],b=d&&d.chat_id&&!d.message&&!g.has(d.chat_id)?r.a.createElement(rn,{key:d.chat_id,chatId:d.chat_id,onClick:()=>this.handleSelectMessage(d.chat_id,null,!0,!0)}):null,y=new Map,v=l&&l.messages?l.messages.map(e=>{const a="".concat(e.chat_id,"_").concat(e.id);return y.set(a,a),r.a.createElement(dn,{key:a,chatId:e.chat_id,messageId:e.id,chatSearch:Boolean(t),onClick:()=>this.handleSelectMessage(e.chat_id,e.id,!1,!0)})}):[],E=d&&d.message&&!y.has("".concat(d.message.chat_id,"_").concat(d.message.id))?r.a.createElement(dn,{key:"".concat(d.message.chat_id,"_").concat(d.message.id),chatId:d.message.chat_id,messageId:d.message.id,chatSearch:!1,onClick:()=>this.handleSelectMessage(d.message.chat_id,d.message.id,!1,!0)}):null;let S=l?l.total_count:0;d&&d.message&&!y.has("".concat(d.message.chat_id,"_").concat(d.message.id))&&S++;let k=a("NoMessages");return S&&(k=1===S?"Found 1 message":"Found ".concat(S," messages")),r.a.createElement("div",{ref:this.listRef,className:"search",onScroll:this.handleScroll},h&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"sidebar-page-section"},r.a.createElement(hn,null,a("SearchMessagesIn")),r.a.createElement("div",{className:"search-chat-wrapper"},r.a.createElement("div",{className:"search-chat-control"},r.a.createElement(Oe,{chatId:t,showStatus:!1})),r.a.createElement(C.a,{className:"header-right-button","aria-label":"Search",onMouseDown:this.handleClose},r.a.createElement(U.a,null)))),r.a.createElement("div",{className:"sidebar-page-section-divider"})),u.length>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"sidebar-page-section"},r.a.createElement(hn,null,a("ChatHints")),r.a.createElement("div",{className:"search-top-chats-list",onScroll:this.handleTopChatsScroll},r.a.createElement("div",{className:"search-top-chats-placeholder"}),u,r.a.createElement("div",{className:"search-top-chats-placeholder"}))),r.a.createElement("div",{className:"sidebar-page-section-divider"})),p.length>0&&r.a.createElement("div",{className:"sidebar-page-section"},r.a.createElement(hn,{command:a("ClearButton"),onClick:this.handleClearRecentlyFound},a("Recent")),p),m.length>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"sidebar-page-section"},r.a.createElement(hn,null,a("ChatsAndContacts")),m),r.a.createElement("div",{className:"sidebar-page-section-divider"})),f.length>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"sidebar-page-section"},r.a.createElement(hn,null,a("GlobalSearch")),b,f),r.a.createElement("div",{className:"sidebar-page-section-divider"})),(l||d&&d.message)&&r.a.createElement("div",{className:"sidebar-page-section"},r.a.createElement(hn,null,k),E,v))}}var pn=Object(f.d)()(un),mn=a(149),gn=Object(S.a)(r.a.createElement("path",{d:"M4,16 L20,16 C20.5522847,16 21,16.4477153 21,17 C21,17.5128358 20.6139598,17.9355072 20.1166211,17.9932723 L20,18 L4,18 C3.44771525,18 3,17.5522847 3,17 C3,16.4871642 3.38604019,16.0644928 3.88337887,16.0067277 L4,16 L20,16 L4,16 Z M4,11 L20,11 C20.5522847,11 21,11.4477153 21,12 C21,12.5128358 20.6139598,12.9355072 20.1166211,12.9932723 L20,13 L4,13 C3.44771525,13 3,12.5522847 3,12 C3,11.4871642 3.38604019,11.0644928 3.88337887,11.0067277 L4,11 Z M4,6 L20,6 C20.5522847,6 21,6.44771525 21,7 C21,7.51283584 20.6139598,7.93550716 20.1166211,7.99327227 L20,8 L4,8 C3.44771525,8 3,7.55228475 3,7 C3,6.48716416 3.38604019,6.06449284 3.88337887,6.00672773 L4,6 Z"}),"Menu"),fn=Object(S.a)(r.a.createElement("path",{d:"M12,1 C18.0751322,1 23,5.92486775 23,12 C23,18.0751322 18.0751322,23 12,23 C5.92486775,23 1,18.0751322 1,12 C1,5.92486775 5.92486775,1 12,1 Z M12,3 C7.02943725,3 3,7.02943725 3,12 C3,16.9705627 7.02943725,21 12,21 C16.9705627,21 21,16.9705627 21,12 C21,7.02943725 16.9705627,3 12,3 Z M11.9779053,15.294165 C12.6523978,15.294165 13.1985107,15.8124506 13.1985107,16.4732666 C13.1985107,17.1238794 12.6418359,17.6523682 11.9779053,17.6523682 C11.3175981,17.6523682 10.7572998,17.1168932 10.7572998,16.4732666 C10.7572998,15.8194152 11.3070616,15.294165 11.9779053,15.294165 Z M12.3306885,6.9 C14.2795758,6.9 15.719873,7.96860761 15.719873,9.65625 C15.719873,10.6709643 15.2884676,11.3128276 14.2962576,12.0165438 L13.7962596,12.3573922 C13.1714716,12.7953495 12.9391113,13.1198405 12.9391113,13.5887451 L12.9391113,13.7132568 C12.9391113,14.2033083 12.5618823,14.5499512 11.9986572,14.5499512 C11.4068652,14.5499512 11.0789551,14.2281702 11.0789551,13.630249 L11.0789551,13.4953613 C11.0789551,12.5573197 11.487326,11.9745882 12.4189711,11.3276124 L12.7619755,11.0871498 C13.5110635,10.5470305 13.7248291,10.2540011 13.7248291,9.73925781 C13.7248291,8.99900037 13.149745,8.51113281 12.2580566,8.51113281 C11.6278214,8.51113281 11.1498312,8.8062186 10.7980484,9.38963394 L10.5277106,9.73161327 L10.5277106,9.73161327 L10.4428973,9.8298462 C10.2452762,10.0412654 10.0433297,10.1297852 9.70556641,10.1297852 C9.27040611,10.1297852 8.9,9.79174463 8.9,9.31384277 C8.9,9.13743147 8.92867764,8.96536563 8.98734042,8.76592778 C9.31829759,7.6784971 10.623966,6.9 12.3306885,6.9 Z"}),"Help"),bn=Object(S.a)(r.a.createElement("path",{d:"M13.4542714,1 C14.5034049,1 15.447759,1.80035641 15.6254934,2.83409123 L15.8863908,4.35151652 C16.4016786,4.58533298 16.8892685,4.86975342 17.3418997,5.20083722 L18.729489,4.68523838 C19.7215225,4.31661974 20.8874905,4.74674629 21.4093705,5.66596818 L22.3631385,7.34590292 C22.8807104,8.25753682 22.6641696,9.47960173 21.8668015,10.158283 L20.7203437,11.1340925 C20.7523279,11.4263818 20.768775,11.713662 20.768775,12 C20.768775,12.2863013 20.7523321,12.5735444 20.7203561,12.8657949 L21.8666717,13.8411466 C22.6665193,14.5217032 22.8803536,15.7423983 22.3631806,16.6535107 L21.4094127,18.3337799 C20.8871999,19.2537711 19.7186485,19.6823124 18.729489,19.3147616 L17.3418997,18.7991628 C16.8892685,19.1302466 16.4016786,19.414667 15.8863908,19.6484835 L15.6254934,21.1659088 C15.4482371,22.1968626 14.500959,23 13.4542714,23 L11.5464067,23 C10.4973482,23 9.55294448,22.1997516 9.37499917,21.1661206 L9.11371177,19.6483803 C8.59870239,19.4145642 8.11116816,19.1301583 7.65836517,18.7991106 L6.27103566,19.3147347 C5.27906015,19.683419 4.11313098,19.25315 3.59116388,18.3339086 L2.63706709,16.6536394 C2.11936149,15.741903 2.33579039,14.5197379 3.13332831,13.8411466 L4.27990265,12.8655748 C4.24777315,12.5724368 4.23122501,12.2856623 4.23122501,12 C4.23122501,11.7143012 4.24777739,11.4274899 4.27991498,11.1343127 L3.1331985,10.158283 C2.33341387,9.47754488 2.11971252,8.25678535 2.6371093,7.34577419 L3.59120609,5.66583945 C4.11357343,4.74607633 5.28204594,4.31769072 6.27103566,4.68526527 L7.65836517,5.20088944 C8.02060756,4.93605128 8.40507795,4.70106385 8.80806121,4.49794854 L9.11371177,4.35161967 L9.37499917,2.83387942 C9.55246572,1.80302941 10.4997942,1 11.5464067,1 L13.4542714,1 Z M13.4542714,3 L11.5464067,3 C11.4759721,3 11.3587093,3.09940116 11.3460046,3.17319893 L10.9911423,5.23448734 C10.9307198,5.5854636 10.6881938,5.87781899 10.3544182,6.00203275 C9.66471384,6.25870451 9.03276419,6.62813555 8.48454956,7.09507573 C8.20871593,7.3300162 7.82737524,7.39737412 7.48774669,7.2711455 L5.57427032,6.55997006 C5.50662795,6.53482964 5.36908018,6.58525743 5.33030218,6.65353615 L4.37620539,8.3334709 C4.33235155,8.41068695 4.36153792,8.57741281 4.42951339,8.63527025 L5.99467372,9.96745916 C6.26327177,10.1960769 6.39156502,10.5492878 6.3322987,10.8969923 C6.26535074,11.2897637 6.23122501,11.6509097 6.23122501,12 C6.23122501,12.3490903 6.26535074,12.7102363 6.3322987,13.1030077 C6.39157523,13.4507721 6.26322722,13.80404 5.99454391,14.0326513 L4.42938358,15.3643802 C4.36263141,15.4211768 4.33280785,15.5895892 4.3762476,15.6660914 L5.33034439,17.3463606 C5.36962791,17.4155432 5.5053715,17.4656373 5.57427032,17.4400299 L7.48774669,16.7288545 C7.82737524,16.6026259 8.20871593,16.6699838 8.48454956,16.9049243 C9.03276419,17.3718644 9.66471384,17.7412955 10.3544182,17.9979673 C10.6881938,18.122181 10.9307198,18.4145364 10.9911423,18.7655127 L11.3460046,20.8268011 C11.3591616,20.9032262 11.473368,21 11.5464067,21 L13.4542714,21 C13.5246311,21 13.6417446,20.9007069 13.6544151,20.8270129 L14.0088212,18.7657245 C14.0691981,18.4145617 14.3118672,18.1220527 14.6458423,17.9978703 C15.3359969,17.7412494 15.9677081,17.3719578 16.5150513,16.9052644 C16.7908836,16.6700754 17.1723926,16.6025695 17.512181,16.7288276 L19.4261097,17.4400031 C19.4938321,17.4651673 19.631347,17.4147366 19.6700861,17.3464893 L20.623854,15.6662201 C20.6677382,15.5889085 20.6385289,15.422164 20.5706164,15.3643802 L19.0054561,14.0326513 C18.7363402,13.803672 18.6080436,13.4496677 18.6679701,13.1014383 C18.7347206,12.7135552 18.768775,12.3516302 18.768775,12 C18.768775,11.6483698 18.7347206,11.2864448 18.6679701,10.8985617 C18.6080539,10.5503923 18.7362957,10.196445 19.0053263,9.96745916 L20.5704866,8.63527025 C20.6374086,8.57830946 20.6672761,8.40975011 20.6238962,8.33334216 L19.6701283,6.65340742 C19.6309511,6.58440211 19.4952014,6.53432393 19.4261097,6.55999695 L17.512181,7.27117239 C17.1723926,7.39743055 16.7908836,7.32992456 16.5150513,7.09473562 C15.9677081,6.62804223 15.3359969,6.25875055 14.6458423,6.00212967 C14.3118672,5.87794735 14.0691981,5.58543825 14.0088212,5.23427554 L13.6544151,3.17298713 C13.6412929,3.0966658 13.5272352,3 13.4542714,3 Z M12.5,10 C13.6045695,10 14.5,10.8954305 14.5,12 C14.5,13.1045695 13.6045695,14 12.5,14 C11.3954305,14 10.5,13.1045695 10.5,12 C10.5,10.8954305 11.3954305,10 12.5,10 Z"}),"Settings");class Cn extends r.a.Component{constructor(e){var t;super(e),t=this,this.onUpdateAuthorizationState=e=>{this.setState({authorizationState:e.authorization_state})},this.handleMenuOpen=e=>{const t=this.state.authorizationState;Object(Ae.q)(t)&&this.setState({anchorEl:e.currentTarget})},this.handleMenuClose=()=>{this.setState({anchorEl:null})},this.handleCheckUpdates=Object(i.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.handleMenuClose();case 1:case"end":return e.stop()}}),e)}))),this.handleNewGroup=e=>{this.handleMenuClose()},this.handleContacts=e=>{this.handleMenuClose(),K.a.clientUpdate({"@type":"clientUpdateContacts",open:!0})},this.handleArchived=e=>{this.handleMenuClose(),Object(G.g)()},this.handleSaved=function(){var e=Object(i.a)(s.a.mark((function e(a){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.handleMenuClose(),e.next=3,K.a.send({"@type":"createPrivateChat",user_id:_.a.getMyId(),force:!0});case 3:if(n=e.sent){e.next=6;break}return e.abrupt("return");case 6:Object(G.h)(n.id);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleSettings=function(){var e=Object(i.a)(s.a.mark((function e(a){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.handleMenuClose(),e.next=3,K.a.send({"@type":"createPrivateChat",user_id:_.a.getMyId(),force:!0});case 3:if(n=e.sent){e.next=6;break}return e.abrupt("return");case 6:K.a.clientUpdate({"@type":"clientUpdateSettings",open:!0,chatId:n.id});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleHelp=e=>{this.handleMenuClose()},this.state={authorizationState:Z.a.getAuthorizationState(),anchorEl:null}}componentDidMount(){Z.a.on("updateAuthorizationState",this.onUpdateAuthorizationState)}componentWillUnmount(){Z.a.off("updateAuthorizationState",this.onUpdateAuthorizationState)}render(){const e=this.props,t=e.t,a=e.showClose,n=e.onClose,s=this.state,i=s.anchorEl,o=s.authorizationState,c=!a&&Object(Ae.q)(o)?r.a.createElement(mn.a,{id:"main-menu",anchorEl:i,open:Boolean(i),onClose:this.handleMenuClose,getContentAnchorEl:null,disableAutoFocusItem:!0,disableRestoreFocus:!0,anchorOrigin:{vertical:"bottom",horizontal:"left"}},r.a.createElement(ft.a,{onClick:this.handleNewGroup},r.a.createElement(pe.a,null,r.a.createElement(Pa,null)),r.a.createElement(me.a,{primary:t("NewGroup")})),r.a.createElement(ft.a,{onClick:this.handleContacts},r.a.createElement(pe.a,null,r.a.createElement(La,null)),r.a.createElement(me.a,{primary:t("Contacts")})),r.a.createElement(ft.a,{onClick:this.handleArchived},r.a.createElement(pe.a,null,r.a.createElement(wa,null)),r.a.createElement(me.a,{primary:t("Archived")})),r.a.createElement(ft.a,{onClick:this.handleSaved},r.a.createElement(pe.a,null,r.a.createElement(k,null)),r.a.createElement(me.a,{primary:t("Saved")})),r.a.createElement(ft.a,{onClick:this.handleSettings},r.a.createElement(pe.a,null,r.a.createElement(bn,null)),r.a.createElement(me.a,{primary:t("Settings")})),r.a.createElement(ft.a,{onClick:this.handleHelp},r.a.createElement(pe.a,null,r.a.createElement(fn,null)),r.a.createElement(me.a,{primary:t("SettingsHelp")}))):null;return r.a.createElement(r.a.Fragment,null,r.a.createElement(C.a,{"aria-owns":i?"simple-menu":null,"aria-haspopup":"true",className:"header-left-button","aria-label":"Menu",onClick:a?n:this.handleMenuOpen},r.a.createElement(Mt.a,{open:a,openIcon:r.a.createElement(Te,null),icon:r.a.createElement(gn,null)})),c)}}var yn=Object(f.d)()(Cn);a(462);class vn extends r.a.Component{constructor(...e){super(...e),this.handleKeyDown=e=>{if(13===e.keyCode)e.preventDefault();else if(27===e.keyCode){const t=this.props,a=t.onChange,n=t.onClose,s=e.target;if(!s)return;if(s.innerText)return e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),s.innerText=null,void(a&&a(s.innerText));n&&(e.stopPropagation(),e.target.blur(),n())}},this.handleKeyUp=e=>{const t=e.target;if(!t)return;const a=t.innerHTML;"<br>"!==a&&"<div><br></div>"!==a||(t.innerHTML=null)},this.handlePaste=e=>{const t=e.clipboardData.getData("text/plain");t&&(e.preventDefault(),document.execCommand("insertText",!1,t))},this.handleInput=e=>{const t=this.props.onChange,a=e.target;a&&t&&t(a.innerText)}}render(){const e=this.props,t=e.inputRef,a=e.t,n=e.onFocus;return r.a.createElement("div",{className:"search-input"},r.a.createElement("div",{id:"search-inputbox",ref:t,placeholder:a("Search"),contentEditable:!0,suppressContentEditableWarning:!0,onKeyDown:this.handleKeyDown,onKeyUp:this.handleKeyUp,onPaste:this.handlePaste,onInput:this.handleInput,onFocus:n}),r.a.createElement(kt,{className:"search-input-icon"}))}}var En=Object(f.d)()(vn);a(344);class Un extends r.a.Component{constructor(e){super(e),this.onUpdateAuthorizationState=e=>{this.setState({authorizationState:e.authorization_state})},this.handleSearch=()=>{const e=this.props,t=e.onSearch,a=e.openSearch,n=this.state.authorizationState;Object(Ae.q)(n)&&t(!a)},this.handleSearchTextChange=()=>{const e=this.props.onSearchTextChange,t=this.searchInputRef.current;if(!t)return;const a=t.innerHTML;"<br>"!==a&&"<div><br></div>"!==a||(t.innerHTML=null),e(t.innerText)},this.handleCloseSearch=()=>{this.handleSearch()},this.handleFocus=()=>{this.handleSearch()},this.searchInputRef=r.a.createRef(),this.state={authorizationState:Z.a.getAuthorizationState(),open:!1}}setInitQuery(e){const t=this.props.onSearchTextChange,a=this.searchInputRef.current;if(a){if(a.innerText=e,a.childNodes.length>0){const e=document.createRange();e.setStart(a.childNodes[0],a.childNodes[0].length),e.collapse(!0);const t=window.getSelection();t.removeAllRanges(),t.addRange(e)}a.focus(),t(e)}}componentDidUpdate(e,t,a){const n=this.props,s=n.openSearch;n.text;if(s!==e.openSearch){const e=this.searchInputRef.current;s?setTimeout(()=>{e&&e.focus()},p.a):e.innerText=null}}componentDidMount(){Z.a.on("updateAuthorizationState",this.onUpdateAuthorizationState)}componentWillUnmount(){Z.a.off("updateAuthorizationState",this.onUpdateAuthorizationState)}render(){let e=null,t=!1;return this.props.openSearch?(t=!0,e=r.a.createElement(En,{inputRef:this.searchInputRef,onChange:this.handleSearchTextChange,onClose:this.handleCloseSearch})):e=r.a.createElement(En,{inputRef:this.searchInputRef,onFocus:this.handleFocus}),r.a.createElement("div",{className:"header-master"},r.a.createElement(yn,{showClose:t,onClose:this.handleCloseSearch}),e)}}var Sn=Un,kn=a(327);a(463);class Mn extends r.a.Component{constructor(e){super(e),this.handleKeyDown=e=>{switch(e.preventDefault(),e.stopPropagation(),e.target.blur(),e.key){case"Escape":const e=this.props.onClose;e&&e()}},this.keyboardHandler=new Xa(this.handleKeyDown)}componentDidUpdate(e,t,a){const n=this.props.open;e.open!==n&&(n?$a.add(this.keyboardHandler):$a.remove(this.keyboardHandler))}render(){const e=this.props,t=e.children,a=e.open,n=e.onClose;return r.a.createElement(kn.a,{direction:"right",in:a,mountOnEnter:!0,unmountOnExit:!0},r.a.createElement("div",{className:"sidebar-page"},n?r.a.cloneElement(t,{onClose:n}):t))}}var In=Mn,wn=Object(S.a)(r.a.createElement("path",{d:"M7.70710678,20.7071068 C7.5195704,20.8946432 7.26521649,21 7,21 L4,21 C3.44771525,21 3,20.5522847 3,20 L3,17 C3,16.7347835 3.10535684,16.4804296 3.29289322,16.2928932 L16.5857864,3 C17.3257272,2.26005924 18.5012114,2.22111499 19.2869988,2.88316725 L19.4142136,3 L21,4.58578644 C21.7399408,5.3257272 21.778885,6.50121136 21.1168328,7.28699879 L21,7.41421356 L7.70710678,20.7071068 Z M5,17.4142136 L5,19 L6.58578644,19 L16.5857864,9 L15,7.41421356 L5,17.4142136 Z M18,4.41421356 L16.414,5.99921356 L18,7.58521356 L19.5857864,6 L18,4.41421356 Z"}),"Edit"),_n=Object(S.a)(r.a.createElement("path",{d:"M11,2 C13.209139,2 15,3.790861 15,6 C15,6.55228475 14.5522847,7 14,7 C13.4477153,7 13,6.55228475 13,6 L13,6 L12.9945143,5.85073766 C12.9181651,4.81587779 12.0543618,4 11,4 L11,4 L6,4 C4.8954305,4 4,4.8954305 4,6 L4,6 L4,18 C4,19.1045695 4.8954305,20 6,20 L6,20 L11,20 C12.1045695,20 13,19.1045695 13,18 L13,18 L13.0067277,17.8833789 C13.0644928,17.3860402 13.4871642,17 14,17 C14.5522847,17 15,17.4477153 15,18 C15,20.209139 13.209139,22 11,22 L11,22 L6,22 C3.790861,22 2,20.209139 2,18 L2,18 L2,6 C2,3.790861 3.790861,2 6,2 L6,2 Z M18.7071068,7.29289322 L22.7071068,11.2928932 C22.7355731,11.3213595 22.7623312,11.3515341 22.787214,11.3832499 L22.7071068,11.2928932 C22.7425008,11.3282873 22.774687,11.3656744 22.8036654,11.4046934 C22.8215099,11.4288693 22.8382813,11.453725 22.8539326,11.4793398 C22.8613931,11.4913869 22.8685012,11.5036056 22.8753288,11.5159379 C22.8862061,11.5357061 22.8966234,11.5561086 22.9063462,11.5769009 C22.914321,11.5939015 22.9218036,11.6112044 22.9287745,11.628664 C22.9366843,11.6484208 22.9438775,11.6682023 22.9504533,11.6882636 C22.9552713,11.7031487 22.9599023,11.7185367 22.9641549,11.734007 C22.9701664,11.7555635 22.9753602,11.7772539 22.9798348,11.7992059 C22.9832978,11.8166247 22.9863719,11.834051 22.9889822,11.8515331 C22.9962388,11.8996379 23,11.9493797 23,12 L22.9962979,11.9137692 C22.9978436,11.9317345 22.9989053,11.9497336 22.9994829,11.9677454 L23,12 C23,12.0112225 22.9998151,12.0224019 22.9994483,12.0335352 C22.9988772,12.050591 22.997855,12.0679231 22.996384,12.0852242 C22.994564,12.1070574 22.9920941,12.1281144 22.9889807,12.1489612 C22.9863719,12.165949 22.9832978,12.1833753 22.9797599,12.2007258 C22.9753602,12.2227461 22.9701664,12.2444365 22.964279,12.2658396 C22.9599023,12.2814633 22.9552713,12.2968513 22.9502619,12.3121425 C22.9438775,12.3317977 22.9366843,12.3515792 22.928896,12.3710585 C22.9218036,12.3887956 22.914321,12.4060985 22.9063266,12.4232215 C22.8966234,12.4438914 22.8862061,12.4642939 22.8751242,12.484277 C22.8685012,12.4963944 22.8613931,12.5086131 22.8540045,12.5207088 C22.8382813,12.546275 22.8215099,12.5711307 22.8036865,12.5951593 C22.7982466,12.602603 22.7927155,12.6098424 22.7870723,12.6170223 C22.7849289,12.6196628 22.7826279,12.6225624 22.7803112,12.625449 L22.7071068,12.7071068 L22.7071068,12.7071068 L18.7071068,16.7071068 C18.3165825,17.0976311 17.6834175,17.0976311 17.2928932,16.7071068 C16.9023689,16.3165825 16.9023689,15.6834175 17.2928932,15.2928932 L19.585,13 L13,13 C12.4871642,13 12.0644928,12.6139598 12.0067277,12.1166211 L12,12 C12,11.4477153 12.4477153,11 13,11 L13,11 L19.585,11 L17.2928932,8.70710678 C16.9023689,8.31658249 16.9023689,7.68341751 17.2928932,7.29289322 C17.6834175,6.90236893 18.3165825,6.90236893 18.7071068,7.29289322 Z"}),"LogOut"),xn=Object(S.a)(r.a.createElement("path",{d:"M12,16 C13.1045695,16 14,16.8954305 14,18 C14,19.1045695 13.1045695,20 12,20 C10.8954305,20 10,19.1045695 10,18 C10,16.8954305 10.8954305,16 12,16 Z M12,10 C13.1045695,10 14,10.8954305 14,12 C14,13.1045695 13.1045695,14 12,14 C10.8954305,14 10,13.1045695 10,12 C10,10.8954305 10.8954305,10 12,10 Z M12,4 C13.1045695,4 14,4.8954305 14,6 C14,7.1045695 13.1045695,8 12,8 C10.8954305,8 10,7.1045695 10,6 C10,4.8954305 10.8954305,4 12,4 Z"}),"More"),On=a(266),Tn=a(267);class Ln extends r.a.Component{constructor(...e){super(...e),this.state={anchorEl:null,open:!1},this.handleMenuOpen=e=>{this.setState({anchorEl:e.currentTarget})},this.handleMenuClose=()=>{this.setState({anchorEl:null})},this.handleLogOut=()=>{this.handleMenuClose(),this.setState({open:!0})},this.handleDone=()=>{this.handleClose(),K.a.logOut()},this.handleClose=()=>{this.setState({open:!1})}}render(){const e=this.props.t,t=this.state,a=t.anchorEl,n=t.open;return r.a.createElement(r.a.Fragment,null,r.a.createElement(C.a,{"aria-owns":a?"simple-menu":null,"aria-haspopup":"true",className:"header-right-button","aria-label":"Menu",onClick:this.handleMenuOpen},r.a.createElement(xn,null)),r.a.createElement(mn.a,{id:"main-menu",anchorEl:a,open:Boolean(a),onClose:this.handleMenuClose,getContentAnchorEl:null,disableAutoFocusItem:!0,disableRestoreFocus:!0,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"}},r.a.createElement(ft.a,{onClick:this.handleLogOut},r.a.createElement(pe.a,null,r.a.createElement(_n,null)),r.a.createElement(me.a,{primary:e("LogOut")}))),r.a.createElement(y.a,{transitionDuration:0,open:n,onClose:this.handleClose,"aria-labelledby":"form-dialog-title"},r.a.createElement(E.a,{id:"form-dialog-title"},e("Confirm")),r.a.createElement(On.a,null,r.a.createElement(Tn.a,{style:{whiteSpace:"pre-wrap"}},e("AreYouSureLogout"))),r.a.createElement(v.a,null,r.a.createElement(b.a,{onClick:this.handleClose,color:"primary"},e("Cancel")),r.a.createElement(b.a,{onClick:this.handleDone,color:"primary"},e("Ok")))))}}var Pn=Object(f.d)()(Ln),Nn=Object(S.a)(r.a.createElement("path",{d:"M12,1 C14.6887547,1 16.8818181,3.12230671 16.9953805,5.78311038 L17,6 L17,8 C18.6568542,8 20,9.34314575 20,11 L20,19 C20,20.6568542 18.6568542,22 17,22 L7,22 C5.34314575,22 4,20.6568542 4,19 L4,11 C4,9.34314575 5.34314575,8 7,8 L7,6 C7,3.23857625 9.23857625,1 12,1 Z M17,10 L7,10 C6.44771525,10 6,10.4477153 6,11 L6,19 C6,19.5522847 6.44771525,20 7,20 L17,20 C17.5522847,20 18,19.5522847 18,19 L18,11 C18,10.4477153 17.5522847,10 17,10 Z M12,13.5 C12.8284271,13.5 13.5,14.1715729 13.5,15 C13.5,15.8284271 12.8284271,16.5 12,16.5 C11.1715729,16.5 10.5,15.8284271 10.5,15 C10.5,14.1715729 11.1715729,13.5 12,13.5 Z M12.1762728,3.00509269 L12,3 C10.4023191,3 9.09633912,4.24891996 9.00509269,5.82372721 L9,6 L9,8 L15,8 L15,6 C15,4.40231912 13.75108,3.09633912 12.1762728,3.00509269 L12,3 L12.1762728,3.00509269 Z"}),"Data"),Dn=Object(S.a)(r.a.createElement("path",{d:"M12.4100787,14.6155108 L10.33,12.56 L10.33,12.56 L10.36,12.53 C12.1,10.59 13.34,8.36 14.07,6 L16,6 C16.5522847,6 17,5.55228475 17,5 C17,4.44771525 16.5522847,4 16,4 L10,4 L10,4 L10,3 C10,2.44771525 9.55228475,2 9,2 C8.44771525,2 8,2.44771525 8,3 L8,4 L8,4 L1.995,4 C1.44547667,4 1,4.44547667 1,4.995 C1,5.54452333 1.44547667,5.99 1.995,5.99 L12.17,5.99 L12.17,5.99 C11.5,7.92 10.44,9.75 9,11.35 C8.29025814,10.5639418 7.67370319,9.7196418 7.15033516,8.83487918 C7.09974701,8.74935905 7.03930045,8.64304956 6.96899548,8.51595071 C6.79288115,8.1975972 6.45776707,8 6.09394677,8 L5.69,8 C5.34408921,8 5.06367311,8.2804161 5.06367311,8.62632689 C5.06367311,8.72554854 5.08724633,8.82335055 5.13246346,8.91167013 C5.1653189,8.97586688 5.19575217,9.03408878 5.22376326,9.08633583 C5.88285067,10.3156835 6.70136504,11.4828779 7.67,12.56 L3.29489879,16.8749328 C2.90279535,17.2616439 2.89842396,17.8929978 3.28513501,18.2851012 C3.28675102,18.2867397 3.28837269,18.2883727 3.29,18.29 L3.29289322,18.2928932 C3.68341751,18.6834175 4.31658249,18.6834175 4.70710678,18.2928932 L9,14 L9,14 L11.3403247,16.3403247 C11.6133932,16.6133932 12.0561246,16.6133932 12.3291931,16.3403247 C12.4001325,16.2693853 12.4549762,16.1840114 12.49,16.09 L12.6442671,15.6759147 C12.7816472,15.3071575 12.6899849,14.8921111 12.4100787,14.6155108 Z M17.8069995,10 L17.1930005,10 C16.7761559,10 16.4030352,10.2585728 16.2566713,10.6488766 L12.3511234,21.0636708 C12.2167367,21.4220355 12.3983067,21.8214894 12.7566713,21.9558761 C12.8344793,21.9850541 12.916901,22 13,22 L13.3059169,22 C13.7232965,22 14.0967782,21.7407727 14.2427584,21.3497542 L15.12,19 L15.12,19 L19.87,19 L20.7561047,21.3524905 C20.9028501,21.74208 21.2756099,22 21.6919201,22 L22,22 C22.3827336,22 22.6930005,21.6897331 22.6930005,21.3069995 C22.6930005,21.2239005 22.6780546,21.1414789 22.6488766,21.0636708 L18.7433287,10.6488766 C18.5969648,10.2585728 18.2238441,10 17.8069995,10 Z M17.5,12.67 L19.12,17 L15.88,17 L17.5,12.67 Z"}),"Language"),jn=a(122),Bn=a.n(jn),Rn=a(583),Fn=a(575),An=a(577),Vn=a(259),zn=a(229),Hn=a(165),Wn=a.n(Hn),Gn=a(166),Zn=a.n(Gn),qn=a(465),Kn=a.n(qn),Yn=a(167),Jn=a.n(Yn),Qn=a(164),Xn=a.n(Qn),$n=a(466),es=a.n($n);a(464);class ts extends r.a.Component{constructor(e){super(e),this.handleChange=e=>{this.setState({type:e.target.value}),Z.a.emit("clientUpdateThemeChanging",{type:e.target.value,primary:this.getColor(this.state.color)})},this.handleAccentChange=e=>{this.setState({color:e.target.value}),Z.a.emit("clientUpdateThemeChanging",{type:this.state.type,primary:this.getColor(e.target.value)})},this.getColorString=e=>{switch(e){case Wn.a[500]:return"red";case Zn.a[500]:return"orange";case Kn.a[500]:return"amber";case Jn.a[500]:return"green";case"#50A2E9":return"blue";case Xn.a[500]:return"indigo";case es.a[500]:return"deepPurple"}return null},this.getColor=e=>{switch(e){case"red":return Wn.a;case"orange":return Zn.a;case"amber":return Kn.a;case"green":return Jn.a;case"blue":return{main:"#50A2E9"};case"indigo":return Xn.a;case"deepPurple":return es.a}return null},this.handleClose=()=>{this.setState({open:!1})},this.open=()=>{this.setState({open:!0})},this.state={open:!1,type:this.props.theme.palette.type,color:this.getColorString(this.props.theme.palette.primary.main)}}render(){const e=this.props.t,t=this.state,a=t.type,n=t.color,s=t.open;return r.a.createElement(y.a,{transitionDuration:0,open:s,onClose:this.handleClose,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},r.a.createElement(E.a,{id:"alert-dialog-title"},e("Appearance")),r.a.createElement(On.a,null,r.a.createElement(Vn.a,{component:"fieldset",className:"theme-picker-form"},r.a.createElement(zn.a,{focused:!0,component:"legend"},e("Theme")),r.a.createElement(Fn.a,{"aria-label":"theme",name:"theme1",className:"theme-picker-group",value:a,onChange:this.handleChange},r.a.createElement(An.a,{value:"light",control:r.a.createElement(Rn.a,{color:"primary"}),label:"Light"}),r.a.createElement(An.a,{value:"dark",control:r.a.createElement(Rn.a,{color:"primary"}),label:"Dark"}))),r.a.createElement(Vn.a,{component:"fieldset",className:"theme-picker-form"},r.a.createElement(zn.a,{focused:!0,component:"legend"},e("Accent")),r.a.createElement(Fn.a,{"aria-label":"accent",name:"accent1",className:"theme-picker-group",value:n,onChange:this.handleAccentChange},r.a.createElement(An.a,{value:"red",control:r.a.createElement(Rn.a,{color:"primary",classes:{root:"theme-picker-red"}}),label:"Red"}),r.a.createElement(An.a,{value:"orange",control:r.a.createElement(Rn.a,{color:"primary",classes:{root:"theme-picker-orange"}}),label:"Orange"}),r.a.createElement(An.a,{value:"amber",control:r.a.createElement(Rn.a,{color:"primary",classes:{root:"theme-picker-amber"}}),label:"Amber"}),r.a.createElement(An.a,{value:"green",control:r.a.createElement(Rn.a,{color:"primary",classes:{root:"theme-picker-green"}}),label:"Green"}),r.a.createElement(An.a,{value:"blue",control:r.a.createElement(Rn.a,{color:"primary",classes:{root:"theme-picker-blue"}}),label:"Blue"}),r.a.createElement(An.a,{value:"indigo",control:r.a.createElement(Rn.a,{color:"primary",classes:{root:"theme-picker-indigo"}}),label:"Indigo"}),r.a.createElement(An.a,{value:"deepPurple",control:r.a.createElement(Rn.a,{color:"primary",classes:{root:"theme-picker-deep-purple"}}),label:"Deep Purple"})))))}}var as=Object(d.a)(Object(d.d)(),Bn.a,Object(f.d)(),Object(d.c)())(ts);a(467);class ns extends r.a.Component{constructor(...e){super(...e),this.handleOpenViewer=()=>{const e=this.props.chatId,t=L.a.get(e);t&&t.photo&&Object(G.q)({chatId:e})}}render(){const e=this.props,t=e.chatId,a=e.t,n=e.onClose,s=e.onEditProfile,i=e.onGeneral,o=e.onNotifications,c=e.onPrivacySecurity,l=e.onLanguage,d=L.a.get(t);if(!d)return null;const h=d.photo;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"header-master"},r.a.createElement(C.a,{className:"header-left-button",onClick:n},r.a.createElement(Te,null)),r.a.createElement("div",{className:"header-status grow cursor-pointer"},r.a.createElement("span",{className:"header-status-content"},a("Settings"))),r.a.createElement(Pn,null)),r.a.createElement("div",{className:"sidebar-page-content"},r.a.createElement("div",{className:"chat-details-info"},r.a.createElement(Oe,{chatId:t,big:!0,showStatus:!0,showSavedMessages:!1,onTileSelect:h?this.handleOpenViewer:null})),r.a.createElement(ue.a,{className:"settings-list-item",button:!0,onClick:s},r.a.createElement(pe.a,null,r.a.createElement(wn,null)),r.a.createElement(me.a,{primary:a("EditProfile")})),r.a.createElement(ue.a,{className:"settings-list-item",button:!0,onClick:i},r.a.createElement(pe.a,null,r.a.createElement(bn,null)),r.a.createElement(me.a,{primary:a("GeneralSettings")})),r.a.createElement(ue.a,{className:"settings-list-item",button:!0,onClick:o},r.a.createElement(pe.a,null,r.a.createElement(Ta,null)),r.a.createElement(me.a,{primary:a("Notifications")})),r.a.createElement(ue.a,{className:"settings-list-item",button:!0,onClick:c},r.a.createElement(pe.a,null,r.a.createElement(Nn,null)),r.a.createElement(me.a,{primary:a("PrivacySettings")})),r.a.createElement(ue.a,{autoFocus:!1,className:"settings-list-item",button:!0,onClick:l},r.a.createElement(pe.a,null,r.a.createElement(Dn,null)),r.a.createElement(me.a,{primary:a("Language")}))))}}var ss=Object(f.d)()(ns),is=a(272);a(468);class os extends r.a.Component{constructor(e){var t;super(e),t=this,this.handleUsernameChange=Object(i.a)(s.a.mark((function e(){var a,n,i,o,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.props.chatId,n=t.state.username,(i=t.usernameRef.current.value).startsWith("@")&&i.length>1&&(i=i.substr(1)),n!==i&&""!==i){e.next=8;break}t.setState({usernameCheck:null}),e.next=14;break;case 8:return e.next=10,K.a.send({"@type":"checkChatUsername",chat_id:a,username:i});case 10:o=e.sent,(r=t.usernameRef.current.value).startsWith("@")&&r.length>1&&(r=r.substr(1)),r===i&&t.setState({usernameCheck:o});case 14:case"end":return e.stop()}}),e)}))),this.firstNameRef=r.a.createRef(),this.lastNameRef=r.a.createRef(),this.bioRef=r.a.createRef(),this.usernameRef=r.a.createRef();const a=_.a.get(_.a.getMyId()),n=_.a.getFullInfo(_.a.getMyId());this.state={firstName:a?a.first_name:"",lastName:a?a.last_name:"",bio:n?n.bio:"",username:a?a.username:"",usernameCheck:null}}componentWillUnmount(){this.setName(),this.setBio(),this.setUsername()}setUsername(){const e=this.state,t=e.username,a=e.usernameCheck;let n=this.usernameRef.current.value;n.startsWith("@")&&n.length>1&&(n=n.substr(1)),t!==n&&a&&"checkChatUsernameResultOk"===a["@type"]&&K.a.send({"@type":"setUsername",username:n})}setName(){const e=this.state,t=e.firstName,a=e.lastName,n=this.firstNameRef.current.value,s=this.lastNameRef.current.value;n===t&&s===a||K.a.send({"@type":"setName",first_name:n,last_name:s})}setBio(){const e=this.state.bio,t=this.bioRef.current.value;t!==e&&K.a.send({"@type":"setBio",bio:t})}render(){let e=this.props,t=e.chatId,a=e.t,n=e.onClose;const s=this.state,i=s.firstName,o=s.lastName,c=s.bio,l=s.username,d=s.usernameCheck;let h=!1,u=a("Username");if(d)switch(d["@type"]){case"checkChatUsernameResultOk":h=!1,u="Username is available";break;case"checkChatUsernameResultPublicChatsTooMuch":case"checkChatUsernameResultPublicGroupsUnavailable":case"checkChatUsernameResultUsernameInvalid":h=!0,u="Invalid username";break;case"checkChatUsernameResultUsernameOccupied":h=!0,u="Username is already taken"}return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"header-master"},r.a.createElement(C.a,{className:"header-left-button",onClick:n},r.a.createElement(Te,null)),r.a.createElement("div",{className:"header-status grow cursor-pointer"},r.a.createElement("span",{className:"header-status-content"},a("EditProfile")))),r.a.createElement("div",{className:"sidebar-page-content"},r.a.createElement("div",{className:"chat-details-info"},r.a.createElement(Oe,{chatId:t,showTitle:!1,big:!0,showStatus:!0,showSavedMessages:!1,onTileSelect:null})),r.a.createElement("div",{className:"edit-profile-name"},r.a.createElement(is.a,{inputRef:this.firstNameRef,className:"edit-profile-input",variant:"outlined",fullWidth:!0,label:a("FirstName"),defaultValue:i}),r.a.createElement(is.a,{inputRef:this.lastNameRef,className:"edit-profile-input",variant:"outlined",fullWidth:!0,label:a("LastName"),defaultValue:o}),r.a.createElement(is.a,{inputRef:this.bioRef,className:"edit-profile-input",variant:"outlined",fullWidth:!0,label:a("Bio"),defaultValue:c}),r.a.createElement("div",{className:"edit-profile-hint"},a("BioAbout"))),r.a.createElement("div",{className:"sidebar-page-section-divider"}),r.a.createElement("div",{className:"edit-profile-username"},r.a.createElement(is.a,{inputRef:this.usernameRef,error:h,className:"edit-profile-input",variant:"outlined",fullWidth:!0,label:u,defaultValue:l,onChange:this.handleUsernameChange}),r.a.createElement("div",{className:"edit-profile-hint"},"You can choose a username on Telegram. If you do, other people will be able to find you by this username and contact you without knowing your phone number. You can use a-z, 0-9 and underscores. Minimum length is 5 characters."))))}}var rs=Object(d.a)(Object(d.d)(),Object(f.d)(),Object(d.c)())(os),cs=Object(S.a)(r.a.createElement("path",{d:"M19.2869988,2.88316725 L19.4142136,3 L21,4.58578644 C21.7399408,5.3257272 21.778885,6.50121136 21.1168328,7.28699879 L21,7.41421356 L17.414,10.9992136 L18.2071068,11.7928932 C18.5976311,12.1834175 18.5976311,12.8165825 18.2071068,13.2071068 C17.8466228,13.5675907 17.2793918,13.5953203 16.8871006,13.2902954 L16.7928932,13.2071068 L16,12.4142136 L7.70710678,20.7071068 C7.55082647,20.8633871 7.34814508,20.9625983 7.13144398,20.9913276 L7,21 L4,21 C3.48716416,21 3.06449284,20.6139598 3.00672773,20.1166211 L3,20 L3,17 C3,16.7789863 3.07316447,16.565516 3.20608063,16.3919705 L3.29289322,16.2928932 L11.585,7.99921356 L10.7928932,7.20710678 C10.4023689,6.81658249 10.4023689,6.18341751 10.7928932,5.79289322 C11.1533772,5.43240926 11.7206082,5.40467972 12.1128994,5.70970461 L12.2071068,5.79289322 L13,6.58521356 L16.5857864,3 C17.3257272,2.26005924 18.5012114,2.22111499 19.2869988,2.88316725 Z M13,9.415 L5,17.414 L5,18.999 L6.585,18.999 L14.585,11 L13,9.415 Z M18,4.41421356 L14.414,7.99921356 L16,9.58521356 L19.5857864,6 L18,4.41421356 Z"}),"Colorize"),ls=(a(469),a(293));class ds extends r.a.Component{constructor(...e){super(...e),this.state={loaded:!1},this.onClientUpdateDocumentThumbnailBlob=e=>{const t=this.props.wallpaper;if(!t)return;const a=t.document;if(!a)return;const n=a.thumbnail;if(!n)return;const s=n.photo;if(!s)return;const i=e.fileId;s.id===i&&this.forceUpdate()},this.handleLoad=()=>{this.setState({loaded:!0})},this.handleClick=()=>{const e=this.props,t=e.wallpaper,a=e.onClick;a&&a(t)}}componentDidMount(){P.a.on("clientUpdateDocumentThumbnailBlob",this.onClientUpdateDocumentThumbnailBlob)}componentWillUnmount(){P.a.off("clientUpdateDocumentThumbnailBlob",this.onClientUpdateDocumentThumbnailBlob)}render(){const e=this.props,t=e.wallpaper,a=e.isSelected,n=(this.state.loaded,t.document),s=n.minithumbnail,i=n.thumbnail,o=s?"data:image/jpeg;base64, "+s.data:null,c=Object(T.j)(i?i.photo:null),l=c||o;return r.a.createElement("div",{className:"shared-photo",onClick:this.handleClick},r.a.createElement("div",{className:"shared-photo-content",style:{backgroundImage:"url(".concat(c||o,")"),backgroundSize:"cover",backgroundPosition:"50%"}},l!==c&&r.a.createElement("div",{className:"shared-photo-main-content",style:{backgroundImage:"url(".concat(l,")")}})),a&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"wallpaper-selected"}),r.a.createElement("div",{className:"wallpaper-selected-inner"})),n&&n.document&&r.a.createElement(ls.a,{file:n.document,cancelButton:!1}))}}var hs=ds;a(470);class us extends r.a.Component{constructor(...e){super(...e),this.state={selectedId:L.a.wallpaper?L.a.wallpaper.id:-1},this.handleClick=e=>{this.setState({selectedId:e.id});const t=e.document;if(!t)return;t.thumbnail;const a=t.document;if(a){if(!Object(T.j)(a)){const t=P.a.getStore();Object(T.o)(t,e,!0)}K.a.clientUpdate({"@type":"clientUpdateChatBackground",wallpaper:e})}}}componentDidMount(){this.loadContent()}loadContent(){const e=this.props.backgrounds;if(!e)return;const t=P.a.getStore();Object(T.p)(t,e.backgrounds)}render(){const e=this.props,t=e.t,a=e.backgrounds,n=e.onClose,s=this.state.selectedId,i=a.backgrounds.filter(e=>"backgroundTypeWallpaper"===e.type["@type"]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"header-master"},r.a.createElement(C.a,{className:"header-left-button",onClick:n},r.a.createElement(Te,null)),r.a.createElement("div",{className:"header-status grow cursor-pointer"},r.a.createElement("span",{className:"header-status-content"},t("ChatBackground")))),r.a.createElement("div",{className:"sidebar-page-content shared-media-list shared-photos-list"},i.map(e=>r.a.createElement(hs,{key:e.id,wallpaper:e,isSelected:e.id===s,onClick:this.handleClick}))))}}var ps=Object(f.d)()(us);a(471);class ms extends r.a.Component{constructor(e){super(e),this.handleAppearance=()=>{this.themePickerRef.current.open()},this.loadContent=()=>{K.a.send({"@type":"getBackgrounds",for_dark_theme:!1}).then(e=>this.setState({backgrounds:e}))},this.openChatBackground=()=>{this.state.backgrounds&&this.setState({openChatBackground:!0})},this.closeChatBackground=()=>{this.setState({openChatBackground:!1})},this.state={backgrounds:null},this.themePickerRef=r.a.createRef()}componentDidMount(){this.loadContent()}render(){const e=this.props,t=e.t,a=e.onClose,n=this.state,s=n.backgrounds,i=n.openChatBackground;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"header-master"},r.a.createElement(C.a,{className:"header-left-button",onClick:a},r.a.createElement(Te,null)),r.a.createElement("div",{className:"header-status grow cursor-pointer"},r.a.createElement("span",{className:"header-status-content"},t("GeneralSettings")))),r.a.createElement("div",{className:"sidebar-page-content"},r.a.createElement("div",{className:"sidebar-page-section"},r.a.createElement(ue.a,{autoFocus:!1,className:"settings-list-item",button:!0,onClick:this.openChatBackground},r.a.createElement(pe.a,null,r.a.createElement(be,null)),r.a.createElement(me.a,{primary:t("ChatBackground")})),r.a.createElement(ue.a,{autoFocus:!1,className:"settings-list-item",button:!0,onClick:this.handleAppearance},r.a.createElement(pe.a,null,r.a.createElement(cs,null)),r.a.createElement(me.a,{primary:t("Appearance")})))),r.a.createElement(In,{open:i,onClose:this.closeChatBackground},r.a.createElement(ps,{backgrounds:s})),r.a.createElement(as,{ref:this.themePickerRef}))}}var gs=Object(d.a)(Object(d.d)(),Object(f.d)(),Object(d.c)())(ms),fs=a(64);a(472);class bs extends r.a.Component{constructor(e){super(e),this.handleChange=e=>{this.setState({language:e}),K.a.clientUpdate({"@type":"clientUpdateLanguageChange",language:e})};const t=e.i18n,a=t?t.language:null;this.state={language:a||"en"}}render(){const e=this.props,t=e.t,a=e.onClose,n=this.state.language,s=(fs.a.info||{language_packs:[]}).language_packs.map(e=>r.a.createElement("div",{key:e.id,className:"settings-item",onClick:()=>this.handleChange(e.id)},r.a.createElement(Rn.a,{color:"primary",className:"settings-item-control",checked:n===e.id,tabIndex:-1,inputProps:{"aria-labelledby":"label-2"}}),r.a.createElement(me.a,{id:"label-2",primary:e.name,secondary:e.native_name})));return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"header-master"},r.a.createElement(C.a,{className:"header-left-button",onClick:a},r.a.createElement(Te,null)),r.a.createElement("div",{className:"header-status grow cursor-pointer"},r.a.createElement("span",{className:"header-status-content"},t("Language")))),r.a.createElement("div",{className:"sidebar-page-content"},s))}}var Cs=Object(d.a)(Object(d.d)(),Object(f.d)(),Object(d.c)())(bs),ys=a(274);a(473);class vs extends r.a.Component{constructor(e){super(e),this.handleMuteFor=e=>{const t=this.state[e];if(!t)return;const a=t.mute_for,n=Object(Ve.a)({},t,{mute_for:0===a?31536e3:0});this.setState({[e]:n})},this.handleShowPreview=e=>{const t=this.state[e];if(!t)return;const a=t.show_preview,n=Object(Ve.a)({},t,{show_preview:!a});this.setState({[e]:n})},this.handleContactJoined=()=>{this.setState({contactJoined:!this.state.contactJoined})};const t=F.a.get("disable_contact_registered_notifications");this.state={privateChatsSettings:Ke.a.settings.get("notificationSettingsScopePrivateChats"),groupChatsSettings:Ke.a.settings.get("notificationSettingsScopeGroupChats"),channelChatsSettings:Ke.a.settings.get("notificationSettingsScopeChannelChats"),contactJoined:!t||!t.value}}componentWillUnmount(){const e=this.state,t=e.privateChatsSettings,a=e.groupChatsSettings,n=e.channelChatsSettings,s=e.contactJoined;this.setScopeNotificationSettings("notificationSettingsScopePrivateChats",t),this.setScopeNotificationSettings("notificationSettingsScopeGroupChats",a),this.setScopeNotificationSettings("notificationSettingsScopeChannelChats",n),this.setContactJoinedOption(s)}setContactJoinedOption(){const e=this.state.contactJoined,t=F.a.get("disable_contact_registered_notifications");(!t||!t.value)!==e&&K.a.send({"@type":"setOption",name:"disable_contact_registered_notifications",value:{"@type":"optionValueBoolean",value:!e}})}setScopeNotificationSettings(e,t){if(!e)return;if(!t)return;const a=Ke.a.settings.get(e);if(!a)return;const n=t.mute_for,s=t.show_preview,i=a.mute_for,o=a.show_preview;n===i&&s===o||K.a.send({"@type":"setScopeNotificationSettings",scope:{"@type":e},notification_settings:t})}isEnabled(e){if(!e)return!1;return 0===e.mute_for}showPreview(e){if(!e)return!1;return e.show_preview}render(){const e=this.props,t=e.t,a=e.onClose,n=this.state,s=n.privateChatsSettings,i=n.groupChatsSettings,o=n.channelChatsSettings,c=n.contactJoined;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"header-master"},r.a.createElement(C.a,{className:"header-left-button",onClick:a},r.a.createElement(Te,null)),r.a.createElement("div",{className:"header-status grow cursor-pointer"},r.a.createElement("span",{className:"header-status-content"},t("Notifications")))),r.a.createElement("div",{className:"sidebar-page-content"},r.a.createElement("div",{className:"sidebar-page-section"},r.a.createElement(hn,null,t("NotificationsPrivateChats")),r.a.createElement("div",{className:"settings-item",onClick:()=>this.handleMuteFor("privateChatsSettings")},r.a.createElement(ys.a,{color:"primary",className:"settings-item-control",checked:this.isEnabled(s),tabIndex:-1,inputProps:{"aria-labelledby":"label-1"}}),r.a.createElement(me.a,{id:"label-1",primary:t("NotificationsForPrivateChats"),secondary:this.isEnabled(s)?t("NotificationsEnabled"):t("NotificationsDisabled")})),r.a.createElement("div",{className:"settings-item",onClick:()=>this.handleShowPreview("privateChatsSettings")},r.a.createElement(ys.a,{color:"primary",className:"settings-item-control",checked:this.showPreview(s),tabIndex:-1,inputProps:{"aria-labelledby":"label-2"}}),r.a.createElement(me.a,{id:"label-2",primary:t("MessagePreview"),secondary:this.showPreview(s)?t("PreviewEnabled"):t("PreviewDisabled")}))),r.a.createElement("div",{className:"sidebar-page-section-divider"}),r.a.createElement("div",{className:"sidebar-page-section"},r.a.createElement(hn,null,t("NotificationsGroups")),r.a.createElement("div",{className:"settings-item",onClick:()=>this.handleMuteFor("groupChatsSettings")},r.a.createElement(ys.a,{color:"primary",className:"settings-item-control",checked:this.isEnabled(i),tabIndex:-1,inputProps:{"aria-labelledby":"label-1"}}),r.a.createElement(me.a,{id:"label-1",primary:t("NotificationsForGroups"),secondary:this.isEnabled(i)?t("NotificationsEnabled"):t("NotificationsDisabled")})),r.a.createElement("div",{className:"settings-item",onClick:()=>this.handleShowPreview("groupChatsSettings")},r.a.createElement(ys.a,{color:"primary",className:"settings-item-control",checked:this.showPreview(i),tabIndex:-1,inputProps:{"aria-labelledby":"label-2"}}),r.a.createElement(me.a,{id:"label-2",primary:t("MessagePreview"),secondary:this.showPreview(i)?t("PreviewEnabled"):t("PreviewDisabled")}))),r.a.createElement("div",{className:"sidebar-page-section-divider"}),r.a.createElement("div",{className:"sidebar-page-section"},r.a.createElement(hn,null,t("NotificationsChannels")),r.a.createElement("div",{className:"settings-item",onClick:()=>this.handleMuteFor("channelChatsSettings")},r.a.createElement(ys.a,{color:"primary",className:"settings-item-control",checked:this.isEnabled(o),tabIndex:-1,inputProps:{"aria-labelledby":"label-1"}}),r.a.createElement(me.a,{id:"label-1",primary:t("NotificationsForChannels"),secondary:this.isEnabled(o)?t("NotificationsEnabled"):t("NotificationsDisabled")})),r.a.createElement("div",{className:"settings-item",onClick:()=>this.handleShowPreview("channelChatsSettings")},r.a.createElement(ys.a,{color:"primary",className:"settings-item-control",checked:this.showPreview(o),tabIndex:-1,inputProps:{"aria-labelledby":"label-2"}}),r.a.createElement(me.a,{id:"label-2",primary:t("MessagePreview"),secondary:this.showPreview(o)?t("PreviewEnabled"):t("PreviewDisabled")}))),r.a.createElement("div",{className:"sidebar-page-section-divider"}),r.a.createElement("div",{className:"sidebar-page-section"},r.a.createElement(hn,null,t("NotificationsOther")),r.a.createElement("div",{className:"settings-item",onClick:this.handleContactJoined},r.a.createElement(ys.a,{color:"primary",className:"settings-item-control",checked:c,tabIndex:-1,inputProps:{"aria-labelledby":"label-1"}}),r.a.createElement(me.a,{id:"label-1",primary:t("ContactJoined"),secondary:t(c?"ContactJoinedEnabled":"ContactJoinedDisabled")})))))}}var Es=Object(d.a)(Object(d.d)(),Object(f.d)(),Object(d.c)())(vs),Us=Object(S.a)(r.a.createElement("g",{transform:"translate(-1.000000, -1.000000)",fillRule:"nonzero"},r.a.createElement("path",{d:"M12,1 C18.0751322,1 23,5.92486775 23,12 C23,18.0751322 18.0751322,23 12,23 C5.92486775,23 1,18.0751322 1,12 C1,5.92486775 5.92486775,1 12,1 Z M12,3 C7.02943725,3 3,7.02943725 3,12 C3,16.9705627 7.02943725,21 12,21 C16.9705627,21 21,16.9705627 21,12 C21,7.02943725 16.9705627,3 12,3 Z M8,11 L16,11 C16.5522847,11 17,11.4477153 17,12 C17,12.5128358 16.6139598,12.9355072 16.1166211,12.9932723 L16,13 L8,13 C7.44771525,13 7,12.5522847 7,12 C7,11.4871642 7.38604019,11.0644928 7.88337887,11.0067277 L8,11 L16,11 L8,11 Z"})),"Stop");a(474);class Ss extends r.a.Component{constructor(...e){super(...e),this.state={contextMenu:!1,left:0,top:0},this.handleContextMenu=e=>{e&&(e.preventDefault(),e.stopPropagation());const t=this.props.session;if(t&&!t.is_current)if(this.state.contextMenu)this.setState({contextMenu:!1});else{const t=e.clientX,a=e.clientY;this.setState({contextMenu:!0,left:t,top:a})}},this.handleCloseContextMenu=e=>{this.setState({contextMenu:!1,left:0,top:0})},this.handleTerminate=e=>{this.handleCloseContextMenu(e);const t=this.props;(0,t.onTerminate)(t.session)}}render(){const e=this.props,t=e.session,a=e.t;if(!t)return null;const n=this.state,s=n.left,i=n.top,o=n.contextMenu,c=t.is_current,l=t.application_name,d=t.application_version,h=t.device_model,u=t.platform,p=t.system_version,m=t.ip,g=t.region,f=t.country,b=t.last_active_date,C=!c;return r.a.createElement(r.a.Fragment,null,r.a.createElement(ue.a,{className:"settings-list-item",button:!0,onContextMenu:this.handleContextMenu},r.a.createElement("div",{className:"session"},r.a.createElement("div",{className:"session-title"},r.a.createElement("div",{className:"session-app"},"".concat(l," ").concat(d)),C&&r.a.createElement("div",{className:"session-date"},Object(w.A)({date:b}))),r.a.createElement("div",{className:"session-subtitle1"},"".concat(h,", ").concat(u," ").concat(p)),r.a.createElement("div",{className:"session-subtitle2"},"".concat(m," - "),g&&"".concat(g,", "),f&&"".concat(f)))),r.a.createElement(bt.a,{open:o,onClose:this.handleCloseContextMenu,anchorReference:"anchorPosition",anchorPosition:{top:i,left:s},anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"},onMouseDown:e=>e.stopPropagation()},r.a.createElement(gt.a,{onClick:e=>e.stopPropagation()},r.a.createElement(ft.a,{onClick:this.handleTerminate},r.a.createElement(pe.a,null,r.a.createElement(Us,null)),r.a.createElement(me.a,{primary:a("Terminate")})))))}}var ks=Object(f.d)()(Ss);a(475);class Ms extends r.a.Component{constructor(...e){var t;super(...e),t=this,this.state={open:!1,openAll:!1,session:null},this.handleTerminate=e=>{this.setState({open:!0,session:e})},this.handleTerminateAllOther=()=>{this.setState({openAll:!0})},this.handleCloseConfirmation=()=>{this.setState({open:!1,session:null})},this.handleDoneConfirmation=Object(i.a)(s.a.mark((function e(){var a,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.props.sessions,n=t.state.session){e.next=4;break}return e.abrupt("return");case 4:return t.setState({open:!1,session:null}),e.next=7,K.a.send({"@type":"terminateSession",session_id:n.id});case 7:a.sessions=a.sessions.filter(e=>e.id!==n.id),t.forceUpdate();case 9:case"end":return e.stop()}}),e)}))),this.handleCloseAllConfirmation=()=>{this.setState({openAll:!1})},this.handleDoneAllConfirmation=Object(i.a)(s.a.mark((function e(){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.props.sessions,t.setState({openAll:!1}),e.next=4,K.a.send({"@type":"terminateAllOtherSessions"});case 4:a.sessions=a.sessions.filter(e=>!e.is_current),t.forceUpdate();case 6:case"end":return e.stop()}}),e)})))}render(){const e=this.props,t=e.t,a=e.sessions,n=e.onClose,s=this.state,i=s.open,o=s.openAll,c=a.sessions.find(e=>e.is_current),l=a.sessions.filter(e=>!e.is_current);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"header-master"},r.a.createElement(C.a,{className:"header-left-button",onClick:n},r.a.createElement(Te,null)),r.a.createElement("div",{className:"header-status grow cursor-pointer"},r.a.createElement("span",{className:"header-status-content"},t("SessionsTitle")))),r.a.createElement("div",{className:"sidebar-page-content"},Boolean(c)&&r.a.createElement("div",{className:"sidebar-page-section"},r.a.createElement(hn,null,t("CurrentSession")),r.a.createElement(ks,{session:c,onTerminate:this.handleTerminate}),l.length>0&&r.a.createElement(ue.a,{className:"settings-list-item",button:!0,disableRipple:!0,onClick:this.handleTerminateAllOther},r.a.createElement(pe.a,null,r.a.createElement(Us,{color:"secondary"})),r.a.createElement(me.a,{primaryTypographyProps:{color:"secondary"},primary:t("TerminateAllSessions")}))),l.length>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"sidebar-page-section-divider"}),r.a.createElement("div",{className:"sidebar-page-section"},r.a.createElement(hn,null,t("OtherSessions")),l.map(e=>r.a.createElement(ks,{key:e.id,session:e,onTerminate:this.handleTerminate}))))),r.a.createElement(y.a,{transitionDuration:0,open:i,onClose:this.handleCloseConfirmation,"aria-labelledby":"form-dialog-title"},r.a.createElement(E.a,{id:"form-dialog-title"},t("Confirm")),r.a.createElement(On.a,null,r.a.createElement(Tn.a,{style:{whiteSpace:"pre-wrap"}},t("TerminateSessionText"))),r.a.createElement(v.a,null,r.a.createElement(b.a,{onClick:this.handleCloseConfirmation,color:"primary"},t("Cancel")),r.a.createElement(b.a,{onClick:this.handleDoneConfirmation,color:"primary"},t("Ok")))),r.a.createElement(y.a,{transitionDuration:0,open:o,onClose:this.handleCloseAllConfirmation,"aria-labelledby":"form-dialog-title"},r.a.createElement(E.a,{id:"form-dialog-title"},t("Confirm")),r.a.createElement(On.a,null,r.a.createElement(Tn.a,{style:{whiteSpace:"pre-wrap"}},t("AreYouSureSessions"))),r.a.createElement(v.a,null,r.a.createElement(b.a,{onClick:this.handleCloseAllConfirmation,color:"primary"},t("Cancel")),r.a.createElement(b.a,{onClick:this.handleDoneAllConfirmation,color:"primary"},t("Ok")))))}}var Is=Object(d.a)(Object(d.d)(),Object(f.d)(),Object(d.c)())(Ms),ws=Object(S.a)(r.a.createElement("path",{d:"M18,1 C20.6887547,1 22.8818181,3.12230671 22.9953805,5.78311038 L23,6 L23,9 C23,9.55228475 22.5522847,10 22,10 C21.4871642,10 21.0644928,9.61395981 21.0067277,9.11662113 L21,9 L21,6 C21,4.34314575 19.6568542,3 18,3 C16.4023191,3 15.0963391,4.24891996 15.0050927,5.82372721 L15,6 L15,8 C16.6568542,8 18,9.34314575 18,11 L18,19 C18,20.6568542 16.6568542,22 15,22 L5,22 C3.34314575,22 2,20.6568542 2,19 L2,11 C2,9.34314575 3.34314575,8 5,8 L13,8 L13,6 C13,3.3112453 15.1223067,1.11818189 17.7831104,1.00461951 L18,1 Z M15,10 L5,10 C4.44771525,10 4,10.4477153 4,11 L4,19 C4,19.5522847 4.44771525,20 5,20 L15,20 C15.5522847,20 16,19.5522847 16,19 L16,11 C16,10.4477153 15.5522847,10 15,10 Z M10,13.5 C10.8284271,13.5 11.5,14.1715729 11.5,15 C11.5,15.8284271 10.8284271,16.5 10,16.5 C9.17157288,16.5 8.5,15.8284271 8.5,15 C8.5,14.1715729 9.17157288,13.5 10,13.5 Z"}),"Unblock");a(476);const _s=r.a.memo(({userId:e,onClick:t,onUnblock:a})=>{const n=r.a.useState(!1),s=Object(g.a)(n,2),i=s[0],o=s[1],c=r.a.useState(0),l=Object(g.a)(c,2),d=l[0],h=l[1],u=r.a.useState(0),p=Object(g.a)(u,2),m=p[0],b=p[1],C=Object(f.c)().t,y=()=>{o(!1),b(0),h(0)};return r.a.createElement(r.a.Fragment,null,r.a.createElement(ue.a,{className:"settings-list-item",button:!0,onClick:()=>{t(e)},onContextMenu:e=>{if(e&&(e.preventDefault(),e.stopPropagation()),i)o(!1);else{const t=e.clientX,a=e.clientY;o(!0),b(t),h(a)}}},r.a.createElement(Ee.a,{userId:e})),r.a.createElement(bt.a,{open:i,onClose:y,anchorReference:"anchorPosition",anchorPosition:{top:d,left:m},anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"},onMouseDown:e=>e.stopPropagation()},r.a.createElement(gt.a,{onClick:e=>e.stopPropagation()},r.a.createElement(ft.a,{onClick:()=>{y(),a(e)}},r.a.createElement(pe.a,null,r.a.createElement(ws,null)),r.a.createElement(me.a,{primary:C("Unblock")})))))});class xs extends r.a.Component{constructor(...e){super(...e),this.handleUnblock=function(){var e=Object(i.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K.a.send({"@type":"unblockUser",user_id:t});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}componentDidMount(){this.loadContent()}loadContent(){const e=this.props.users,t=P.a.getStore();Object(T.C)(t,e.user_ids)}render(){const e=this.props,t=e.onClose,a=e.users,n=e.t;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"header-master"},r.a.createElement(C.a,{className:"header-left-button",onClick:t},r.a.createElement(Te,null)),r.a.createElement("div",{className:"header-status grow cursor-pointer"},r.a.createElement("span",{className:"header-status-content"},n("BlockedUsers")))),r.a.createElement("div",{className:"sidebar-page-content"},r.a.createElement("div",{className:"sidebar-page-section"},a.user_ids.length>0?r.a.createElement(r.a.Fragment,null,r.a.createElement(hn,{multiline:!0},n("BlockedUsersInfo")),a.user_ids.map(e=>r.a.createElement(_s,{key:e,userId:e,onClick:G.j,onUnblock:this.handleUnblock}))):r.a.createElement(hn,null,n("NoBlocked")))))}}var Os=Object(f.d)()(xs),Ts=Object(S.a)(r.a.createElement("g",{transform:"translate(0.000000, -2.000000)",fillRule:"nonzero"},r.a.createElement("path",{d:"M18,2 C20.209139,2 22,3.790861 22,6 L22,6 L22,8 C22,8.55228475 21.5522847,9 21,9 C20.4477153,9 20,8.55228475 20,8 L20,8 L20,6 C20,4.8954305 19.1045695,4 18,4 L18,4 L4,4 C2.8954305,4 2,4.8954305 2,6 L2,6 L2,14 C2,15.1045695 2.8954305,16 4,16 L4,16 L14,16 C14.5522847,16 15,16.4477153 15,17 C15,17.5522847 14.5522847,18 14,18 L14,18 L12,18 L12,20 L14,20 C14.5128358,20 14.9355072,20.3860402 14.9932723,20.8833789 L15,21 C15,21.5522847 14.5522847,22 14,22 L14,22 L8,22 C7.44771525,22 7,21.5522847 7,21 C7,20.4477153 7.44771525,20 8,20 L8,20 L10,20 L10,18 L4,18 C1.85780461,18 0.108921124,16.3160315 0.00489530723,14.1996403 L0,14 L0,6 C0,3.790861 1.790861,2 4,2 L4,2 Z M22,11 C23.1045695,11 24,11.8954305 24,13 L24,20 C24,21.1045695 23.1045695,22 22,22 L19,22 C17.8954305,22 17,21.1045695 17,20 L17,13 C17,11.8954305 17.8954305,11 19,11 L22,11 Z M22,13 L19,13 L19,20 L22,20 L22,13 Z"})),"Device"),Ls=Object(S.a)(r.a.createElement("g",{transform:"translate(-1.000000, -3.000000)",fillRule:"nonzero"},r.a.createElement("path",{d:"M9,13 C12.3229116,13 14.7530244,13.8337117 16.2223821,15.5699359 C16.724477,16.1632234 17,16.915291 17,17.6925226 L17,18.5 C17,19.8807119 15.8807119,21 14.5,21 L3.5,21 C2.11928813,21 1,19.8807119 1,18.5 L1,17.6925204 C1,16.9152876 1.2755246,16.1632192 1.77762117,15.569932 C3.24697824,13.8337108 5.67709024,13 9,13 Z M9,15 C6.21130036,15 4.33538166,15.6435809 3.30428673,16.861943 C3.10781409,17.0940989 3,17.3883868 3,17.6925212 L3,18.5 C3,18.7761424 3.22385763,19 3.5,19 L14.5,19 C14.7761424,19 15,18.7761424 15,18.5 L15,17.6925226 C15,17.3883883 14.8921864,17.0941004 14.6957148,16.8619448 C13.6646202,15.6435815 11.788701,15 9,15 Z M16,10 L22,10 C22.5522847,10 23,10.4477153 23,11 C23,11.5128358 22.6139598,11.9355072 22.1166211,11.9932723 L22,12 L16,12 C15.4477153,12 15,11.5522847 15,11 C15,10.4871642 15.3860402,10.0644928 15.8833789,10.0067277 L16,10 L22,10 L16,10 Z M9,3 C11.209139,3 13,4.790861 13,7 C13,9.209139 11.209139,11 9,11 C6.790861,11 5,9.209139 5,7 C5,4.790861 6.790861,3 9,3 Z M9,5 C7.8954305,5 7,5.8954305 7,7 C7,8.1045695 7.8954305,9 9,9 C10.1045695,9 11,8.1045695 11,7 C11,5.8954305 10.1045695,5 9,5 Z"})),"RemoveMember");a(477);class Ps extends r.a.Component{constructor(...e){super(...e),this.state={sessions:null,users:null,openBlockedUsers:!1,openActiveSessions:!1},this.onUpdateUserFullInfo=e=>{const t=e.user_id,a=e.user_full_info,n=this.state.users;if(!n)return;const s=n.total_count,i=n.user_ids,o=a.is_blocked;o!==(-1!==i.indexOf(t))&&(o?this.setState({users:Object(Ve.a)({},n,{total_count:s+1,user_ids:[t,...i]})}):this.setState({users:Object(Ve.a)({},n,{total_count:s-1,user_ids:i.filter(e=>e!==t)})}))},this.openActiveSessions=()=>{this.state.sessions&&this.setState({openActiveSessions:!0})},this.closeActiveSessions=()=>{this.setState({openActiveSessions:!1})},this.openBlockedUsers=()=>{this.state.users&&this.setState({openBlockedUsers:!0})},this.closeBlockedUsers=()=>{this.setState({openBlockedUsers:!1})}}componentDidMount(){this.loadContent(),_.a.on("updateUserFullInfo",this.onUpdateUserFullInfo)}componentWillUnmount(){_.a.off("updateUserFullInfo",this.onUpdateUserFullInfo)}loadContent(){var e=this;return Object(i.a)(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:K.a.send({"@type":"getActiveSessions"}).then(t=>e.setState({sessions:t})),K.a.send({"@type":"getBlockedUsers",offset:0,limit:100}).then(t=>e.setState({users:t}));case 2:case"end":return t.stop()}}),t)})))()}render(){const e=this.props,t=e.t,a=e.onClose,n=this.state,s=n.openBlockedUsers,i=n.users,o=n.openActiveSessions,c=n.sessions,l=c&&c.sessions.length>0?1===c.sessions.length?"1 session":"".concat(c.sessions.length," sessions"):"1 session",d=i&&i.total_count>0?1===i.total_count?"1 user":"".concat(i.total_count," users"):"no users";return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"header-master"},r.a.createElement(C.a,{className:"header-left-button",onClick:a},r.a.createElement(Te,null)),r.a.createElement("div",{className:"header-status grow cursor-pointer"},r.a.createElement("span",{className:"header-status-content"},t("PrivacySettings")))),r.a.createElement("div",{className:"sidebar-page-content"},r.a.createElement("div",{className:"sidebar-page-section"},r.a.createElement(ue.a,{className:"settings-list-item2",role:void 0,button:!0,onClick:this.openBlockedUsers},r.a.createElement(pe.a,{className:"settings-list-item-icon"},r.a.createElement(Ls,null)),r.a.createElement(me.a,{id:"label-2",className:"settings-list-item-text",primary:t("BlockedUsers"),secondary:d})),r.a.createElement(ue.a,{className:"settings-list-item2",role:void 0,button:!0,onClick:this.openActiveSessions},r.a.createElement(pe.a,{className:"settings-list-item-icon"},r.a.createElement(Ts,null)),r.a.createElement(me.a,{id:"label-2",className:"settings-list-item-text",primary:t("SessionsTitle"),secondary:l}))),r.a.createElement("div",{className:"sidebar-page-section-divider"}),r.a.createElement("div",{className:"sidebar-page-section"},r.a.createElement(hn,null,t("PrivacyTitle")),r.a.createElement(ue.a,{className:"settings-list-item2",role:void 0,button:!0},r.a.createElement(me.a,{className:"settings-list-item-text2",primary:t("PrivacyPhoneTitle"),secondary:t("LastSeenContacts")})),r.a.createElement(ue.a,{className:"settings-list-item2",role:void 0,button:!0},r.a.createElement(me.a,{className:"settings-list-item-text2",primary:t("LastSeenTitle"),secondary:t("LastSeenEverybody")})),r.a.createElement(ue.a,{className:"settings-list-item2",role:void 0,button:!0},r.a.createElement(me.a,{className:"settings-list-item-text2",primary:t("PrivacyProfilePhotoTitle"),secondary:t("LastSeenEverybody")})),r.a.createElement(ue.a,{className:"settings-list-item2",role:void 0,button:!0},r.a.createElement(me.a,{className:"settings-list-item-text2",primary:t("PrivacyForwardsTitle"),secondary:t("LastSeenEverybody")})),r.a.createElement(ue.a,{className:"settings-list-item2",role:void 0,button:!0},r.a.createElement(me.a,{className:"settings-list-item-text2",primary:t("WhoCanAddMe"),secondary:t("LastSeenEverybody")})))),r.a.createElement(In,{open:s,onClose:this.closeBlockedUsers},r.a.createElement(Os,{users:i})),r.a.createElement(In,{open:o,onClose:this.closeActiveSessions},r.a.createElement(Is,{sessions:c})))}}var Ns=Object(d.a)(Object(d.d)(),Object(f.d)(),Object(d.c)())(Ps);a(478);class Ds extends r.a.Component{constructor(e){super(e),this.openEditProfile=()=>{this.setState({openEditProfile:!0})},this.closeEditProfile=()=>{this.setState({openEditProfile:!1})},this.openGeneral=()=>{this.setState({openGeneral:!0})},this.closeGeneral=()=>{this.setState({openGeneral:!1})},this.openNotifications=()=>{this.setState({openNotifications:!0})},this.closeNotifications=()=>{this.setState({openNotifications:!1})},this.openPrivacySecurity=()=>{this.setState({openPrivacySecurity:!0})},this.closePrivacySecurity=()=>{this.setState({openPrivacySecurity:!1})},this.openLanguage=()=>{this.setState({openLanguage:!0})},this.closeLanguage=()=>{this.setState({openLanguage:!1})},this.handleCloseSettings=()=>{K.a.clientUpdate({"@type":"clientUpdateSettings",open:!1})},this.state={openEditProfile:!1,openGeneral:!1,openNotifications:!1,openPrivacySecurity:!1,openLanguage:!1}}componentDidMount(){this.loadContent()}loadContent(){var e=this;return Object(i.a)(s.a.mark((function t(){var a,n,i;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.props.chatId,n=P.a.getStore(),Object(T.r)(n,[a]),t.next=5,K.a.send({"@type":"getUserFullInfo",user_id:_.a.getMyId()});case 5:i=t.sent,_.a.setFullInfo(_.a.getMyId(),i);case 7:case"end":return t.stop()}}),t)})))()}render(){const e=this.props.chatId,t=this.state,a=t.openEditProfile,n=t.openGeneral,s=t.openNotifications,i=t.openPrivacySecurity,o=t.openLanguage;return r.a.createElement(r.a.Fragment,null,r.a.createElement(ss,{chatId:e,onClose:this.handleCloseSettings,onEditProfile:this.openEditProfile,onGeneral:this.openGeneral,onNotifications:this.openNotifications,onPrivacySecurity:this.openPrivacySecurity,onLanguage:this.openLanguage}),r.a.createElement(In,{open:a,onClose:this.closeEditProfile},r.a.createElement(rs,{chatId:e})),r.a.createElement(In,{open:n,onClose:this.closeGeneral},r.a.createElement(gs,{chatId:e})),r.a.createElement(In,{open:s,onClose:this.closeNotifications},r.a.createElement(Es,{chatId:e})),r.a.createElement(In,{open:i,onClose:this.closePrivacySecurity},r.a.createElement(Ns,null)),r.a.createElement(In,{open:o,onClose:this.closeLanguage},r.a.createElement(Cs,null)))}}var js=Object(d.a)(Object(d.d)(),Object(f.d)(),Object(d.c)())(Ds),Bs=a(17);var Rs=new class{load(e){return Object(i.a)(s.a.mark((function t(){var a;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=localStorage.getItem(e)){t.next=3;break}return t.abrupt("return",null);case 3:return t.prev=3,t.abrupt("return",JSON.parse(a));case 7:return t.prev=7,t.t0=t.catch(3),t.abrupt("return",null);case 10:case"end":return t.stop()}}),t,null,[[3,7]])})))()}save(e,t){return Object(i.a)(s.a.mark((function a(){return s.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:localStorage.setItem(e,JSON.stringify(t));case 1:case"end":return a.stop()}}),a)})))()}remove(e){return Object(i.a)(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:localStorage.removeItem(e);case 1:case"end":return t.stop()}}),t)})))()}clear(){return Object(i.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:localStorage.clear();case 1:case"end":return e.stop()}}),e)})))()}};class Fs extends Bs.a{constructor(){super(),this.reset=()=>{this.chatIds=[],this.cache=null,this.contacts=null},this.onUpdate=e=>{switch(e["@type"]){case"updateAuthorizationState":{const t=e.authorization_state;if(!t)break;switch(t["@type"]){case"authorizationStateClosed":this.reset();break;case"authorizationStateLoggingOut":case"authorizationStateWaitCode":case"authorizationStateWaitPhoneNumber":case"authorizationStateWaitPassword":case"authorizationStateWaitRegistration":Rs.remove("cache"),Rs.remove("files"),Rs.remove("contacts")}break}}},this.onClientUpdate=e=>{switch(e["@type"]){case"clientUpdateDialogsReady":this.clear()}},this.addTdLibListener=()=>{K.a.on("update",this.onUpdate),K.a.on("clientUpdate",this.onClientUpdate)},this.removeTdLibListener=()=>{K.a.off("update",this.onUpdate),K.a.off("clientUpdate",this.onClientUpdate)},this.reset(),this.addTdLibListener(),this.saveChatsInternal=Object(Ae.c)(this.saveChatsInternal,2e3)}loadCache(){var e=this;return Object(i.a)(s.a.mark((function t(){var a,n,i,o,r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(a=[]).push(Rs.load("cache").catch(e=>null)),a.push(Rs.load("files").catch(e=>null)),t.next=5,Promise.all(a);case 5:if(n=t.sent,i=Object(g.a)(n,2),o=i[0],r=i[1],e.cache=o,e.cache&&(e.cache.files=r||[]),e.cache){t.next=13;break}return t.abrupt("return",null);case 13:return e.parseCache(e.cache),t.abrupt("return",e.cache);case 15:case"end":return t.stop()}}),t)})))()}parseCache(e){if(!e)return;const t=e.chats,a=e.archiveChats,n=e.users,s=e.basicGroups,i=e.supergroups,o=e.files,r=e.options;(o||[]).forEach(({id:e,url:t})=>{P.a.setDataUrl(e,t)}),(n||[]).forEach(e=>{_.a.set(e)}),(s||[]).forEach(e=>{Me.a.set(e)}),(i||[]).forEach(e=>{Ie.a.set(e)}),(t||[]).concat(a||[]).forEach(e=>{delete e.OutputTypingManager,L.a.set(e),e.photo&&(e.photo.small&&P.a.set(e.photo.small),e.photo.big&&P.a.set(e.photo.big)),e.chat_list&&L.a.updateChatChatList(e.id,e.chat_list),e.last_message&&q.a.set(e.last_message)}),(r||[]).forEach(([e,t])=>{F.a.set(e,t)})}getCache(e,t){const a=new Map,n=new Map,s=new Map,i=new Map,o=e.map(e=>L.a.get(e)),r=t.map(e=>L.a.get(e));return o.concat(r).forEach(e=>{const t=e.photo,o=e.type,r=e.last_message;if(t&&t.small){const e=t.small.id;if(e){const t=P.a.getBlob(e);t&&a.set(e,t)}}switch(o["@type"]){case"chatTypeBasicGroup":{const e=Me.a.get(o.basic_group_id);e&&s.set(e.id,e)}case"chatTypePrivate":case"chatTypeSecret":{const e=_.a.get(o.user_id);e&&n.set(e.id,e)}case"chatTypeSupergroup":{const e=Ie.a.get(o.supergroup_id);e&&i.set(e.id,e)}}if(r){const e=r.sender_user_id;if(e){const t=_.a.get(e);t&&n.set(t.id,t)}}}),{chats:o,archiveChats:r,users:[...n.values()],basicGroups:[...s.values()],supergroups:[...i.values()],files:[...a.entries()],options:[...F.a.items.entries()]}}saveChats(e,t){this.chatIds=e,this.archiveChatIds=t,this.saveChatsInternal()}saveChatsInternal(){var e=this;return Object(i.a)(s.a.mark((function t(){var a,n,i,o;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.getCache(e.chatIds,e.archiveChatIds),n=a.files,a.files=[],t.next=5,Rs.save("cache",a);case 5:return i=[],n.forEach(e=>{const t=Object(g.a)(e,2),a=t[0],n=t[1];i.push(new Promise((e,t)=>{const s=new FileReader;s.readAsDataURL(n),s.onload=t=>{e({id:a,url:t.target.result})},s.onerror=t=>{e(null)}}))}),t.next=9,Promise.all(i);case 9:return o=t.sent,t.next=12,Rs.save("files",o);case 12:case"end":return t.stop()}}),t)})))()}clear(){if(this.cache){this.cache.files.forEach(({id:e,url:t})=>{P.a.deleteDataUrl(e)})}}}const As=new Fs;window.cache=As;var Vs=As;a(479);class zs extends r.a.Component{shouldComponentUpdate(e,t,a){const n=this.props,s=n.userId,i=n.style;return e.userId!==s||e.style.top!==i.top}render(){const e=this.props,t=e.userId,a=e.onClick,n=e.style;return r.a.createElement(ue.a,{className:"user-list-item",onClick:()=>a(t),button:!0,style:n},r.a.createElement(Ee.a,{userId:t}))}}class Hs extends r.a.Component{constructor(e){var t;super(e),t=this,this.handleScroll=e=>{this.handleDebounceScroll(),this.handleThrottleScroll()},this.loadRenderIdsContent=()=>{const e=this.state,t=e.items,a=e.searchItems,n=a||t,s=(n===a?this.searchListRef:this.listRef).current;if(!s)return;const i=s.getListRenderIds();if(i.size>0){const e=[];[...i.keys()].forEach(t=>{e.push(n.user_ids[t])});const t=P.a.getStore();Object(T.C)(t,e)}},this.handleOpenUser=e=>{Object(G.j)(e,!1),this.handleClose()},this.renderItem=({index:e,style:t},a)=>{const n=a.user_ids[e];return r.a.createElement(zs,{key:n,userId:n,onClick:()=>this.handleOpenUser(n),style:t})},this.handleSearch=function(){var e=Object(i.a)(s.a.mark((function e(a){var n,i,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.trim()){e.next=4;break}return t.setState({searchItems:null}),e.abrupt("return");case 4:return e.next=6,K.a.send({"@type":"searchContacts",query:n,limit:1e3});case 6:(i=e.sent).user_ids=i.user_ids.sort((e,t)=>Object(I.c)(e).localeCompare(Object(I.c)(t))),o=P.a.getStore(),Object(T.C)(o,i.user_ids.slice(0,20)),t.setState({searchItems:i});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleClose=()=>{const e=this.props.onClose;e&&e()},this.searchInputRef=r.a.createRef(),this.listRef=r.a.createRef(),this.searchListRef=r.a.createRef(),this.state={items:null,searchItems:null},this.handleDebounceScroll=Object(Ae.c)(this.handleDebounceScroll,100,!1),this.handleThrottleScroll=Object(Ae.y)(this.handleThrottleScroll,200,!1)}componentDidMount(){const e=this.searchInputRef.current;e&&setTimeout(()=>e.focus(),50),this.loadContent()}handleDebounceScroll(){this.loadRenderIdsContent()}handleThrottleScroll(){this.loadRenderIdsContent()}loadContent(){var e=this;return Object(i.a)(s.a.mark((function t(){var a,n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=Vs.contacts){t.next=7;break}return t.next=4,K.a.send({"@type":"getContacts"});case 4:(a=t.sent).user_ids=a.user_ids.sort((e,t)=>Object(I.c)(e).localeCompare(Object(I.c)(t))),Vs.contacts=a;case 7:n=P.a.getStore(),Object(T.C)(n,a.user_ids.slice(0,20)),e.setState({items:a});case 10:case"end":return t.stop()}}),t)})))()}render(){const e=this.state,t=e.items,a=e.searchItems;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"header-master"},r.a.createElement(C.a,{className:"header-left-button",onClick:this.handleClose},r.a.createElement(Te,null)),r.a.createElement(En,{inputRef:this.searchInputRef,onChange:this.handleSearch})),r.a.createElement("div",{className:"contacts-content"},t&&r.a.createElement(Ha,{ref:this.listRef,className:"contacts-list",source:t.user_ids,rowHeight:72,overScanCount:20,renderItem:e=>this.renderItem(e,t),onScroll:this.handleScroll}),a&&r.a.createElement(Ha,{ref:this.searchListRef,className:"contacts-list contacts-search-list",source:a.user_ids,rowHeight:72,overScanCount:20,renderItem:e=>this.renderItem(e,a),onScroll:this.handleScroll})))}}var Ws=Hs;a(480);class Gs extends r.a.Component{constructor(e){super(e),this.onClientUpdateNewContentAvailable=()=>{this.setState({newContentAvailable:!0})},this.handleUpdate=()=>{this.handled||(this.handled=!0,setTimeout(()=>{window.location.reload()},250))},this.state={newContentAvailable:!1}}componentDidMount(){Z.a.on("clientUpdateNewContentAvailable",this.onClientUpdateNewContentAvailable)}componentWillUnmount(){Z.a.off("clientUpdateNewContentAvailable",this.onClientUpdateNewContentAvailable)}render(){const e=this.state.newContentAvailable,t=this.props.t;return e?r.a.createElement(b.a,{className:"update-button",variant:"contained",color:"primary",onClick:this.handleUpdate},t("Update")):null}}var Zs=Object(f.d)()(Gs),qs=a(30);function Ks(){const e=L.a.chatList.get("chatListArchive"),t=[],a=[];if(e){var n,s=Object(qs.a)(e.keys());try{for(s.s();!(n=s.n()).done;){const e=n.value,s=L.a.get(e);s&&("0"!==s.order&&t.push(s),a.push({order:s.order,id:s.id,title:s.title}))}}catch(i){s.e(i)}finally{s.f()}}return t.sort((e,t)=>Object(Ae.v)(t.order,e.order)).map(e=>e.title).join(", ")}a(481);var Ys=a(555);class Js extends o.Component{constructor(e){var t;super(e),t=this,this.onUpdateChatOrder=e=>{const t=e.chat_id,a=this.dialogListRef.current;if(a&&a.loading)return;const n=this.archiveListRef.current;if(n&&n.loading)return;const s=L.a.chatList.get("chatListArchive");s&&s.has(t)&&this.setState({archiveTitle:Ks()})},this.onUpdateChatChatList=e=>{const t=this.state.showArchive,a=this.dialogListRef.current;if(a&&a.loading)return;const n=this.archiveListRef.current;if(n&&n.loading)return;const s=L.a.chatList.get("chatListArchive"),i=s&&s.size>0;this.setState({showArchive:i,archiveTitle:Ks()},()=>{if(!t&&i){const e=this.dialogListRef.current;if(e.listRef){const t=e.listRef.current;t&&t.scrollTop>0&&(e.scrollTop+=68)}}}),t&&!i&&K.a.clientUpdate({"@type":"clientUpdateCloseArchive"})},this.onClientUpdateContacts=function(){var e=Object(i.a)(s.a.mark((function e(a){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=a.open,t.setState({openContacts:n});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.onClientUpdateSettings=e=>{const t=e.open,a=e.chatId;this.setState({openSettings:t,meChatId:a})},this.onClientUpdateArchive=e=>{const t=e.open;this.setState({openArchive:t})},this.onClientUpdateThemeChange=e=>{this.forceUpdate()},this.onClientUpdateChatDetailsVisibility=e=>{const t=Z.a.isChatDetailsVisible;this.setState({isChatDetailsVisible:t})},this.onClientUpdateSearchChat=e=>{const t=e.chatId,a=e.query,n=this.state,s=n.openSearch,i=n.searchChatId,o=n.searchText;if(s&&t===i&&a===o)return;const r=this.dialogsHeaderRef.current;this.setState({openSearch:!0,searchChatId:t,searchText:null,openSettings:!1,openActiveSessions:!1,openContacts:!1},()=>{r&&r.setInitQuery(a)})},this.handleHeaderClick=()=>{this.state.openArchive?K.a.clientUpdate({"@type":"clientUpdateCloseArchive"}):this.dialogListRef.current.scrollToTop()},this.handleSearch=e=>{this.setState({openSearch:e,searchChatId:0,searchText:null})},this.handleSelectMessage=(e,t,a)=>{Object(G.h)(e,t);const n=a?this.state.searchChatId:0,s=a?this.state.searchText:null;this.setState({openSearch:a,searchChatId:n,searchText:s})},this.handleCloseSearch=()=>{this.setState({openSearch:!1,searchChatId:0,searchText:null})},this.handleSearchTextChange=e=>{this.setState({searchText:e,query:null})},this.handleSaveCache=()=>{this.saveCache()},this.handleCloseArchive=()=>{this.setState({openArchive:!1})},this.handleCloseContacts=()=>{this.setState({openContacts:!1})},this.handleCloseSettings=()=>{this.setState({openSettings:!1})},this.dialogListRef=r.a.createRef(),this.archiveListRef=r.a.createRef(),this.dialogsHeaderRef=r.a.createRef();const a=Z.a.isChatDetailsVisible;this.state={cache:null,showArchive:!1,archiveTitle:null,mainItems:[],archiveItems:[],isChatDetailsVisible:a,openSearch:!1,openArchive:!1,openContacts:!1,openSettings:!1,searchChatId:0,searchText:null,query:null}}shouldComponentUpdate(e,t){const a=this.state,n=a.cache,s=a.showArchive,i=a.archiveTitle,o=a.mainItems,r=a.archiveItems,c=a.isChatDetailsVisible,l=a.openSearch,d=a.openArchive,h=a.openSettings,u=a.openContacts,p=a.searchChatId,m=a.searchText;return t.cache!==n||(t.showArchive!==s||(t.archiveTitle!==i||(t.archiveItems!==r||(t.mainItems!==o||(t.isChatDetailsVisible!==c||(t.openSearch!==l||(t.openArchive!==d||(t.openSettings!==h||(t.openContacts!==u||(t.searchChatId!==p||t.searchText!==m))))))))))}componentDidMount(){this.loadCache(),Z.a.on("clientUpdateChatDetailsVisibility",this.onClientUpdateChatDetailsVisibility),Z.a.on("clientUpdateSearchChat",this.onClientUpdateSearchChat),Z.a.on("clientUpdateThemeChange",this.onClientUpdateThemeChange),L.a.on("updateChatChatList",this.onUpdateChatChatList),L.a.on("updateChatDraftMessage",this.onUpdateChatOrder),L.a.on("updateChatIsPinned",this.onUpdateChatOrder),L.a.on("updateChatIsSponsored",this.onUpdateChatOrder),L.a.on("updateChatLastMessage",this.onUpdateChatOrder),L.a.on("updateChatOrder",this.onUpdateChatOrder),L.a.on("clientUpdateSettings",this.onClientUpdateSettings),L.a.on("clientUpdateArchive",this.onClientUpdateArchive),L.a.on("clientUpdateContacts",this.onClientUpdateContacts)}componentWillUnmount(){Z.a.off("clientUpdateChatDetailsVisibility",this.onClientUpdateChatDetailsVisibility),Z.a.off("clientUpdateSearchChat",this.onClientUpdateSearchChat),Z.a.off("clientUpdateThemeChange",this.onClientUpdateThemeChange),L.a.off("updateChatChatList",this.onUpdateChatChatList),L.a.off("updateChatDraftMessage",this.onUpdateChatOrder),L.a.off("updateChatIsPinned",this.onUpdateChatOrder),L.a.off("updateChatIsSponsored",this.onUpdateChatOrder),L.a.off("updateChatLastMessage",this.onUpdateChatOrder),L.a.off("updateChatOrder",this.onUpdateChatOrder),L.a.off("clientUpdateSettings",this.onClientUpdateSettings),L.a.off("clientUpdateArchive",this.onClientUpdateArchive),L.a.off("clientUpdateContacts",this.onClientUpdateContacts)}loadCache(){var e=this;return Object(i.a)(s.a.mark((function t(){var a,n,i;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Vs.loadCache();case 2:if(t.t0=t.sent,t.t0){t.next=5;break}t.t0={};case 5:a=t.t0,n=a.chats,i=a.archiveChats,e.setState({cache:a,showArchive:i&&i.length>0,archiveTitle:Ks()}),e.loadChatContents((n||[]).map(e=>e.id)),K.a.clientUpdate({"@type":"clientUpdateCacheLoaded"});case 10:case"end":return t.stop()}}),t)})))()}saveCache(){const e=this.archiveListRef.current,t=e&&e.state.chats?e.state.chats.slice(0,25):[],a=this.dialogListRef.current,n=a&&a.state.chats?a.state.chats.slice(0,25):[];Vs.saveChats(n,t)}loadChatContents(e){const t=P.a.getStore();Object(T.r)(t,e)}render(){const e=this.state,t=e.cache,a=e.showArchive,n=e.archiveTitle,s=e.mainItems,i=e.archiveItems,o=e.isChatDetailsVisible,c=e.meChatId,d=e.openSettings,h=e.openContacts,u=e.openArchive,p=e.openSearch,m=e.searchChatId,g=e.searchText,f=t?t.chats||[]:null,b=t?t.archiveChats||[]:null;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:l()("dialogs",{"dialogs-third-column":o})},r.a.createElement("div",{className:"sidebar-page"},r.a.createElement(Sn,{ref:this.dialogsHeaderRef,openSearch:p,onClick:this.handleHeaderClick,onSearch:this.handleSearch,onSearchTextChange:this.handleSearchTextChange}),r.a.createElement("div",{className:"dialogs-content"},r.a.createElement(Ya,{type:"chatListMain",ref:this.dialogListRef,cacheItems:f,items:s,showArchive:a,archiveTitle:n,open:!0,onSaveCache:this.handleSaveCache}),r.a.createElement(Ys.a,{classNames:"search",timeout:200,in:p,mountOnEnter:!0,unmountOnExit:!0},r.a.createElement(pn,{chatId:m,text:g,onSelectMessage:this.handleSelectMessage,onClose:this.handleCloseSearch}))),r.a.createElement(Zs,null)),r.a.createElement(In,{open:u,onClose:this.handleCloseArchive},r.a.createElement(Qa,{innerListRef:this.archiveListRef,items:i,cacheItems:b})),r.a.createElement(In,{open:h,onClose:this.handleCloseContacts},r.a.createElement(Ws,null)),r.a.createElement(In,{open:d,onClose:this.handleCloseSettings},r.a.createElement(js,{chatId:c}))))}}var Qs=Js;a(482);class Xs extends r.a.Component{constructor(...e){super(...e),this.state={chatId:Z.a.dialogChatId},this.onClientUpdateMediaViewerContent=e=>{Z.a.mediaViewerContent&&this.handleClose()},this.onClientUpdateDialogChatId=e=>{const t=e.chatId;this.setState({chatId:t})},this.handleClose=()=>{K.a.clientUpdate({"@type":"clientUpdateDialogChatId",chatId:0})}}shouldComponentUpdate(e,t,a){const n=this.state.chatId;return t.chatId!==n}componentDidMount(){Z.a.on("clientUpdateDialogChatId",this.onClientUpdateDialogChatId),Z.a.on("clientUpdateMediaViewerContent",this.onClientUpdateMediaViewerContent)}componentWillUnmount(){Z.a.off("clientUpdateDialogChatId",this.onClientUpdateDialogChatId),Z.a.off("clientUpdateMediaViewerContent",this.onClientUpdateMediaViewerContent)}render(){const e=this.state.chatId;return e?r.a.createElement(y.a,{open:!0,transitionDuration:0,onClose:this.handleClose,classes:{root:"chat-info-dialog-root",container:"chat-info-dialog-container",paper:"chat-info-dialog-paper"}},r.a.createElement(da,{className:"chat-info-dialog-content",chatId:e,popup:!0})):null}}var $s=Xs,ei=a(354),ti=a(333),ai=a.n(ti),ni=Object(S.a)(r.a.createElement("path",{d:"M4.70710678,12.2928932 C4.31658249,11.9023689 3.68341751,11.9023689 3.29289322,12.2928932 C2.90236893,12.6834175 2.90236893,13.3165825 3.29289322,13.7071068 L8.29289322,18.7071068 C8.68341751,19.0976311 9.31658249,19.0976311 9.70710678,18.7071068 L20.7071068,7.70710678 C21.0976311,7.31658249 21.0976311,6.68341751 20.7071068,6.29289322 C20.3165825,5.90236893 19.6834175,5.90236893 19.2928932,6.29289322 L9,16.5857864 L4.70710678,12.2928932 Z"}),"Done"),si=a(345),ii=Object(S.a)(r.a.createElement("path",{d:"M2.65383364,2.92607697 L4.145798,9.778632 C4.26700994,10.3353554 4.73555061,10.7489799 5.30300879,10.8002098 L16.196355,11.7836569 C16.3159306,11.7944521 16.4041145,11.9001385 16.3933192,12.0197141 C16.3838746,12.1243302 16.3009783,12.2072294 16.1963626,12.2166777 L5.30295988,13.2005138 C4.73552551,13.2517615 4.26701089,13.6653731 4.14579755,14.2220735 L2.65385781,21.074154 C2.55168485,21.543407 2.84926209,22.0066394 3.31851517,22.1088123 C3.50628037,22.1496954 3.70229947,22.1272304 3.87594675,22.0449272 L23.4110848,12.7858981 C23.8450551,12.5802101 24.0301144,12.0616646 23.8244264,11.6276943 C23.7384721,11.4463438 23.5924353,11.300307 23.4110848,11.2143527 L3.87592461,1.95531307 C3.44195432,1.74962507 2.92340882,1.93468443 2.71772082,2.36865471 C2.63541897,2.54229904 2.61295329,2.73831451 2.65383364,2.92607697 Z"}),"Send"),oi=Object(S.a)(r.a.createElement("path",{d:"M11.657825,8.68730116 L7.89384699,12.5266719 C6.53977525,13.9078658 6.53979565,16.118605 7.89389288,17.4997739 C9.18119565,18.812813 11.2598788,18.8798255 12.6276396,17.6859428 L12.8071445,17.5177786 L19.3928802,10.8005213 C21.4766204,8.67512215 21.4766204,5.27313659 19.3928802,3.14773741 C17.4051081,1.12022499 14.1862843,1.0310006 12.0906645,2.90336495 L11.834659,3.14773741 L5.26671543,9.84699003 C2.45333216,12.7166196 2.45333216,17.3098454 5.26671543,20.179475 C7.96150749,22.9281424 12.3352577,23.0332941 15.1578204,20.4629606 L15.452067,20.1794113 L19.2160679,16.340063 C19.6027032,15.945688 19.596429,15.3125541 19.202054,14.9259188 C18.8076791,14.5392835 18.1745452,14.5455577 17.7879099,14.9399327 L13.9520378,18.8511531 C11.9281881,20.8353343 8.67903707,20.8031766 6.6948559,18.7793268 C4.64395201,16.6874204 4.64395201,13.3390446 6.6948559,11.2471382 L13.3088798,4.50180526 C14.6072848,3.22884976 16.6917843,3.24948061 17.9647398,4.54788555 C19.2860006,5.89556155 19.2860006,8.05269718 17.9647398,9.40037319 L11.3764629,16.119959 C10.803533,16.6816592 9.88373353,16.6725557 9.32203335,16.0996258 C8.73040544,15.4961698 8.73039653,14.5302606 9.3220133,13.9267937 L13.0859914,10.0874229 C13.4726243,9.6930457 13.4663463,9.05991185 13.0719691,8.67327889 C12.6775919,8.28664594 12.044458,8.29292392 11.657825,8.68730116 Z"}),"Attach"),ri=a(483),ci=a.n(ri);class li extends r.a.Component{constructor(...e){super(...e),this.state={anchorEl:null},this.handleMenuClick=e=>{this.setState({anchorEl:e.currentTarget})},this.handleMenuClose=()=>{this.setState({anchorEl:null})},this.handleAttachPhoto=()=>{this.handleMenuClose();const e=this.props.onAttachPhoto;e&&setTimeout(()=>e(),p.c)},this.handleAttachDocument=()=>{this.handleMenuClose();const e=this.props.onAttachDocument;e&&setTimeout(()=>e(),p.c)},this.handleAttachPoll=()=>{this.handleMenuClose();const e=this.props.onAttachPoll;e&&e()}}render(){const e=this.props,t=(e.classes,e.t),a=e.chatId,n=this.state.anchorEl;return r.a.createElement(r.a.Fragment,null,r.a.createElement(C.a,{className:"inputbox-icon-button","aria-label":"Attach",open:Boolean(n),onClick:this.handleMenuClick},r.a.createElement(oi,null)),r.a.createElement(mn.a,{id:"attach-menu",anchorEl:n,open:Boolean(n),getContentAnchorEl:null,disableAutoFocusItem:!0,disableRestoreFocus:!0,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"bottom",horizontal:"right"},onClose:this.handleMenuClose},r.a.createElement(ft.a,{onClick:this.handleAttachPhoto,disabled:!Object(w.d)(a)},r.a.createElement(pe.a,null,r.a.createElement(be,null)),r.a.createElement(me.a,{primary:t("AttachPhoto")})),r.a.createElement(ft.a,{onClick:this.handleAttachDocument,disabled:!Object(w.d)(a)},r.a.createElement(pe.a,null,r.a.createElement(ce,null)),r.a.createElement(me.a,{primary:t("AttachDocument")})),!Object(w.T)(a)&&r.a.createElement(ft.a,{onClick:this.handleAttachPoll,disabled:!Object(w.f)(a)},r.a.createElement(pe.a,null,r.a.createElement(ci.a,null)),r.a.createElement(me.a,{primary:t("Poll")}))))}}var di=Object(f.d)()(li),hi=a(576),ui=a(350);function pi(e,t=!1){if(e){if(t&&e.childNodes&&e.childNodes.length>0){const t=e.childNodes[e.childNodes.length-1],a=document.createRange();a.setStart(t,t.length),a.collapse(!0);const n=window.getSelection();n.removeAllRanges(),n.addRange(a),e.scrollTop=e.scrollHeight}e.focus()}}const mi=8,gi=16,fi=17,bi=18,Ci=46,yi=37,vi=38,Ei=39,Ui=40,Si={special:{},navigational:{},isSpecial(e){return"undefined"!==typeof this.special[e.keyCode]},isNavigational(e){return"undefined"!==typeof this.navigational[e.keyCode]}};Si.special[mi]=!0,Si.special[gi]=!0,Si.special[fi]=!0,Si.special[bi]=!0,Si.special[Ci]=!0,Si.navigational[vi]=!0,Si.navigational[Ui]=!0,Si.navigational[yi]=!0,Si.navigational[Ei]=!0;a(484);class ki extends r.a.Component{constructor(e){super(e),this.getText=()=>this.optionTextRef.current.innerText,this.focus=(e=!1)=>{pi(this.optionTextRef.current,e)},this.handleDelete=()=>{const e=this.props,t=e.option,a=e.onDelete;t&&a&&a(t.id)},this.handleInput=e=>{const t=this.props.option;e.preventDefault();const a=this.optionTextRef.current,n=a.dataset.length,s=(a.dataset.maxLength,this.getText());this.setState({remainLength:n-s.length}),K.a.clientUpdate({"@type":"clientUpdatePollOption",id:t.id,text:s})},this.handleKeyDown=e=>{const t=this.optionTextRef.current,a=t.dataset.maxLength,n=this.getText().length;let s=!1;const i=window.getSelection(),o=Si.isSpecial(e),r=Si.isNavigational(e);switch(i&&(s=!!i.toString()),e.key){case"Backspace":if(!this.getText()){const t=this.props,a=t.option,n=t.onDelete;return n&&n(a.id,!0),e.preventDefault(),!1}break;case"Enter":{const t=this.props,a=t.option,n=t.onFocusNext;return a&&n&&n(a.id),e.preventDefault(),!1}case"ArrowUp":{const a=window.getSelection();if(!a)break;if(!a.isCollapsed)break;const n=t.childNodes&&t.childNodes.length>0?t.childNodes[0]:null;if(!n||a.anchorNode===n&&!a.anchorOffset){const t=this.props,a=t.option,n=t.onFocusPrev;return n&&n(a.id),e.preventDefault(),!1}break}case"ArrowDown":{const a=window.getSelection();if(!a)break;if(!a.isCollapsed)break;const n=t.childNodes&&t.childNodes.length>0?t.childNodes[t.childNodes.length-1]:null;if(!n||a.anchorNode===n&&a.anchorOffset===n.length){const t=this.props,a=t.option,n=t.onFocusNext;return n&&n(a.id),e.preventDefault(),!1}break}}return!(!o&&!r)||(!(n>=a&&!s)||(e.preventDefault(),!1))},this.handlePaste=e=>{e.preventDefault();const t=this.optionTextRef.current.dataset.maxLength,a=window.getSelection(),n=a?a.toString():"",s=this.getText();if(s.length-a.length>=t)return;let i=e.clipboardData.getData("text/plain");i&&(i=i.replace("\r\n","\n").replace("\n"," "),s.length-n.length+i.length>t&&(i=i.substr(0,t-s.length+n.length)),document.execCommand("insertText",!1,i))},this.handleChange=()=>{const e=this.props.option;e&&K.a.clientUpdate({"@type":"clientUpdatePollChooseOption",id:e.id})},this.optionTextRef=r.a.createRef(),this.state={remainLength:p.P}}render(){const e=this.props,t=e.t,a=e.option,n=this.state.remainLength,s=a.is_chosen;return r.a.createElement("div",{className:"create-poll-option"},r.a.createElement("div",{className:"create-poll-option-wrapper"},r.a.createElement(Rn.a,{key:Date.now(),classes:{root:"create-poll-radio-root"},color:"primary",checked:s,onChange:this.handleChange}),r.a.createElement("div",{ref:this.optionTextRef,className:"create-poll-option-text",contentEditable:!0,suppressContentEditableWarning:!0,placeholder:t("Option"),"data-length":p.O,"data-max-length":p.P,onInput:this.handleInput,onKeyDown:this.handleKeyDown,onPaste:this.handlePaste})),r.a.createElement("div",{className:"create-poll-option-delete-button"},r.a.createElement(C.a,{className:"create-poll-option-button",onClick:this.handleDelete},r.a.createElement(U.a,{fontSize:"small"}))),r.a.createElement("div",{className:"create-poll-option-bottom-border"}),n<=p.O-p.N&&r.a.createElement(ui.a,{align:"center",className:"create-poll-option-subtitle",color:n>=0?"textSecondary":"error",variant:"subtitle1"},n))}}var Mi=Object(d.a)(Object(d.d)(),Object(f.d)(),Object(d.c)())(ki),Ii=a(338),wi=a(337);a(485);class _i extends r.a.Component{constructor(e){super(e),this.handleClientUpdateNewPoll=e=>{const t=wi.a.poll;this.setState({confirm:!1,remainLength:p.S,poll:t})},this.handleClientUpdatePollQuestion=e=>{const t=wi.a.poll,a=this.questionRef.current,n=a.dataset.length,s=a.innerText;this.setState({remainLength:n-s.length,poll:t})},this.handleClientUpdatePoll=e=>{const t=wi.a.poll;this.setState({poll:t})},this.handleClientUpdateNewPollOption=e=>{const t=wi.a.poll;this.setState({poll:t},()=>{setTimeout(()=>{this.optionsRefMap.get(t.options.length-1).focus(!0)})})},this.handleKeyDown=e=>{const t=this.questionRef.current,a=t.dataset.maxLength,n=t.innerText.length;let s=!1;const i=window.getSelection(),o=Si.isSpecial(e),r=Si.isNavigational(e);switch(i&&(s=!!i.toString()),e.key){case"Enter":if(!e.shiftKey)return this.handleFocusNextOption(0),e.preventDefault(),!1;break;case"ArrowDown":{const a=window.getSelection();if(!a)break;if(!a.isCollapsed)break;const n=t.childNodes&&t.childNodes.length>0?t.childNodes[t.childNodes.length-1]:null;if(!n||a.anchorNode===n&&a.anchorOffset===n.length)return this.handleFocusNextOption(0),e.preventDefault(),!1;break}}return!(!o&&!r)||(!(n>=a&&!s)||(e.preventDefault(),!1))},this.handlePaste=e=>{e.preventDefault();const t=this.questionRef.current,a=t.dataset.maxLength,n=window.getSelection(),s=n?n.toString():"",i=t.innerText;if(i.length-n.length>=a)return;let o=e.clipboardData.getData("text/plain");o&&(i.length-s.length+o.length>a&&(o=o.substr(0,a-i.length+s.length)),document.execCommand("insertText",!1,o))},this.handleInput=e=>{e.preventDefault();const t=this.questionRef.current,a=t.innerText;"<br>"===t.innerHTML&&(t.innerText=""),K.a.clientUpdate({"@type":"clientUpdatePollQuestion",question:a})},this.handleAddOption=()=>{const e=this.state.poll;if(!e)return;if(e.options.length>=p.M)return;const t={id:Date.now(),text:""};K.a.clientUpdate({"@type":"clientUpdateNewPollOption",option:t})},this.handleDeleteOption=(e,t=!1)=>{t?this.handleDeleteByBackspace(e):this.handleDelete(e)},this.handleDelete=e=>{K.a.clientUpdate({"@type":"clientUpdateDeletePollOption",id:e})},this.handleDeleteByBackspace=e=>{const t=this.state.poll;if(!t)return;const a=t.options,n=a.findIndex(t=>t.id===e),s=n-1;let i=!0;for(let r=n;r<a.length;r++){if(a[r].text){i=!1;break}}i&&this.handleDeleteOption(e);const o=this.optionsRefMap.get(s);if(o)o.focus(!0);else{pi(this.questionRef.current,!0)}},this.handleFocusPrevOption=e=>{const t=this.state.poll;if(!t)return;const a=t.options.findIndex(t=>t.id===e)-1,n=this.optionsRefMap.get(a);if(n)n.focus(!1);else{pi(this.questionRef.current,!1)}},this.handleFocusNextOption=e=>{const t=this.state.poll;if(!t)return;const a=t.options,n=a.findIndex(t=>t.id===e),s=n+1,i=this.optionsRefMap.get(s);if(i)i.focus(i,!0);else{const e=n>=0&&n<a.length?a[n].text:"";if(a.length&&!e)return;this.handleAddOption()}},this.getHint=()=>{const e=this.state.poll;if(!e)return;const t=e.options,a=p.M-t.length;return a<=0?"You have added the maximum number of options.":1===a?"You can add 1 more option.":"You can add ".concat(p.M-t.length," more options.")},this.handleClose=()=>{const e=this.state.poll;Object(Ii.a)(e)?this.setState({confirm:!0}):this.handleConfirmationDone()},this.handleSend=()=>{const e=this.props.onSend,t=wi.a.getInputMessagePoll();t&&(e(t),this.handleConfirmationDone())},this.handleConfirmationClose=()=>{this.setState({confirm:!1})},this.handleConfirmationDone=()=>{this.handleConfirmationClose(),K.a.clientUpdate({"@type":"clientUpdateDeletePoll"})},this.handleChangeAnonymous=()=>{K.a.clientUpdate({"@type":"clientUpdatePollChangeAnonymous"})},this.handleChangeAllowMultipleAnswers=()=>{K.a.clientUpdate({"@type":"clientUpdatePollChangeAllowMultipleAnswers"})},this.handleChangeType=()=>{K.a.clientUpdate({"@type":"clientUpdatePollChangeType"})},this.handleScheduledAction=(e,t,a)=>{if(!e)return;const n=this.props.enqueueSnackbar;if(!n)return;Z.a.addScheduledAction(e,p.y+300,a)&&n(t,{autoHideDuration:p.y,action:[r.a.createElement(C.a,{key:"close","aria-label":"Close",color:"inherit",className:"notification-close-button",onClick:()=>Z.a.removeScheduledAction(e)},r.a.createElement(U.a,null))]})},this.handleAllowMultipleAnswersClick=e=>{const t=this.props.t,a=this.state.poll;if(a&&"pollTypeQuiz"===a.type["@type"]){e.stopPropagation();const a="disallow_multiple_answers",n=t("PollQuizOneRightAnswer"),s=null;this.handleScheduledAction(a,n,s)}},this.questionRef=r.a.createRef(),this.optionsRefMap=new Map,this.state={poll:null,confirm:!1,remainLength:p.S}}componentDidMount(){wi.a.on("clientUpdatePollChooseOption",this.handleClientUpdatePoll),wi.a.on("clientUpdatePollChangeAnonymous",this.handleClientUpdatePoll),wi.a.on("clientUpdatePollChangeAllowMultipleAnswers",this.handleClientUpdatePoll),wi.a.on("clientUpdatePollChangeType",this.handleClientUpdatePoll),wi.a.on("clientUpdateDeletePoll",this.handleClientUpdatePoll),wi.a.on("clientUpdateDeletePollOption",this.handleClientUpdatePoll),wi.a.on("clientUpdateNewPoll",this.handleClientUpdateNewPoll),wi.a.on("clientUpdateNewPollOption",this.handleClientUpdateNewPollOption),wi.a.on("clientUpdatePollOption",this.handleClientUpdatePoll),wi.a.on("clientUpdatePollQuestion",this.handleClientUpdatePollQuestion)}componentWillUnmount(){wi.a.off("clientUpdatePollChooseOption",this.handleClientUpdatePoll),wi.a.off("clientUpdatePollChangeAnonymous",this.handleClientUpdatePoll),wi.a.off("clientUpdatePollChangeAllowMultipleAnswers",this.handleClientUpdatePoll),wi.a.off("clientUpdatePollChangeType",this.handleClientUpdatePoll),wi.a.off("clientUpdateDeletePoll",this.handleClientUpdatePoll),wi.a.off("clientUpdateDeletePollOption",this.handleClientUpdatePoll),wi.a.off("clientUpdateNewPoll",this.handleClientUpdateNewPoll),wi.a.off("clientUpdateNewPollOption",this.handleClientUpdateNewPollOption),wi.a.off("clientUpdatePollOption",this.handleClientUpdatePoll),wi.a.off("clientUpdatePollQuestion",this.handleClientUpdatePollQuestion)}componentDidUpdate(e,t,a){this.state.poll&&!t.poll&&setTimeout(()=>{pi(this.questionRef.current,!0)},0)}render(){const e=this.props.t,t=this.state,a=t.remainLength,n=t.confirm,s=t.poll;if(!s)return null;const i=s.is_anonymous,o=s?s.options:[],c=s.type.allow_multiple_answers,d="pollTypeRegular"!==s.type["@type"],h="pollTypeQuiz"===s.type["@type"];this.optionsRefMap.clear();const u=o.map((e,t)=>r.a.createElement(Mi,{ref:e=>this.optionsRefMap.set(t,e),key:e.id,option:e,onDelete:this.handleDeleteOption,onFocusPrev:this.handleFocusPrevOption,onFocusNext:this.handleFocusNextOption})),m=p.M-o.length>0,g=this.getHint();return r.a.createElement(r.a.Fragment,null,r.a.createElement(y.a,{className:l()("create-poll-dialog",{"create-quiz-dialog":h}),open:!0,transitionDuration:0,onClose:this.handleClose,"aria-labelledby":"dialog-title"},r.a.createElement(E.a,{id:"dialog-title"},e("NewPoll")),r.a.createElement(On.a,{classes:{root:"create-poll-dialog-root"}},r.a.createElement("div",{className:"create-poll-dialog-question-title"},r.a.createElement(Ce.a,{color:"primary",variant:"subtitle1",style:{flexGrow:1}},e("Question")),a<=p.R-p.Q&&r.a.createElement(Ce.a,{color:a>=0?"textSecondary":"error",variant:"subtitle1"},a)),r.a.createElement("div",{ref:this.questionRef,id:"create-poll-dialog-question",contentEditable:!0,suppressContentEditableWarning:!0,placeholder:e("QuestionHint"),"data-length":p.R,"data-max-length":p.S,onPaste:this.handlePaste,onKeyDown:this.handleKeyDown,onInput:this.handleInput}),r.a.createElement(ne.a,{className:"divider"}),r.a.createElement(Ce.a,{color:"primary",variant:"subtitle1"},e("PollOptions")),r.a.createElement(he.a,{classes:{root:"create-poll-dialog-list"}},u,m&&r.a.createElement(ue.a,{selected:!1,className:"create-poll-add-option",button:!0,onClick:this.handleAddOption},r.a.createElement(me.a,{disableTypography:!0,primary:e("AddAnOption")}))),r.a.createElement(Ce.a,null,g),r.a.createElement(ne.a,{className:"divider"}),r.a.createElement(Ce.a,{color:"primary",variant:"subtitle1"},e("Settings")),r.a.createElement(hi.a,null,r.a.createElement(An.a,{control:r.a.createElement(ys.a,{color:"primary",checked:i,onChange:this.handleChangeAnonymous}),label:e("PollAnonymous")}),r.a.createElement("div",{onClick:this.handleAllowMultipleAnswersClick,style:{background:"transparent"}},r.a.createElement(An.a,{control:r.a.createElement(ys.a,{color:"primary",disabled:d,checked:c,onChange:this.handleChangeAllowMultipleAnswers}),label:e("PollMultiple")})),r.a.createElement(An.a,{control:r.a.createElement(ys.a,{color:"primary",checked:h,onChange:this.handleChangeType}),label:e("PollQuiz")})),r.a.createElement(Ce.a,null,e("QuizInfo"))),r.a.createElement(v.a,null,r.a.createElement(b.a,{color:"primary",onClick:this.handleClose},e("Cancel")),Object(Ii.b)(s)&&r.a.createElement(b.a,{color:"primary",onClick:this.handleSend},e("Create")))),r.a.createElement(y.a,{className:"create-poll-dialog-root",open:n,transitionDuration:0,onClose:this.handleConfirmationClose,"aria-labelledby":"dialog-title"},r.a.createElement(E.a,{id:"dialog-title"},e("CancelPollAlertTitle")),r.a.createElement(On.a,{classes:{root:"create-poll-dialog-root"}},e("CancelPollAlertText")),r.a.createElement(v.a,null,r.a.createElement(b.a,{color:"primary",onClick:this.handleConfirmationClose},e("Cancel")),r.a.createElement(b.a,{color:"primary",onClick:this.handleConfirmationDone},e("Ok")))))}}var xi=Object(d.a)(Object(d.d)(),Object(f.d)(),u.withSnackbar,Object(d.c)())(_i),Oi=a(317);a(486);class Ti extends r.a.Component{constructor(e){super(e),this.handleTextKeyDown=e=>{"Enter"===e.key&&(this.urlInputRef.current.focus(),e.preventDefault(),e.stopPropagation())},this.handleUrlKeyDown=e=>{"Enter"===e.key&&(this.handleDone(),e.preventDefault(),e.stopPropagation())},this.handleTextChange=e=>{this.setState({text:e.target.value})},this.handleUrlChange=e=>{this.setState({url:e.target.value})},this.handleDone=()=>{const e=this.props,t=e.defaultText,a=e.defaultUrl;let n=this.state,s=n.text,i=n.url;if(s=null!==s?s:t,i=null!==i?i:a,!s&&!i)return void this.textInputRef.current.focus();if(!s)return this.setState({textError:!0}),void this.textInputRef.current.focus();if(i=Object(Oi.d)(i),!i)return this.setState({urlError:!0}),void this.urlInputRef.current.focus();(0,this.props.onDone)(s,i)},this.handleCancel=()=>{(0,this.props.onCancel)()},this.textRef=r.a.createRef(),this.textInputRef=r.a.createRef(),this.urlRef=r.a.createRef(),this.urlInputRef=r.a.createRef(),this.state={}}componentDidUpdate(e,t,a){const n=this.props,s=n.defaultText,i=n.defaultUrl,o=n.open;o&&e.open!==o&&setTimeout(()=>{const e=this.textInputRef.current,t=this.urlInputRef.current;e&&t&&(s?i?(e.focus(),e.select()):t.focus():e.focus())},0)}componentDidMount(){}shouldComponentUpdate(e,t,a){const n=this.props,s=n.defaultText,i=n.defaultUrl,o=n.onDone,r=n.onCancel,c=n.open,l=this.state,d=l.textError,h=l.urlError;return e.defaultText!==s||(e.defaultUrl!==i||(t.textError!==d||(t.urlError!==h||(e.onDone!==o||(e.onCancel!==r||e.open!==c)))))}static getDerivedStateFromProps(e,t){return t.prevOpen!==e.open?{prevOpen:!0,textError:!1,urlError:!1,text:null,url:null}:null}render(){const e=this.props,t=e.open,a=e.defaultUrl,n=e.defaultText,s=e.t,i=this.state,o=i.textError,c=i.urlError;return t?r.a.createElement(y.a,{transitionDuration:0,open:!0,onClose:this.handleCancel,"aria-labelledby":"edit-url-dialog-title"},r.a.createElement(E.a,{id:"edit-url-dialog-title"},s("CreateLink")),r.a.createElement(On.a,null,r.a.createElement("div",{style:{display:"flex",flexDirection:"column",width:260}},r.a.createElement(is.a,{ref:this.textRef,inputRef:this.textInputRef,label:s("Text"),margin:"normal",autoComplete:"off",defaultValue:n,error:o,onChange:this.handleTextChange,onKeyDown:this.handleTextKeyDown}),r.a.createElement(is.a,{ref:this.urlRef,inputRef:this.urlInputRef,label:s("URL"),margin:"normal",autoComplete:"off",defaultValue:a,error:c,onChange:this.handleUrlChange,onKeyDown:this.handleUrlKeyDown}))),r.a.createElement(v.a,null,r.a.createElement(b.a,{onClick:this.handleCancel,color:"primary"},s("Cancel")),r.a.createElement(b.a,{onClick:this.handleDone,color:"primary"},s("Create")))):null}}var Li=Object(f.d)()(Ti);a(487);class Pi extends r.a.Component{constructor(...e){super(...e),this.onClientUpdatePhotoBlob=e=>{const t=this.props,a=t.chatId,n=t.messageId,s=t.photoSize;if(!s)return;const i=s.photo;i&&e.chatId===a&&e.messageId===n&&e.fileId===i.id&&this.forceUpdate()}}componentDidMount(){P.a.on("clientUpdateAnimationThumbnailBlob",this.onClientUpdatePhotoBlob),P.a.on("clientUpdateAudioThumbnailBlob",this.onClientUpdatePhotoBlob),P.a.on("clientUpdateDocumentThumbnailBlob",this.onClientUpdatePhotoBlob),P.a.on("clientUpdatePhotoBlob",this.onClientUpdatePhotoBlob),P.a.on("clientUpdateStickerThumbnailBlob",this.onClientUpdatePhotoBlob),P.a.on("clientUpdateVideoThumbnailBlob",this.onClientUpdatePhotoBlob),P.a.on("clientUpdateVideoNoteThumbnailBlob",this.onClientUpdatePhotoBlob)}componentWillUnmount(){P.a.off("clientUpdateAnimationThumbnailBlob",this.onClientUpdatePhotoBlob),P.a.off("clientUpdateAudioThumbnailBlob",this.onClientUpdatePhotoBlob),P.a.off("clientUpdateDocumentThumbnailBlob",this.onClientUpdatePhotoBlob),P.a.off("clientUpdatePhotoBlob",this.onClientUpdatePhotoBlob),P.a.off("clientUpdateStickerThumbnailBlob",this.onClientUpdatePhotoBlob),P.a.off("clientUpdateVideoThumbnailBlob",this.onClientUpdatePhotoBlob),P.a.off("clientUpdateVideoNoteThumbnailBlob",this.onClientUpdatePhotoBlob)}render(){const e=this.props,t=e.chatId,a=e.messageId,n=e.photoSize,s=e.minithumbnail;if(!n)return null;const i=n.photo;if(!i)return null;const o=s?"data:image/jpeg;base64, "+s.data:null,c=Object(T.j)(i),d=!c&&o||Object(Et.k)(n),h=Object(vt.A)(t,a),u=Boolean(c||o);return r.a.createElement("div",{className:"reply-tile"},u&&r.a.createElement("img",{className:l()("reply-tile-photo",{"reply-tile-photo-round":h},{"reply-tile-photo-loading":!c},{"media-blurred":c&&d},{"media-mini-blurred":!c&&o&&d}),draggable:!1,src:c||o,alt:""}))}}var Ni=Pi;a(488);class Di extends r.a.Component{constructor(...e){super(...e),this.onGetMessageResult=e=>{const t=this.props,a=t.chatId,n=t.messageId;a===e.chat_id&&n===e.id&&this.forceUpdate()},this.handleClick=e=>{e.stopPropagation()},this.handleOpen=e=>{if(0!==e.button)return;e.stopPropagation();const t=this.props,a=t.chatId,n=t.messageId,s=t.onClick,i=q.a.get(a,n);return i?Object(vt.D)(i)?null:(Object(G.h)(a,n,!1),void(s&&s())):null}}componentDidMount(){q.a.on("getMessageResult",this.onGetMessageResult)}componentWillUnmount(){q.a.off("getMessageResult",this.onGetMessageResult)}render(){const e=this.props,t=e.t,a=e.chatId,n=e.messageId;let s=this.props.title;const i=q.a.get(a,n);s=s||Object(vt.x)(i,t);let o=i?Object(vt.h)(i,t):t("Loading");const c=Object(vt.t)(a,n),d=Object(vt.s)(a,n);return Object(vt.D)(i)&&(s=null,o=t("DeletedMessage")),r.a.createElement("div",{className:"reply",onMouseDown:this.handleOpen,onClick:this.handleClick},r.a.createElement("div",{className:"reply-wrapper"},r.a.createElement("div",{className:"border reply-border"}),c&&r.a.createElement(Ni,{chatId:a,messageId:n,photoSize:c,minithumbnail:d}),r.a.createElement("div",{className:"reply-content"},s&&r.a.createElement("div",{className:"reply-content-title"},s),r.a.createElement("div",{className:l()("reply-content-subtitle")},o))))}}var ji=Object(f.d)()(Di);a(489);class Bi extends r.a.Component{constructor(...e){super(...e),this.onUpdateMessageContent=e=>{const t=this.props,a=t.chatId,n=t.messageId,s=t.editMessageId,i=e.chat_id,o=e.message_id;a===i&&(n!==o&&s!==o||this.forceUpdate())},this.handleClose=()=>{const e=this.props,t=e.chatId;e.editMessageId?K.a.clientUpdate({"@type":"clientUpdateEditMessage",chatId:t,messageId:0}):K.a.clientUpdate({"@type":"clientUpdateReply",chatId:t,messageId:0})}}componentDidMount(){q.a.on("updateMessageContent",this.onUpdateMessageContent)}componentWillUnmount(){q.a.off("updateMessageContent",this.onUpdateMessageContent)}render(){const e=this.props,t=e.chatId,a=e.messageId,n=e.editMessageId,s=e.t,i=e.onClick;return t&&(a||n)?r.a.createElement("div",{className:"inputbox-header"},r.a.createElement("div",{className:"inputbox-header-left-column"},r.a.createElement(C.a,{className:"inputbox-icon-button","aria-label":"Close",onClick:this.handleClose},r.a.createElement(U.a,null))),r.a.createElement("div",{className:"inputbox-header-middle-column"},r.a.createElement(ji,{chatId:t,messageId:a||n,title:n?s("EditMessage"):null,onClick:i})),r.a.createElement("div",{className:"inputbox-header-right-column"})):null}}var Ri=Object(f.d)()(Bi);a(490);class Fi extends r.a.Component{constructor(...e){super(...e),this.handleDone=()=>{(0,this.props.onConfirm)()},this.handleCancel=()=>{(0,this.props.onCancel)()}}render(){const e=this.props,t=e.files,a=e.t;return t?r.a.createElement(y.a,{transitionDuration:0,open:!0,onClose:this.handleCancel,"aria-labelledby":"delete-dialog-title"},r.a.createElement(E.a,{id:"delete-dialog-title"},a("Confirm")),r.a.createElement(On.a,null,r.a.createElement(Tn.a,null,t.length>1?a("SendFilesConfirmation"):a("SendFileConfirmation"))),r.a.createElement(v.a,null,r.a.createElement(b.a,{onClick:this.handleCancel,color:"primary"},a("Cancel")),r.a.createElement(b.a,{onClick:this.handleDone,color:"primary"},a("Ok")))):null}}var Ai=Object(d.a)(Object(f.d)())(Fi),Vi=a(492),zi=a.n(Vi);a(491);class Hi extends r.a.Component{constructor(e){var t;super(e),t=this,this.handleSelectionChange=()=>{document.activeElement===this.captionRef.current&&this.saveSelection()},this.handleDone=()=>{const e=this.props,t=e.chatId,a=e.newFile,n=e.newMedia,s=e.onSend,i=e.onEdit,o=this.state,r=o.editMessage,c=o.editFile,l=o.editMedia,d=o.sendAsPhoto,h=this.captionRef.current;if(!h)return;const u=h.innerHTML;h.innerText=null;const p=Object(vt.l)(u),m={"@type":"formattedText",text:p.text,entities:p.entities};if(Boolean(r))if(l){const e=l.photo;if(!e)return;const a=e.sizes;if(!a)return;const n=a[a.length-1],s=n.width,o=n.height;i(null,{"@type":"inputMessagePhoto",photo:{"@type":"inputFileBlob",name:c.name,data:c},width:s,height:o,caption:m}),K.a.clientUpdate({"@type":"clientUpdateEditMessage",chatId:t,messageId:0})}else i(m,null),K.a.clientUpdate({"@type":"clientUpdateEditMessage",chatId:t,messageId:0});else{const e=n.photo,i=n.document;if(e){const n=e.sizes;if(!n)return;const i=n[n.length-1],o=i.width,r=i.height;s(d?{"@type":"inputMessagePhoto",photo:{"@type":"inputFileBlob",name:a.name,data:a},width:o,height:r,caption:m}:{"@type":"inputMessageDocument",document:{"@type":"inputFileBlob",name:a.name,data:a},thumbnail:null,caption:m},a),K.a.clientUpdate({"@type":"clientUpdateEditMessage",chatId:t,messageId:0})}else if(i){s({"@type":"inputMessageDocument",document:{"@type":"inputFileBlob",name:a.name,data:a},thumbnail:null,caption:m},a),K.a.clientUpdate({"@type":"clientUpdateEditMessage",chatId:t,messageId:0})}}},this.handleCancel=()=>{const e=this.props,t=e.chatId,a=e.onCancel;K.a.clientUpdate({"@type":"clientUpdateEditMessage",chatId:t,messageId:0}),a()},this.handleKeyDown=e=>{const t=e.altKey,a=e.ctrlKey,n=e.keyCode,s=e.metaKey,i=e.repeat,o=e.shiftKey;switch(n){case 13:t||a||s||o||(i||this.handleDone(),e.preventDefault(),e.stopPropagation());break;case 66:t||!a&&!s||o||(i||this.handleBold(),e.preventDefault(),e.stopPropagation());break;case 73:t||!a&&!s||o||(i||this.handleItalic(),e.preventDefault(),e.stopPropagation());break;case 75:t||!a&&!s||o?t&&(a||s)&&!o&&(i||this.handleMono(),e.preventDefault(),e.stopPropagation()):(i||this.handleUrl(),e.preventDefault(),e.stopPropagation());break;case 192:t&&(a||s)&&!o&&(i||this.handleClear(),e.preventDefault(),e.stopPropagation())}},this.handleClear=()=>{document.execCommand("removeFormat",!1,null),document.execCommand("unlink",!1,null)},this.handleBold=()=>{document.execCommand("removeFormat",!1,null),document.execCommand("unlink",!1,null),document.execCommand("bold",!1,null)},this.handleItalic=()=>{document.execCommand("removeFormat",!1,null),document.execCommand("unlink",!1,null),document.execCommand("italic",!1,null)},this.handleMono=()=>{document.execCommand("removeFormat",!1,null),document.execCommand("unlink",!1,null);let e="";const t=this.selection;t&&!t.isCollapsed&&(e=t.toString()),e&&(e="<code>".concat(e,"</code>"),document.execCommand("removeFormat",!1,null),document.execCommand("insertHTML",!1,e))},this.handleUnderline=()=>{document.execCommand("removeFormat",!1,null),document.execCommand("unlink",!1,null),document.execCommand("underline",!1,null)},this.handleStrikeThrough=()=>{document.execCommand("removeFormat",!1,null),document.execCommand("unlink",!1,null),document.execCommand("strikeThrough",!1,null)},this.handleUrl=()=>{this.openEditUrlDialog()},this.openEditUrlDialog=()=>{let e="",t="";const a=this.selection,n=this.range;if(n){let a=n.startContainer;if(a===n.endContainer){const n=a.parentElement;n&&"A"===n.nodeName&&(e=n.innerText,t=n.href)}}e||!a||a.isCollapsed||(e=a.toString()),this.setState({openEditUrl:!0,defaultUrl:t,defaultText:e})},this.closeEditUrlDialog=()=>{this.setState({openEditUrl:!1},()=>{this.restoreSelection()})},this.handlePaste=e=>{const t=e.clipboardData.getData("text/plain");t&&(e.preventDefault(),document.execCommand("insertText",!1,t))},this.handleInput=()=>{this.clearInnerHtml()},this.handleCancelEditUrl=()=>{this.closeEditUrlDialog()},this.handleDoneEditUrl=(e,t)=>{this.closeEditUrlDialog(),setTimeout(()=>{const a=this.range;if(a){const n=a.startContainer,s=a.endContainer;if(n&&n===s){const a=n.parentNode;if(a&&"A"===a.nodeName){a.href=t,a.title=t,a.innerText=e;const n=a.lastChild;if(n){const e=document.createRange();e.setStart(n,n.textContent.length),e.setEnd(n,n.textContent.length);const t=document.getSelection();t.removeAllRanges(),t.addRange(e)}return}}}const n="<a href=".concat(t," title=").concat(t," rel='noopener noreferrer' target='_blank'>").concat(e,"</a>");document.execCommand("removeFormat",!1,null),document.execCommand("insertHTML",!1,n)},0)},this.handleEditMedia=e=>{const t=this.editMediaRef.current;t&&t.click()},this.handleEditMediaComplete=Object(i.a)(s.a.mark((function e(){var a,n,i,o,r,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.editMediaRef.current){e.next=3;break}return e.abrupt("return");case 3:if(0!==(n=a.files).length){e.next=6;break}return e.abrupt("return");case 6:if(i=Array.from(n),o=Object(ei.a)(i),r=o[0],o.slice(1),r){e.next=9;break}return e.abrupt("return");case 9:return e.next=11,Object(Et.h)(r);case 11:c=e.sent,t.setState({editFile:r,editMedia:c}),a.value="";case 14:case"end":return e.stop()}}),e)}))),this.handleSendAsPhoto=()=>{const e=this.state.sendAsPhoto;this.setState({sendAsPhoto:!e})},this.captionRef=r.a.createRef(),this.editMediaRef=r.a.createRef(),this.state={}}static getDerivedStateFromProps(e,t){const a=t.prevOpen,n=e.open,s=e.chatId,i=e.messageId,o=e.newMedia;if(a!==n){if(n){const e=q.a.get(s,i);let t=!1;return(e&&"messagePhoto"===e.content["@type"]||o&&"messagePhoto"===o["@type"])&&(t=!0),{prevOpen:!0,sendAsPhoto:t,editMessage:e,editMedia:null,editFile:null}}return{prevOpen:!1,sendAsPhoto:!1,editMessage:null,editMedia:null,editFile:null}}return null}componentDidMount(){document.addEventListener("selectionchange",this.handleSelectionChange,!0)}componentWillUnmount(){document.removeEventListener("selectionchange",this.handleSelectionChange,!0)}componentDidUpdate(e,t,a){const n=this.props,s=n.chatId,i=n.messageId,o=n.open;if(o&&o!==e.open){let e=null,t=null;const a=q.a.get(s,i);if(a){const n=a.content;n&&(e=n.text,t=n.caption)}setTimeout(()=>{const a=this.captionRef.current;a&&(e?this.setFormattedText(e):t?this.setFormattedText(t):a.innerText=null,Ga(a))},0)}}setFormattedText(e){const t=this.props.t,a=this.captionRef.current;if(!e)return void(a.innerText=null);const n=e.text,s=e.entities;try{const e=Object(vt.r)(n,s,t);a.innerHTML=null,e.forEach(e=>{a.appendChild(e)})}catch(i){a.innerText=n}}saveSelection(){this.selection=document.getSelection(),this.range=this.selection.getRangeAt(0)}restoreSelection(){const e=this.range;if(!e)return void Ga();const t=document.getSelection();t.removeAllRanges(),t.addRange(e),this.captionRef.current.focus()}clearInnerHtml(){const e=this.captionRef.current;if(!e)return;const t=e.innerHTML;"<br>"!==t&&"<div><br></div>"!==t||(e.innerHTML=null)}render(){const e=this.props,t=e.chatId,a=e.messageId,n=e.newMedia,s=e.open,i=e.t,o=this.state,c=o.defaultText,l=o.defaultUrl,d=o.openEditUrl,h=o.editMessage,u=o.editMedia,p=o.sendAsPhoto;if(!s)return null;const m=q.a.get(t,a),g=Boolean(m);let f=!1;(n&&"messagePhoto"===n["@type"]||u&&"messagePhoto"===u["@type"]||h&&"messagePhoto"===h.content["@type"])&&(f=!0);let E=null;E=g?u?Object(Et.f)({content:u}):Object(Et.f)(m,null):Object(Et.f)({content:n});const U=i(g?"Edit":"Send");return r.a.createElement(y.a,{transitionDuration:0,open:!0,onClose:this.handleCancel,"aria-labelledby":"edit-media-dialog-title"},r.a.createElement("div",{className:"edit-media-dialog-content"},r.a.createElement("div",{style:{margin:24}},E),g&&r.a.createElement(r.a.Fragment,null,r.a.createElement(C.a,{disableRipple:!0,"aria-label":i("Edit"),className:"edit-media-dialog-edit-button",size:"small",onClick:this.handleEditMedia},r.a.createElement(zi.a,{fontSize:"inherit"})),r.a.createElement("input",{ref:this.editMediaRef,className:"inputbox-attach-button",type:"file",accept:"image/*",onChange:this.handleEditMediaComplete})),!g&&f&&r.a.createElement(Fn.a,{value:p,onChange:this.handleSendAsPhoto,style:{margin:"0 24px 24px"}},r.a.createElement(An.a,{value:!0,control:r.a.createElement(Rn.a,{color:"primary"}),label:i("SendAsPhoto")}),r.a.createElement(An.a,{value:!1,control:r.a.createElement(Rn.a,{color:"primary"}),label:i("SendAsFile")}))),r.a.createElement("div",{ref:this.captionRef,id:"edit-media-dialog-caption",contentEditable:!0,suppressContentEditableWarning:!0,placeholder:i("Caption"),onKeyDown:this.handleKeyDown,onPaste:this.handlePaste,onInput:this.handleInput}),r.a.createElement(v.a,null,r.a.createElement(b.a,{onClick:this.handleCancel,color:"primary"},i("Cancel")),r.a.createElement(b.a,{onClick:this.handleDone,color:"primary"},U)),r.a.createElement(Li,{open:d,defaultText:c,defaultUrl:l,onDone:this.handleDoneEditUrl,onCancel:this.handleCancelEditUrl}))}}var Wi=Object(f.d)()(Hi);var Gi=class{constructor(e){this.chatId=e,this.lastAction=null}setTyping(e){if(this.chatId){if(this.lastAction&&this.lastAction["@type"]===e["@type"]){let e=new Date;if(e.setSeconds(e.getSeconds()-p.qb),this.lastTypingDate&&this.lastTypingDate>e)return}this.lastAction=e,this.lastTypingDate=new Date,K.a.send({"@type":"sendChatAction",chat_id:this.chatId,action:e})}}},Zi=a(295);a(493);const qi=r.a.lazy(()=>Promise.all([a.e(8),a.e(7)]).then(a.bind(null,582)));class Ki extends o.Component{constructor(e){var t;super(e),t=this,this.selectionChangeListener=()=>{document.activeElement===this.newMessageRef.current&&this.saveSelection()},this.onClientUpdateSendFiles=e=>{const t=e.files;t&&this.handleSendFiles(Array.from(t))},this.onUpdateDeleteMessages=e=>{const t=this.state,a=t.chatId,n=t.editMessageId,s=e.chat_id,i=e.message_ids,o=e.is_permanent;n&&o&&a===s&&-1!==i.indexOf(n)&&this.handleCancel()},this.onClientUpdateEditMessage=e=>{const t=e.chatId,a=e.messageId;this.state.chatId===t&&(a?this.saveDraftAndSelection():this.restoreDraftAndSelection(),this.setState({editMessageId:a,openEditMedia:0!==a&&Object(Et.l)(t,a)},()=>{this.state.openEditMedia||(this.setEditMessage(),this.handleInput(),this.focusInput())}))},this.onClientUpdateFocusWindow=e=>{e.focused||this.saveDraft()},this.onUpdateChatDraftMessage=e=>{const t=e.chat_id;this.state.chatId===t&&this.loadDraft()},this.onClientUpdateStickerSend=e=>{const t=e.sticker;if(!t)return;const a=t.sticker,n=t.thumbnail,s=t.width,i=t.height;if(!a)return;const o=this.newMessageRef.current;if(!o)return;o.innerText=null,this.restoreSelection();const r={"@type":"inputMessageSticker",sticker:{"@type":"inputFileId",id:a.id},width:s,height:i};if(n){const e=n.width,t=n.height,a=n.photo;r.thumbnail={thumbnail:{"@type":"inputFileId",id:a.id},width:e,height:t}}this.sendMessage(r,!1,e=>{}),K.a.clientUpdate({"@type":"clientUpdateLocalStickersHint",hint:null})},this.onClientUpdateReply=e=>{const t=this.state.chatId,a=e.chatId,n=e.messageId;t===a&&(this.setState({replyToMessageId:n}),n&&this.setInputFocus())},this.onClientUpdateChatId=e=>{this.state.chatId!==e.nextChatId&&(this.saveDraft(),this.beforeEditText=null,this.setState({chatId:e.nextChatId,replyToMessageId:Object(w.l)(e.nextChatId),editMessageId:0,openEditUrl:!1},()=>{this.loadDraft()}))},this.setDraft=()=>{const e=this.state.chatId,t=this.newMessageRef.current,a=Object(w.k)(e);a?(this.setFormattedText(a),this.setState({replyToMessageId:Object(w.l)(e)})):t.innerText=null},this.setInputFocus=()=>{setTimeout(()=>{Ga(this.newMessageRef.current)},100)},this.setChatDraftMessage=e=>{if(!e)return;const t=e.chatId,a=e.draftMessage;t&&K.a.send({"@type":"setChatDraftMessage",chat_id:t,draft_message:a})},this.getDraftMessage=(e,t,a)=>{const n=L.a.get(e);if(!n)return;const s=n.draft_message,i=Object(vt.l)(a),o=i.text,r=i.entities,c=o&&o.length>0||r.length>0?{"@type":"draftMessage",reply_to_message_id:t,input_message_text:{"@type":"inputMessageText",text:{"@type":"formattedText",text:o,entities:r},disable_web_page_preview:!1,clear_draft:!1}}:null;return Object(w.i)(s,c)?null:{chatId:e,draftMessage:c}},this.handleSubmit=()=>{const e=this.state,t=e.chatId,a=e.editMessageId,n=this.newMessageRef.current;if(!n)return;let s=n.innerHTML;if(n.innerText=null,this.handleInput(),K.a.clientUpdate({"@type":"clientUpdateEditMessage",chatId:t,messageId:0}),!s)return;if(!s.trim())return;s=s.replace(/<div><br><\/div>/gi,"<br>"),s=s.replace(/<div>/gi,"<br>"),s=s.replace(/<\/div>/gi,"");const i=Object(vt.l)(s),o={"@type":"formattedText",text:i.text,entities:i.entities},r={"@type":"inputMessageText",text:o,disable_web_page_preview:!1,clear_draft:!0};if(a){const e=q.a.get(t,a);if(!e)return;const n=e.content;if(!n)return;const s=n.text,i=n.caption;s?this.editMessageText(r,e=>{}):i&&this.editMessageCaption(o)}else this.sendMessage(r,!1,e=>{})},this.handleAttachPoll=()=>{K.a.clientUpdate({"@type":"clientUpdateNewPoll"})},this.handleAttachPhoto=()=>{this.attachPhotoRef&&this.attachPhotoRef.current.click()},this.handleAttachPhotoComplete=Object(i.a)(s.a.mark((function e(){var a,n,o,r,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==(a=t.attachPhotoRef.current.files).length){e.next=3;break}return e.abrupt("return");case 3:if(1!==a.length){e.next=13;break}if(n=Array.from(a),o=Object(ei.a)(n),r=o[0],o.slice(1),r){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,Object(Et.h)(r);case 9:c=e.sent,t.setState({openEditMedia:!0,newFile:r,newMedia:c}),e.next=14;break;case 13:Array.from(a).forEach(function(){var e=Object(i.a)(s.a.mark((function e(a){var n,i,o,r,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Ae.w)(a);case 2:n=e.sent,i=Object(g.a)(n,2),o=i[0],r=i[1],c={"@type":"inputMessagePhoto",photo:{"@type":"inputFileBlob",name:a.name,size:a.size,data:a},width:o,height:r},t.handleSendPhoto(c,a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 14:t.attachPhotoRef.current.value="";case 15:case"end":return e.stop()}}),e)}))),this.handleAttachDocument=()=>{this.attachDocumentRef&&this.attachDocumentRef.current.click()},this.handleAttachDocumentComplete=Object(i.a)(s.a.mark((function e(){var a,n,i,o,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==(a=t.attachDocumentRef.current.files).length){e.next=3;break}return e.abrupt("return");case 3:if(1!==a.length){e.next=13;break}if(n=Array.from(a),i=Object(ei.a)(n),o=i[0],i.slice(1),o){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,Object(Et.g)(o);case 9:r=e.sent,t.setState({openEditMedia:!0,newFile:o,newMedia:r}),e.next=14;break;case 13:Array.from(a).forEach(e=>{const a={"@type":"inputMessageDocument",document:{"@type":"inputFileBlob",name:e.name,size:e.size,data:e}};t.handleSendDocument(a,e)});case 14:t.attachDocumentRef.current.value="";case 15:case"end":return e.stop()}}),e)}))),this.handleClear=()=>{document.execCommand("removeFormat",!1,null),document.execCommand("unlink",!1,null)},this.handleBold=()=>{document.execCommand("removeFormat",!1,null),document.execCommand("unlink",!1,null),document.execCommand("bold",!1,null)},this.handleItalic=()=>{document.execCommand("removeFormat",!1,null),document.execCommand("unlink",!1,null),document.execCommand("italic",!1,null)},this.handleMono=()=>{document.execCommand("removeFormat",!1,null),document.execCommand("unlink",!1,null);let e="";const t=this.selection;t&&!t.isCollapsed&&(e=t.toString()),e&&(e="<code>".concat(e,"</code>"),document.execCommand("removeFormat",!1,null),document.execCommand("insertHTML",!1,e))},this.handleUnderline=()=>{document.execCommand("removeFormat",!1,null),document.execCommand("unlink",!1,null),document.execCommand("underline",!1,null)},this.handleStrikeThrough=()=>{document.execCommand("removeFormat",!1,null),document.execCommand("unlink",!1,null),document.execCommand("strikeThrough",!1,null)},this.handleUrl=()=>{this.openEditUrlDialog()},this.handleCancel=()=>{const e=this.state,t=e.chatId,a=e.editMessageId,n=e.replyToMessageId;a?K.a.clientUpdate({"@type":"clientUpdateEditMessage",chatId:t,messageId:0}):n&&K.a.clientUpdate({"@type":"clientUpdateReply",chatId:t,messageId:0})},this.handleKeyDown=e=>{const t=e.altKey,a=e.ctrlKey,n=e.keyCode,s=e.metaKey,i=e.repeat,o=e.shiftKey;switch(n){case 13:t||a||s||o||(i||this.handleSubmit(),e.preventDefault(),e.stopPropagation());break;case 27:t||a||s||o||(i||this.handleCancel(),e.preventDefault(),e.stopPropagation());break;case 38:if(!i&&!t&&!a&&!s&&!o){const t=this.newMessageRef.current;if(t&&!t.innerText){if(this.state.editMessageId)return;K.a.clientUpdate({"@type":"clientUpdateTryEditMessage"}),e.preventDefault(),e.stopPropagation()}}break;case 66:t||!a&&!s||o||(i||this.handleBold(),e.preventDefault(),e.stopPropagation());break;case 73:t||!a&&!s||o||(i||this.handleItalic(),e.preventDefault(),e.stopPropagation());break;case 75:t||!a&&!s||o?t&&(a||s)&&!o&&(i||this.handleMono(),e.preventDefault(),e.stopPropagation()):(i||this.handleUrl(),e.preventDefault(),e.stopPropagation());break;case 192:t&&(a||s)&&!o&&(i||this.handleClear(),e.preventDefault(),e.stopPropagation())}},this.handleSendPhoto=(e,t)=>{e&&this.sendMessage(e,!0,e=>{const a=q.a.get(e.chat_id,e.id);null!=a&&this.handleSendingMessage(a,t),P.a.uploadFile(e.content.photo.sizes[0].photo.id,e)})},this.handleSendPoll=e=>{this.sendMessage(e,!0,()=>{})},this.handleSendDocument=(e,t)=>{e&&this.sendMessage(e,!0,e=>P.a.uploadFile(e.content.document.document.id,e))},this.handlePaste=function(){var e=Object(i.a)(s.a.mark((function e(a){var n,i,o,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.clipboardData||a.originalEvent.clipboardData,i=n.items){e.next=3;break}return e.abrupt("return");case 3:if(o=[],Array.from(i).forEach(e=>{if(0===e.kind.indexOf("file")){const t=e.getAsFile();t&&o.push(t)}}),!(o.length>0)){e.next=9;break}return a.preventDefault(),t.handleSendFiles(o),e.abrupt("return");case 9:if(!(r=a.clipboardData.getData("text/plain"))){e.next=14;break}return a.preventDefault(),document.execCommand("insertText",!1,r),e.abrupt("return");case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handlePasteConfirm=()=>{const e=this.state.files;e&&e.length&&(e.forEach(e=>{const t={"@type":"inputMessageDocument",document:{"@type":"inputFileBlob",name:e.name,data:e}};this.handleSendDocument(t,e)}),this.handlePasteCancel())},this.handlePasteCancel=()=>{this.setState({files:null})},this.handleUpdateDraftConfirm=()=>{this.state.newDraft&&(this.loadDraft(),this.handleUpdateDraftCancel())},this.handleUpdateDraftCancel=()=>{this.setState({newDraft:null})},this.handleSendingMessage=(e,t)=>{if(!e)return;const a=e.sending_state,n=e.content,s=e.chat_id,i=e.id;if(!a)return;if("messageSendingStatePending"!==a["@type"])return;if("messagePhoto"!==n["@type"])return;const o=n.photo;if(!o)return;const r=Object(Ae.m)(o.sizes,p.F);if(!r)return;const c=r.photo;c&&(c.blob||(c.blob=t,P.a.updatePhotoBlob(s,i,c.id)))},this.sendMessage=function(){var e=Object(i.a)(s.a.mark((function e(a,n,i){var o,r,c,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t.state,r=o.chatId,c=o.replyToMessageId,r){e.next=3;break}return e.abrupt("return");case 3:if(a){e.next=5;break}return e.abrupt("return");case 5:return e.prev=5,e.next=8,Z.a.invokeScheduledAction("clientUpdateClearHistory chatId=".concat(r));case 8:return e.next=10,K.a.send({"@type":"sendMessage",chat_id:r,reply_to_message_id:c,input_message_content:a});case 10:l=e.sent,t.setState({replyToMessageId:0},()=>{n&&t.saveDraft()}),K.a.send({"@type":"viewMessages",chat_id:r,message_ids:[l.id]}),i(l),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(5),alert("sendMessage error "+JSON.stringify(e.t0));case 19:case"end":return e.stop()}}),e,null,[[5,16]])})));return function(t,a,n){return e.apply(this,arguments)}}(),this.handleEmojiSelect=e=>{e&&(this.restoreSelection(),document.execCommand("insertText",!1,e.native),this.handleInput())},this.handleInput=function(){var e=Object(i.a)(s.a.mark((function e(a){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.setTyping(),t.setHints();case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.openEditUrlDialog=()=>{let e="",t="";const a=this.selection,n=this.range;if(n){let a=n.startContainer;if(a===n.endContainer){const n=a.parentElement;n&&"A"===n.nodeName&&(e=n.innerText,t=n.href)}}e||!a||a.isCollapsed||(e=a.toString()),this.setState({openEditUrl:!0,defaultUrl:t,defaultText:e})},this.closeEditUrlDialog=()=>{this.setState({openEditUrl:!1},()=>{this.restoreSelection()})},this.focusInput=()=>{const e=this.newMessageRef.current;if(!e)return;if(!e.childNodes.length)return void e.focus();const t=Wa(e);if(!t)return;const a=document.createRange();a.setStart(t,t.length),a.collapse(!0);const n=window.getSelection();n.removeAllRanges(),n.addRange(a),e.focus()},this.handleCancelEditUrl=()=>{this.closeEditUrlDialog()},this.handleDoneEditUrl=(e,t)=>{this.closeEditUrlDialog(),setTimeout(()=>{const a=this.range;if(a){const n=a.startContainer,s=a.endContainer;if(n&&n===s){const a=n.parentNode;if(a&&"A"===a.nodeName){a.href=t,a.title=t,a.innerText=e;const n=a.lastChild;if(n){const e=document.createRange();e.setStart(n,n.textContent.length),e.setEnd(n,n.textContent.length);const t=document.getSelection();t.removeAllRanges(),t.addRange(e)}return}}}const n="<a href=".concat(t," title=").concat(t," rel='noopener noreferrer' target='_blank'>").concat(e,"</a>");document.execCommand("removeFormat",!1,null),document.execCommand("insertHTML",!1,n)},0)},this.handleCancelEditMedia=()=>{this.closeEditMediaDialog()},this.handleEditMedia=(e,t)=>{t?this.editMessageMedia(t):this.editMessageCaption(e)},this.handleSendMedia=(e,t)=>{switch(e["@type"]){case"inputMessagePhoto":this.handleSendPhoto(e,t);break;case"inputMessageDocument":this.handleSendDocument(e,t)}},this.handleHeaderClick=()=>{setTimeout(()=>this.restoreSelection(),0)},this.attachDocumentRef=r.a.createRef(),this.attachPhotoRef=r.a.createRef(),this.newMessageRef=r.a.createRef();const a=Z.a.getChatId();this.state={chatId:a,replyToMessageId:Object(w.l)(a),editMessageId:0,sendFile:null},document.execCommand("defaultParagraphSeparator",!1,"br")}shouldComponentUpdate(e,t){const a=this.props.t,n=this.state,s=n.chatId,i=n.newDraft,o=n.files,r=n.replyToMessageId,c=n.editMessageId,l=n.openEditMedia,d=n.openEditUrl,h=n.sendFile;return e.t!==a||(t.chatId!==s||(t.newDraft!==i||(t.files!==o||(t.replyToMessageId!==r||(t.editMessageId!==c||(t.sendFile!==h||(t.openEditUrl!==d||t.openEditMedia!==l)))))))}loadDraft(){this.setDraft(),this.setInputFocus(),this.handleInput()}saveDraft(){const e=this.state,t=e.chatId,a=e.editMessageId,n=e.replyToMessageId,s=this.newMessageRef.current;if(!s)return;let i=null;i=a?this.beforeEditText?this.beforeEditText.innerHTML:null:s.innerHTML;const o=this.getDraftMessage(t,n,i);this.setChatDraftMessage(o)}componentDidMount(){document.addEventListener("selectionchange",this.selectionChangeListener,!0),Z.a.on("clientUpdateChatId",this.onClientUpdateChatId),Z.a.on("clientUpdateEditMessage",this.onClientUpdateEditMessage),Z.a.on("clientUpdateFocusWindow",this.onClientUpdateFocusWindow),L.a.on("updateChatDraftMessage",this.onUpdateChatDraftMessage),P.a.on("clientUpdateSendFiles",this.onClientUpdateSendFiles),q.a.on("clientUpdateReply",this.onClientUpdateReply),q.a.on("updateDeleteMessages",this.onUpdateDeleteMessages),Zi.a.on("clientUpdateStickerSend",this.onClientUpdateStickerSend),this.loadDraft()}componentWillUnmount(){this.saveDraft(),Z.a.off("clientUpdateChatId",this.onClientUpdateChatId),Z.a.off("clientUpdateEditMessage",this.onClientUpdateEditMessage),Z.a.off("clientUpdateFocusWindow",this.onClientUpdateFocusWindow),L.a.off("updateChatDraftMessage",this.onUpdateChatDraftMessage),P.a.off("clientUpdateSendFiles",this.onClientUpdateSendFiles),q.a.off("clientUpdateReply",this.onClientUpdateReply),q.a.off("updateDeleteMessages",this.onUpdateDeleteMessages),Zi.a.off("clientUpdateStickerSend",this.onClientUpdateStickerSend),document.removeEventListener("selectionchange",this.selectionChangeListener,!0)}restoreDraftAndSelection(){const e=this.newMessageRef.current;if(!e)return;const t=this.beforeEditText;if(t){if(e.innerHTML=t.innerHTML,!t.range)return void this.focusInput();const a=document.getSelection();a.removeAllRanges(),a.addRange(t.range),e.focus()}else e.innerHTML=null,this.focusInput();this.handleInput()}saveDraftAndSelection(){const e=this.newMessageRef.current;e&&(this.beforeEditText={innerHTML:e.innerHTML,range:this.range})}setEditMessage(){const e=this.state,t=e.chatId,a=e.editMessageId,n=q.a.get(t,a);if(!n)return;const s=n.content;if(!s)return;const i=s.text,o=s.caption;if(!i&&!o)return;const r=this.newMessageRef.current;i?this.setFormattedText(i):o?this.setFormattedText(o):r.innerText=null}setFormattedText(e){const t=this.props.t,a=this.newMessageRef.current;if(!e)return void(a.innerText=null);const n=e.text,s=e.entities;try{const e=Object(vt.r)(n,s,t);a.innerHTML=null,e.forEach(e=>{a.appendChild(e)})}catch(i){a.innerText=n}}setTyping(){const e=this.state,t=e.chatId,a=e.editMessageId,n=L.a.get(t);if(!n)return;const s=this.newMessageRef.current;if(!s)return;const i=s.innerHTML;"<br>"!==i&&"<div><br></div>"!==i||(s.innerHTML=null),s.innerText&&(Object(w.S)(t)||a||(n.OutputTypingManager||(n.OutputTypingManager=new Gi(n.id))).setTyping({"@type":"chatActionTyping"}))}setHints(){const e=this.state.editMessageId,t=this.newMessageRef.current.innerText;if(!t||t.length>11||e){return void(Zi.a.hint&&K.a.clientUpdate({"@type":"clientUpdateLocalStickersHint",hint:null}))}performance.now();let a=ai()().exec(t);performance.now();if(!a||t!==a[0]){return void(Zi.a.hint&&K.a.clientUpdate({"@type":"clientUpdateLocalStickersHint",hint:null}))}const n=Date.now();K.a.send({"@type":"getStickers",emoji:a[0],limit:100}).then(e=>{K.a.clientUpdate({"@type":"clientUpdateLocalStickersHint",hint:{timestamp:n,emoji:a[0],stickers:e}})}),K.a.send({"@type":"searchStickers",emoji:a[0],limit:100}).then(e=>{K.a.clientUpdate({"@type":"clientUpdateRemoteStickersHint",hint:{timestamp:n,emoji:a[0],stickers:e}})})}handleSendFiles(e){var t=this;return Object(i.a)(s.a.mark((function a(){var n,i;return s.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(e){a.next=2;break}return a.abrupt("return");case 2:if(e.length){a.next=4;break}return a.abrupt("return");case 4:if(1!==e.length){a.next=19;break}if(!(n=e[0]).type.startsWith("image")){a.next=13;break}return a.next=9,Object(Et.h)(n);case 9:(i=a.sent)&&t.setState({newMedia:i,newFile:n,openEditMedia:!0}),a.next=17;break;case 13:return a.next=15,Object(Et.g)(n);case 15:(i=a.sent)&&t.setState({newMedia:i,newFile:n,openEditMedia:!0});case 17:a.next=20;break;case 19:t.setState({files:e});case 20:case"end":return a.stop()}}),a)})))()}editMessageMedia(e){const t=this.state,a=t.chatId,n=t.editMessageId;a&&n&&e&&K.a.send({"@type":"editMessageMedia",chat_id:a,message_id:n,input_message_content:e})}editMessageCaption(e){const t=this.state,a=t.chatId,n=t.editMessageId;a&&n&&e&&K.a.send({"@type":"editMessageCaption",chat_id:a,message_id:n,caption:e})}editMessageText(e,t){var a=this;return Object(i.a)(s.a.mark((function n(){var i,o,r,c;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=a.state,o=i.chatId,r=i.editMessageId,o){n.next=3;break}return n.abrupt("return");case 3:if(r){n.next=5;break}return n.abrupt("return");case 5:if(e){n.next=7;break}return n.abrupt("return");case 7:return n.prev=7,n.next=10,K.a.send({"@type":"editMessageText",chat_id:o,message_id:r,input_message_content:e});case 10:c=n.sent,t(c);case 12:return n.prev=12,n.finish(12);case 14:case"end":return n.stop()}}),n,null,[[7,,12,14]])})))()}saveSelection(){this.selection=document.getSelection(),this.range=this.selection.getRangeAt(0)}restoreSelection(){const e=this.range;if(!e)return void this.focusInput();const t=document.getSelection();t.removeAllRanges(),t.addRange(e),this.newMessageRef.current.focus()}closeEditMediaDialog(){this.setState({openEditMedia:!1},()=>{this.restoreSelection()})}render(){const e=this.props.t,t=this.state,a=t.chatId,n=t.editMessageId,s=t.newFile,i=t.newMedia,o=t.replyToMessageId,c=t.files,l=(t.newDraft,t.defaultText),d=t.defaultUrl,h=t.openEditUrl,u=t.openEditMedia,p=n>0&&!Object(vt.K)(a,n);return r.a.createElement("div",{className:"inputbox-background"},r.a.createElement("div",{className:"inputbox"},r.a.createElement("div",{className:"inputbox-bubble"},r.a.createElement(Ri,{chatId:a,messageId:o,editMessageId:u?0:n,onClick:this.handleHeaderClick}),r.a.createElement("div",{className:"inputbox-wrapper"},r.a.createElement("div",{className:"inputbox-left-column"},r.a.createElement(r.a.Suspense,{fallback:r.a.createElement(C.a,{className:"inputbox-icon-button","aria-label":"Emoticon"},r.a.createElement(si.a,null))},r.a.createElement(qi,{onSelect:this.handleEmojiSelect}))),r.a.createElement("div",{className:"inputbox-middle-column"},r.a.createElement("div",{id:"inputbox-message",ref:this.newMessageRef,placeholder:e(p?"Caption":"Message"),contentEditable:!0,suppressContentEditableWarning:!0,onKeyDown:this.handleKeyDown,onPaste:this.handlePaste,onInput:this.handleInput})),r.a.createElement("div",{className:"inputbox-right-column"},r.a.createElement("input",{ref:this.attachDocumentRef,className:"inputbox-attach-button",type:"file",multiple:"multiple",onChange:this.handleAttachDocumentComplete}),r.a.createElement("input",{ref:this.attachPhotoRef,className:"inputbox-attach-button",type:"file",multiple:"multiple",accept:"image/*",onChange:this.handleAttachPhotoComplete}),!Boolean(n)&&r.a.createElement(di,{chatId:a,onAttachPhoto:this.handleAttachPhoto,onAttachDocument:this.handleAttachDocument,onAttachPoll:this.handleAttachPoll})))),r.a.createElement("div",{className:"inputbox-send-button-background"},r.a.createElement(C.a,{className:"inputbox-send-button","aria-label":"Send",size:"small",onClick:this.handleSubmit},n?r.a.createElement(ni,null):r.a.createElement(ii,null)))),!Object(w.T)(a)&&r.a.createElement(xi,{onSend:this.handleSendPoll}),r.a.createElement(Ai,{files:c,onConfirm:this.handlePasteConfirm,onCancel:this.handlePasteCancel}),r.a.createElement(Li,{open:h,defaultText:l,defaultUrl:d,onDone:this.handleDoneEditUrl,onCancel:this.handleCancelEditUrl}),r.a.createElement(Wi,{open:u,chatId:a,messageId:n,newFile:s,newMedia:i,onEdit:this.handleEditMedia,onSend:this.handleSendMedia,onCancel:this.handleCancelEditMedia}))}}var Yi=Object(f.d)()(Ki),Ji=a(141),Qi=a.n(Ji);a(494);class Xi extends r.a.Component{render(){const e=this.props,t=e.command,a=e.onCommand;return r.a.createElement("div",{className:"footer-command-wrapper"},r.a.createElement("div",{className:"footer-command-actions"},r.a.createElement(Qi.a,{color:"primary",className:"footer-command-button",onClick:a},t)))}}var $i=Xi;var eo=Object(f.d)()(class extends Je{render(){const e=this.props.t,t=e(this.state.isMuted?"ChatsUnmute":"ChatsMute");return r.a.createElement($i,{command:t,onCommand:this.handleSetChatNotifications})}});a(495);class to extends r.a.Component{constructor(...e){super(...e),this.onUpdateBasicGroup=e=>{const t=this.props.chatId;Object(w.F)(t,e.basic_group.id)&&this.forceUpdate()},this.onUpdateSupergroup=e=>{const t=this.props.chatId;Object(w.G)(t,e.supergroup.id)&&this.forceUpdate()},this.handleJoin=()=>{const e=this.props.chatId;e&&K.a.send({"@type":"joinChat",chat_id:e})},this.handleDeleteAndExit=()=>{const e=this.props.chatId;e&&K.a.send({"@type":"deleteChatHistory",chat_id:e,remove_from_chat_list:!0})}}shouldComponentUpdate(e,t){const a=this.props,n=a.t,s=a.chatId;return e.chatId!==s||e.t!==n}componentDidMount(){Me.a.on("updateBasicGroup",this.onUpdateBasicGroup),Ie.a.on("updateSupergroup",this.onUpdateSupergroup)}componentWillUnmount(){Me.a.off("updateBasicGroup",this.onUpdateBasicGroup),Ie.a.off("updateSupergroup",this.onUpdateSupergroup)}render(){const e=this.props,t=e.chatId,a=e.t,n=L.a.get(t);if(!n)return null;const s=n.type;if(!s)return null;switch(s["@type"]){case"chatTypeBasicGroup":{const e=Me.a.get(s.basic_group_id);if(!e)return null;const t=e.status;if(!t)return null;const n=t.is_member,i=t.permissions;switch(t["@type"]){case"chatMemberStatusAdministrator":return r.a.createElement(Yi,null);case"chatMemberStatusBanned":return r.a.createElement($i,{command:a("DeleteChat"),onCommand:this.handleDeleteAndExit});case"chatMemberStatusCreator":return n?r.a.createElement(Yi,null):null;case"chatMemberStatusLeft":return null;case"chatMemberStatusMember":return r.a.createElement(Yi,null);case"chatMemberStatusRestricted":return n?i&&i.can_send_messages?r.a.createElement(Yi,null):null:r.a.createElement($i,{command:a("JoinGroup"),onCommand:this.handleJoin})}break}case"chatTypePrivate":case"chatTypeSecret":return r.a.createElement(Yi,null);case"chatTypeSupergroup":{const e=Ie.a.get(s.supergroup_id);if(!e)return null;const n=e.is_channel,i=e.status;if(!i)return null;const o=i.is_member,c=i.permissions;switch(i["@type"]){case"chatMemberStatusAdministrator":return r.a.createElement(Yi,null);case"chatMemberStatusBanned":return r.a.createElement($i,{command:a("DeleteChat"),onCommand:this.handleDeleteAndExit});case"chatMemberStatusCreator":return o?r.a.createElement(Yi,null):null;case"chatMemberStatusLeft":return r.a.createElement($i,{command:a(n?"ChannelJoin":"JoinGroup"),onCommand:this.handleJoin});case"chatMemberStatusMember":return n?r.a.createElement(eo,{chatId:t}):r.a.createElement(Yi,null);case"chatMemberStatusRestricted":return o?c&&c.can_send_messages?r.a.createElement(Yi,null):null:r.a.createElement($i,{command:a(n?"ChannelJoin":"JoinGroup"),onCommand:this.handleJoin})}}}return null}}var ao=Object(f.d)()(to),no=a(125),so=a(565);a(496);class io extends r.a.Component{constructor(e){super(e),this.handleTimer=()=>{const e=new Date,t=this.expire-e,a=100-t/this.props.timeout*100;this.setState({seconds:t>0?t:0,value:a>100?100:a}),e>=this.expire&&this.timerId&&(clearInterval(this.timerId),this.timerId=null)},this.state={seconds:this.props.timeout/1e3,value:0}}componentDidMount(){this.startTime=new Date,this.expire=this.startTime,this.expire.setMilliseconds(this.expire.getMilliseconds()+this.props.timeout),this.timerId=setInterval(this.handleTimer,100)}componentWillUnmount(){this.timerId&&(clearInterval(this.timerId),this.timerId=null)}render(){const e=this.state,t=e.value,a=e.seconds;return r.a.createElement("div",{className:"notification-timer"},r.a.createElement("div",{className:"notification-timer-text"},r.a.createElement(ui.a,{color:"inherit"},(a/1e3).toFixed())),r.a.createElement("div",{className:"notification-timer-progress"},r.a.createElement(so.a,{size:32,value:100-t,variant:"static"})))}}var oo=io;a(497);class ro extends r.a.Component{constructor(...e){super(...e),this.getDeleteDialogText=(e,t)=>{const a=L.a.get(e);if(!a)return null;if(!a.type)return null;switch(a.type["@type"]){case"chatTypeBasicGroup":return"Are you sure you want to leave group ".concat(a.title,"?");case"chatTypeSupergroup":{const e=Ie.a.get(a.type.supergroup_id);return e?e.is_channel?"Are you sure you want to leave channel ".concat(a.title,"?"):"Are you sure you want to leave group ".concat(a.title,"?"):null}case"chatTypePrivate":case"chatTypeSecret":return"Are you sure you want to delete chat with ".concat(Object(w.p)(e,!1,t),"?")}return null}}render(){const e=this.props,t=e.onClose,a=e.chatId,n=e.t,s=Object(no.a)(e,["onClose","chatId","t"]);return r.a.createElement(y.a,Object.assign({transitionDuration:0,onClose:()=>t(!1),"aria-labelledby":"delete-dialog-title"},s),r.a.createElement(E.a,{id:"delete-dialog-title"},Object(w.p)(a,!1,n)),r.a.createElement(On.a,null,r.a.createElement("div",{className:"delete-dialog-content"},r.a.createElement(D,{chatId:a}),r.a.createElement(Tn.a,{id:"delete-dialog-description"},this.getDeleteDialogText(a,n)))),r.a.createElement(v.a,null,r.a.createElement(b.a,{onClick:()=>t(!1),color:"primary"},"Cancel"),r.a.createElement(b.a,{onClick:()=>t(!0),color:"primary",autoFocus:!0},"Ok")))}}const co=Object(f.d)()(ro);class lo extends r.a.Component{render(){const e=this.props,t=e.onClose,a=e.chatId,n=e.t,s=Object(no.a)(e,["onClose","chatId","t"]);return r.a.createElement(y.a,Object.assign({transitionDuration:0,onClose:()=>t(!1),"aria-labelledby":"delete-dialog-title"},s),r.a.createElement(E.a,{id:"delete-dialog-title"},Object(w.p)(a,!1,n)),r.a.createElement(On.a,null,r.a.createElement("div",{className:"delete-dialog-content"},r.a.createElement(D,{chatId:a}),r.a.createElement(Tn.a,{id:"delete-dialog-description"},"Are you sure you want clear history?"))),r.a.createElement(v.a,null,r.a.createElement(b.a,{onClick:()=>t(!1),color:"primary"},"Cancel"),r.a.createElement(b.a,{onClick:()=>t(!0),color:"primary",autoFocus:!0},"Ok")))}}const ho=Object(f.d)()(lo);class uo extends r.a.Component{constructor(e){super(e),this.handleButtonClick=e=>{this.setState({anchorEl:e.currentTarget})},this.handleMenuClose=()=>{this.setState({anchorEl:null})},this.handleChatInfo=()=>{this.handleMenuClose(),setTimeout(()=>this.props.openChatDetails(),150)},this.handleClearHistory=()=>{this.handleMenuClose(),this.setState({openClearHistory:!0})},this.handleClearHistoryContinue=e=>{if(this.setState({openClearHistory:!1}),!e)return;const t=Z.a.getChatId(),a={"@type":"deleteChatHistory",chat_id:t,remove_from_chat_list:!1};this.handleScheduledAction(t,"clientUpdateClearHistory","Messages deleted",a)},this.handleLeave=()=>{this.handleMenuClose(),this.setState({openDelete:!0})},this.handleLeaveContinue=e=>{if(this.setState({openDelete:!1}),!e)return;const t=Z.a.getChatId(),a=this.getLeaveChatNotification(t),n=Object(w.T)(t)?{"@type":"deleteChatHistory",chat_id:t,remove_from_chat_list:!0}:{"@type":"leaveChat",chat_id:t};this.handleScheduledAction(t,"clientUpdateLeaveChat",a,n)},this.handleScheduledAction=(e,t,a,n)=>{const o=this.props.t;if(!t)return;const c="".concat(t," chatId=").concat(e),l=function(){var a=Object(i.a)(s.a.mark((function a(){return s.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,K.a.send(n);case 3:return a.prev=3,K.a.clientUpdate({"@type":t,chatId:e,inProgress:!1}),a.finish(3);case 6:case"end":return a.stop()}}),a,null,[[0,,3,6]])})));return function(){return a.apply(this,arguments)}}(),d=this.props.enqueueSnackbar;if(!d)return;Z.a.addScheduledAction(c,p.y,l,()=>{K.a.clientUpdate({"@type":t,chatId:e,inProgress:!1})})&&(K.a.clientUpdate({"@type":t,chatId:e,inProgress:!0}),d(a,{autoHideDuration:p.y-300,action:[r.a.createElement(C.a,{key:"progress",color:"inherit",className:"progress-button"},r.a.createElement(oo,{timeout:p.y})),r.a.createElement(b.a,{key:"undo",color:"primary",size:"small",onClick:()=>Z.a.removeScheduledAction(c)},o("Undo"))]}))},this.getLeaveChatTitle=(e,t)=>{const a=L.a.get(e);if(!a)return null;if(!a.type)return null;switch(a.type["@type"]){case"chatTypeBasicGroup":return t("DeleteChat");case"chatTypeSupergroup":{const e=Ie.a.get(a.type.supergroup_id);return e?e.is_channel?t("LeaveChannel"):t("LeaveMegaMenu"):null}case"chatTypePrivate":case"chatTypeSecret":return t("DeleteChatUser")}return null},this.getLeaveChatNotification=e=>{const t=this.props.t,a=L.a.get(e);if(!a)return t("ChatDeletedUndo");if(!a.type)return t("ChatDeletedUndo");switch(a.type["@type"]){case"chatTypeBasicGroup":return t("ChatDeletedUndo");case"chatTypeSupergroup":{const e=Ie.a.get(a.type.supergroup_id);return e?e.is_channel?"Left channel":"Left group":t("ChatDeletedUndo")}case"chatTypePrivate":case"chatTypeSecret":return t("ChatDeletedUndo")}return t("ChatDeletedUndo")},this.handleUnpin=()=>{this.handleMenuClose();const e=Z.a.getChatId();K.a.clientUpdate({"@type":"clientUpdateUnpin",chatId:e})},this.state={anchorEl:null,openDelete:!1,openClearHistory:!1}}render(){const e=this.props.t,t=this.state,a=t.anchorEl,n=t.openDelete,s=t.openClearHistory,i=Z.a.getChatId(),o=Object(w.a)(i),c=Object(w.b)(i),l=this.getLeaveChatTitle(i,e),d=Object(w.h)(i);return r.a.createElement(r.a.Fragment,null,r.a.createElement(C.a,{"aria-owns":a?"simple-menu":null,"aria-haspopup":"true",className:"main-menu-button","aria-label":"Menu",onClick:this.handleButtonClick},r.a.createElement(xn,null)),r.a.createElement(mn.a,{id:"main-menu",anchorEl:a,open:Boolean(a),onClose:this.handleMenuClose,getContentAnchorEl:null,disableAutoFocusItem:!0,disableRestoreFocus:!0,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"}},r.a.createElement(ft.a,{onClick:this.handleChatInfo},e("ChatInfo")),o&&r.a.createElement(ft.a,{onClick:this.handleClearHistory},e("ClearHistory")),c&&l&&r.a.createElement(ft.a,{onClick:this.handleLeave},l),d&&r.a.createElement(ft.a,{onClick:this.handleUnpin},e("Unpin"))),r.a.createElement(co,{chatId:i,open:n,onClose:this.handleLeaveContinue}),r.a.createElement(ho,{chatId:i,open:s,onClose:this.handleClearHistoryContinue}))}}var po=Object(d.a)(u.withSnackbar,Object(f.d)())(uo);a(498);class mo extends r.a.Component{constructor(...e){super(...e),this.onUpdateChatOnlineMemberCount=e=>{this.props.chatId===e.chat_id&&this.forceUpdate()},this.onUpdateChatTitle=e=>{this.props.chatId===e.chat_id&&this.forceUpdate()},this.onUpdateUserChatAction=e=>{this.props.chatId===e.chat_id&&this.forceUpdate()},this.onUpdateUserStatus=e=>{const t=this.props.chatId,a=L.a.get(t);if(a&&a.type)switch(a.type["@type"]){case"chatTypeBasicGroup":{const t=Me.a.getFullInfo(a.type.basic_group_id);if(t&&t.members){t.members.find(t=>t.user_id===e.user_id)&&this.forceUpdate()}break}case"chatTypePrivate":case"chatTypeSecret":a.type.user_id===e.user_id&&this.forceUpdate()}},this.onUpdateUserFullInfo=e=>{const t=this.props.chatId,a=L.a.get(t);a&&a.type&&("chatTypePrivate"!==a.type["@type"]&&"chatTypeSecret"!==a.type["@type"]||a.type.user_id!==e.user_id||this.forceUpdate())},this.onUpdateBasicGroupFullInfo=e=>{const t=this.props.chatId,a=L.a.get(t);a&&a.type&&"chatTypeBasicGroup"===a.type["@type"]&&a.type.basic_group_id===e.basic_group_id&&this.forceUpdate()},this.onUpdateSupergroupFullInfo=e=>{const t=this.props.chatId,a=L.a.get(t);a&&a.type&&"chatTypeSupergroup"===a.type["@type"]&&a.type.supergroup_id===e.supergroup_id&&this.forceUpdate()},this.onUpdateBasicGroup=e=>{const t=this.props.chatId,a=L.a.get(t);a&&a.type&&"chatTypeBasicGroup"===a.type["@type"]&&a.type.basic_group_id===e.basic_group.id&&this.forceUpdate()},this.onUpdateSupergroup=e=>{const t=this.props.chatId,a=L.a.get(t);a&&a.type&&"chatTypeSupergroup"===a.type["@type"]&&a.type.supergroup_id===e.supergroup.id&&this.forceUpdate()}}componentDidMount(){L.a.on("updateChatOnlineMemberCount",this.onUpdateChatOnlineMemberCount),L.a.on("updateChatTitle",this.onUpdateChatTitle),_.a.on("updateUserStatus",this.onUpdateUserStatus),L.a.on("updateUserChatAction",this.onUpdateUserChatAction),_.a.on("updateUserFullInfo",this.onUpdateUserFullInfo),Me.a.on("updateBasicGroupFullInfo",this.onUpdateBasicGroupFullInfo),Ie.a.on("updateSupergroupFullInfo",this.onUpdateSupergroupFullInfo),Me.a.on("updateBasicGroup",this.onUpdateBasicGroup),Ie.a.on("updateSupergroup",this.onUpdateSupergroup)}componentWillUnmount(){L.a.off("updateChatOnlineMemberCount",this.onUpdateChatOnlineMemberCount),L.a.off("updateChatTitle",this.onUpdateChatTitle),_.a.off("updateUserStatus",this.onUpdateUserStatus),L.a.off("updateUserChatAction",this.onUpdateUserChatAction),_.a.off("updateUserFullInfo",this.onUpdateUserFullInfo),Me.a.off("updateBasicGroupFullInfo",this.onUpdateBasicGroupFullInfo),Ie.a.off("updateSupergroupFullInfo",this.onUpdateSupergroupFullInfo),Me.a.off("updateBasicGroup",this.onUpdateBasicGroup),Ie.a.off("updateSupergroup",this.onUpdateSupergroup)}render(){const e=this.props.chatId,t=Object(w.q)(e,!0),a=Object(w.H)(e);return r.a.createElement("div",{className:l()("header-chat-subtitle",{"header-chat-subtitle-accent":a})},t)}}var go=mo;a(499);class fo extends r.a.Component{render(){const e=this.props,t=e.className,a=e.chatId,n=e.onClick;return r.a.createElement("div",{className:l()("header-chat",t),onClick:n},r.a.createElement(D,{chatId:a,size:44}),r.a.createElement("div",{className:"header-chat-content"},r.a.createElement(ke,{chatId:a}),r.a.createElement(go,{chatId:a})))}}var bo=fo;a(500);class Co extends r.a.Component{constructor(...e){super(...e),this.handleCancel=()=>{Object(G.a)()},this.handleDelete=()=>{let e=0,t=[];var a,n=Object(qs.a)(q.a.selectedItems.values());try{for(n.s();!(a=n.n()).done;){let n=a.value,s=n.chatId,i=n.messageId;e=s,t.push(i)}}catch(s){n.e(s)}finally{n.f()}Object(G.c)(e,t)},this.handleForward=()=>{let e;const t=[];var a,n=Object(qs.a)(q.a.selectedItems.values());try{for(n.s();!(a=n.n()).done;){let n=a.value,s=n.chatId,i=n.messageId;e=s,t.push(i)}}catch(s){n.e(s)}finally{n.f()}Object(G.e)(e,t)}}render(){const e=this.props,t=e.t,a=e.count;let n=!0;var s,i=Object(qs.a)(q.a.selectedItems.values());try{for(i.s();!(s=i.n()).done;){let e=s.value,t=e.chatId,a=e.messageId;const i=q.a.get(t,a);if(!i){n=!1;break}if(!i.can_be_deleted_only_for_self&&!i.can_be_deleted_for_all_users){n=!1;break}}}catch(d){i.e(d)}finally{i.f()}let o=!0;var c,l=Object(qs.a)(q.a.selectedItems.values());try{for(l.s();!(c=l.n()).done;){let e=c.value,t=e.chatId,a=e.messageId;const n=q.a.get(t,a);if(!n){o=!1;break}if(!n.can_be_forwarded){o=!1;break}}}catch(d){l.e(d)}finally{l.f()}return r.a.createElement("div",{className:"header-command"},o&&r.a.createElement(b.a,{color:"primary",className:"header-command-button",onClick:this.handleForward},a<=1?t("Forward"):"".concat(t("Forward")," ").concat(a)),n&&r.a.createElement(b.a,{color:"primary",className:"header-command-button",onClick:this.handleDelete},a<=1?t("Delete"):"".concat(t("Delete")," ").concat(a)),r.a.createElement("div",{className:"header-command-space"}),r.a.createElement(b.a,{color:"primary",className:"header-command-button",onClick:this.handleCancel},t("Cancel")))}}var yo=Object(f.d)()(Co),vo=a(67);a(501);class Eo extends r.a.Component{constructor(e){var t;super(e),t=this,this.onClientUpdateUnpin=e=>{const t=e.chatId;this.props.chatId===t&&this.handleDelete()},this.onClientUpdateDialogsReady=e=>{this.state.messageId&&this.loadContent()},this.onClientUpdateSetChatClientData=e=>{const t=e.chatId,a=e.clientData;this.props.chatId===t&&this.setState({clientData:a})},this.onUpdateChatPinnedMessage=e=>{const t=e.chat_id,a=e.pinned_message_id;this.props.chatId===t&&this.setState({messageId:a})},this.loadContent=()=>{const e=this.props.chatId,t=this.state.messageId;e&&t&&(q.a.get(e,t)||K.a.send({"@type":"getMessage",chat_id:e,message_id:t}).then(e=>{q.a.set(e);const t=P.a.getStore();Object(T.v)(t,[e]),this.forceUpdate()}).catch(a=>{a.code;if("Chat not found"!==a.message){const a={"@type":"deletedMessage",chat_id:e,id:t,content:null};q.a.set(a),this.forceUpdate()}}))},this.handleClick=e=>{const t=this.props.chatId,a=this.state.messageId;a&&Object(G.h)(t,a)},this.handleDelete=function(){var e=Object(i.a)(s.a.mark((function e(a){var n,i,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a&&(a.preventDefault(),a.stopPropagation()),n=t.props.chatId,i=t.state.messageId,!Object(w.c)(n)){e.next=8;break}t.setState({confirm:!0}),e.next=11;break;case 8:return o=L.a.getClientData(n),e.next=11,K.a.clientUpdate({"@type":"clientUpdateSetChatClientData",chatId:n,clientData:Object.assign({},o,{unpinned_message_id:i})});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleUnpin=Object(i.a)(s.a.mark((function e(){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.props.chatId,t.handleClose(),K.a.send({"@type":"unpinChatMessage",chat_id:a});case 3:case"end":return e.stop()}}),e)}))),this.handleClose=()=>{this.setState({confirm:!1})},this.state={}}static getDerivedStateFromProps(e,t){const a=t.prevPropsChatId,n=e.chatId;if(a!==n){const e=L.a.get(n);return{prevPropsChatId:n,clientData:L.a.getClientData(n),messageId:e&&e.pinned_message_id?e.pinned_message_id:0,confirm:!1}}return null}componentDidUpdate(e,t,a){const n=this.state.messageId;n&&t.messageId!==n&&this.loadContent()}componentDidMount(){this.loadContent(),Z.a.on("clientUpdateDialogsReady",this.onClientUpdateDialogsReady),L.a.on("clientUpdateSetChatClientData",this.onClientUpdateSetChatClientData),L.a.on("clientUpdateUnpin",this.onClientUpdateUnpin),L.a.on("updateChatPinnedMessage",this.onUpdateChatPinnedMessage)}componentWillUnmount(){Z.a.off("clientUpdateDialogsReady",this.onClientUpdateDialogsReady),L.a.off("clientUpdateSetChatClientData",this.onClientUpdateSetChatClientData),L.a.off("clientUpdateUnpin",this.onClientUpdateUnpin),L.a.off("updateChatPinnedMessage",this.onUpdateChatPinnedMessage)}shouldComponentUpdate(e,t,a){const n=this.props,s=n.chatId,i=n.t,o=n.theme,r=this.state,c=r.clientData,l=r.confirm,d=r.messageId;return e.t!==i||(e.theme!==o||(e.chatId!==s||(t.clientData!==c||(t.confirm!==l||t.messageId!==d))))}render(){const e=this.props,t=e.chatId,a=e.t,n=this.state,s=n.messageId,i=n.confirm;if(!t)return null;if(L.a.getClientData(t).unpinned_message_id===s)return null;const o=q.a.get(t,s);if(!o)return null;let c=o?Object(vt.h)(o,a):a("Loading");const l=Object(vt.t)(t,s),d=Object(vt.s)(t,s);return Object(vt.D)(o)&&(c=a("DeletedMessage")),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"pinned-message",onMouseDown:this.handleClick},r.a.createElement("div",{className:"border reply-border"}),l&&r.a.createElement(Ni,{chatId:t,messageId:s,photoSize:l,minithumbnail:d}),r.a.createElement("div",{className:"pinned-message-content"},r.a.createElement("div",{className:"pinned-message-title"},a("PinnedMessage")),r.a.createElement("div",{className:"pinned-message-subtitle"},c))),i&&r.a.createElement(y.a,{transitionDuration:0,open:!0,onClose:this.handleClose,"aria-labelledby":"unpin-message-confirmation"},r.a.createElement(E.a,{id:"unpin-message-confirmation"},a("Confirm")),r.a.createElement(On.a,null,r.a.createElement(Tn.a,null,a("UnpinMessageAlert"))),r.a.createElement(v.a,null,r.a.createElement(b.a,{onClick:this.handleClose,color:"primary"},a("Cancel")),r.a.createElement(b.a,{onClick:this.handleUnpin,color:"primary"},a("Ok")))))}}var Uo=Object(f.d)()(Eo);class So extends o.Component{constructor(e){super(e),this.onClientUpdateDeleteMessages=e=>{const t=e.chatId,a=e.messageIds;let n=!0;var s,i=Object(qs.a)(a);try{for(i.s();!(s=i.n()).done;){let e=s.value;const a=q.a.get(t,e);if(!a){n=!1;break}if(!a.can_be_deleted_for_all_users){n=!1;break}}}catch(o){i.e(o)}finally{i.f()}this.setState({openDeleteDialog:!0,chatId:t,messageIds:a,canBeDeletedForAllUsers:n,revoke:n})},this.handleRevokeChange=()=>{this.setState({revoke:!this.state.revoke})},this.handleCloseDelete=()=>{this.setState({openDeleteDialog:!1})},this.handleDeleteContinue=()=>{const e=this.state,t=e.revoke,a=e.chatId,n=e.messageIds;Object(G.a)(),this.handleCloseDelete(),K.a.send({"@type":"deleteMessages",chat_id:a,message_ids:n,revoke:t})},this.onClientUpdateMessageSelected=e=>{this.setState({selectionCount:q.a.selectedItems.size})},this.onClientUpdateChatId=e=>{this.forceUpdate()},this.onUpdateConnectionState=e=>{this.setState({connectionState:e.state})},this.onUpdateAuthorizationState=e=>{this.setState({authorizationState:e.authorization_state})},this.openChatDetails=()=>{const e=Z.a.getChatId();L.a.get(e)&&Z.a.changeChatDetailsVisibility(!0)},this.handleSearchChat=()=>{const e=Z.a.getChatId();L.a.get(e)&&Object(G.l)(e)},this.localize=e=>(0,this.props.t)(e).replace("...","").replace("\u2026",""),this.state={authorizationState:Z.a.getAuthorizationState(),connectionState:Z.a.getConnectionState(),openDeleteDialog:!1}}shouldComponentUpdate(e,t){return t!==this.state||(e.theme!==this.props.theme||e.t!==this.props.t)}componentDidMount(){Z.a.on("clientUpdateChatId",this.onClientUpdateChatId),Z.a.on("clientUpdateDeleteMessages",this.onClientUpdateDeleteMessages),Z.a.on("updateAuthorizationState",this.onUpdateAuthorizationState),Z.a.on("updateConnectionState",this.onUpdateConnectionState),q.a.on("clientUpdateClearSelection",this.onClientUpdateMessageSelected),q.a.on("clientUpdateMessageSelected",this.onClientUpdateMessageSelected)}componentWillUnmount(){Z.a.off("clientUpdateChatId",this.onClientUpdateChatId),Z.a.off("clientUpdateDeleteMessages",this.onClientUpdateDeleteMessages),Z.a.off("updateAuthorizationState",this.onUpdateAuthorizationState),Z.a.off("updateConnectionState",this.onUpdateConnectionState),q.a.off("clientUpdateClearSelection",this.onClientUpdateMessageSelected),q.a.off("clientUpdateMessageSelected",this.onClientUpdateMessageSelected)}render(){const e=this.props.t,t=this.state,a=t.authorizationState,n=t.connectionState,s=t.selectionCount,i=t.openDeleteDialog,o=t.canBeDeletedForAllUsers,c=t.revoke,d=t.messageIds,h=d?d.length:0;let u=null;s&&(u=r.a.createElement(yo,{count:s}));const p=Z.a.getChatId(),m=L.a.get(p),g=Object(w.H)(p);let f=Object(w.s)(p,!0,e),U=Object(w.q)(p,!0),S=!1;if(n)switch(n["@type"]){case"connectionStateConnecting":f=this.localize("Connecting"),U="",S=!0;break;case"connectionStateConnectingToProxy":f=this.localize("Connecting to proxy"),U="",S=!0;break;case"connectionStateReady":break;case"connectionStateUpdating":f=this.localize("Updating"),U="",S=!0;break;case"connectionStateWaitingForNetwork":f=this.localize("Waiting for network"),U="",S=!0}else if(a)switch(a["@type"]){case"authorizationStateClosed":case" authorizationStateClosing":break;case"authorizationStateLoggingOut":f=this.localize("Logging out"),U="",S=!0;break;case"authorizationStateReady":case"authorizationStateWaitCode":break;case"authorizationStateWaitEncryptionKey":f=this.localize("Loading"),U="",S=!0;break;case"authorizationStateWaitPassword":case"authorizationStateWaitPhoneNumber":break;case"authorizationStateWaitTdlibParameters":f=this.localize("Loading"),U="",S=!0}else f=this.localize("Loading"),U="",S=!0;return u=u||r.a.createElement("div",{className:"header-details"},S?r.a.createElement("div",{className:l()("header-status","grow",m?"cursor-pointer":"cursor-default"),onClick:this.openChatDetails},r.a.createElement("span",{className:"header-status-content"},f),r.a.createElement(vo.a,null),r.a.createElement("span",{className:l()("header-status-title",{"header-status-accent":g})},U),r.a.createElement("span",{className:"header-status-tail"})):r.a.createElement(bo,{className:l()("grow","cursor-pointer"),chatId:p,onClick:this.openChatDetails}),r.a.createElement(Uo,{chatId:p}),m&&r.a.createElement(r.a.Fragment,null,r.a.createElement(C.a,{className:"header-right-second-button","aria-label":"Search",onClick:this.handleSearchChat},r.a.createElement(kt,null)),r.a.createElement(po,{openChatDetails:this.openChatDetails}))),r.a.createElement(r.a.Fragment,null,u,r.a.createElement(y.a,{transitionDuration:0,open:i,onClose:this.handleCloseDelete,"aria-labelledby":"delete-dialog-title"},r.a.createElement(E.a,{id:"delete-dialog-title"},"Confirm"),r.a.createElement(On.a,null,r.a.createElement(Tn.a,null,1===h?"Do you want to delete this message?":"Do you want to delete ".concat(h," messages?")),Object(w.U)(p)?r.a.createElement(Tn.a,null,!Object(w.J)(p)&&(1===h?"This will delete it for everyone in this chat":"This will delete them for everyone in this chat")):r.a.createElement(r.a.Fragment,null,o&&r.a.createElement(An.a,{control:r.a.createElement(ys.a,{checked:c,onChange:this.handleRevokeChange,color:"primary"}),label:Object(w.T)(p)?"Delete for ".concat(Object(w.p)(p,!1,e)):"Delete for all"}))),r.a.createElement(v.a,null,r.a.createElement(b.a,{onClick:this.handleCloseDelete,color:"primary"},e("Cancel")),r.a.createElement(b.a,{onClick:this.handleDeleteContinue,color:"primary"},e("Ok")))))}}var ko=Object(f.d)()(So),Mo=a(313),Io=a(319),wo=a(512),_o=a.n(wo),xo=a(511),Oo=a.n(xo),To=a(503),Lo=a.n(To),Po=a(504),No=a.n(Po),Do=a(505),jo=a.n(Do),Bo=a(342),Ro=a.n(Bo),Fo=a(584),Ao=a(287);a(502);class Vo extends r.a.Component{constructor(...e){super(...e),this.state={anchorEl:null,value:Ao.b.volume,prevValue:Ao.b.volume,dragging:!1,buttonOver:!1,popupOver:!1},this.onClientUpdateMediaVolume=e=>{const t=e.volume,a=e.prevVolume;void 0===a?this.setState({value:t}):this.setState({value:t,prevValue:a})},this.handlePopoverOpen=e=>{this.setState({anchorEl:e})},this.handlePopoverClose=()=>{const e=this.state,t=e.dragging,a=e.buttonOver,n=e.popupOver;t||a||n||this.setState({anchorEl:null})},this.handleMouseEnter=(e,t)=>{this.setState({buttonOver:!0}),t&&this.handlePopoverOpen(e.currentTarget)},this.handleMouseLeave=()=>{this.setState({buttonOver:!1},()=>{this.handlePopoverClose()})},this.handlePopupMouseLeave=()=>{this.setState({popupOver:!1},()=>{this.handlePopoverClose()})},this.handleVoiceClick=()=>{const e=this.state,t=e.value,a=e.prevValue,n=t>0?0:a||p.L;K.a.clientUpdate({"@type":"clientUpdateMediaVolume",volume:n})},this.handleChange=(e,t)=>{const a=this.state,n=a.dragging,s=a.prevValue;n?K.a.clientUpdate({"@type":"clientUpdateMediaVolume",volume:t}):K.a.clientUpdate({"@type":"clientUpdateMediaVolume",prevVolume:t>0?t:s,volume:t})},this.handleDragStart=()=>{const e=this.state.value;this.setState({dragging:!0,prevValue:e})},this.handleDragEnd=()=>{const e=this.state,t=e.value,a=e.prevValue;this.setState({dragging:!1,prevValue:t>0?t:a},()=>{this.handlePopoverClose()})},this.getVolumeIcon=e=>0===e?r.a.createElement(Ro.a,{fontSize:"small"}):e<.25?r.a.createElement(Lo.a,{fontSize:"small"}):e<.5?r.a.createElement(No.a,{fontSize:"small"}):r.a.createElement(jo.a,{fontSize:"small"})}componentDidMount(){Ao.b.on("clientUpdateMediaVolume",this.onClientUpdateMediaVolume)}componentWillUnmount(){Ao.b.off("clientUpdateMediaVolume",this.onClientUpdateMediaVolume)}render(){const e=this.state,t=e.anchorEl,a=e.value,n=Boolean(t);return r.a.createElement("div",{onMouseEnter:e=>this.handleMouseEnter(e,!0),onMouseLeave:this.handleMouseLeave,style:{position:"relative",background:"transparent"}},r.a.createElement(C.a,{className:"header-player-button",color:"primary",onClick:this.handleVoiceClick},this.getVolumeIcon(a)),r.a.createElement("div",{style:{position:"absolute",background:"transparent",visibility:n?"visible":"hidden",zIndex:1},onMouseEnter:e=>this.handleMouseEnter(e,!1),onMouseLeave:this.handlePopupMouseLeave},r.a.createElement("div",{className:"volume-button-panel"},r.a.createElement(Fo.a,{min:0,max:1,step:.01,value:a,onChange:this.handleChange,onDragStart:this.handleDragStart,onDragEnd:this.handleDragEnd,orientation:"vertical"}))))}}var zo=Vo,Ho=a(506),Wo=a.n(Ho),Go=a(507),Zo=a.n(Go);class qo extends r.a.Component{constructor(e){super(e),this.onClientUpdateMediaRepeat=e=>{const t=e.repeat;this.setState({repeat:t})},this.handleRepeat=()=>{const e=this.state.repeat;let t=e;switch(e){case Ao.a.NONE:t=Ao.a.REPEAT;break;case Ao.a.REPEAT:t=Ao.a.REPEAT_ONE;break;case Ao.a.REPEAT_ONE:t=Ao.a.NONE}K.a.clientUpdate({"@type":"clientUpdateMediaRepeat",repeat:t})},this.getIcon=e=>{switch(e){case Ao.a.NONE:case Ao.a.REPEAT:return r.a.createElement(Wo.a,{fontSize:"small"});case Ao.a.REPEAT_ONE:return r.a.createElement(Zo.a,{fontSize:"small"});default:return r.a.createElement(Wo.a,{fontSize:"small"})}};const t=Ao.b.repeat;this.state={repeat:t}}componentDidMount(){Ao.b.on("clientUpdateMediaRepeat",this.onClientUpdateMediaRepeat)}componentWillUnmount(){Ao.b.off("clientUpdateMediaRepeat",this.onClientUpdateMediaRepeat)}render(){const e=this.state.repeat;return r.a.createElement(C.a,{className:"header-player-button",color:e===Ao.a.NONE?"default":"primary",onClick:this.handleRepeat},this.getIcon(e))}}var Ko=qo,Yo=a(508),Jo=a.n(Yo);class Qo extends r.a.Component{constructor(e){super(e),this.onClientUpdateMediaShuffle=e=>{const t=e.shuffle;this.setState({shuffle:t})},this.handleShuffle=()=>{const e=this.state.shuffle;K.a.clientUpdate({"@type":"clientUpdateMediaShuffle",shuffle:!e})};const t=Ao.b.shuffle;this.state={shuffle:t}}componentDidMount(){Ao.b.on("clientUpdateMediaShuffle",this.onClientUpdateMediaShuffle)}componentWillUnmount(){Ao.b.off("clientUpdateMediaShuffle",this.onClientUpdateMediaShuffle)}render(){const e=this.state.shuffle;return r.a.createElement(C.a,{className:"header-player-button",color:e?"primary":"default",onClick:this.handleShuffle},r.a.createElement(Jo.a,{fontSize:"small"}))}}var Xo=Qo;class $o extends r.a.Component{constructor(e){super(e),this.onClientUpdateMediaPlaybackRate=e=>{const t=e.playbackRate;this.setState({playbackRate:t})},this.handlePlaybackRate=()=>{const e=this.state.playbackRate===p.I?p.H:p.I;K.a.clientUpdate({"@type":"clientUpdateMediaPlaybackRate",playbackRate:e})};const t=Ao.b.playbackRate;this.state={playbackRate:t}}componentDidMount(){Ao.b.on("clientUpdateMediaPlaybackRate",this.onClientUpdateMediaPlaybackRate)}componentWillUnmount(){Ao.b.off("clientUpdateMediaPlaybackRate",this.onClientUpdateMediaPlaybackRate)}render(){const e=this.state.playbackRate;return r.a.createElement(C.a,{className:"header-player-button",color:e>p.I?"primary":"default",onClick:this.handlePlaybackRate},r.a.createElement("div",{className:"header-player-playback-icon"},"2X"))}}var er=$o;class tr extends r.a.Component{constructor(e){super(e),this.onClientUpdateMediaTime=e=>{const t=e.currentTime;this.setState({currentTime:t,currentTimeString:Object(Ae.e)(Math.floor(t||0))})},this.getTimeString=(e,t)=>{Object(Ae.e)(Math.floor(t||0));return Object(Ae.e)(Math.floor(e||0))},this.state={currentTime:0,duration:0,timeString:this.getTimeString(0,0)}}componentDidMount(){Ao.b.on("clientUpdateMediaTime",this.onClientUpdateMediaTime)}componentWillUnmount(){Ao.b.off("clientUpdateMediaTime",this.onClientUpdateMediaTime)}render(){const e=this.state.currentTimeString;return r.a.createElement(r.a.Fragment,null,e)}}var ar=tr,nr=a(16),sr=a.n(nr);a(509);class ir extends r.a.Component{constructor(e){super(e),this.scrollToActive=()=>{const e=this.listRef.current;if(!e)return;const t=this.messageId;if(!t)return;const a=this.itemRefMap.get(t);if(!a)return;const n=nr.findDOMNode(a);n&&(e.scrollTop=n.offsetTop-15)},this.onClientUpdateMediaTitleMouseOver=e=>{const t=e.over;t?this.setState({playlistMouseOver:t},()=>{this.tryOpen()}):this.setState({playlistMouseOver:t},()=>{this.tryClose()})},this.onClientUpdateMediaActive=e=>{const t=e.chatId,a=e.messageId;this.chatId=t,this.messageId=a},this.onClientUpdateMediaPlaylistLoading=e=>{const t=this.chatId,a=this.messageId;e.chatId===t&&e.messageId===a&&this.setState({playlist:null})},this.onClientUpdateMediaPlaylist=e=>{const t=this.chatId,a=this.messageId,n=e.playlist;t===n.chatId&&a===n.messageId&&this.setState({playlist:n})},this.tryOpen=()=>{clearTimeout(this.openTimeout),this.openTimeout=setTimeout(()=>{const e=this.state,t=e.titleMouseOver,a=e.playlistMouseOver;this.setState({open:t||a})},250)},this.tryClose=()=>{clearTimeout(this.timeout),this.timeout=setTimeout(()=>{const e=this.state,t=e.titleMouseOver,a=e.playlistMouseOver;this.setState({open:t||a})},250)},this.handleMouseEnter=()=>{this.setState({playlistMouseOver:!0,open:!0})},this.handleMouseLeave=()=>{this.setState({playlistMouseOver:!1},()=>{this.tryClose()})},this.handleScroll=()=>{const e=this.listRef.current;e&&(e.scrollTop<=p.gb?K.a.clientUpdate({"@type":"clientUpdateMediaPlaylistNext"}):e.scrollTop+e.offsetHeight>=e.scrollHeight-p.gb&&K.a.clientUpdate({"@type":"clientUpdateMediaPlaylistPrev"}))},this.listRef=r.a.createRef(),this.itemRefMap=new Map;const t=Ao.b.message,a=Ao.b.playlist;this.chatId=t?t.chat_id:0,this.messageId=t?t.id:0,this.state={open:!1,titleMouseOver:!1,playlistMouseOver:!1,playlist:a}}componentDidUpdate(e,t,a){const n=this.state.open;!t.open&&n&&this.scrollToActive()}componentDidMount(){Ao.b.on("clientUpdateMediaActive",this.onClientUpdateMediaActive),Ao.b.on("clientUpdateMediaPlaylist",this.onClientUpdateMediaPlaylist),Ao.b.on("clientUpdateMediaPlaylistLoading",this.onClientUpdateMediaPlaylistLoading),Ao.b.on("clientUpdateMediaTitleMouseOver",this.onClientUpdateMediaTitleMouseOver)}componentWillUnmount(){Ao.b.off("clientUpdateMediaActive",this.onClientUpdateMediaActive),Ao.b.off("clientUpdateMediaPlaylist",this.onClientUpdateMediaPlaylist),Ao.b.off("clientUpdateMediaPlaylistLoading",this.onClientUpdateMediaPlaylistLoading),Ao.b.off("clientUpdateMediaTitleMouseOver",this.onClientUpdateMediaTitleMouseOver)}render(){this.props.classes;const e=this.state,t=e.open,a=e.playlist;if(!t)return null;if(!a)return null;const n=a.messages;return n?n.length<=1?null:(this.itemRefMap.clear(),r.a.createElement("div",{className:"playlist"},r.a.createElement("div",{className:"playlist-wrapper"},r.a.createElement("div",{ref:this.listRef,className:"playlist-items",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onScroll:this.handleScroll},a.messages.slice(0).reverse().map(e=>r.a.createElement("div",{key:e.id,ref:t=>this.itemRefMap.set(e.id,t),className:"playlist-item"},Object(Et.f)(e,()=>Object(vt.N)(e.chat_id,e.id)))))))):null}}var or=ir;a(510);class rr extends r.a.Component{constructor(e){super(e),this.onClientUpdateMediaPlaybackRate=e=>{const t=e.playbackRate,a=this.videoRef.current;a&&(a.playbackRate=t)},this.onClientUpdateMediaVolume=e=>{const t=e.volume,a=this.videoRef.current;a&&(a.volume=t)},this.onClientUpdateMediaViewerContent=e=>{this.playingMediaViewer=Boolean(Z.a.mediaViewerContent)},this.onClientUpdateMediaViewerEnded=e=>{this.playingMediaViewer=!1},this.onClientUpdateMediaViewerPause=e=>{this.playingMediaViewer=!1},this.onClientUpdateMediaViewerPlay=e=>{this.playingMediaViewer=!0;const t=this.videoRef.current;t&&t.pause()},this.startPlayingFile=(e,t)=>{const a=t.chat_id,n=t.id;this.setState({src:this.getMediaSrc(t)},()=>{const e=this.videoRef.current;e&&this.playingMediaViewer&&(e.pause(),K.a.clientUpdate({"@type":"clientUpdateMediaPause",chatId:a,messageId:n}))})},this.onClientUpdateMediaBlob=e=>{const t=e.chatId,a=e.messageId,n=this.state.message;if(!n)return;const s=n.chat_id,i=n.id,o=n.content;if(o&&t===s&&a===i)switch(o["@type"]){case"messageText":{const e=o.web_page;if(e){const t=e.audio,a=e.voice_note,s=e.video_note;if(t){const e=t.audio;e&&this.startPlayingFile(e,n)}if(a){const e=a.voice;e&&this.startPlayingFile(e,n)}if(s){const e=s.video;e&&this.startPlayingFile(e,n)}}break}case"messageAudio":{const e=o.audio;if(e){const t=e.audio;t&&this.startPlayingFile(t,n)}break}case"messageVoiceNote":{const e=o.voice_note;if(e){const t=e.voice;t&&this.startPlayingFile(t,n)}break}case"messageVideoNote":{const e=o.video_note;if(e){const t=e.video;t&&this.startPlayingFile(t,n)}break}}},this.onClientUpdateMediaPlaylist=e=>{const t=e.playlist,a=t.chatId,n=t.messageId,s=this.state.message;s&&s.chat_id===a&&s.id===n&&this.setState({playlist:t})},this.onClientUpdateMediaClose=e=>{this.setState({message:null,playlist:null,playing:!1,src:null})},this.onClientUpdateMediaActive=e=>{const t=e.chatId,a=e.messageId,n=this.state,s=n.message,i=n.src;if(s&&s.chat_id===t&&s.id===a){if(i){const e=this.videoRef.current;e&&(e.paused?e.play():e.pause())}}else{const e=this.getMediaSrc(Ao.b.message),t=Boolean(e);Ao.b.playlist;this.setState({message:Ao.b.message,playlist:Ao.b.playlist,playing:t,src:e},()=>{const e=this.videoRef.current;e&&(e.currentTime=this.startTime,this.playingMediaViewer?e.pause():e.paused&&e.play())})}},this.handlePrev=()=>{K.a.clientUpdate({"@type":"clientUpdateMediaPrev"})},this.handlePlay=()=>{const e=this.state.message;e&&K.a.clientUpdate({"@type":"clientUpdateMediaActive",chatId:e.chat_id,messageId:e.id})},this.handleNext=()=>{K.a.clientUpdate({"@type":"clientUpdateMediaNext"})},this.getMediaSrc=e=>{if(e){const t=e.content;if(t){const e=t.audio,a=t.voice_note,n=t.video_note,s=t.web_page;if(e){const t=e.audio;if(t)return Object(T.j)(t)}if(a){const e=a.voice;if(e)return Object(T.j)(e)}if(n){const e=n.video;if(e)return Object(T.j)(e)}if(s){if(s.audio){const e=s.audio.audio;if(e)return Object(T.j)(e)}if(s.voice_note){const e=s.voice_note.voice;if(e)return Object(T.j)(e)}if(s.video_note){const e=s.video_note.video;if(e)return Object(T.j)(e)}}}}return""},this.handleEnded=(e=!0)=>{const t=this.state.message;t&&(K.a.clientUpdate({"@type":"clientUpdateMediaEnding",chatId:t.chat_id,messageId:t.id,moveNext:e}),this.setState({},()=>{K.a.clientUpdate({"@type":"clientUpdateMediaEnd",chatId:t.chat_id,messageId:t.id,moveNext:e})}))},this.handleVideoEnded=()=>{this.handleEnded(!0)},this.handleClose=()=>{const e=this.videoRef.current;e&&e.pause(),this.handleEnded(!1)},this.handleTimeUpdate=()=>{const e=this.state.message;if(!e)return;const t=this.videoRef.current;t&&(this.setState({currentTime:t.currentTime,currentTimeString:Object(Ae.e)(Math.floor(t.currentTime||0))}),K.a.clientUpdate({"@type":"clientUpdateMediaTime",chatId:e.chat_id,messageId:e.id,duration:t.duration,currentTime:t.currentTime,timestamp:Date.now()}))},this.handleCanPlay=()=>{const e=this.state.message;if(!e)return;const t=this.videoRef.current;if(!t)return;const a=Ao.b.playbackRate,n=Ao.b.volume,s=e.chat_id,i=e.id,o=Object(vt.z)(s,i);if(t.playbackRate=o?p.I:a,t.volume=n,t.muted=!1,o)return;let r=null;"captureStream"in t?r=t.captureStream():"mozCaptureStream"in t&&(r=t.mozCaptureStream()),r&&K.a.clientUpdate({"@type":"clientUpdateMediaCaptureStream",chatId:e.chat_id,messageId:e.id,stream:r})},this.handleVideoPlay=()=>{const e=this.state.message;if(!e)return;this.setState({playing:!0});const t=this.videoRef.current;t&&K.a.clientUpdate({"@type":"clientUpdateMediaPlay",chatId:e.chat_id,messageId:e.id,currentTime:t.currentTime,duration:t.duration,timestamp:Date.now()})},this.handleVideoPause=()=>{const e=this.state.message;e&&(this.setState({playing:!1}),this.videoRef.current&&K.a.clientUpdate({"@type":"clientUpdateMediaPause",chatId:e.chat_id,messageId:e.id}))},this.handlePlaybackRate=()=>{const e=this.state.playbackRate===p.I?p.H:p.I;this.setState({playbackRate:e},()=>{const t=this.videoRef.current;t&&(t.playbackRate=e)}),K.a.clientUpdate({"@type":"clientUpdateMediaPlaybackRate",playbackRate:e})},this.hasPrev=(e,t)=>{if(!e)return!1;if(!t||!t.messages.length)return!1;const a=e.chat_id,n=e.id,s=t.messages.findIndex(e=>e.chat_id===a&&e.id===n);return-1!==s&&s+1<t.messages.length},this.hasNext=(e,t)=>{if(!e)return!1;if(!t||!t.messages.length)return!1;const a=e.chat_id,n=e.id,s=t.messages.findIndex(e=>e.chat_id===a&&e.id===n);return-1!==s&&s-1>=0},this.handleTitleMouseEnter=()=>{K.a.clientUpdate({"@type":"clientUpdateMediaTitleMouseOver",over:!0})},this.handleTitleMouseLeave=()=>{K.a.clientUpdate({"@type":"clientUpdateMediaTitleMouseOver",over:!1})},this.handleTitleClick=()=>{const e=this.state.message;e&&Object(G.h)(e.chat_id,e.id)},this.videoRef=r.a.createRef();const t=Ao.b.message,a=Ao.b.playlist;this.startTime=p.K,this.state={currentTime:0,currentTimeString:Object(Ae.e)(0),message:t,playlist:a,playing:!1,src:this.getMediaSrc(t)}}shouldComponentUpdate(e,t,a){const n=this.props.theme,s=this.state,i=s.message,o=s.playlist,r=s.src,c=s.playing;return e.theme!==n||(t.message!==i||(t.playlist!==o||(t.src!==r||t.playing!==c)))}componentDidMount(){P.a.on("clientUpdateVoiceNoteBlob",this.onClientUpdateMediaBlob),P.a.on("clientUpdateVideoNoteBlob",this.onClientUpdateMediaBlob),P.a.on("clientUpdateAudioBlob",this.onClientUpdateMediaBlob),Ao.b.on("clientUpdateMediaActive",this.onClientUpdateMediaActive),Ao.b.on("clientUpdateMediaClose",this.onClientUpdateMediaClose),Ao.b.on("clientUpdateMediaPlaylist",this.onClientUpdateMediaPlaylist),Ao.b.on("clientUpdateMediaViewerPlay",this.onClientUpdateMediaViewerPlay),Ao.b.on("clientUpdateMediaViewerPause",this.onClientUpdateMediaViewerPause),Ao.b.on("clientUpdateMediaViewerEnded",this.onClientUpdateMediaViewerEnded),Ao.b.on("clientUpdateMediaVolume",this.onClientUpdateMediaVolume),Ao.b.on("clientUpdateMediaPlaybackRate",this.onClientUpdateMediaPlaybackRate),Z.a.on("clientUpdateMediaViewerContent",this.onClientUpdateMediaViewerContent)}componentWillUnmount(){P.a.off("clientUpdateVoiceNoteBlob",this.onClientUpdateMediaBlob),P.a.off("clientUpdateVideoNoteBlob",this.onClientUpdateMediaBlob),P.a.off("clientUpdateAudioBlob",this.onClientUpdateMediaBlob),Ao.b.off("clientUpdateMediaActive",this.onClientUpdateMediaActive),Ao.b.off("clientUpdateMediaClose",this.onClientUpdateMediaClose),Ao.b.off("clientUpdateMediaPlaylist",this.onClientUpdateMediaPlaylist),Ao.b.off("clientUpdateMediaViewerPlay",this.onClientUpdateMediaViewerPlay),Ao.b.off("clientUpdateMediaViewerPause",this.onClientUpdateMediaViewerPause),Ao.b.off("clientUpdateMediaViewerEnded",this.onClientUpdateMediaViewerEnded),Ao.b.off("clientUpdateMediaVolume",this.onClientUpdateMediaVolume),Ao.b.off("clientUpdateMediaPlaybackRate",this.onClientUpdateMediaPlaybackRate),Z.a.off("clientUpdateMediaViewerContent",this.onClientUpdateMediaViewerContent)}render(){const e=this.props.t,t=this.state,a=t.playing,n=t.message,s=t.playlist,i=t.src;let o=!1;if(n){const e=n.chat_id,t=n.id;o=Object(vt.z)(e,t)}const c=n?n.date:null,l=Object(vt.p)(n,e),d=Object(vt.j)(c),h=Object(vt.i)(c),u=!o,p=!o,m=o,g=o,f=this.hasPrev(n,s),b=this.hasNext(n,s);return r.a.createElement(r.a.Fragment,null,r.a.createElement("video",{className:"header-player-video",ref:this.videoRef,src:i,autoPlay:!0,controls:!1,width:44,height:44,onCanPlay:this.handleCanPlay,onPlay:this.handleVideoPlay,onPause:this.handleVideoPause,onTimeUpdate:this.handleTimeUpdate,onEnded:this.handleVideoEnded}),n&&r.a.createElement("div",{className:"header-player"},r.a.createElement(C.a,{disabled:!f,className:"header-player-button",color:"primary",onClick:this.handlePrev},r.a.createElement(Oo.a,{fontSize:"small"})),r.a.createElement(C.a,{className:"header-player-button",color:"primary",disabled:!i,onClick:this.handlePlay},a?r.a.createElement(Io.a,null):r.a.createElement(Mo.a,null)),r.a.createElement(C.a,{disabled:!b,className:"header-player-button",color:"primary",onClick:this.handleNext},r.a.createElement(_o.a,{fontSize:"small"})),r.a.createElement(or,null),r.a.createElement("div",{className:"header-player-content",onMouseEnter:this.handleTitleMouseEnter,onMouseLeave:this.handleTitleMouseLeave,onClick:this.handleTitleClick},r.a.createElement("div",{className:"header-player-title"},l,u&&r.a.createElement("span",{title:d},"\xa0",h)),"\xa0",r.a.createElement(ar,null)),r.a.createElement(zo,null),p&&r.a.createElement(er,null),m&&r.a.createElement(Ko,null),g&&r.a.createElement(Xo,null),r.a.createElement(C.a,{className:"header-player-button",onClick:this.handleClose},r.a.createElement(U.a,{fontSize:"small"}))))}}var cr=Object(f.d)()(rr);a(513);class lr extends r.a.Component{constructor(...e){super(...e),this.onUpdateChatActionBar=e=>{const t=this.props.chatId;e.chat_id===t&&this.forceUpdate()},this.handleClose=()=>{const e=this.props.chatId;if(!L.a.get(e))return null;K.a.send({"@type":"removeChatActionBar",chat_id:e})},this.handleReportSpam=()=>{const e=this.props.chatId;if(!L.a.get(e))return null;K.a.send({"@type":"reportChat",chat_id:e,reason:{"@type":"chatReportReasonSpam"},message_ids:[]})},this.handleReportUnrelatedLocation=()=>{const e=this.props.chatId;if(!L.a.get(e))return null;K.a.send({"@type":"reportChat",chat_id:e,reason:{"@type":"chatReportReasonUnrelatedLocation"},message_ids:[]})},this.handleSharePhoneNumber=()=>{const e=this.props.chatId,t=Object(w.u)(e);t&&K.a.send({"@type":"sharePhoneNumber",user_id:t})},this.handleAddContact=()=>{const e=this.props.chatId,t=Object(w.u)(e);if(!t)return;const a=_.a.get(t);if(!a)return;const n=a.user_id,s=a.phone_number,i=a.first_name,o=a.last_name;K.a.send({"@type":"addContact",contact:{"@type":"contact",phone_number:s,first_name:i,last_name:o,vcard:"",user_id:n},share_phone_number:!1})},this.handleBlockUser=()=>{const e=this.props.chatId,t=Object(w.u)(e);t&&K.a.send({"@type":"blockUser",user_id:t})}}componentDidMount(){L.a.on("updateChatActionBar",this.onUpdateChatActionBar)}componentWillUnmount(){L.a.off("updateChatActionBar",this.onUpdateChatActionBar)}render(){const e=this.props,t=e.chatId,a=e.t;if(!t)return null;const n=L.a.get(t);if(!n)return null;const s=n.action_bar;if(!s)return null;let i=null;switch(s["@type"]){case"chatActionBarSharePhoneNumber":i=r.a.createElement(b.a,{color:"primary",className:"header-command-button",onClick:this.handleSharePhoneNumber},a("ShareMyPhone"));break;case"chatActionBarAddContact":i=r.a.createElement(b.a,{color:"primary",className:"header-command-button",onClick:this.handleAddContact},a("AddContactChat"));break;case"chatActionBarReportAddBlock":i=r.a.createElement(r.a.Fragment,null,r.a.createElement(b.a,{color:"primary",className:"header-command-button",onClick:this.handleAddContact},a("AddContactChat")),r.a.createElement(b.a,{color:"secondary",className:"header-command-button",onClick:this.handleBlockUser},a("ReportSpamUser")));break;case"chatActionBarUnrelatedLocation":i=r.a.createElement(b.a,{color:"secondary",className:"header-command-button",onClick:this.handleReportUnrelatedLocation},a("ReportSpamLocation"));break;case"chatActionBarReportSpam":i=r.a.createElement(b.a,{color:"secondary",className:"header-command-button",onClick:this.handleReportSpam},a("ReportSpam"))}return r.a.createElement("div",{className:"action-bar",onMouseDown:this.handleClick},r.a.createElement("div",{className:"action-bar-content"},i),r.a.createElement("div",{className:"action-bar-close-button"},r.a.createElement(C.a,{onClick:this.handleClose},r.a.createElement(U.a,null))))}}var dr=Object(f.d)()(lr);a(514);class hr extends r.a.Component{constructor(...e){super(...e),this.onClientUpdateLanguage=()=>{this.forceUpdate()}}componentDidMount(){fs.a.on("clientUpdateLanguageChange",this.onClientUpdateLanguage)}componentWillUnmount(){fs.a.off("clientUpdateLanguageChange",this.onClientUpdateLanguage)}render(){const e=this.props,t=e.date,a=e.i18n,n=new Date(1e3*t)<(new Date).setMonth((new Date).getMonth()-3)?{day:"numeric",month:"long",year:"numeric"}:{day:"numeric",month:"long"};return r.a.createElement("div",{className:"day-meta"},r.a.createElement("div",{className:"day-meta-wrapper"},r.a.createElement("div",null,new Date(1e3*t).toLocaleDateString([a.language],n))))}}var ur=Object(f.d)()(hr);a(515);class pr extends r.a.Component{constructor(e){super(e),this.onClientUpdateDragging=e=>{const t=Z.a.dragParams;this.setState({dragParams:t})},this.handleDragEnter=e=>{e.preventDefault(),e.stopPropagation()},this.handleDrop=e=>{e.preventDefault(),e.stopPropagation(),K.a.clientUpdate({"@type":"clientUpdateDragging",dragging:!1}),this.handleAttachDocumentComplete(e.dataTransfer.files)},this.handleDragLeave=e=>{e.preventDefault(),e.stopPropagation(),K.a.clientUpdate({"@type":"clientUpdateDragging",dragging:!1})},this.handleAttachDocumentComplete=e=>{0!==e.length&&K.a.clientUpdate({"@type":"clientUpdateSendFiles",files:e})};const t=Z.a.dragParams;this.state={dragParams:t}}componentDidMount(){Z.a.on("clientUpdateDragging",this.onClientUpdateDragging)}componentWillUnmount(){Z.a.off("clientUpdateDragging",this.onClientUpdateDragging)}render(){return this.state.dragParams?r.a.createElement("div",{className:"files-drop-target",onDragEnter:this.handleDragEnter,onDragLeave:this.handleDragLeave,onDrop:this.handleDrop},r.a.createElement("div",{className:"files-drop-target-wrapper"},r.a.createElement("div",{className:"files-drop-target-text"},r.a.createElement("div",{className:"files-drop-target-title"},"Drop files here"),r.a.createElement("div",{className:"files-drop-target-subtitle"},"to send them")))):null}}var mr=pr,gr=a(522),fr=a.n(gr),br=a(578);a(516);class Cr extends r.a.Component{constructor(...e){super(...e),this.state={arrowRef:null},this.handleArrowRef=e=>{this.setState({arrowRef:e})},this.openForward=e=>{e.stopPropagation();const t=this.props.forwardInfo;if(!t)return null;const a=t.origin;switch(a["@type"]){case"messageForwardOriginUser":{const e=a.sender_user_id;Object(G.j)(e,!0);break}case"messageForwardOriginHiddenUser":break;case"messageForwardOriginChannel":{const e=a.chat_id,t=a.message_id;Object(G.h)(e,t);break}}}}render(){const e=this.props,t=e.t,a=e.forwardInfo,n=this.state.arrowRef,s=Object(vt.n)(a,t),i=Object(vt.E)(a)?r.a.createElement(r.a.Fragment,null,t("HidAccount"),r.a.createElement("span",{className:"forward-arrow",ref:this.handleArrowRef})):"";return r.a.createElement("div",{className:l()("message-author","forward")},r.a.createElement("div",null,t("ForwardedMessage")),r.a.createElement("div",null,t("From")+" ",r.a.createElement(br.a,{title:i,classes:{popper:"forward-arrow-popper",tooltip:"forward-tooltip"},PopperProps:{popperOptions:{modifiers:{arrow:{enabled:Boolean(n),element:n}}}},placement:"top"},r.a.createElement("a",{onClick:this.openForward},s))))}}var yr=Object(f.d)()(Cr),vr=a(140),Er=a.n(vr);a(517);class Ur extends r.a.Component{render(){const e=this.props,t=e.className,a=e.chatId,n=e.messageId,s=e.date,i=e.editDate,o=e.onDateClick,c=e.t,d=e.views,h=e.style,u=q.a.get(a,n);if(!u)return null;const p=u.is_outgoing,m=Object(vt.i)(s),g=Object(vt.j)(s);return r.a.createElement("div",{className:l()("meta",t),style:h},r.a.createElement("span",null,"\u2002"),d>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement(Er.a,{className:"meta-views-icon"}),r.a.createElement("span",{className:"meta-views"},"\xa0",d,"\xa0 \xa0")),i>0&&r.a.createElement("span",null,c("EditedMessage"),"\xa0"),r.a.createElement("a",{onClick:o},r.a.createElement("span",{title:g},m)),p&&r.a.createElement(ka,{chatId:a,messageId:n}))}}var Sr=Object(f.d)()(Ur),kr=a(335);a(518);class Mr extends r.a.PureComponent{constructor(...e){super(...e),this.state={confirmStopPoll:!1},this.handleConfirmStopPoll=e=>{this.state.dialog||this.setState({confirmStopPoll:!0,contextMenu:!1})},this.handleCloseConfirm=e=>{e&&e.stopPropagation(),this.setState({confirmStopPoll:!1})},this.handleStopPoll=e=>{e.stopPropagation();const t=this.props,a=t.chatId,n=t.messageId;this.state.confirmStopPoll&&this.setState({confirmStopPoll:!1}),Object(kr.c)(a,n)},this.handleUnvote=e=>{e&&e.stopPropagation();const t=this.props,a=t.chatId,n=t.messageId;(0,t.onClose)(e),Object(kr.a)(a,n)},this.handleCopyLink=e=>{const t=this.props.onClose,a=this.state.copyLink;t(e),a&&R(a)},this.handleReply=e=>{const t=this.props,a=t.chatId,n=t.messageId,s=t.onClose;Object(G.a)(),s(e),Object(G.k)(a,n)},this.handlePin=e=>{const t=this.props,a=t.chatId,n=t.messageId,s=t.onClose;Object(G.a)(),s(e),Object(vt.H)(a,n)?function(e){K.a.send({"@type":"unpinChatMessage",chat_id:e})}(a):function(e,t,a=!1){K.a.send({"@type":"pinChatMessage",chat_id:e,message_id:t,disable_notification:a})}(a,n)},this.handleForward=e=>{const t=this.props,a=t.chatId,n=t.messageId;(0,t.onClose)(e),Object(G.e)(a,[n])},this.handleEdit=e=>{const t=this.props,a=t.chatId,n=t.messageId,s=t.onClose;Object(G.a)(),s(e),Object(G.d)(a,n)},this.handleSelect=e=>{const t=this.props,a=t.chatId,n=t.messageId;(0,t.onClose)(e),Object(G.m)(a,n,!0)},this.handleDelete=e=>{const t=this.props,a=t.chatId,n=t.messageId;(0,t.onClose)(e),Object(G.c)(a,[n])}}render(){const e=this.props,t=e.t,a=e.chatId,n=e.messageId,s=e.anchorPosition,i=e.canCopyLink,o=e.open,c=e.onClose,l=this.state.confirmStopPoll,d=Object(vt.H)(a,n),h=Object(vt.e)(a,n),u=Object(vt.a)(a,n),p=Object(w.e)(a),m=Object(w.c)(a),g=Object(vt.d)(a,n),f=Object(vt.b)(a,n),C=Object(vt.c)(a,n),U=!q.a.hasSelectedMessage(a,n);return r.a.createElement(r.a.Fragment,null,r.a.createElement(bt.a,{open:o,onClose:c,anchorReference:"anchorPosition",anchorPosition:s,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"},onMouseDown:e=>e.stopPropagation()},r.a.createElement(gt.a,{onClick:e=>e.stopPropagation()},i&&r.a.createElement(ft.a,{onClick:this.handleCopyLink},t("CopyLink")),p&&r.a.createElement(ft.a,{onClick:this.handleReply},t("Reply")),m&&r.a.createElement(ft.a,{onClick:this.handlePin},t(d?"Unpin":"Pin")),U&&r.a.createElement(ft.a,{onClick:this.handleSelect},t("Select")),g&&r.a.createElement(ft.a,{onClick:this.handleForward},t("Forward")),C&&r.a.createElement(ft.a,{onClick:this.handleEdit},t("Edit")),f&&r.a.createElement(ft.a,{onClick:this.handleDelete},t("Delete")),h&&r.a.createElement(ft.a,{onClick:this.handleUnvote},t("Unvote")),u&&r.a.createElement(ft.a,{onClick:this.handleConfirmStopPoll},t("StopPoll")))),r.a.createElement(y.a,{transitionDuration:0,open:l,onClose:this.handleCloseConfirm,"aria-labelledby":"form-dialog-title"},r.a.createElement(E.a,{id:"form-dialog-title"},t("StopPollAlertTitle")),r.a.createElement(On.a,null,r.a.createElement(Tn.a,null,t("StopPollAlertText"))),r.a.createElement(v.a,null,r.a.createElement(b.a,{onClick:this.handleCloseConfirm,color:"primary"},t("Cancel")),r.a.createElement(b.a,{onClick:this.handleStopPoll,color:"primary"},t("Stop")))))}}var Ir=Object(f.d)()(Mr);a(519);var wr=Object(f.d)()((function(e){const t=e.t;return r.a.createElement("div",{className:"unread-separator"},t("UnreadMessages"))})),_r=a(71),xr=a(312),Or=a(318),Tr=a(352),Lr=a(294),Pr=a(323),Nr=a(341),Dr=a(353);let jr=null;function Br(e){return Rr.apply(this,arguments)}function Rr(){return(Rr=Object(i.a)(s.a.mark((function e(t){var a,n,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=jr=new Date,e.next=4,K.a.send({"@type":"getWebPageInstantView",url:t,force_full:!0});case 4:if(n=e.sent,jr===a){e.next=7;break}return e.abrupt("return");case 7:console.log("[IV] open",n),Object(T.t)(n),Object(G.n)({instantView:n}),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(0),(i=window.open()).opener=null,i.location=t;case 17:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}a(520);class Fr extends r.a.Component{constructor(...e){var t;super(...e),t=this,this.getMedia=()=>{const e=this.props,t=e.chatId,a=e.messageId,n=e.size,s=(e.displaySize,e.displaySmallSize),i=e.displayExtraSmallSize,o=e.openMedia,c=q.a.get(t,a);if(!c)return null;const l=c.content;if(!l)return null;const d=l.web_page;if(!d)return null;const h=d.site_name,u=d.title,p=d.description,m=(d.url,d.photo),g=d.animation,f=d.video,b=d.audio,C=d.document,y=d.voice_note,v=d.video_note,E=d.sticker,U=d.type;if(E)return[null,r.a.createElement(Lr.b,{chatId:t,messageId:a,sticker:E,openMedia:o,source:Lr.a.MESSAGE})];if(y)return[null,r.a.createElement(Dr.a,{chatId:t,messageId:a,voiceNote:y,openMedia:o})];if(v)return[null,r.a.createElement(Nr.a,{chatId:t,messageId:a,videoNote:v,openMedia:o})];if(b)return[null,r.a.createElement(Or.a,{chatId:t,messageId:a,audio:b,openMedia:o})];if(C)return[null,r.a.createElement(Tr.a,{chatId:t,messageId:a,document:C,openMedia:o})];if(g){if(Object(T.j)(g.animation)||g.thumbnail)return[null,r.a.createElement(xr.a,{chatId:t,messageId:a,animation:g,openMedia:o})]}if(f&&f.thumbnail)return[null,r.a.createElement(Pr.a,{chatId:t,messageId:a,video:f,openMedia:o})];if(m){const e=Object(Ae.m)(m.sizes,n),c=("article"===U||"photo"===U)&&(h||u||p)&&e&&e.width===e.height,l=c&&(!p||p.length<50),d=c||l?{float:"right",marginLeft:6}:{};return[c?r.a.createElement(Nt.a,{displaySize:l?i:s,style:d,chatId:t,messageId:a,photo:m,openMedia:o}):null,c?null:r.a.createElement(Nt.a,{chatId:t,messageId:a,photo:m,openMedia:o})]}return[null,null]},this.handleInstantViewClick=function(){var e=Object(i.a)(s.a.mark((function e(a){var n,i,o,r,c,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),a.stopPropagation(),n=t.props,i=n.chatId,o=n.messageId,r=q.a.get(i,o)){e.next=6;break}return e.abrupt("return",null);case 6:if(c=r.content){e.next=9;break}return e.abrupt("return",null);case 9:if(l=c.web_page){e.next=12;break}return e.abrupt("return",null);case 12:Br(l.url);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}getWebPage(){const e=this.props,t=e.chatId,a=e.messageId,n=e.t,s=q.a.get(t,a);if(!s)return null;const i=s.content;if(!i)return null;const o=i.web_page;if(!o)return null;const c=o.description,l=o.instant_view_version,d=o.site_name,h=o.title,u=r.a.createElement(r.a.Fragment,null,d&&r.a.createElement("div",{className:"web-page-site-name"},d),h&&r.a.createElement("div",{className:"web-page-title"},h),c&&r.a.createElement("div",{className:"web-page-description"},c)),p=this.getMedia(),m=Object(g.a)(p,2),f=m[0],C=m[1],y=l>0&&r.a.createElement(b.a,{variant:"outlined",color:"primary",classes:{outlinedPrimary:"message-control",disabled:"message-control-disabled"},fullWidth:!0,onClick:this.handleInstantViewClick,className:"web-page-button"},r.a.createElement(_r.a,null,r.a.createElement("path",{d:"M10.5159727,16.7438514 C10.1741929,18.1203636 10.687342,18.4055299 11.6053255,17.4005852 L15.4613785,12.9698209 C16.3535455,11.8808642 16.1300862,11.0059438 14.8452805,10.7872179 L12.9861121,10.4429102 L12.9861121,10.4429102 C12.8775019,10.4227962 12.8057616,10.3184447 12.8258756,10.2098345 C12.8265392,10.2062511 12.8273007,10.2026864 12.8281591,10.1991446 L13.5436135,7.24719783 C13.8863521,5.8619451 13.3150978,5.61107807 12.4582164,6.59275159 C11.2270125,7.98097123 10.2913754,9.02966176 9.65130514,9.73882318 C9.42814828,9.98606827 9.06894462,10.3719875 8.57369417,10.8965808 C7.48829706,12.1010165 8.05955136,12.9745105 9.31498713,13.1932365 L11.0917769,13.5117472 L11.0917769,13.5117472 C11.2005008,13.5312372 11.2728391,13.6351751 11.253349,13.743899 C11.2525988,13.7480841 11.2517153,13.7522442 11.2506999,13.756373 L10.5159727,16.7438514 Z"})),n("InstantView"));return r.a.createElement(r.a.Fragment,null,f,u,C,y)}render(){const e=this.props.meta;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"web-page"},r.a.createElement("div",{className:"border"}),r.a.createElement("div",{className:"web-page-wrapper"},this.getWebPage())),e)}}Fr.defaultProps={size:p.F,displaySize:p.D,displaySmallSize:p.E,displayExtraSmallSize:p.C};var Ar=Object(f.d)()(Fr);a(521);class Vr extends o.Component{constructor(e){var t;super(e),t=this,this.onClientUpdateClearSelection=e=>{this.state.selected&&this.setState({selected:!1})},this.onClientUpdateMessageShake=e=>{const t=this.props,a=t.chatId,n=t.messageId,s=this.state.shook;a===e.chatId&&n===e.messageId&&(s?this.setState({shook:!1},()=>{setTimeout(()=>{this.setState({shook:!0})},0)}):this.setState({shook:!0}))},this.onClientUpdateMessageHighlighted=e=>{const t=this.props,a=t.chatId,n=t.messageId,s=this.state,i=s.selected,o=s.highlighted;i||(a===e.chatId&&n===e.messageId?o?this.setState({highlighted:!1},()=>{setTimeout(()=>{this.setState({highlighted:!0})},0)}):this.setState({highlighted:!0}):o&&this.setState({highlighted:!1}))},this.onClientUpdateMessageSelected=e=>{const t=this.props,a=t.chatId,n=t.messageId,s=e.selected;a===e.chatId&&n===e.messageId&&this.setState({selected:s,highlighted:!1})},this.onUpdateMessageEdited=e=>{const t=e.chat_id,a=e.message_id,n=this.props,s=n.chatId,i=n.messageId;s===t&&i===a&&this.forceUpdate()},this.onUpdateMessageViews=e=>{const t=e.chat_id,a=e.message_id,n=this.props,s=n.chatId,i=n.messageId;s===t&&i===a&&this.forceUpdate()},this.onUpdateMessageContent=e=>{const t=e.chat_id,a=e.message_id,n=this.props,s=n.chatId,i=n.messageId,o=this.state.emojiMatches;s===t&&i===a&&(Object(vt.k)(s,i)!==o?this.setState({emojiMatches:Object(vt.k)(s,i)}):this.forceUpdate())},this.handleSelectUser=e=>{Object(G.j)(e,!0)},this.handleSelectChat=e=>{Object(G.h)(e,null,!0)},this.handleSelection=()=>{if(!this.mouseDown)return;if(window.getSelection().toString())return;const e=this.props,t=e.chatId,a=e.messageId,n=!q.a.selectedItems.has("chatId=".concat(t,"_messageId=").concat(a));Object(G.m)(t,a,n)},this.handleDateClick=e=>{e.preventDefault(),e.stopPropagation();const t=this.props,a=t.chatId,n=t.messageId;Object(w.e)(a)?K.a.clientUpdate({"@type":"clientUpdateReply",chatId:a,messageId:n}):Object(vt.d)(a,n)&&K.a.clientUpdate({"@type":"clientUpdateForward",info:{chatId:a,messageIds:[n]}})},this.openMedia=e=>{e&&(e.preventDefault(),e.stopPropagation());const t=this.props,a=t.chatId,n=t.messageId;Object(vt.N)(a,n)},this.handleAnimationEnd=()=>{this.setState({highlighted:!1})},this.handleMouseDown=()=>{this.mouseDown=!0},this.handleMouseOver=()=>{this.mouseDown=!1},this.handleMouseOut=()=>{this.mouseOut=!1},this.handleReplyClick=()=>{const e=this.props,t=e.chatId,a=e.messageId;Object(G.i)(t,a)},this.handleOpenContextMenu=function(){var e=Object(i.a)(s.a.mark((function e(a){var n,i,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a&&(a.preventDefault(),a.stopPropagation()),!t.state.contextMenu){e.next=6;break}t.setState({contextMenu:!1}),e.next=12;break;case 6:if(!(q.a.selectedItems.size>1)){e.next=8;break}return e.abrupt("return");case 8:n=a.clientX,i=a.clientY,o=a.target&&"A"===a.target.tagName&&a.target.href?a.target.href:null,t.setState({contextMenu:!0,canCopyLink:o,left:n,top:i});case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleCloseContextMenu=e=>{e&&e.stopPropagation(),this.setState({contextMenu:!1})};const a=this.props,n=a.chatId,o=a.messageId;this.state={message:q.a.get(n,o),emojiMatches:Object(vt.k)(n,o),selected:!1,highlighted:!1,shook:!1,contextMenu:!1,canCopyLink:!1,left:0,top:0}}shouldComponentUpdate(e,t){const a=this.props,n=a.chatId,s=a.messageId,i=a.sendingState,o=a.showUnreadSeparator,r=a.showTail,c=a.showTitle,l=this.state,d=l.contextMenu,h=l.selected,u=l.highlighted,p=l.shook,m=l.emojiMatches;return e.chatId!==n||(e.messageId!==s||(e.sendingState!==i||(e.showUnreadSeparator!==o||(e.showTail!==r||(e.showTitle!==c||(t.contextMenu!==d||(t.selected!==h||(t.highlighted!==u||(t.shook!==p||t.emojiMatches!==m)))))))))}componentDidMount(){q.a.on("clientUpdateMessageHighlighted",this.onClientUpdateMessageHighlighted),q.a.on("clientUpdateMessageSelected",this.onClientUpdateMessageSelected),q.a.on("clientUpdateMessageShake",this.onClientUpdateMessageShake),q.a.on("clientUpdateClearSelection",this.onClientUpdateClearSelection),q.a.on("updateMessageContent",this.onUpdateMessageContent),q.a.on("updateMessageEdited",this.onUpdateMessageEdited),q.a.on("updateMessageViews",this.onUpdateMessageViews)}componentWillUnmount(){q.a.off("clientUpdateMessageHighlighted",this.onClientUpdateMessageHighlighted),q.a.off("clientUpdateMessageSelected",this.onClientUpdateMessageSelected),q.a.off("clientUpdateMessageShake",this.onClientUpdateMessageShake),q.a.off("clientUpdateClearSelection",this.onClientUpdateClearSelection),q.a.off("updateMessageContent",this.onUpdateMessageContent),q.a.off("updateMessageEdited",this.onUpdateMessageEdited),q.a.off("updateMessageViews",this.onUpdateMessageViews)}render(){const e=this.props,t=e.t,a=e.chatId,n=e.messageId,s=e.showUnreadSeparator,i=e.showTail,o=e.showTitle,c=e.showDate,d=this.state,h=d.emojiMatches,u=d.selected,p=d.highlighted,m=d.shook,g=d.canCopyLink,f=d.contextMenu,b=d.left,C=d.top,y=q.a.get(a,n);if(!y)return r.a.createElement("div",null,"[empty message]");const v=y.is_outgoing,E=y.views,U=y.date,S=y.edit_date,k=y.reply_to_message_id,M=y.forward_info,I=y.sender_user_id,_=v&&!Object(w.J)(a),x=r.a.createElement(Sr,{className:"meta-hidden",key:"".concat(a,"_").concat(n,"_meta"),chatId:a,messageId:n,date:U,editDate:S,views:E}),O=Object(vt.w)(y,x,t),T=null!==O&&O.length>0,L=Object(vt.O)(a,n),P=Boolean(k),N=Object(w.T)(a),j=!N&&o||L||P,B=Object(vt.y)(y),R=Object(Et.f)(y,this.openMedia,j,T,x);let F=null;i&&(F=I?r.a.createElement(cn.a,{small:!0,userId:I,onSelect:this.handleSelectUser}):r.a.createElement(D,{small:!0,chatId:a,onSelect:this.handleSelectChat}));const A=Object(vt.q)(a,n),V="messageSticker"!==y.content["@type"]&&"messageVideoNote"!==y.content["@type"];return r.a.createElement("div",null,c&&r.a.createElement(ur,{date:U}),r.a.createElement("div",{className:l()("message",{"message-short":!F,"message-out":_,"message-selected":u,"message-highlighted":p&&!u,"message-top":o&&!i,"message-bottom":!o&&i,"message-middle":!o&&!i,"message-bubble-hidden":!V}),onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onMouseDown:this.handleMouseDown,onClick:this.handleSelection,onAnimationEnd:this.handleAnimationEnd,onContextMenu:this.handleOpenContextMenu},s&&r.a.createElement(wr,null),r.a.createElement("div",{className:"message-body"},r.a.createElement("div",{className:"message-padding"},r.a.createElement(fr.a,{className:"message-select-tick"})),r.a.createElement("div",{className:l()("message-wrapper",{"message-wrapper-shook":m})},F,r.a.createElement("div",{className:l()("message-content",{"message-bubble":V,"message-bubble-out":V&&_}),style:A},V&&(o&&!N||L)&&r.a.createElement("div",{className:"message-title"},o&&!L&&r.a.createElement(na.a,{chatId:a,openChat:!0,userId:I,openUser:!0}),L&&r.a.createElement(yr,{forwardInfo:M})),P&&r.a.createElement(ji,{chatId:a,messageId:k,onClick:this.handleReplyClick}),R,r.a.createElement("div",{className:l()("message-text",{"message-text-1emoji":1===h,"message-text-2emoji":2===h,"message-text-3emoji":3===h})},O),B&&r.a.createElement(Ar,{chatId:a,messageId:n,openMedia:this.openMedia,meta:x}),V&&r.a.createElement(Sr,{className:l()("meta-text",{"meta-bubble":Object(vt.J)(a,n)}),chatId:a,messageId:n,date:U,editDate:S,views:E,onDateClick:this.handleDateClick})),r.a.createElement("div",{className:"message-tile-padding"})),r.a.createElement("div",{className:"message-padding"}))),r.a.createElement(Ir,{chatId:a,messageId:n,anchorPosition:{top:C,left:b},open:f,onClose:this.handleCloseContextMenu,canCopyLink:g}))}}var zr=Object(d.a)(Object(d.d)(),Object(f.d)(),Object(d.c)())(Vr);a(523);class Hr extends r.a.Component{constructor(e){super(e),this.onClientUpdateCacheLoaded=e=>{const t=Z.a.cacheLoaded;this.setState({cacheLoaded:t})},this.onClientUpdateChatId=e=>{const t=e.nextChatId;this.setState({chatId:t})},this.onClientUpdateDialogsReady=e=>{const t=Z.a.dialogsReady;this.setState({dialogsReady:t})};const t=Z.a.chatId,a=Z.a.dialogsReady,n=Z.a.cacheLoaded;this.state={chatId:t,dialogsReady:a,cacheLoaded:n}}shouldComponentUpdate(e,t,a){return t.chatId!==this.state.chatId||(t.dialogsReady!==this.state.dialogsReady||t.cacheLoaded!==this.state.cacheLoaded)}componentDidMount(){Z.a.on("clientUpdateChatId",this.onClientUpdateChatId),Z.a.on("clientUpdateDialogsReady",this.onClientUpdateDialogsReady),Z.a.on("clientUpdateCacheLoaded",this.onClientUpdateCacheLoaded)}componentWillUnmount(){Z.a.off("clientUpdateChatId",this.onClientUpdateChatId),Z.a.off("clientUpdateDialogsReady",this.onClientUpdateDialogsReady),Z.a.off("clientUpdateCacheLoaded",this.onClientUpdateCacheLoaded)}render(){const e=this.props,t=e.t,a=(e.force,this.state),n=a.chatId;a.dialogsReady,a.cacheLoaded;return n?null:r.a.createElement("div",{className:"placeholder"},r.a.createElement("div",{className:"placeholder-wrapper"},r.a.createElement("div",{className:"placeholder-meta"},t("SelectChatToStartMessaging"))))}}var Wr=Object(f.d)()(Hr),Gr=a(525),Zr=a.n(Gr);a(524);class qr extends r.a.Component{render(){const e=this.props.onClick;return r.a.createElement("div",{className:"scroll-down-button"},r.a.createElement(C.a,{disableRipple:!0,onMouseDown:e},r.a.createElement(Zr.a,null)))}}var Kr=qr,Yr=a(314);a(526);const Jr={width:64,height:64,borderRadius:"50%",margin:"0 auto 5px"};class Qr extends r.a.Component{constructor(e){super(e),this.onClientUpdateMessageHighlighted=e=>{const t=this.props,a=t.chatId,n=t.messageId,s=this.state,i=s.selected,o=s.highlighted;i||(a===e.chatId&&n===e.messageId?o?this.setState({highlighted:!1},()=>{setTimeout(()=>{this.setState({highlighted:!0})},0)}):this.setState({highlighted:!0}):o&&this.setState({highlighted:!1}))},this.handleAnimationEnd=()=>{this.setState({highlighted:!1})},this.openMedia=e=>{e&&(e.preventDefault(),e.stopPropagation());const t=this.props,a=t.chatId,n=t.messageId;Object(vt.N)(a,n)};const t=this.props,a=t.chatId,n=t.messageId;this.state={message:q.a.get(a,n),highlighted:!1}}shouldComponentUpdate(e,t){const a=this.props,n=a.chatId,s=a.messageId,i=a.sendingState,o=a.showUnreadSeparator,r=this.state.highlighted;return e.chatId!==n||(e.messageId!==s||(e.sendingState!==i||(e.showUnreadSeparator!==o||t.highlighted!==r)))}componentDidMount(){q.a.on("clientUpdateMessageHighlighted",this.onClientUpdateMessageHighlighted)}componentWillUnmount(){q.a.off("clientUpdateMessageHighlighted",this.onClientUpdateMessageHighlighted)}render(){const e=this.props,t=e.chatId,a=e.messageId,n=e.showUnreadSeparator,s=e.showDate,i=this.state.highlighted,o=q.a.get(t,a);if(!o)return null;const c=o.content,d=o.date;if(!c)return null;const h=c.photo,u=Object(Yr.a)(o,!0);return r.a.createElement("div",null,s&&r.a.createElement(ur,{date:d}),r.a.createElement("div",{className:l()("service-message",{"message-highlighted":i}),onAnimationEnd:this.handleAnimationEnd},n&&r.a.createElement(wr,null),r.a.createElement("div",{className:"service-message-wrapper"},r.a.createElement("div",{className:"service-message-content"},r.a.createElement("div",null,u))),h&&r.a.createElement(Nt.a,{chatId:t,messageId:a,photo:h,style:Jr,openMedia:this.openMedia})))}}var Xr=Object(d.a)(Object(d.d)(),Object(f.d)(),Object(d.c)())(Qr),$r=a(325);a(528);class ec extends r.a.Component{constructor(e){super(e),this.onClientUpdateRemoteStickersHint=e=>{const t=e.hint,a=this.state.hint;if(a&&t.timestamp!==a.timestamp)return;this.setState({hint:Zi.a.hint,items:this.getItems(Zi.a.hint)});const n=P.a.getStore(),s=t.stickers;Object(T.B)(n,s.stickers)},this.onClientUpdateLocalStickersHint=e=>{const t=e.hint;if(this.setState({hint:t,items:this.getItems(t),previewStickerId:0,showPreview:!1,cancelSend:!1}),!t)return;const a=P.a.getStore(),n=t.stickers;Object(T.B)(a,n.stickers)},this.handleSend=e=>{this.state.cancelSend||e&&K.a.clientUpdate({"@type":"clientUpdateStickerSend",sticker:e})},this.loadPreviewContent=e=>{const t=this.state.items,a=t.find(t=>t.sticker.id===e);if(!a)return;const n=P.a.getStore();Object(T.y)(n,a,null);let s=8;this.hintsRef&&this.hintsRef.current&&(s=Math.floor(this.hintsRef.current.clientWidth/p.kb)),this.getNeighborStickers(e,t,s).forEach(e=>{Object(T.y)(n,e,null)})},this.getNeighborStickers=(e,t,a)=>{if(!t)return[];const n=[],s=t.findIndex(t=>t.sticker.id===e);if(-1===s)return[];const i=Math.floor(s/a),o=s%a,r=i-1,c=i+1,l=o-1,d=o+1;return r>=0&&(l>=0&&n.push(a*r+l),n.push(a*r+o),d<a&&n.push(a*r+d)),l>=0&&n.push(a*i+l),d<a&&n.push(a*i+d),c<Math.ceil(t.length/a)&&(l>=0&&n.push(a*c+l),n.push(a*c+o),d<a&&n.push(a*c+d)),n.map(e=>t[e])},this.handleMouseEnter=e=>{const t=Number(e.currentTarget.dataset.stickerId),a=this.getSticker(t);a&&this.mouseDown&&(this.mouseDownStickerId!==t&&(this.mouseDownStickerId=null),this.setState({sticker:a}),K.a.clientUpdate({"@type":"clientUpdateStickerPreview",sticker:a}),this.loadPreviewContent(t))},this.handleMouseDown=e=>{const t=Number(e.currentTarget.dataset.stickerId),a=this.getSticker(t);if(!a)return;this.mouseDownStickerId=t;const n=Date.now();return this.setState({sticker:a,timestamp:n,showPreview:!1,cancelSend:!1}),setTimeout(()=>{this.state.timestamp===n&&(this.setState({showPreview:!0,cancelSend:!0}),K.a.clientUpdate({"@type":"clientUpdateStickerPreview",sticker:a}))},500),this.loadPreviewContent(t),this.mouseDown=!0,document.addEventListener("mouseup",this.handleMouseUp),e.preventDefault(),e.stopPropagation(),!1},this.handleMouseUp=()=>{this.setState({sticker:null,timestamp:0,showPreview:!1}),K.a.clientUpdate({"@type":"clientUpdateStickerPreview",sticker:null}),this.mouseDown=!1,document.removeEventListener("mouseup",this.handleMouseUp)},this.getItems=e=>{const t=[];if(!e)return t;const a=new Map,n=e.stickers,s=e.foundStickers;return n&&n.stickers.forEach(e=>{t.push(e),a.set(e.sticker.id,e.sticker.id)}),s&&s.stickers.forEach(e=>{a.has(e.sticker.id)||(t.push(e),a.set(e.sticker.id,e.sticker.id))}),t},this.hintsRef=r.a.createRef(),this.state={hint:null,items:[],previewStickerId:0,showPreview:!1,cancelSend:!1}}componentDidMount(){Zi.a.on("clientUpdateLocalStickersHint",this.onClientUpdateLocalStickersHint),Zi.a.on("clientUpdateRemoteStickersHint",this.onClientUpdateRemoteStickersHint)}componentWillUnmount(){Zi.a.off("clientUpdateLocalStickersHint",this.onClientUpdateLocalStickersHint),Zi.a.off("clientUpdateRemoteStickersHint",this.onClientUpdateRemoteStickersHint)}getSticker(e){const t=this.state.items,a=t.findIndex(t=>t.sticker.id===e);return-1!==a?t[a]:null}render(){const e=this.state,t=e.hint,a=e.items,n=e.sticker,s=e.showPreview;if(!t)return null;if(!a)return null;if(!a.length)return null;const i=a.map(e=>r.a.createElement("div",{className:"sticker-set-dialog-item",key:e.sticker.id,"data-sticker-id":e.sticker.id,style:{width:p.kb,height:p.kb},onClick:()=>this.handleSend(e),onMouseEnter:this.handleMouseEnter,onMouseDown:this.handleMouseDown},r.a.createElement(Lr.b,{key:e.sticker.id,className:"sticker-set-dialog-item-sticker",sticker:e,autoplay:!1,blur:!1,displaySize:p.mb,preview:!0,source:Lr.a.HINTS})));return r.a.createElement("div",{ref:this.hintsRef,className:"stickers-hint"},i,Boolean(n)&&s&&r.a.createElement($r.a,{sticker:n}))}}var tc=ec;a(529);const ac=Object.freeze({SCROLL_TO_BOTTOM:"SCROLL_TO_BOTTOM",SCROLL_TO_UNREAD:"SCROLL_TO_UNREAD",SCROLL_TO_MESSAGE:"SCROLL_TO_MESSAGE",KEEP_SCROLL_POSITION:"KEEP_SCROLL_POSITION",NONE:"NONE"});class nc extends r.a.Component{constructor(e){var t;super(e),t=this,this.onKeyDown=e=>{},this.onClientUpdateTryEditMessage=function(){var e=Object(i.a)(s.a.mark((function e(a){var n,i,o,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.completed){e.next=11;break}n=t.state.history,i=n.length-1;case 3:if(!(i>=0)){e.next=11;break}if(o=n[i],!Object(vt.c)(o.chat_id,o.id)){e.next=8;break}return K.a.clientUpdate({"@type":"clientUpdateEditMessage",chatId:o.chat_id,messageId:o.id}),e.abrupt("return");case 8:i--,e.next=3;break;case 11:return e.next=13,K.a.send({"@type":"searchChatMessages",chat_id:t.props.chatId,query:"",sender_user_id:_.a.getMyId(),from_message_id:0,offset:0,limit:100,filter:{"@type":"searchMessagesFilterEmpty"}});case 13:r=e.sent,i=0;case 15:if(!(i<r.messages.length)){e.next=23;break}if(o=r.messages[i],!Object(vt.c)(o.chat_id,o.id)){e.next=20;break}return K.a.clientUpdate({"@type":"clientUpdateEditMessage",chatId:o.chat_id,messageId:o.id}),e.abrupt("return");case 20:i++,e.next=15;break;case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.onClientUpdateDialogsReady=function(){var e=Object(i.a)(s.a.mark((function e(a){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.a.initDB(Object(i.a)(s.a.mark((function e(){var a,n,i,o,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.props,n=a.chatId,i=a.messageId,!n){e.next=18;break}if(!(o=L.a.get(n))){e.next=18;break}r=o.type,e.t0=r["@type"],e.next="chatTypePrivate"===e.t0||"chatTypeSecret"===e.t0?8:"chatTypeBasicGroup"===e.t0?11:"chatTypeSupergroup"===e.t0?14:17;break;case 8:return e.next=10,K.a.send({"@type":"createPrivateChat",user_id:r.user_id,force:!1});case 10:return e.abrupt("break",17);case 11:return e.next=13,K.a.send({"@type":"createBasicGroupChat",basic_group_id:r.basic_group_id,force:!1});case 13:return e.abrupt("break",17);case 14:return e.next=16,K.a.send({"@type":"createSupergroupChat",supergroup_id:r.supergroup_id,force:!1});case 16:return e.abrupt("break",17);case 17:t.handleSelectChat(n,0,i,0);case 18:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.onClientUpdateFocusWindow=e=>{e.focused&&(this.defferedActions.forEach(e=>e()),this.defferedActions=[])},this.onClientUpdateOpenReply=e=>{const t=e.chatId,a=e.messageId,n=this.state.replyHistory;if(this.props.chatId!==t)return;const s=n.length>0?n[n.length-1]:null;s&&s.chatId===t&&s.messageId===a||n.push({chatId:t,messageId:a})},this.onClientUpdateMediaActive=e=>{const t=this.listRef.current,a=t.offsetHeight,n=t.scrollTop;this.setState({playerOpened:!0},()=>{t.scrollTop===n&&(t.scrollTop+=Math.abs(a-t.offsetHeight))})},this.onClientUpdateMediaEnding=e=>{const t=this.listRef.current;this.prevOffsetHeight=t.offsetHeight,this.prevScrollTop=t.scrollTop},this.onClientUpdateMediaEnd=e=>{const t=this.listRef.current;this.setState({playerOpened:!1},()=>{t.scrollTop===this.prevScrollTop&&(t.scrollTop-=Math.abs(this.prevOffsetHeight-t.offsetHeight))})},this.onClientUpdateSelection=e=>{this.setState({selectionActive:q.a.selectedItems.size>0})},this.onClientUpdateClearHistory=e=>{this.props.chatId===e.chatId&&this.setState({clearHistory:e.inProgress})},this.onUpdateMessageContent=e=>{const t=this.props.chatId,a=this.state.history,n=e.chat_id,s=e.message_id;if(t===n&&-1!==a.findIndex(e=>e.id===s)){const e=q.a.get(n,s);if(!e)return;const t=P.a.getStore();Object(T.v)(t,[e])}},this.onUpdateChatLastMessage=e=>{this.props.chatId;e.chat_id},this.onUpdateMessageSendSucceeded=e=>{if(!this.completed)return;const t=e.message,a=e.old_message_id;if(this.props.chatId!==t.chat_id)return;const n=t.is_outgoing?ac.SCROLL_TO_BOTTOM:ac.KEEP_SCROLL_POSITION;this.replaceMessage(a,t,()=>{n!==ac.KEEP_SCROLL_POSITION&&this.handleScrollBehavior(n,this.snapshot)});const s=P.a.getStore();Object(T.v)(s,[t]),this.viewMessages([t])},this.onUpdateNewMessage=e=>{if(!this.completed)return;const t=e.message;if(this.props.chatId!==t.chat_id)return;if(0===t.date)return;const a=this.listRef.current;let n=t.is_outgoing?ac.SCROLL_TO_BOTTOM:ac.NONE;a.scrollTop+a.offsetHeight>=a.scrollHeight&&(n=ac.SCROLL_TO_BOTTOM);const s=t.is_outgoing?{scrollDownVisible:!1}:{},i=[t];this.scrollBehaviorNone=!0,this.insertPrevious(Object(vt.g)(i),s,()=>{this.scrollBehaviorNone=!1,this.handleScrollBehavior(n,this.snapshot)});const o=P.a.getStore();Object(T.v)(o,i),this.viewMessages(i)},this.onUpdateDeleteMessages=e=>{const t=this.props.chatId,a=e.chat_id,n=e.is_permanent,s=e.message_ids;t===a&&n&&this.deleteHistory(s)},this.updateItemsInView=()=>{if(!this.messages)return;const e=new Map,t=Object(Ae.u)(this.listRef,this.itemsRef);for(let a=0;a<t.length;a++){const n=this.messages[t[a]];if(n){const t=n.props,a=t.chatId,s=t.messageId,i="".concat(a,"_").concat(s);e.set(i,i)}}K.a.clientUpdate({"@type":"clientUpdateMessagesInView",messages:e})},this.loadIncompleteHistory=function(){var e=Object(i.a)(s.a.mark((function e(a){var n,i,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=5,i=a&&a.messages.length>0&&a.messages.length<p.t,o=0;case 3:if(!(o<n&&i)){e.next=11;break}return e.next=6,t.onLoadNext();case 6:a=e.sent,i=a&&a.messages.length>0&&a.messages.length<p.t;case 8:o++,e.next=3;break;case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.onLoadNext=Object(i.a)(s.a.mark((function e(){var a,n,i,o,r,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.props.chatId,n=t.state.history,a){e.next=4;break}return e.abrupt("return");case 4:if(!t.loading){e.next=6;break}return e.abrupt("return");case 6:if(!t.loadMigratedHistory){e.next=9;break}return t.onLoadMigratedHistory(),e.abrupt("return");case 9:return i=n&&n.length>0?n[0].id:0,t.loading=!0,o=t.sessionId,e.next=14,K.a.send({"@type":"getChatHistory",chat_id:a,from_message_id:i,offset:0,limit:p.t}).finally(()=>{t.loading=!1});case 14:if(r=e.sent,o===t.sessionId){e.next=17;break}return e.abrupt("return");case 17:if(t.props.chatId===a){e.next=19;break}return e.abrupt("return");case 19:return q.a.setItems(r.messages),r.messages.reverse(),t.insertNext(Object(vt.g)(r.messages),()=>{r.messages.length||t.onLoadMigratedHistory()}),c=P.a.getStore(),Object(T.v)(c,r.messages),t.viewMessages(r.messages),e.abrupt("return",r);case 26:case"end":return e.stop()}}),e)}))),this.onLoadMigratedHistory=Object(i.a)(s.a.mark((function e(){var a,n,i,o,r,c,l,d,h;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.props.chatId,n=t.state.history,a){e.next=4;break}return e.abrupt("return");case 4:if(!t.loading){e.next=6;break}return e.abrupt("return");case 6:if(i=Object(w.E)(a)){e.next=9;break}return e.abrupt("return");case 9:if(o=Ie.a.getFullInfo(i)){e.next=12;break}return e.abrupt("return");case 12:if(o.upgraded_from_basic_group_id){e.next=14;break}return e.abrupt("return");case 14:return t.loadMigratedHistory=!0,e.next=17,K.a.send({"@type":"createBasicGroupChat",basic_group_id:o.upgraded_from_basic_group_id});case 17:if(r=e.sent){e.next=20;break}return e.abrupt("return");case 20:return c=n.length>0&&n[0].chat_id===r.id?n[0].id:0,t.loading=!0,l=t.sessionId,e.next=25,K.a.send({"@type":"getChatHistory",chat_id:r.id,from_message_id:c,offset:0,limit:p.t}).finally(()=>{t.loading=!1});case 25:if(d=e.sent,l===t.sessionId){e.next=28;break}return e.abrupt("return");case 28:if(t.props.chatId===a){e.next=30;break}return e.abrupt("return");case 30:q.a.setItems(d.messages),d.messages.reverse(),t.insertNext(Object(vt.g)(d.messages)),h=P.a.getStore(),Object(T.v)(h,d.messages),t.viewMessages(d.messages);case 36:case"end":return e.stop()}}),e)}))),this.onLoadPrevious=Object(i.a)(s.a.mark((function e(){var a,n,i,o,r,c,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.props.chatId,n=t.state.history,i=L.a.get(a)){e.next=5;break}return e.abrupt("return");case 5:if(!t.loading){e.next=7;break}return e.abrupt("return");case 7:if(!t.completed){e.next=9;break}return e.abrupt("return");case 9:return o=n&&n.length>0?n[n.length-1].id:0,t.loading=!0,r=t.sessionId,e.next=14,K.a.send({"@type":"getChatHistory",chat_id:a,from_message_id:o,offset:-p.t-1,limit:p.t+1}).finally(()=>{t.loading=!1});case 14:if(c=e.sent,r===t.sessionId){e.next=17;break}return e.abrupt("return");case 17:if(t.props.chatId===a){e.next=19;break}return e.abrupt("return");case 19:return i.last_message?t.completed=c.messages.length>0&&i.last_message.id===c.messages[0].id:t.completed=!0,Object(vt.f)(c,t.state.history),q.a.setItems(c.messages),c.messages.reverse(),t.scrollBehaviorNone=!0,t.insertPrevious(Object(vt.g)(c.messages),{},()=>{t.scrollBehaviorNone=!1}),l=P.a.getStore(),Object(T.v)(l,c.messages),t.viewMessages(c.messages),e.abrupt("return",c);case 29:case"end":return e.stop()}}),e)}))),this.handleScroll=()=>{const e=this.state,t=e.scrollDownVisible,a=e.replyHistory,n=e.history,s=this.listRef.current;this.updateItemsInView(),s.scrollTop<=p.gb?this.onLoadNext():s.scrollTop+s.offsetHeight>=s.scrollHeight-p.gb&&this.onLoadPrevious(),s.scrollTop+s.offsetHeight>=s.scrollHeight-p.gb?this.completed&&t&&(this.prevScrollTop!==s.scrollTop&&this.prevScrollTop&&this.prevHistory===n?this.setState({scrollDownVisible:!1,replyHistory:[]}):a.length||this.setState({scrollDownVisible:!1})):t||this.setState({scrollDownVisible:!0}),this.prevScrollTop=s.scrollTop,this.prevHistory=n},this.handleScrollBehavior=(e,t)=>{const a=this.props,n=(a.chatId,a.messageId,t||{scrollTop:0,scrollHeight:0,offsetHeight:0});n.scrollTop,n.scrollHeight,n.offsetHeight;switch(e){case ac.SCROLL_TO_BOTTOM:this.scrollToBottom();break;case ac.SCROLL_TO_MESSAGE:this.scrollToMessage();break;case ac.SCROLL_TO_UNREAD:this.scrollToUnread();break;case ac.KEEP_SCROLL_POSITION:this.keepScrollPosition(t);break;case ac.NONE:}},this.keepScrollPosition=e=>{const t=e.scrollTop,a=e.scrollHeight,n=(e.offsetHeight,this.listRef.current);n.scrollTop=t+(n.scrollHeight-a)},this.scrollToUnread=()=>{const e=this.props,t=e.chatId,a=(e.messageId,this.state.history),n=this.listRef.current;L.a.get(t);let s=!1;for(let i=0;i<a.length;i++){let e=this.itemsMap.get(i),t=nr.findDOMNode(e);if(t&&e.props.showUnreadSeparator){n.scrollTop=t.offsetTop-0,s=!0;break}}s||this.scrollToBottom()},this.scrollToMessage=()=>{const e=this.props,t=(e.chatId,e.messageId),a=this.state.history,n=this.listRef.current;let s=!1;for(let i=0;i<a.length;i++){const e=this.itemsMap.get(i),a=nr.findDOMNode(e);if(a&&e.props.messageId===t){n.scrollTop=a.offsetTop-n.offsetHeight/2,s=!0;break}}},this.scrollToBottom=()=>{const e=this.props,t=(e.chatId,e.messageId,this.listRef.current);t.scrollHeight-t.offsetHeight!==t.scrollTop&&(t.scrollTop=t.scrollHeight-t.offsetHeight)},this.scrollToStart=Object(i.a)(s.a.mark((function e(){var a,n,i,o,r,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.props.chatId,n=L.a.get(a)){e.next=4;break}return e.abrupt("return");case 4:return t.sessionId=Date.now(),t.loading=!1,t.completed=!1,0,0,i=p.t,t.loading=!0,o=t.sessionId,e.next=14,K.a.send({"@type":"getChatHistory",chat_id:n.id,from_message_id:0,offset:0,limit:i}).finally(()=>{t.loading=!1});case 14:if(r=e.sent,o===t.sessionId){e.next=17;break}return e.abrupt("return");case 17:if(t.props.chatId===a){e.next=19;break}return e.abrupt("return");case 19:n.last_message?t.completed=r.messages.length>0&&n.last_message.id===r.messages[0].id:t.completed=!0,t.setState({scrollDownVisible:!1,replyHistory:[]}),q.a.setItems(r.messages),r.messages.reverse(),t.replace(t.state.separatorMessageId,r.messages,()=>{t.handleScrollBehavior(ac.SCROLL_TO_BOTTOM,t.snapshot)}),c=P.a.getStore(),Object(T.v)(c,r.messages),t.viewMessages(r.messages),t.loadIncompleteHistory(r);case 28:case"end":return e.stop()}}),e)}))),this.handleListDragEnter=e=>{e.preventDefault(),e.stopPropagation();const t=this.props.chatId;Object(w.d)(t)&&K.a.clientUpdate({"@type":"clientUpdateDragging",dragging:!0,files:e.dataTransfer.files})},this.handleScrollDownClick=e=>{const t=this.state.replyHistory;if(t.length>0){const e=t.pop();if(e){const t=e.chatId,a=e.messageId;t===this.props.chatId&&Object(G.h)(t,a)}}else this.scrollToStart()},this.sessionId=Date.now(),this.state={prevChatId:0,prevMessageId:null,playerOpened:!1,history:[],clearHistory:!1,selectionActive:!1,separatorMessageId:0,scrollDownVisible:!1,replyHistory:[]},this.listRef=r.a.createRef(),this.itemsRef=r.a.createRef(),this.scrollDownButtonRef=r.a.createRef(),this.defferedActions=[],this.itemsMap=new Map,this.updateItemsInView=Object(Ae.y)(this.updateItemsInView,500)}static getDerivedStateFromProps(e,t){return e.chatId!==t.prevChatId||e.messageId!==t.prevMessageId?{prevChatId:e.chatId,prevMessageId:e.messageId,clearHistory:!1,selectionActive:!1,separatorMessageId:e.chatId!==t.prevChatId?0:t.separatorMessageId,scrollDownVisible:e.chatId===t.prevChatId&&(t.scrollDownVisible||t.replyHistory.length>0),replyHistory:e.chatId!==t.prevChatId?[]:t.replyHistory}:null}getSnapshotBeforeUpdate(e,t){const a=this.listRef.current,n={scrollTop:a.scrollTop,scrollHeight:a.scrollHeight,offsetHeight:a.offsetHeight};return this.snapshot=n,n}componentDidUpdate(e,t,a){const n=this.props,s=n.chatId,i=n.messageId;this.state.scrollDownVisible,this.listRef.current;e.chatId!==s||e.messageId!==i?this.handleSelectChat(s,e.chatId,i,e.messageId):this.scrollBehaviorNone||this.handleScrollBehavior(ac.KEEP_SCROLL_POSITION,a)}shouldComponentUpdate(e,t){const a=this.props,n=a.chatId,s=a.messageId,i=a.theme,o=this.state,r=o.playerOpened,c=o.history,l=o.dragging,d=o.clearHistory,h=o.selectionActive,u=o.scrollDownVisible;return e.theme!==i||(e.chatId!==n||(e.messageId!==s||(t.scrollDownVisible!==u||(t.playerOpened!==r||(!Object(Ae.n)(t.history,c)||(t.dragging!==l||(t.clearHistory!==d||t.selectionActive!==h)))))))}componentDidMount(){Z.a.on("clientUpdateFocusWindow",this.onClientUpdateFocusWindow),Z.a.on("clientUpdateDialogsReady",this.onClientUpdateDialogsReady),L.a.on("clientUpdateClearHistory",this.onClientUpdateClearHistory),L.a.on("updateChatLastMessage",this.onUpdateChatLastMessage),q.a.on("clientUpdateClearSelection",this.onClientUpdateSelection),q.a.on("clientUpdateMessageSelected",this.onClientUpdateSelection),q.a.on("clientUpdateOpenReply",this.onClientUpdateOpenReply),q.a.on("clientUpdateTryEditMessage",this.onClientUpdateTryEditMessage),q.a.on("updateNewMessage",this.onUpdateNewMessage),q.a.on("updateDeleteMessages",this.onUpdateDeleteMessages),q.a.on("updateMessageContent",this.onUpdateMessageContent),q.a.on("updateMessageSendSucceeded",this.onUpdateMessageSendSucceeded),Ao.b.on("clientUpdateMediaActive",this.onClientUpdateMediaActive),Ao.b.on("clientUpdateMediaEnding",this.onClientUpdateMediaEnding),Ao.b.on("clientUpdateMediaEnd",this.onClientUpdateMediaEnd)}componentWillUnmount(){Z.a.off("clientUpdateFocusWindow",this.onClientUpdateFocusWindow),Z.a.off("clientUpdateDialogsReady",this.onClientUpdateDialogsReady),L.a.off("clientUpdateClearHistory",this.onClientUpdateClearHistory),L.a.off("updateChatLastMessage",this.onUpdateChatLastMessage),q.a.off("clientUpdateClearSelection",this.onClientUpdateSelection),q.a.off("clientUpdateMessageSelected",this.onClientUpdateSelection),q.a.off("clientUpdateOpenReply",this.onClientUpdateOpenReply),q.a.off("clientUpdateTryEditMessage",this.onClientUpdateTryEditMessage),q.a.off("updateNewMessage",this.onUpdateNewMessage),q.a.off("updateDeleteMessages",this.onUpdateDeleteMessages),q.a.off("updateMessageContent",this.onUpdateMessageContent),q.a.off("updateMessageSendSucceeded",this.onUpdateMessageSendSucceeded),Ao.b.off("clientUpdateMediaActive",this.onClientUpdateMediaActive),Ao.b.off("clientUpdateMediaEnding",this.onClientUpdateMediaEnding),Ao.b.off("clientUpdateMediaEnd",this.onClientUpdateMediaEnd)}handleSelectChat(e,t,a,n){var o=this;return Object(i.a)(s.a.mark((function n(){var i,r,c,l,d,h,u,m,g,f,b,C,y;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=L.a.get(e),r=L.a.get(t),o.sessionId=Date.now(),o.loading=!1,o.completed=!1,o.loadMigratedHistory=!1,o.defferedActions=[],!i){n.next=51;break}return K.a.send({"@type":"openChat",chat_id:i.id}),c=!a&&i.unread_count>0,l=c&&i.unread_count>1?i.last_read_inbox_message_id:a||0,d=c&&i.unread_count>1||a?-1-p.t:0,h=c&&i.unread_count>1||a?2*p.t:p.t,o.loading=!0,u=o.sessionId,n.next=17,K.a.send({"@type":"getChatHistory",chat_id:i.id,from_message_id:l,offset:d,limit:h}).finally(()=>{o.loading=!1});case 17:if(m=n.sent,u===o.sessionId){n.next=20;break}return n.abrupt("return");case 20:if(i.last_message?o.completed=m.messages.length>0&&i.last_message.id===m.messages[0].id:o.completed=!0,q.a.setItems(m.messages),m.messages.reverse(),g=o.state.separatorMessageId,e===t){n.next=39;break}if(g=Number.MAX_VALUE,!(i&&i.unread_count>1)){n.next=38;break}f=m.messages.length-1;case 28:if(!(f>=0)){n.next=38;break}if(b=m.messages[f].id,!(!m.messages[f].is_outgoing&&b>i.last_read_inbox_message_id&&b<g)){n.next=34;break}g=b,n.next=35;break;case 34:return n.abrupt("break",38);case 35:f--,n.next=28;break;case 38:g=g===Number.MAX_VALUE?0:g;case 39:C=ac.SCROLL_TO_BOTTOM,a?C=ac.SCROLL_TO_MESSAGE:c&&g&&(C=ac.SCROLL_TO_UNREAD),o.replace(g,m.messages,()=>{o.handleScrollBehavior(C,o.snapshot),a&&Object(G.f)(e,a)}),y=P.a.getStore(),Object(T.v)(y,m.messages),o.viewMessages(m.messages),Object(T.r)(y,[e]),Object(T.s)(y,e),o.loadIncompleteHistory(m),Object(w.m)(i.id),n.next=53;break;case 51:o.loading=!0,o.replace(0,[],()=>{o.loading=!1});case 53:r&&t!==e&&K.a.send({"@type":"closeChat",chat_id:t});case 54:case"end":return n.stop()}}),n)})))()}viewMessages(e){if(!e)return;if(0===e.length)return;if(!e[0].chat_id)return;const t=()=>{K.a.send({"@type":"viewMessages",chat_id:e[0].chat_id,message_ids:e.map(e=>e.id)})};window.hasFocus?t():this.defferedActions.push(t)}cancelLoadMessageContents(e){for(let t=e.length-1;t>=0;t--){let a=e[t];if(a&&a.content)switch(a.content["@type"]){case"messagePhoto":{let e=this.getMessagePhoto(a),t=Object(g.a)(e,2),n=t[0];if(t[1]){Object(Ae.j)(a.content.photo.sizes).blob||P.a.cancelGetRemoteFile(n,a)}break}case"messageSticker":{let e=this.getMessageSticker(a),t=Object(g.a)(e,2),n=t[0];if(t[1]){a.content.sticker.sticker.blob||P.a.cancelGetRemoteFile(n,a)}break}}}}replace(e,t,a){this.setState({separatorMessageId:e,history:t},a)}replaceMessage(e,t,a){t?this.setState({history:this.state.history.filter(t=>t.id!==e).concat([t])},a):a&&a()}insertNext(e,t){0!==e.length?this.setState({history:e.concat(this.state.history)},t):t&&t()}insertPrevious(e,t,a){0!==e.length?this.setState(Object(Ve.a)({history:this.state.history.concat(e)},t),a):a&&a()}deleteHistory(e,t){const a=this.state.history;if(0===a.length)return void(t&&t());const n=new Map(e.map(e=>[e,e]));this.setState({history:a.filter(e=>!n.has(e.id))},t)}showMessageTitle(e,t,a){if(!e)return!1;const n=e.chat_id,s=e.date,i=e.sender_user_id;e.content;return!!a||(!!Object(w.J)(n)||t&&(Object(Yr.b)(t)||i!==t.sender_user_id||s-t.date>p.u))}showMessageDate(e,t,a){if(a)return!0;const n=new Date(1e3*e.date),s=t?new Date(1e3*t.date):n;return n.getFullYear()!==s.getFullYear()||n.getMonth()!==s.getMonth()||n.getDate()!==s.getDate()}render(){const e=this.props.chatId,t=this.state,a=t.history,n=t.separatorMessageId,s=t.clearHistory,i=t.selectionActive,o=t.scrollDownVisible;return this.itemsMap.clear(),this.messages=s?null:a.map((e,t)=>{const s=t>0?a[t-1]:null,i=t<a.length-1?a[t+1]:null,o=this.showMessageDate(e,s,0===t);let c=null;if(Object(Yr.b)(e))c=r.a.createElement(Xr,{key:"chat_id=".concat(e.chat_id," message_id=").concat(e.id),ref:e=>this.itemsMap.set(t,e),chatId:e.chat_id,messageId:e.id,showUnreadSeparator:n===e.id});else{const a=this.showMessageTitle(e,s,0===t),l=this.showMessageTitle(i,e,!1),d=!i||Object(Yr.b)(i)||l;c=r.a.createElement(zr,{key:"chat_id=".concat(e.chat_id," message_id=").concat(e.id),ref:e=>this.itemsMap.set(t,e),chatId:e.chat_id,messageId:e.id,sendingState:e.sending_state,showTitle:a,showTail:d,showUnreadSeparator:n===e.id,showDate:o})}return c}),r.a.createElement("div",{className:l()("messages-list",{"messages-list-selection-active":i}),onDragEnter:this.handleListDragEnter},r.a.createElement("div",{ref:this.listRef,className:"messages-list-wrapper",onScroll:this.handleScroll},r.a.createElement("div",{className:"messages-list-top"}),r.a.createElement("div",{ref:this.itemsRef,className:"messages-list-items"},this.messages)),r.a.createElement(dr,{chatId:e}),r.a.createElement(Wr,null),o&&r.a.createElement(Kr,{ref:this.scrollDownButtonRef,onClick:this.handleScrollDownClick}),r.a.createElement(mr,null),r.a.createElement(tc,null))}}var sc=nc,ic=a(530),oc=a.n(ic),rc=a(531),cc=a.n(rc);class lc extends r.a.Component{constructor(...e){super(...e),this.state={anchorEl:null},this.handleMenuClick=e=>{this.handleOpen(e.currentTarget)},this.handleOpen=e=>{this.setState({anchorEl:e})},this.handleClose=()=>{this.setState({anchorEl:null})},this.handleCopyLink=()=>{this.handleClose();const e=this.props.t,t=this.getStickersLink(Zi.a.stickerSet);if(!t)return;R(t);const a="".concat(t,"_copy_stickers_link"),n=e("LinkCopied");this.handleScheduledAction(a,n,null)},this.getStickersLink=e=>{if(!e)return"";const t=e.name;if(!t)return"";const a=F.a.get("t_me_url");return(a?a.value:"https://telegram.org/")+"addstickers/"+t},this.handleScheduledAction=(e,t,a)=>{if(!e)return;const n=this.props,s=n.enqueueSnackbar;n.classes,n.t;if(!s)return;Z.a.addScheduledAction(e,p.y+300,a)&&s(t,{autoHideDuration:p.y,action:[r.a.createElement(C.a,{key:"close","aria-label":"Close",color:"inherit",className:"notification-close-button",onClick:()=>Z.a.removeScheduledAction(e)},r.a.createElement(U.a,null))]})},this.handleShare=()=>{this.handleClose();const e=this.getStickersLink(Zi.a.stickerSet);if(!e)return;K.a.clientUpdate({"@type":"clientUpdateStickerSet",stickerSet:null});const t={"@type":"inputMessageText",text:{"@type":"formattedText",text:e,entities:null},disable_web_page_preview:!1,clear_draft:!1};K.a.clientUpdate({"@type":"clientUpdateForward",info:{inputMessageContent:t}})}}render(){const e=this.props,t=e.t,a=e.className,n=this.state.anchorEl;return r.a.createElement(r.a.Fragment,null,r.a.createElement(C.a,{className:a,"aria-label":"Share",open:Boolean(n),onClick:this.handleMenuClick},r.a.createElement(xn,null)),r.a.createElement(mn.a,{id:"attach-menu",anchorEl:n,open:Boolean(n),getContentAnchorEl:null,disableAutoFocusItem:!0,disableRestoreFocus:!0,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},onClose:this.handleClose},r.a.createElement(ft.a,{onClick:this.handleCopyLink},r.a.createElement(pe.a,null,r.a.createElement(oc.a,null)),r.a.createElement(me.a,{primary:t("CopyLink")})),r.a.createElement(ft.a,{onClick:this.handleShare},r.a.createElement(pe.a,null,r.a.createElement(cc.a,null)),r.a.createElement(me.a,{primary:t("StickersShare")}))))}}var dc=Object(d.a)(Object(f.d)(),u.withSnackbar)(lc);a(532);class hc extends r.a.Component{constructor(e){super(e),this.handleUpdateInstalledStickerSets=e=>{const t=Zi.a.stickerSet;this.setState({stickerSet:t})},this.handleClientUpdateStickerSet=e=>{const t=e.stickerSet;if(this.setState({stickerSet:t}),t){const e=P.a.getStore();Object(T.z)(e,t)}},this.handleClose=()=>{K.a.clientUpdate({"@type":"clientUpdateStickerSet",stickerSet:null})},this.handleDone=()=>{const e=this.state.stickerSet;if(!e)return;const t=e.is_installed;K.a.send({"@type":"changeStickerSet",set_id:e.id,is_installed:!t}),this.handleClose()},this.loadPreviewContent=e=>{const t=this.state.stickerSet.stickers.find(t=>t.sticker.id===e);if(!t)return;const a=P.a.getStore();Object(T.y)(a,t,null),this.getNeighborStickers(e).forEach(e=>{Object(T.y)(a,e,null)})},this.getNeighborStickers=e=>{const t=this.state.stickerSet;if(!t)return[];const a=t.stickers;if(!a)return[];const n=[],s=a.findIndex(t=>t.sticker.id===e);if(-1===s)return[];const i=Math.floor(s/4),o=s%4,r=i-1,c=i+1,l=o-1,d=o+1;return r>=0&&(l>=0&&n.push(4*r+l),n.push(4*r+o),d<4&&n.push(4*r+d)),l>=0&&n.push(4*i+l),d<4&&n.push(4*i+d),c<Math.ceil(a.length/4)&&(l>=0&&n.push(4*c+l),n.push(4*c+o),d<4&&n.push(4*c+d)),n.map(e=>a[e])},this.handleMouseUp=()=>{this.setState({sticker:null}),K.a.clientUpdate({"@type":"clientUpdateStickerPreview",sticker:null}),this.mouseDown=!1,document.removeEventListener("mouseup",this.handleMouseUp)},this.handleMouseEnter=e=>{const t=Number(e.currentTarget.dataset.stickerId),a=this.getSticker(t);a&&this.mouseDown&&(this.setState({sticker:a}),K.a.clientUpdate({"@type":"clientUpdateStickerPreview",sticker:a}),this.loadPreviewContent(t))},this.handleMouseDown=e=>{const t=Number(e.currentTarget.dataset.stickerId),a=this.getSticker(t);if(a)return this.setState({sticker:a}),K.a.clientUpdate({"@type":"clientUpdateStickerPreview",sticker:a}),this.loadPreviewContent(t),this.mouseDown=!0,document.addEventListener("mouseup",this.handleMouseUp),e.preventDefault(),e.stopPropagation(),!1},this.state={stickerSet:Zi.a.stickerSet,stickerId:0}}shouldComponentUpdate(e,t,a){const n=this.state,s=n.stickerSet,i=n.sticker;return s!==t.stickerSet||i!==t.sticker}componentDidMount(){Zi.a.on("clientUpdateStickerSet",this.handleClientUpdateStickerSet),Zi.a.on("updateInstalledStickerSets",this.handleUpdateInstalledStickerSets)}componentWillUnmount(){Zi.a.off("clientUpdateStickerSet",this.handleClientUpdateStickerSet),Zi.a.off("updateInstalledStickerSets",this.handleUpdateInstalledStickerSets)}getSticker(e){const t=this.state.stickerSet;if(!t)return null;const a=t.stickers,n=a.findIndex(t=>t.sticker.id===e);return-1!==n?a[n]:null}render(){const e=this.props.t,t=this.state,a=t.stickerSet,n=t.sticker;if(!a)return null;const s=a.title,i=a.stickers,o=a.is_installed,c=i.map(e=>r.a.createElement("div",{className:"sticker-set-dialog-item",key:e.sticker.id,"data-sticker-id":e.sticker.id,style:{width:76,height:76},onMouseEnter:this.handleMouseEnter,onMouseDown:this.handleMouseDown},r.a.createElement(Lr.b,{key:e.sticker.id,className:"sticker-set-dialog-item-sticker",sticker:e,autoplay:!1,blur:!1,displaySize:p.mb,preview:!0,source:Lr.a.STICKER_SET}),r.a.createElement("div",{className:"sticker-set-dialog-item-emoji"},e.emoji)));return r.a.createElement(y.a,{className:"sticker-set-dialog",open:!0,transitionDuration:0,onClose:this.handleClose,"aria-labelledby":"sticker-set-dialog-title-text",classes:{paper:"sticker-set-dialog-paper"}},r.a.createElement(E.a,{id:"sticker-set-dialog-title-text",className:l()({"sticker-set-dialog-disabled":Boolean(n)}),disableTypography:!0},r.a.createElement(Ce.a,{variant:"h6",className:"sticker-set-dialog-title-typography",noWrap:!0},s),r.a.createElement(dc,{className:"sticker-set-dialog-share-button"})),r.a.createElement(On.a,{classes:{root:"sticker-set-dialog-content-root"},onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut},c),r.a.createElement(v.a,{className:l()({"sticker-set-dialog-disabled":Boolean(n)})},r.a.createElement(b.a,{color:"primary",onClick:this.handleClose},e("Cancel")),r.a.createElement(b.a,{color:"primary",onClick:this.handleDone},e(o?"StickersRemove":"Add"))),r.a.createElement($r.a,{sticker:n}))}}var uc=Object(f.d)()(hc);a(533);class pc extends o.Component{constructor(e){super(e),this.onClientUpdateDocumentBlob=e=>{const t=this.state.wallpaper;if(!t)return;const a=t.document;if(!a)return;const n=a.document;if(!n)return;const s=e.fileId;if(n.id===s){if(this.thumbnailTime&&this.thumbnailTime.wallpaper===t){if(new Date-this.thumbnailTime.time<250)return void setTimeout(()=>{this.forceUpdate()},250)}this.forceUpdate()}},this.onClientUpdateDocumentThumbnailBlob=e=>{const t=this.state.wallpaper;if(!t)return;const a=t.document;if(!a)return;const n=a.thumbnail;if(!n)return;const s=n.photo;if(!s)return;const i=e.fileId;s.id===i&&(this.thumbnailTime={wallpaper:t,time:new Date},this.forceUpdate())},this.onClientUpdateChatBackground=e=>{const t=e.wallpaper;this.thumbnailTime={wallpaper:t,time:new Date},this.setState({wallpaper:t})},this.onUpdateChatDetailsVisibility=e=>{this.forceUpdate()},this.onClientUpdateChatId=e=>{this.setState({chatId:e.nextChatId,messageId:e.nextMessageId})},this.scrollToBottom=()=>{this.messagesList.scrollToBottom()},this.scrollToStart=()=>{this.messagesList.scrollToStart()},this.scrollToMessage=()=>{this.messagesList.scrollToMessage()},this.state={chatId:Z.a.getChatId(),messageId:Z.a.getMessageId(),selectedCount:0,wallpaper:null,wallpaperSrc:null}}shouldComponentUpdate(e,t){const a=this.state,n=a.chatId,s=a.messageId,i=a.selectedCount,o=a.wallpaper;return t.chatId!==n||(t.messageId!==s||(t.selectedCount!==i||t.wallpaper!==o))}componentDidMount(){Z.a.on("clientUpdateChatDetailsVisibility",this.onUpdateChatDetailsVisibility),Z.a.on("clientUpdateChatId",this.onClientUpdateChatId),L.a.on("clientUpdateChatBackground",this.onClientUpdateChatBackground),P.a.on("clientUpdateDocumentThumbnailBlob",this.onClientUpdateDocumentThumbnailBlob),P.a.on("clientUpdateDocumentBlob",this.onClientUpdateDocumentBlob)}componentWillUnmount(){Z.a.off("clientUpdateChatDetailsVisibility",this.onUpdateChatDetailsVisibility),Z.a.off("clientUpdateChatId",this.onClientUpdateChatId),L.a.off("clientUpdateChatBackground",this.onClientUpdateChatBackground),P.a.off("clientUpdateDocumentThumbnailBlob",this.onClientUpdateDocumentThumbnailBlob),P.a.off("clientUpdateDocumentBlob",this.onClientUpdateDocumentBlob)}render(){const e=this.state,t=e.chatId,a=e.messageId,n=e.wallpaper,s=Z.a.isChatDetailsVisible;let i=null,o=null;if(n){const e=n.document;if(e){const t=e.thumbnail,a=e.document;a&&(o=Object(T.j)(a)),!o&&t&&(o=Object(T.j)(t.photo))}i={backgroundImage:o?"url(".concat(o,")"):null}}return r.a.createElement("div",{className:l()("dialog-details",{"dialog-details-third-column":s}),style:i},r.a.createElement(cr,null),r.a.createElement(ko,{chatId:t}),r.a.createElement(sc,{ref:e=>this.messagesList=e,chatId:t,messageId:a}),r.a.createElement(ao,{chatId:t}),r.a.createElement(uc,null),r.a.createElement($s,null))}}var mc=pc;const gc=r.a.createContext(null);var fc=gc;function bc(e){class t extends r.a.Component{render(){return r.a.createElement(gc.Consumer,null,t=>r.a.createElement(e,Object.assign({iv:t},this.props)))}}return t.displayName="WithIV(".concat(Object(d.b)(e),")"),t}function Cc(e){return function(e){if(!e)return null;if(e instanceof String)return e;switch(e["@type"]){case"richTextAnchor":{const t=e.name,a=e.text;return r.a.createElement(ml,{text:a,name:t})}case"richTextBold":{const t=e.text;return r.a.createElement(tl,{text:t})}case"richTextEmailAddress":{const t=e.email_address,a=e.text;return r.a.createElement(al,{emailAddress:t,text:a})}case"richTextFixed":{const t=e.text;return r.a.createElement(nl,{text:t})}case"richTextIcon":{const t=e.document,a=e.height,n=e.width;return r.a.createElement(il,{document:t,height:a,width:n})}case"richTextItalic":{const t=e.text;return r.a.createElement(ol,{text:t})}case"richTextMarked":{const t=e.text;return r.a.createElement(rl,{text:t})}case"richTextPhoneNumber":{const t=e.phone_number,a=e.text;return r.a.createElement(cl,{phoneNumber:t,text:a})}case"richTextPlain":{const t=e.text;return r.a.createElement(dl,{text:t})}case"richTextStrikethrough":{const t=e.text;return r.a.createElement(hl,{text:t})}case"richTextSubscript":{const t=e.text;return r.a.createElement(ul,{text:t})}case"richTextSuperscript":{const t=e.text;return r.a.createElement(pl,{text:t})}case"richTexts":{const t=e.texts;return r.a.createElement(gl,{texts:t})}case"richTextUnderline":{const t=e.text;return r.a.createElement(fl,{text:t})}case"richTextUrl":{const t=e.text,a=e.url;return r.a.createElement(Cl,{text:t,url:a})}}return"[".concat(e["@type"],"]")}(e.text)}Cc.propTypes={text:mt.a.object.isRequired};var yc=Cc;var vc=function(e){return r.a.createElement("a",{id:e.name})};var Ec=function(e){const t=e.text,a=e.credit,n=!_l(t),s=!_l(a);return n||s?r.a.createElement("figcaption",null,n&&r.a.createElement(yc,{text:t}),s&&r.a.createElement("cite",null,r.a.createElement(yc,{text:a}))):null};var Uc=function(e){const t=e.animation,a=e.block,n=e.caption,s=(e.need_autoplay,e.openMedia);return r.a.createElement("figure",null,r.a.createElement(xr.a,{iv:!0,pageBlock:a,animation:t,displaySize:p.j,openMedia:s}),r.a.createElement(Ec,{text:n.text,credit:n.credit}))},Sc=a(303);var kc=function(e){const t=e.author,a=e.publishDate,n=!_l(t),s=a>0;if(!n&&!s)return null;const i=a>0?new Date(1e3*a):null;return r.a.createElement("address",null,n&&r.a.createElement("a",{rel:"author"},r.a.createElement(yc,{text:t})),n&&s&&" \u2022 ",s&&r.a.createElement("time",{dateTime:i.toISOString()},Object(Sc.a)(i,"dd mmm, yyyy")))};var Mc=function(e){const t=e.text,a=e.credit;return r.a.createElement("blockquote",null,r.a.createElement(yc,{text:t}),a&&r.a.createElement("cite",null,r.a.createElement(yc,{text:a})))};var Ic=bc((function(e){const t=e.pageBlocks,a=e.caption,n=e.iv;return r.a.createElement("div",{className:"collage"},t.map((e,t)=>wl(e,n,t)),r.a.createElement(Ec,{text:a.text,credit:a.credit}))}));function wc(e){return wl(e.cover,e.iv)}wc.propTypes={cover:mt.a.object.isRequired};var _c=bc(wc);var xc=bc((function(e){const t=e.header,a=e.pageBlocks,n=e.isOpen,s=e.iv;return r.a.createElement("details",{open:n},r.a.createElement("summary",null,r.a.createElement(yc,{text:t})),a.map((e,t)=>wl(e,s,t)))}));var Oc=function(){return r.a.createElement("hr",null)},Tc=a(534);class Lc extends r.a.Component{constructor(e){super(e),this.updateIframe=e=>{if(e.src)return;const t=e.content||e.children;if(!t)return;const a=this.frameRef.current;if(!a)return;const n=a.contentDocument;n&&("string"===typeof t?(n.open(),n.write(t),n.close()):(n.open(),n.write('<div id="iframe-root"></div>'),n.close(),sr.a.render(t,n.getElementById("iframe-root"))))},this.injectIframeResizerUrl=()=>{if(!this.props.iframeResizerUrl)return;const e=this.frameRef.current;if(!e)return;const t=e.contentDocument;if(!t)return;let a=null;if(["head","HEAD","body","BODY","div","DIV"].forEach(e=>{if(a)return;const n=t.getElementsByTagName(e);n&&n.length&&(a=n[0])}),!a)return void console.error("Unable to inject iframe resizer script");const n=document.createElement("script");n.type="text/javascript",n.src=this.props.iframeResizerUrl,a.appendChild(n)},this.onLoad=()=>{this.injectIframeResizerUrl()},this.resizeIframe=e=>{const t=this.frameRef.current;t&&e.iframeResizerEnable&&Object(Tc.iframeResizer)(e.iframeResizerOptions,t)},this.frameRef=r.a.createRef()}componentDidMount(){this.updateIframe(this.props),this.resizeIframe(this.props)}componentWillUnmount(){const e=this.frameRef.current;if(!e)return;const t=e.iframeResizer;t&&t.removeListeners()}componentWillReceiveProps(e){this.updateIframe(e),this.resizeIframe(e)}render(){const e=this.props,t=e.src,a=e.id,n=e.frameBorder,s=e.className,i=e.style;return r.a.createElement("iframe",{ref:this.frameRef,src:t,id:a,frameBorder:n,className:s,style:i,onLoad:this.onLoad})}}Lc.defaultProps={iframeResizerEnable:!0,iframeResizerOptions:{},iframeResizerUrl:"https://cdnjs.cloudflare.com/ajax/libs/iframe-resizer/3.5.8/iframeResizer.contentWindow.min.js",frameBorder:0,style:{width:"100%",minHeight:20}};var Pc=Lc;class Nc extends r.a.Component{constructor(...e){super(...e),this.state={}}static getDerivedStateFromProps(e,t){return e.url!==t.prevUrl||e.html!==t.prevHtml?{url:null,html:null,prevUrl:e.url,prevHtml:e.html}:null}componentDidMount(){this.setIframeSource()}componentDidUpdate(e,t,a){const n=this.props,s=n.url,i=n.html;s===e.url&&i===e.html||this.setIframeSource()}setIframeSource(){const e=this.props,t=e.url,a=e.html;this.setState({url:t,html:a})}render(){const e=this.state,t=e.url,a=e.html,n=this.props,s=n.width,i=n.height,o=n.caption,c=n.isFullWidth,l=n.allowScrolling,d={scrolling:l},h=s>0&&i>0,u=Boolean(t)||Boolean(a);return r.a.createElement("figure",null,u&&r.a.createElement(r.a.Fragment,null,h?r.a.createElement("iframe",{src:t||null,srcDoc:t?null:a,width:s>0?s:null,height:i>0?i:null,allowFullScreen:c,scrolling:l?"auto":"no",frameBorder:0}):r.a.createElement(Pc,{content:a,src:t,iframeResizerOptions:d,style:{width:"100%"}})),r.a.createElement(Ec,{text:o.text,credit:o.credit}))}}var Dc=Nc;var jc=bc((function(e){e.url;const t=e.author,a=(e.authorPhoto,e.date),n=e.pageBlocks,s=e.caption,i=e.iv;return r.a.createElement("blockquote",null,r.a.createElement("figure",null,Boolean(t)&&r.a.createElement("h3",null,t),r.a.createElement(kc,{author:null,publishDate:a}),n.map((e,t)=>wl(e,i,t)),r.a.createElement(Ec,{text:s.text,credit:s.credit})))}));a(538);class Bc extends r.a.Component{constructor(...e){super(...e),this.state={error:null,errorInfo:null}}componentDidCatch(e,t){this.setState({error:e,errorInfo:t})}render(){const e=this.props.children,t=this.state,a=t.error,n=t.errorInfo;return a||n?r.a.createElement("div",{className:"error-handler"},r.a.createElement("span",null,r.a.createElement("pre",null,"".concat(a.name,": ").concat(a.message),n.componentStack))):e}}var Rc=Bc;var Fc=function(e){return r.a.createElement("footer",null,r.a.createElement(yc,{text:e.footer}))};var Ac=function(e){return r.a.createElement("h3",null,r.a.createElement(yc,{text:e.header}))};var Vc=function(e){const t=e.kicker;return r.a.createElement("h6",{className:"kicker"},r.a.createElement(yc,{text:t}))};var zc=bc((function(e){return r.a.createElement("li",{"data-before":e.label},e.pageBlocks.map((t,a)=>wl(t,e.iv,a)))}));var Hc=function(e){return r.a.createElement("ul",null,e.items.map((e,t)=>r.a.createElement(zc,{key:t,label:e.label,pageBlocks:e.page_blocks})))};var Wc=function(e){return r.a.createElement("p",null,r.a.createElement(yc,{text:e.text}))};var Gc=function(e){const t=e.photo,a=e.caption,n=(e.url,e.openMedia);return r.a.createElement("figure",null,r.a.createElement(Nt.a,{photo:t,size:p.k,displaySize:p.j,openMedia:n}),r.a.createElement(Ec,{text:a.text,credit:a.credit}))};var Zc=function(e){return r.a.createElement("pre",null,r.a.createElement(yc,{text:e.text}))};var qc=function(e){const t=e.text,a=e.credit;return r.a.createElement("aside",null,r.a.createElement(yc,{text:t}),a&&r.a.createElement("cite",null,r.a.createElement(yc,{text:a})))};class Kc extends r.a.Component{constructor(...e){super(...e),this.handleClick=e=>{e.preventDefault(),e.stopPropagation();const t=this.props.url;K.a.clientUpdate({"@type":"clientUpdateInstantViewUrl",url:t})}}render(){const e=this.props,t=e.author,a=(e.description,e.publishDate),n=e.title,s=e.url,i=a>0?new Date(1e3*a):null,o=t&&i,c=i||t;return r.a.createElement("li",null,r.a.createElement(Dt.a,{url:s,onClick:this.handleClick},n),c&&r.a.createElement("address",null,t,o&&" \u2022 ",i&&r.a.createElement("time",{dateTime:i.toISOString()},Object(Sc.a)(i,"dd mmm, yyyy"))))}}var Yc=Kc;var Jc=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h4",null,r.a.createElement(yc,{text:e.header})),r.a.createElement("ul",{className:"related-articles"},e.articles.map(e=>r.a.createElement(Yc,{key:e.url,url:e.url,title:e.title,description:e.description,photo:e.photo,author:e.author,publishDate:e.publish_date}))))};var Qc=bc((function(e){const t=e.pageBlocks,a=e.caption,n=e.iv;return r.a.createElement("div",{className:"slideshow"},t.map((e,t)=>wl(e,n,t)),r.a.createElement(Ec,{text:a.text,credit:a.credit}))}));var Xc=function(e){return r.a.createElement("h4",null,r.a.createElement(yc,{text:e.subheader}))};var $c=function(e){return r.a.createElement("h2",null,r.a.createElement(yc,{text:e.subtitle}))};var el=function(e){return r.a.createElement("h1",null,r.a.createElement(yc,{text:e.title}))};var tl=function(e){return r.a.createElement("b",null,r.a.createElement(yc,{text:e.text}))};var al=function(e){return r.a.createElement("a",{href:"mailto:".concat(e.emailAddress)},r.a.createElement(yc,{text:e.text}))};var nl=function(e){return r.a.createElement("code",null,r.a.createElement(yc,{text:e.text}))};class sl extends r.a.Component{constructor(...e){super(...e),this.onClientUpdateDocumentThumbnailBlob=e=>{const t=this.props.document;if(!t)return;const a=t.thumbnail;if(!a)return;const n=a.photo;if(!n)return;const s=e.fileId;n.id===s&&this.forceUpdate()},this.onClientUpdateDocumentBlob=e=>{const t=this.props.document;if(!t)return;const a=t.document;if(!a)return;const n=e.fileId;a.id===n&&this.forceUpdate()}}componentDidMount(){P.a.on("clientUpdateDocumentThumbnailBlob",this.onClientUpdateDocumentThumbnailBlob),P.a.on("clientUpdateDocumentBlob",this.onClientUpdateDocumentBlob)}componentWillUnmount(){P.a.off("clientUpdateDocumentThumbnailBlob",this.onClientUpdateDocumentThumbnailBlob),P.a.off("clientUpdateDocumentBlob",this.onClientUpdateDocumentBlob)}emptyPlaceholderSrc(e,t){return'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 '.concat(e," ").concat(t,'"%3E%3C/svg%3E')}render(){const e=this.props,t=e.document,a=e.height,n=e.width;if(!t)return null;const s=t.thumbnail,i=t.document,o=Object(T.j)(s?s.photo:null),c=Object(T.j)(i);return r.a.createElement("img",{src:c||o||this.emptyPlaceholderSrc(1,1),width:n>0?n:null,height:a>0?a:null,draggable:!1,alt:""})}}var il=sl;var ol=function(e){return r.a.createElement("i",null,r.a.createElement(yc,{text:e.text}))};var rl=function(e){return r.a.createElement("mark",null,r.a.createElement(yc,{text:e.text}))};var cl=function(e){return r.a.createElement("a",{href:"tel:".concat(e.phoneNumber)},r.a.createElement(yc,{text:e.text}))};function ll(e){return e.text}ll.propTypes={text:mt.a.string.isRequired};var dl=ll;var hl=function(e){return r.a.createElement("del",null,r.a.createElement(yc,{text:e.text}))};var ul=function(e){return r.a.createElement("sub",null,r.a.createElement(yc,{text:e.text}))};var pl=function(e){return r.a.createElement("sup",null,r.a.createElement(yc,{text:e.text}))};var ml=function(e){return r.a.createElement("a",{id:e.name},r.a.createElement(yc,{text:e.text}))};var gl=function(e){return r.a.createElement(r.a.Fragment,null,e.texts.map((e,t)=>r.a.createElement(yc,{key:t,text:e})))};var fl=function(e){return r.a.createElement("ins",null,r.a.createElement(yc,{text:e.text}))};class bl extends r.a.Component{constructor(...e){super(...e),this.handleClick=e=>{e.preventDefault(),e.stopPropagation();const t=this.props.url;K.a.clientUpdate({"@type":"clientUpdateInstantViewUrl",url:t})}}render(){const e=this.props,t=e.text,a=e.url;return r.a.createElement(Dt.a,{url:a,onClick:this.handleClick},r.a.createElement(yc,{text:t}))}}var Cl=bl;var yl=bc((function(e){const t=e.caption,a=e.cells,n=e.isBordered,s=e.isStriped,i=e.iv;return r.a.createElement("table",{striped:s?"":null,border:n?1:0},!_l(t)&&r.a.createElement("caption",null,r.a.createElement(yc,{text:t})),r.a.createElement("tbody",null,a.map((e,t)=>r.a.createElement("tr",{key:t},e.map((e,t)=>wl(e,i,t))))))}));var vl=function(e){const t=e.text,a=e.isHeader,n=e.colspan,s=e.rowspan,i=e.align,o=e.valign;if(_l(t))return null;const c={colSpan:n,rowSpan:s,align:xl(i),valign:Ol(o)},l=r.a.createElement(yc,{text:t});return a?r.a.createElement("th",c,l):r.a.createElement("td",c,l)},El=a(322);var Ul=function(e){const t=e.location,a=e.caption;return r.a.createElement("figure",null,r.a.createElement(El.a,{width:p.i,height:p.h,location:t}),r.a.createElement(Ec,{text:a.text,credit:a.credit}))};var Sl=function(e){const t=e.audio,a=e.caption,n=e.openMedia;return r.a.createElement("figure",null,r.a.createElement(Or.a,{audio:t,displaySize:p.D,openMedia:n}),r.a.createElement(Ec,{text:a.text,credit:a.credit}))};var kl=function(e){return r.a.createElement("div",null)};var Ml=function(e){const t=e.video,a=e.caption,n=(e.needAutoplay,e.isLooped,e.openMedia);return r.a.createElement("figure",null,r.a.createElement(Pr.a,{video:t,displaySize:p.j,openMedia:n}),r.a.createElement(Ec,{text:a.text,credit:a.credit}))};function Il(e,t,a,n,s){if(!e)return;switch(e["@type"]){case"animation":{let i=e.animation;if(!i)return;if(i=P.a.get(i.id)||i,s&&i.local.is_downloading_active)return void P.a.cancelGetRemoteFile(i.id,e);if(s&&i.remote.is_uploading_active)return void P.a.cancelUploadFile(i.id,e);Object(T.b)(i,e,P.a.updateAnimationBlob(0,0,i.id)),Object(G.o)({media:e,caption:t,block:a,instantView:n});break}case"audio":{let t=e.audio;if(!t)return;if(t=P.a.get(t.id)||t,s&&t.local.is_downloading_active)return void P.a.cancelGetRemoteFile(t.id,e);if(s&&t.remote.is_uploading_active)return void P.a.cancelUploadFile(t.id,e);Object(T.b)(t,e,P.a.updateAudioBlob(0,0,t.id)),K.a.clientUpdate({"@type":"clientUpdateMediaActive",instantView:n,block:a});break}case"photo":Object(G.o)({media:e,caption:t,block:a,instantView:n});break;case"video":{let i=e.video;if(!i)return;if(i=P.a.get(i.id)||i,s&&i.local.is_downloading_active)return void P.a.cancelGetRemoteFile(i.id,e);if(s&&i.remote.is_uploading_active)return void P.a.cancelUploadFile(i.id,e);Object(T.b)(i,e,P.a.updateVideoBlob(0,0,i.id)),Object(G.o)({media:e,caption:t,block:a,instantView:n});break}}}function wl(e,t,a){if(!e)return null;let n=null;switch(e["@type"]){case"pageBlockAnchor":n=r.a.createElement(vc,{name:e.name});break;case"pageBlockAnimation":n=r.a.createElement(Uc,{block:e,caption:e.caption,animation:e.animation,needAutoplay:e.need_autoplay,openMedia:()=>Il(e.animation,e.caption,e,t,!0)});break;case"pageBlockAudio":n=r.a.createElement(Sl,{caption:e.caption,audio:e.audio,openMedia:()=>Il(e.audio,e.caption,e,t,!0)});break;case"pageBlockAuthorDate":n=r.a.createElement(kc,{author:e.author,publishDate:e.publish_date});break;case"pageBlockBlockQuote":n=r.a.createElement(Mc,{credit:e.credit,text:e.text});break;case"pageBlockCollage":n=r.a.createElement(Ic,{pageBlocks:e.page_blocks,caption:e.caption});break;case"pageBlockChatLink":n=r.a.createElement(kl,{title:e.title,photo:e.photo,username:e.username});break;case"pageBlockCover":n=r.a.createElement(_c,{cover:e.cover});break;case"pageBlockDetails":n=r.a.createElement(xc,{header:e.header,pageBlocks:e.page_blocks,isOpen:e.is_open});break;case"pageBlockDivider":n=r.a.createElement(Oc,null);break;case"pageBlockEmbedded":n=r.a.createElement(Dc,{url:e.url,html:e.html,posterPhoto:e.poster_photo,width:e.width,height:e.height,caption:e.caption,isFullWidth:e.is_full_width,allowScrolling:e.allow_scrolling});break;case"pageBlockEmbeddedPost":n=r.a.createElement(jc,{url:e.url,author:e.author,authorPhoto:e.author_photo,date:e.date,pageBlocks:e.page_blocks,caption:e.caption});break;case"pageBlockFooter":n=r.a.createElement(Fc,{footer:e.footer});break;case"pageBlockHeader":n=r.a.createElement(Ac,{header:e.header});break;case"pageBlockKicker":n=r.a.createElement(Vc,{kicker:e.kicker});break;case"pageBlockList":n=r.a.createElement(Hc,{items:e.items});break;case"pageBlockListItem":n=r.a.createElement(zc,{label:e.label,pageBlocks:e.page_blocks});break;case"pageBlockMap":n=r.a.createElement(Ul,{location:e.location,zoom:e.zoom,width:e.width,height:e.height,caption:e.caption});break;case"pageBlockParagraph":n=r.a.createElement(Wc,{text:e.text});break;case"pageBlockPhoto":n=r.a.createElement(Gc,{caption:e.caption,photo:e.photo,url:e.url,openMedia:()=>Il(e.photo,e.caption,e,t,!0)});break;case"pageBlockPreformatted":n=r.a.createElement(Zc,{text:e.text,language:e.language});break;case"pageBlockPullQuote":n=r.a.createElement(qc,{credit:e.credit,text:e.text});break;case"pageBlockRelatedArticle":n=r.a.createElement(Yc,{url:e.url,title:e.title,description:e.description,photo:e.photo,author:e.author,publishDate:e.publish_date});break;case"pageBlockRelatedArticles":n=r.a.createElement(Jc,{header:e.header,articles:e.articles});break;case"pageBlockSlideshow":n=r.a.createElement(Qc,{pageBlocks:e.page_blocks,caption:e.caption});break;case"pageBlockSubheader":n=r.a.createElement(Xc,{subheader:e.subheader});break;case"pageBlockSubtitle":n=r.a.createElement($c,{subtitle:e.subtitle});break;case"pageBlockTable":n=r.a.createElement(yl,{caption:e.caption,cells:e.cells,isBordered:e.is_bordered,isStriped:e.is_striped});break;case"pageBlockTableCell":n=r.a.createElement(vl,{text:e.text,isHeader:e.is_header,colspan:e.colspan,rowspan:e.rowspan,align:e.align,valign:e.valign});break;case"pageBlockTitle":n=r.a.createElement(el,{title:e.title});break;case"pageBlockVideo":n=r.a.createElement(Ml,{caption:e.caption,video:e.video,needAutoplay:e.need_autoplay,isLooped:e.is_looped,openMedia:()=>Il(e.video,e.caption,e,t,!0)})}return n?r.a.createElement(Rc,{key:a},n):r.a.createElement("div",null,"[".concat(e["@type"],"]"))}function _l(e){if(!e)return!0;switch(e["@type"]){case"richTextAnchor":case"richTextBold":case"richTextEmailAddress":case"richTextFixed":return _l(e.text);case"richTextIcon":return!1;case"richTextItalic":case"richTextMarked":case"richTextPhoneNumber":case"richTextPlain":case"richTextStrikethrough":case"richTextSubscript":case"richTextSuperscript":return _l(e.text);case"richTexts":return e.texts.every(_l);case"richTextUnderline":case"richTextUrl":return _l(e.text)}return!1}function xl(e){if(!e)return null;switch(e["@type"]){case"pageBlockHorizontalAlignmentCenter":return"center";case"pageBlockHorizontalAlignmentLeft":return"left";case"pageBlockHorizontalAlignmentRight":return"right"}return null}function Ol(e){if(!e)return null;switch(e["@type"]){case"pageBlockVerticalAlignmentBottom":return"bottom";case"pageBlockVerticalAlignmentMiddle":return"middle";case"pageBlockVerticalAlignmentTop":return"top"}return null}function Tl(e){if(!e)return[];switch(e["@type"]){case"pageBlockAnchor":return[];case"pageBlockAnimation":case"pageBlockAudio":return[e.caption];case"pageBlockAuthorDate":case"pageBlockBlockQuote":case"pageBlockChatLink":return[];case"pageBlockCollage":{const t=e.page_blocks.map(e=>[e,...Tl(e)]);return[].concat.apply([],t)}case"pageBlockCover":return[e.cover];case"pageBlockDetails":{const t=e.page_blocks.map(e=>[e,...Tl(e)]);return[].concat.apply([],t)}case"pageBlockDivider":return[];case"pageBlockEmbedded":return[e.caption];case"pageBlockEmbeddedPost":{const t=e.page_blocks.map(e=>[e,...Tl(e)]);return[].concat.apply([e.caption],t)}case"pageBlockFooter":case"pageBlockHeader":case"pageBlockKicker":return[];case"pageBlockList":{const t=e.items.map(e=>[e,...Tl(e)]);return[].concat.apply([],t)}case"pageBlockListItem":{const t=e.page_blocks.map(e=>[e,...Tl(e)]);return[].concat.apply([],t)}case"pageBlockMap":return[e.caption];case"pageBlockParagraph":return[];case"pageBlockPhoto":return[e.caption];case"pageBlockPreformatted":case"pageBlockPullQuote":case"pageBlockRelatedArticle":return[];case"pageBlockRelatedArticles":return[...e.articles];case"pageBlockSlideshow":{const t=e.page_blocks.map(e=>[e,...Tl(e)]);return[].concat.apply([e.caption],t)}case"pageBlockSubheader":case"pageBlockSubtitle":return[];case"pageBlockTable":return[...e.cells];case"pageBlockTableCell":case"pageBlockTitle":return[];case"pageBlockVideo":return[e.caption]}return[]}function Ll(e){if(!e)return null;switch(e["@type"]){case"pageBlockAnimation":return e.animation;case"pageBlockPhoto":return e.photo;case"pageBlockVideo":return e.video}return null}function Pl(e){if(!e)return!1;switch(e["@type"]){case"pageBlockAnimation":case"pageBlockPhoto":case"pageBlockVideo":return!0}return!1}a(539);class Nl extends r.a.PureComponent{render(){const e=this.props,t=e.forwardedRef,a=e.iv;if(!a)return null;const n=a.page_blocks,s=a.is_rtl;if(!n)return;const i=n.map((e,t)=>wl(e,a,t));return r.a.createElement("article",{ref:t,dir:s?"rtl":"ltr"},i)}}var Dl=Object(d.a)(Object(d.d)(),bc)(Nl),jl=Object(S.a)(r.a.createElement("path",{d:"M9.91421356,11.5 L16.2071068,5.20710678 C16.5976311,4.81658249 16.5976311,4.18341751 16.2071068,3.79289322 C15.8165825,3.40236893 15.1834175,3.40236893 14.7928932,3.79289322 L7.79289322,10.7928932 C7.40236893,11.1834175 7.40236893,11.8165825 7.79289322,12.2071068 L14.7928932,19.2071068 C15.1834175,19.5976311 15.8165825,19.5976311 16.2071068,19.2071068 C16.5976311,18.8165825 16.5976311,18.1834175 16.2071068,17.7928932 L9.91421356,11.5 Z"}),"Left"),Bl=Object(S.a)(r.a.createElement("path",{d:"M11.8025478,4.79529691 C11.8025478,3.93005081 12.5039683,3.22863025 13.3692144,3.22863025 C13.7633775,3.22863025 14.1430567,3.37720768 14.4325315,3.64473128 L22.2284036,10.8494344 C22.8638434,11.4366882 22.9029059,12.4278772 22.2883553,13.0917108 L22.2284036,13.1505656 L14.4325315,20.3552687 C13.7970916,20.9425225 12.8059026,20.90346 12.2186488,20.2680201 C11.9511252,19.9785454 11.8025478,19.5988662 11.8025478,19.2047031 L11.8025478,16.4249931 C8.21922017,16.6092505 5.79479016,17.8111183 4.43312712,19.9909578 L4.29164834,20.2262356 C3.95336498,20.8131459 3.20334729,21.0146979 2.61643694,20.6764146 C2.24185558,20.4605134 2.00860424,20.0633528 2.00249611,19.6310483 C1.8981509,12.2459874 5.13388305,8.13673748 11.4825227,7.6491321 L11.8025478,7.62777147 L11.8025478,4.79529691 Z M13.8025478,5.78581808 L13.8025478,8.6 C13.8025478,9.15228475 13.3548325,9.6 12.8025478,9.6 C7.49232524,9.6 4.65375859,12.0566924 4.1006582,17.2535243 C6.09650127,15.345115 9.01935671,14.4 12.8025478,14.4 C13.3548325,14.4 13.8025478,14.8477153 13.8025478,15.4 L13.8025478,18.2142808 L20.5271714,12.0005066 L13.8025478,5.78581808 Z"}),"Share");a(540);class Rl extends r.a.Component{constructor(...e){super(...e),this.handleClick=e=>{e.stopPropagation()}}render(){const e=this.props.text;return r.a.createElement("div",{className:"media-caption",onClick:this.handleClick},r.a.createElement("div",{className:"media-caption-text"},e))}}Rl.defaultProps={};var Fl=Rl;class Al extends r.a.Component{constructor(e){super(e),this.onClientUpdateMediaBlob=e=>{const t=e.fileId,a=this.state.file;a&&a.id===t&&this.forceUpdate()},this.onClientUpdateMediaThumbnailBlob=e=>{const t=e.fileId,a=this.state.thumbnail;a&&a.id===t&&this.forceUpdate()},this.videoRef=r.a.createRef(),this.state={}}static getDerivedStateFromProps(e,t){const a=e.media,n=e.size;e.caption,e.url;if(a!==t.prevMedia){let e=Object(T.l)(a,n),t=Object(g.a)(e,3),s=t[0],i=t[1],o=t[2];o=P.a.get(o.id)||o;let r=Object(T.m)(a),c=Object(g.a)(r,3),l=c[0],d=c[1],h=c[2];return h=P.a.get(h.id)||h,{prevMedia:a,speed:1,isPlaying:!1,width:s,height:i,file:o,thumbnailWidth:l,thumbnailHeight:d,thumbnail:h}}return null}componentDidMount(){P.a.on("clientUpdatePhotoBlob",this.onClientUpdateMediaBlob),P.a.on("clientUpdateVideoBlob",this.onClientUpdateMediaBlob),P.a.on("clientUpdateAnimationBlob",this.onClientUpdateMediaBlob),P.a.on("clientUpdateVideoThumbnailBlob",this.onClientUpdateMediaThumbnailBlob),P.a.on("clientUpdateAnimationThumbnailBlob",this.onClientUpdateMediaThumbnailBlob)}componentWillUnmount(){P.a.off("clientUpdatePhotoBlob",this.onClientUpdateMediaBlob),P.a.off("clientUpdateVideoBlob",this.onClientUpdateMediaBlob),P.a.off("clientUpdateAnimationBlob",this.onClientUpdateMediaBlob),P.a.off("clientUpdateVideoThumbnailBlob",this.onClientUpdateMediaThumbnailBlob),P.a.off("clientUpdateAnimationThumbnailBlob",this.onClientUpdateMediaThumbnailBlob)}render(){const e=this.props,t=e.media,a=e.caption,n=e.url;if(!t)return null;const s=this.state,i=s.width,o=s.height,c=s.file,d=s.thumbnailWidth,h=s.thumbnailHeight,u=s.thumbnail,p=s.isPlaying;if(!c)return null;const m=P.a.getBlob(c.id)||c.blob,g=P.a.getBlobUrl(m)||"",f=u?P.a.getBlob(u.id)||u.blob:null,b=P.a.getBlobUrl(f),C=Object(Et.k)({width:d,height:h});let y=i,v=o;if(Math.max(y,v)>640){const e=640/Math.max(y,v);y=y>v?640:Math.floor(y*e),v=v>y?640:Math.floor(v*e)}let E=null;switch(t["@type"]){case"video":E=r.a.createElement("div",{className:"media-viewer-content-wrapper"},r.a.createElement("video",{ref:this.videoRef,className:"media-viewer-content-video-player",src:g,onClick:this.handleContentClick,controls:!0,autoPlay:!0,width:y,height:v,onPlay:()=>{this.setState({isPlaying:!0}),K.a.clientUpdate({"@type":"clientUpdateMediaViewerPlay"})},onCanPlay:()=>{const e=this.videoRef.current;e&&(e.volume=Ao.b.volume)},onPause:()=>{K.a.clientUpdate({"@type":"clientUpdateMediaViewerPause"})},onEnded:()=>{K.a.clientUpdate({"@type":"clientUpdateMediaViewerEnded"})},onVolumeChange:()=>{const e=this.videoRef.current;e&&K.a.clientUpdate({"@type":"clientUpdateMediaVolume",volume:e.volume})}}),!p&&(!g&&b?r.a.createElement("img",{className:l()("media-viewer-content-video-thumbnail",{"media-blurred":C}),src:b,alt:"",width:y,height:v}):r.a.createElement("div",{className:"media-viewer-content-video-thumbnail",style:{width:y,height:v}})));break;case"animation":E=r.a.createElement("div",{className:"media-viewer-content-wrapper"},r.a.createElement("video",{className:"media-viewer-content-video-player",src:g,onClick:this.handleContentClick,loop:!0,autoPlay:!0,width:y,height:v,onPlay:()=>{this.setState({isPlaying:!0})}}),!p&&(!g&&b?r.a.createElement("img",{className:l()("media-viewer-content-video-thumbnail",{"media-blurred":C}),src:b,alt:"",width:y,height:v}):r.a.createElement("div",{className:"media-viewer-content-video-thumbnail",style:{width:y,height:v}})));break;default:E=r.a.createElement("img",{className:"media-viewer-content-image",src:g,alt:"",onClick:this.handleContentClick})}return r.a.createElement("div",{className:"media-viewer-content"},E,r.a.createElement(ls.a,{file:c,zIndex:2}),a&&(!_l(a.text)||!_l(a.credit)||n)&&r.a.createElement(Fl,{text:r.a.createElement(r.a.Fragment,null,r.a.createElement(Ec,{text:a.text,credit:a.credit}),r.a.createElement(Dt.a,{url:n}))}))}}var Vl=Al;a(541);class zl extends r.a.Component{constructor(...e){super(...e),this.handleClick=e=>{e.stopPropagation();const t=this.props,a=t.disabled,n=t.onClick;a||n(e)}}render(){const e=this.props,t=e.disabled,a=e.grow,n=e.children,s=e.className,i=e.style,o=l()(t?"media-viewer-button-disabled":"media-viewer-button",{grow:a},s);return r.a.createElement("div",{className:o,style:i,onClick:this.handleClick},n)}}var Hl=zl;a(542);class Wl extends r.a.Component{render(){const e=this.props,t=e.title,a=e.subtitle,n=e.style;return r.a.createElement("div",{className:"media-viewer-footer-text",style:n},r.a.createElement("div",{className:"media-viewer-footer-text-wrapper"},r.a.createElement("span",null,t),Boolean(a)&&r.a.createElement("span",null,"\xa0",a)))}}var Gl=Wl;a(346);class Zl extends r.a.Component{constructor(...e){super(...e),this.handleClick=e=>{e.stopPropagation();const t=this.props,a=t.onClick;t.disabled||a(e)}}render(){const e=this.props,t=e.checked,a=e.children,n=e.disabled,s=e.title;return r.a.createElement("div",{className:l()("media-viewer-footer-button",{"media-viewer-footer-button-checked":t,"media-viewer-footer-button-disabled":n}),title:s,onClick:this.handleClick},a)}}var ql=Zl,Kl=a(306);class Yl extends r.a.Component{constructor(e){super(e),this.onClientUpdateMediaBlob=e=>{const t=this.state.fileId;t===e.fileId&&this.setState({disabled:Yl.saveDisabled(t)})},this.handleClick=e=>{e.stopPropagation();const t=this.props.onClick;this.state.disabled||t(e)};const t=e.fileId;this.state={prevPropsFileId:t,fileId:t,disabled:Yl.saveDisabled(t)}}static getDerivedStateFromProps(e,t){const a=e.fileId;return a!==t.prevPropsFileId?{prevPropsFileId:a,fileId:a,disabled:Yl.saveDisabled(a)}:null}componentDidMount(){P.a.on("clientUpdateAnimationBlob",this.onClientUpdateMediaBlob),P.a.on("clientUpdateChatBlob",this.onClientUpdateMediaBlob),P.a.on("clientUpdateDocumentBlob",this.onClientUpdateMediaBlob),P.a.on("clientUpdatePhotoBlob",this.onClientUpdateMediaBlob),P.a.on("clientUpdateUserBlob",this.onClientUpdateMediaBlob),P.a.on("clientUpdateVideoBlob",this.onClientUpdateMediaBlob)}componentWillUnmount(){P.a.off("clientUpdateAnimationBlob",this.onClientUpdateMediaBlob),P.a.off("clientUpdateChatBlob",this.onClientUpdateMediaBlob),P.a.off("clientUpdateDocumentBlob",this.onClientUpdateMediaBlob),P.a.off("clientUpdatePhotoBlob",this.onClientUpdateMediaBlob),P.a.off("clientUpdateUserBlob",this.onClientUpdateMediaBlob),P.a.off("clientUpdateVideoBlob",this.onClientUpdateMediaBlob)}render(){const e=this.props,t=e.title,a=e.children,n=this.state.disabled;return r.a.createElement(ql,{disabled:n,title:t,onClick:this.handleClick},a||r.a.createElement(Kl.a,null))}}Yl.saveDisabled=e=>!Boolean(P.a.getBlob(e));var Jl=Yl;a(543);class Ql extends r.a.Component{constructor(e){super(e),this.onKeyDown=e=>{39===e.keyCode?this.handlePrevious():37===e.keyCode&&this.handleNext()},this.handlePrevious=e=>{e&&e.stopPropagation();const t=this.state,a=t.index,n=t.blocks,s=a+1;this.hasPreviousMedia(a,n)&&this.setState({index:s,hasPreviousMedia:this.hasPreviousMedia(s,n),hasNextMedia:this.hasNextMedia(s,n)})},this.handleNext=e=>{e&&e.stopPropagation();const t=this.state,a=t.index,n=t.blocks,s=a-1;this.hasNextMedia(a,n)&&this.setState({index:s,hasPreviousMedia:this.hasPreviousMedia(s,n),hasNextMedia:this.hasNextMedia(s,n)})},this.handleClose=()=>{Object(G.o)(null)},this.handleForward=()=>{const e=this.props.media,t=Object(Et.e)(e,null);t&&K.a.clientUpdate({"@type":"clientUpdateForward",info:{inputMessageContent:t}})},this.handleSave=()=>{const e=this.props.media;Object(T.F)(e,null)},this.state={index:-1,hasPreviousMedia:!1,hasNextMedia:!1,blocks:[]},this.keyboardHandler=new Xa(this.onKeyDown)}componentDidMount(){this.loadContent(),$a.add(this.keyboardHandler)}componentWillUnmount(){$a.remove(this.keyboardHandler)}loadContent(){const e=this.props,t=e.iv,a=e.media,n=function(e){if(!e)return[];const t=e.page_blocks,a=[];return t.forEach(e=>{a.push(e),Tl(e).forEach(e=>{a.push(e)})}),a.filter(Pl)}(t),s=n.findIndex(e=>Ll(e)===a);this.setState({blocks:n,index:s,hasPreviousMedia:this.hasPreviousMedia(s,n),hasNextMedia:this.hasNextMedia(s,n)})}hasPreviousMedia(e,t){if(-1===e)return!1;return e+1<t.length}hasNextMedia(e,t){if(-1===e)return!1;return e-1>=0}render(){const e=this.props,t=e.size,a=e.t,n=this.state,s=n.index,i=n.blocks,o=n.hasNextMedia,c=n.hasPreviousMedia;if(!i)return null;if(-1===s)return null;const d=i[s],h=Ll(d),u=function(e){if(!e)return null;switch(e["@type"]){case"pageBlockAnimation":case"pageBlockPhoto":case"pageBlockVideo":return e.caption}return null}(d),p=function(e){if(!e)return null;switch(e["@type"]){case"pageBlockPhoto":return e.url}return null}(d),m=Object(T.l)(h,t),f=Object(g.a)(m,3),b=(f[0],f[1],f[2]);let C="";"photo"===h["@type"]&&(C=a("AttachPhoto")),"video"===h["@type"]?C=a("AttachVideo"):"animation"===h["@type"]&&(C=a("AttachGif"));const y=i.length;return r.a.createElement("div",{className:l()("instant-view-media-viewer","media-viewer-default")},r.a.createElement("div",{className:"media-viewer-footer"},r.a.createElement(Gl,{title:C,subtitle:y&&s>=0?"".concat(s+1," of ").concat(y):null,style:{marginLeft:128}}),r.a.createElement(Jl,{title:a("Save"),fileId:b.id,onClick:this.handleSave}),r.a.createElement(ql,{title:a("Forward"),onClick:this.handleForward},r.a.createElement(Bl,null)),r.a.createElement(ql,{title:a("Close"),onClick:this.handleClose},r.a.createElement(U.a,null))),r.a.createElement("div",{className:"media-viewer-wrapper"},r.a.createElement("div",{className:"media-viewer-left-column"},r.a.createElement(Hl,{disabled:!o,grow:!0,onClick:this.handleNext},r.a.createElement(jl,null))),r.a.createElement("div",{className:"media-viewer-content-column"},r.a.createElement(Vl,{media:h,size:t,caption:u,url:p})),r.a.createElement("div",{className:"media-viewer-right-column"},r.a.createElement(Hl,{disabled:!c,grow:!0,onClick:this.handlePrevious},r.a.createElement(jl,{style:{transform:"rotate(180deg)"}})))))}}var Xl=Object(d.a)(Object(f.d)(),bc)(Ql),$l=a(305);a(544);class ed extends r.a.Component{constructor(e){var t;super(e),t=this,this.onClientUpdateInstantViewViewerContent=e=>{const t=e.content;if(!t)return void this.setState({media:null,caption:null,url:null});const a=t.media,n=t.caption,s=t.url,i=t.instantView;this.props.instantView===i&&this.setState({media:a,caption:n,url:s})},this.onClientUpdateInstantViewUrl=function(){var e=Object(i.a)(s.a.mark((function e(a){var n,i,o,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("[IV] clientUpdateInstantViewUrl",a),n=a.url,i=$l.a.getCurrent(),o=t.props.instantView,i===o){e.next=6;break}return e.abrupt("return");case 6:if(!o||!n.startsWith(o.url)){e.next=15;break}if(r=new URL(n).hash,n.indexOf("#")!==n.length-1){e.next=13;break}return t.scrollTop("smooth"),e.abrupt("return");case 13:if(!r||!t.scrollToHash(r,"smooth")){e.next=15;break}return e.abrupt("return");case 15:Br(n);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.onKeyDown=e=>{if(27===e.keyCode){if(this.state.media)return void Object(G.o)(null);this.handleClose()}},this.handleBack=()=>{const e=this.state,t=e.hasPrev;e.hasScroll?this.scrollTop("smooth"):t?K.a.clientUpdate({"@type":"clientUpdatePrevInstantView"}):this.handleClose()},this.handleScroll=()=>{const e=this.instantViewerRef.current;this.setState({hasScroll:e.scrollTop>50}),this.updateItemsInView()},this.keyboardHandler=new Xa(this.onKeyDown),this.articleRef=r.a.createRef(),this.instantViewerRef=r.a.createRef(),this.state={},this.updateItemsInView=Object(Ae.y)(this.updateItemsInView,500)}static getDerivedStateFromProps(e,t){return e.instantView!==t.prevInstantView?{prevInstantView:e.instantView,hasPrev:$l.a.hasPrev(),hasScroll:!1,media:null,caption:null,url:null}:null}shouldComponentUpdate(e,t,a){const n=this.props.instantView,s=this.state,i=s.hasScroll,o=s.hasPrev,r=s.media,c=s.caption,l=s.url;return n!==e.instantView||(i!==t.hasScroll||(o!==t.hasPrev||(r!==t.media||(c!==t.caption||l!==t.url))))}componentDidMount(){this.mounted=!0,this.handleScroll(),$a.add(this.keyboardHandler),$l.a.on("clientUpdateInstantViewUrl",this.onClientUpdateInstantViewUrl),$l.a.on("clientUpdateInstantViewViewerContent",this.onClientUpdateInstantViewViewerContent)}componentWillUnmount(){this.mounted=!1,$a.remove(this.keyboardHandler),$l.a.off("clientUpdateInstantViewUrl",this.onClientUpdateInstantViewUrl),$l.a.off("clientUpdateInstantViewViewerContent",this.onClientUpdateInstantViewViewerContent)}scrollToHash(e,t){if(!e)return!1;const a=document.getElementById(e.substr(1));if(a){const e=[];let n=!1,s=a;do{s=s.parentNode,s?"DETAILS"===s.nodeName?e.push(s):"ARTICLE"===s.nodeName&&(n=!0):n=!0}while(!n);return e.forEach(e=>e.open=!0),a.scrollIntoView({block:"center",behavior:t}),!0}return!1}scrollTop(e){const t=this.instantViewerRef.current;switch(e){case"smooth":Za(t);break;default:t.scrollTo({top:0,behavior:e})}}componentDidUpdate(e,t,a){const n=this.props,s=n.instantView;n.url;console.log("[IV] componentDidUpdate",s.url,s.url===e.instantView.url);const i=new URL(s.url).hash;e.instantView!==s&&(e.instantView.url!==s.url?s.url.indexOf("#")===s.url.length-1?(console.log("[IV] componentDidUpdate scrollTop auto"),this.scrollTop("auto")):i?(console.log("[IV] componentDidUpdate scrollToHash",i),this.scrollToHash(i,"auto")):(console.log("[IV] componentDidUpdate scrollTop auto"),this.scrollTop("auto")):i?(console.log("[IV] componentDidUpdate scrollToHash",i),this.scrollToHash(i,"auto")):(console.log("[IV] componentDidUpdate scrollTop smooth"),this.scrollTop("smooth")),this.handleScroll())}handleClose(){Object(G.n)(null)}updateItemsInView(){if(!this.mounted)return;const e=this.props.instantView;if(!e)return;const t=e.page_blocks,a=new Map,n=Object(Ae.u)(this.instantViewerRef,this.articleRef);for(let s=0;s<n.length;s++){const e=t[n[s]];a.set(e,e),Tl(e).forEach(e=>a.set(e,e))}K.a.clientUpdate({"@type":"clientUpdateBlocksInView",blocks:a})}render(){const e=this.props,t=(e.classes,e.instantView),a=this.state,n=(a.hasPrev,a.hasScroll),s=a.media,i=a.caption,o=a.url;return t?r.a.createElement(fc.Provider,{value:t},r.a.createElement("div",{ref:this.instantViewerRef,className:"instant-viewer",onScroll:this.handleScroll},r.a.createElement("div",{className:"instant-viewer-left-column",onClick:this.handleBack},r.a.createElement(Hl,{className:"instant-viewer-left-button",style:{alignItems:"flex-start"},onClick:this.handleBack},r.a.createElement(jl,{style:{transition:"transform 0.25s ease-out",transform:n?"rotate(90deg)":"rotate(0deg)"}}))),r.a.createElement("div",{className:"instant-viewer-content-column"},r.a.createElement("div",null,r.a.createElement(Dl,{ref:this.articleRef}))),r.a.createElement("div",{className:"instant-viewer-right-column"},r.a.createElement(Hl,{className:"instant-viewer-right-button",onClick:this.handleClose},r.a.createElement(U.a,null)))),s&&r.a.createElement(Xl,{media:s,size:p.k,caption:i,url:o})):null}}var td=Object(f.d)()(ed);a(347);class ad extends r.a.Component{constructor(e){super(e)}render(){const e=this.props,t=e.chatId,a=e.messageId,n=q.a.get(t,a);if(!n)return null;const s=n.date,i=Object(vt.v)(n),o=Object(vt.j)(s),c=i?r.a.createElement(cn.a,{userId:i}):r.a.createElement(D,{chatId:t});return r.a.createElement("div",{className:"media-info"},r.a.createElement("div",{className:"media-info-wrapper"},c,r.a.createElement("div",{className:"media-info-content"},r.a.createElement("div",{className:"media-info-row"},r.a.createElement(na.a,{chatId:t,userId:i})),r.a.createElement("div",{className:"media-info-row meta"},r.a.createElement("span",null,o)))))}}var nd=ad;a(545);class sd extends r.a.Component{constructor(e){var t;super(e),t=this,this.onClientUpdateDocumentBlob=e=>{const t=this.props,a=t.chatId,n=t.messageId;a===e.chatId&&n===e.messageId&&this.updateAnimationData()},this.updateAnimationData=Object(i.a)(s.a.mark((function e(){var a,n,i,o,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.props,n=a.chatId,i=a.messageId,Object(vt.F)(n,i)){e.next=3;break}return e.abrupt("return");case 3:return o=t.state.file,e.next=6,Object(T.c)(o);case 6:r=e.sent,t.setState({animationData:r});case 8:case"end":return e.stop()}}),e)}))),this.onClientUpdateMediaBlob=e=>{const t=this.props,a=t.chatId,n=t.messageId,s=t.size;if(a===e.chatId&&n===e.messageId){const e=Object(T.h)(a,n,s),t=Object(g.a)(e,3),i=t[0],o=t[1],r=t[2];this.setState({width:i,height:o,file:r})}},this.onClientUpdateMediaThumbnailBlob=e=>{const t=this.props,a=t.chatId,n=t.messageId;if(a===e.chatId&&n===e.messageId){const e=Object(T.i)(a,n),t=Object(g.a)(e,3),s=t[0],i=t[1],o=t[2];this.setState({thumbnailWidth:s,thumbnailHeight:i,thumbnail:o})}},this.onUpdateMessageContent=e=>{const t=this.props,a=t.chatId,n=t.messageId,s=t.size,i=t.t,o=e.chat_id,r=e.message_id;if(a===o&&n===r){const e=Object(T.h)(a,n,s),t=Object(g.a)(e,3),o=t[0],r=t[1],c=t[2],l=q.a.get(a,n),d=Object(vt.w)(l,null,i);this.setState({width:o,height:r,file:c,text:d})}},this.handleContentClick=e=>{e&&e.stopPropagation()},this.changeSpeed=e=>{this.setState({speed:e})},this.state={},this.videoRef=r.a.createRef(),this.lottieRef=r.a.createRef(),this.updateAnimationData()}static getDerivedStateFromProps(e,t){const a=e.chatId,n=e.messageId,s=e.size,i=e.t;if(a!==t.prevChatId||n!==t.prevMessageId){let e=Object(T.h)(a,n,s),t=Object(g.a)(e,3),o=t[0],r=t[1],c=t[2];c=P.a.get(c.id)||c;let l=Object(T.i)(a,n),d=Object(g.a)(l,3),h=d[0],u=d[1],p=d[2];p=P.a.get(p.id)||p;const m=q.a.get(a,n);return{prevChatId:a,prevMessageId:n,speed:1,isPlaying:!1,width:o,height:r,file:c,text:Object(vt.w)(m,null,i),thumbnailWidth:h,thumbnailHeight:u,thumbnail:p}}return null}componentDidMount(){P.a.on("clientUpdateDocumentBlob",this.onClientUpdateDocumentBlob),P.a.on("clientUpdatePhotoBlob",this.onClientUpdateMediaBlob),P.a.on("clientUpdateVideoBlob",this.onClientUpdateMediaBlob),P.a.on("clientUpdateAnimationBlob",this.onClientUpdateMediaBlob),P.a.on("clientUpdateVideoThumbnailBlob",this.onClientUpdateMediaThumbnailBlob),P.a.on("clientUpdateAnimationThumbnailBlob",this.onClientUpdateMediaThumbnailBlob),q.a.on("updateMessageContent",this.onUpdateMessageContent)}componentWillUnmount(){P.a.off("clientUpdateDocumentBlob",this.onClientUpdateDocumentBlob),P.a.off("clientUpdatePhotoBlob",this.onClientUpdateMediaBlob),P.a.off("clientUpdateVideoBlob",this.onClientUpdateMediaBlob),P.a.off("clientUpdateAnimationBlob",this.onClientUpdateMediaBlob),P.a.off("clientUpdateVideoThumbnailBlob",this.onClientUpdateMediaThumbnailBlob),P.a.off("clientUpdateAnimationThumbnailBlob",this.onClientUpdateMediaThumbnailBlob),q.a.off("updateMessageContent",this.onUpdateMessageContent)}componentDidUpdate(e,t,a){const n=this.props,s=n.chatId,i=n.messageId;e.chatId===s&&e.messageId===i||this.updateAnimationData()}render(){const e=this.props,t=e.chatId,a=e.messageId,n=this.state,s=(n.animationData,n.width),i=n.height,o=n.file,c=n.text,d=n.thumbnailWidth,h=n.thumbnailHeight,u=n.thumbnail,p=n.isPlaying;if(!o)return null;const m=P.a.getBlob(o.id)||o.blob,g=P.a.getBlobUrl(m)||"",f=u?P.a.getBlob(u.id)||u.blob:null,b=P.a.getBlobUrl(f),C=Object(Et.k)({width:d,height:h}),y=Object(vt.L)(t,a),v=Object(vt.B)(t,a),E=Object(vt.F)(t,a);let U=s,S=i;if(Math.max(U,S)>640){const e=640/Math.max(U,S);U=U>S?640:Math.floor(U*e),S=S>U?640:Math.floor(S*e)}let k=null;if(y)k=r.a.createElement("div",{className:"media-viewer-content-wrapper"},r.a.createElement("video",{ref:this.videoRef,className:"media-viewer-content-video-player",src:g,onClick:this.handleContentClick,controls:!0,autoPlay:!0,width:U,height:S,onPlay:()=>{this.setState({isPlaying:!0}),K.a.clientUpdate({"@type":"clientUpdateMediaViewerPlay"})},onCanPlay:()=>{const e=this.videoRef.current;e&&(e.volume=Ao.b.volume)},onPause:()=>{K.a.clientUpdate({"@type":"clientUpdateMediaViewerPause"})},onEnded:()=>{K.a.clientUpdate({"@type":"clientUpdateMediaViewerEnded"})},onVolumeChange:()=>{const e=this.videoRef.current;e&&K.a.clientUpdate({"@type":"clientUpdateMediaVolume",volume:e.volume})}}),!p&&(!g&&b?r.a.createElement("img",{className:l()("media-viewer-content-video-thumbnail",{"media-blurred":C}),src:b,alt:"",width:U,height:S}):r.a.createElement("div",{className:"media-viewer-content-video-thumbnail",style:{width:U,height:S}})));else if(v)k=r.a.createElement("div",{className:"media-viewer-content-wrapper"},r.a.createElement("video",{className:"media-viewer-content-video-player",src:g,onClick:this.handleContentClick,loop:!0,autoPlay:!0,width:U,height:S,onPlay:()=>{this.setState({isPlaying:!0})}}),!p&&(!g&&b?r.a.createElement("img",{className:l()("media-viewer-content-video-thumbnail",{"media-blurred":C}),src:b,alt:"",width:U,height:S}):r.a.createElement("div",{className:"media-viewer-content-video-thumbnail",style:{width:U,height:S}})));else if(E){this.state.speed;k=null}else k=r.a.createElement("img",{className:"media-viewer-content-image",src:g,alt:"",onClick:this.handleContentClick});return r.a.createElement("div",{className:"media-viewer-content"},r.a.createElement(r.a.Suspense,{fallback:""},k),r.a.createElement(ls.a,{file:o,zIndex:2}),c&&c.length>0&&r.a.createElement(Fl,{text:c}))}}var id=Object(f.d)()(sd);a(348);class od extends r.a.Component{constructor(e){var t;super(e),t=this,this.onKeyDown=e=>{if(27===e.keyCode){if(this.state.deleteConfirmationOpened)return;this.handleClose()}else 39===e.keyCode?this.handleNext():37===e.keyCode&&this.handlePrevious()},this.onUpdateMessageContent=e=>{const t=e.chat_id,a=e.message_id,n=e.new_content,s=e.old_content,i=this.props.chatId,o=this.state,r=o.currentMessageId,c=o.totalCount;if(i!==t)return;const l=q.a.get(t,a);if(l){if(Object(T.u)([l]),Object(vt.G)(n)&&!Object(vt.G)(s)){if(this.history.length>=2&&(this.firstSliceLoaded||Object(Ae.b)(a,this.history[0].id,this.history[this.history.length-1].id))){let e=!1,t=[];for(let n=0;n<this.history.length;n++)this.history[n].id>a||e||(e=!0,t.push(l)),t.push(this.history[n]);this.history=t}const e=this.history.findIndex(e=>e.id===r);this.setState({hasNextMedia:this.hasNextMedia(e),hasPreviousMedia:this.hasPreviousMedia(e),totalCount:c+1})}if(!Object(vt.G)(n)&&Object(vt.G)(s)){let e=this.history;if(this.history=this.history.filter(e=>e.id!==a),r===a){const t=new Map;t.set(a,a),this.moveToNextMedia(e,t),this.setState({totalCount:Math.max(c-1,0)})}else{const e=this.history.findIndex(e=>e.id===r);this.setState({hasNextMedia:this.hasNextMedia(e),hasPreviousMedia:this.hasPreviousMedia(e),totalCount:Math.max(c-1,0)})}}}},this.onUpdateDeleteMessages=e=>{const t=e.chat_id,a=e.message_ids,n=e.is_permanent,s=this.props.chatId,i=this.state,o=i.currentMessageId,r=i.totalCount;if(!n)return;if(s!==t)return;const c=a.reduce((e,t)=>(e.set(t,t),e),new Map),l=this.history;let d=l.length;this.history=this.history.filter(e=>!c.has(e.id)),d-=this.history.length,this.setState({totalCount:Math.max(r-d,0)}),this.history.length?c.has(o)&&this.moveToNextMedia(l,c):Object(G.p)(null)},this.onUpdateNewMessage=e=>{const t=this.props.chatId,a=this.state,n=a.currentMessageId,s=a.totalCount,i=e.message;if(!i)return;if(!Object(vt.G)(i.content))return;if(i.chat_id!==t)return;if(!this.firstSliceLoaded)return;this.history=[i].concat(this.history);const o=this.history.findIndex(e=>e.id===n);this.setState({hasNextMedia:this.hasNextMedia(o),hasPreviousMedia:this.hasPreviousMedia(o),totalCount:s+1})},this.getFilter=(e,t)=>{const a=q.a.get(e,t);if(!a)return null;const n=a.content;if(!n)return null;switch(n["@type"]){case"messageChatChangePhoto":return{"@type":"searchMessagesFilterChatPhoto"};case"messagePhoto":case"messageVideo":return{"@type":"searchMessagesFilterPhotoAndVideo"};default:return null}},this.loadHistory=Object(i.a)(s.a.mark((function e(){var a,n,i,o,r,c,l,d,h;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.props,n=a.chatId,i=a.messageId,o=t.getFilter(n,i),r={"@type":"messages",messages:[],total_count:0},!o){e.next=7;break}return e.next=6,K.a.send({"@type":"searchChatMessages",chat_id:n,query:"",sender_user_id:0,from_message_id:i,offset:-p.s,limit:2*p.s,filter:o});case 6:r=e.sent;case 7:if(Object(vt.f)(r,t.history),q.a.setItems(r.messages),t.history=r.messages,t.firstSliceLoaded=0===r.messages.length,c=t.state.currentMessageId,l=t.history.findIndex(e=>e.id===c),t.setState({hasNextMedia:t.hasNextMedia(l),hasPreviousMedia:t.hasPreviousMedia(l)}),-1!==l){e.next=19;break}t.history=[q.a.get(n,c)],Object(T.D)(0,t.history),e.next=39;break;case 19:if(Object(T.D)(l,t.history),o=t.getFilter(n,i)){e.next=23;break}return e.abrupt("return");case 23:d=1500,h=0;case 25:if(t.firstSliceLoaded||!(h<d)){e.next=39;break}return e.next=28,K.a.send({"@type":"searchChatMessages",chat_id:n,query:"",sender_user_id:0,from_message_id:t.history.length>0?t.history[0].id:0,offset:-99,limit:100,filter:o});case 28:r=e.sent,h+=r.messages.length,Object(vt.f)(r,t.history),q.a.setItems(r.messages),t.history=r.messages.concat(t.history),t.firstSliceLoaded=0===r.messages.length,c=t.state.currentMessageId,l=t.history.findIndex(e=>e.id===c),t.setState({hasNextMedia:t.hasNextMedia(l),hasPreviousMedia:t.hasPreviousMedia(l),firstSliceLoaded:t.firstSliceLoaded,totalCount:r.total_count}),e.next=25;break;case 39:case"end":return e.stop()}}),e)}))),this.handleClose=()=>{Object(G.p)(null);const e=this.state.currentMessageId,t=this.history.findIndex(t=>t.id===e);-1!==t&&Object(T.a)(t,this.history)},this.handleSave=()=>{const e=this.props.chatId,t=this.state.currentMessageId,a=q.a.get(e,t);if(!a)return;const n=a.content;if(!n)return;let s=null;switch(n["@type"]){case"messageAnimation":s=n.animation;break;case"messageChatChangePhoto":s=n.photo;break;case"messageDocument":s=n.document;break;case"messagePhoto":s=n.photo;break;case"messageText":{const e=n.web_page;if(!e)return;const t=e.animation,a=e.document,i=e.photo,o=e.video;if(t){s=t;break}if(a){s=a;break}if(i){s=i;break}if(o){s=o;break}break}case"messageVideo":s=n.video;break}Object(T.F)(s,a)},this.handleForward=()=>{const e=this.props.chatId,t=this.state.currentMessageId;K.a.clientUpdate({"@type":"clientUpdateForward",info:{chatId:e,messageIds:[t]}})},this.handleDelete=()=>{this.handleDialogOpen()},this.hasPreviousMedia=e=>{if(-1===e)return!1;return e+1<this.history.length},this.handlePrevious=e=>{e&&e.stopPropagation();const t=this.state.currentMessageId,a=this.history.findIndex(e=>e.id===t)+1;return this.loadMedia(a,()=>{a===this.history.length-1&&this.loadPrevious()})},this.loadPrevious=Object(i.a)(s.a.mark((function e(){var a,n,i,o,r,c,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.props,n=a.chatId,i=a.messageId,o=t.state.currentMessageId,r=t.getFilter(n,i),c={"@type":"messages",messages:[],total_count:0},!r){e.next=8;break}return e.next=7,K.a.send({"@type":"searchChatMessages",chat_id:n,query:"",sender_user_id:0,from_message_id:o,offset:0,limit:p.s,filter:r});case 7:c=e.sent;case 8:Object(vt.f)(c,t.history),q.a.setItems(c.messages),t.history=t.history.concat(c.messages),l=t.history.findIndex(e=>e.id===o),t.setState({hasNextMedia:t.hasNextMedia(l),hasPreviousMedia:t.hasPreviousMedia(l),totalCount:c.total_count});case 13:case"end":return e.stop()}}),e)}))),this.hasNextMedia=e=>{if(-1===e)return!1;return e-1>=0},this.handleNext=e=>{e&&e.stopPropagation();const t=this.state.currentMessageId,a=this.history.findIndex(e=>e.id===t)-1;return this.loadMedia(a,()=>{0===a&&this.loadNext()})},this.loadNext=Object(i.a)(s.a.mark((function e(){var a,n,i,o,r,c,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.props,n=a.chatId,i=a.messageId,o=t.state.currentMessageId,r=t.getFilter(n,i),c={"@type":"messages",messages:[],total_count:0},!r){e.next=8;break}return e.next=7,K.a.send({"@type":"searchChatMessages",chat_id:n,query:"",sender_user_id:0,from_message_id:o,offset:-p.s,limit:p.s+1,filter:r});case 7:c=e.sent;case 8:Object(vt.f)(c,t.history),q.a.setItems(c.messages),t.firstSliceLoaded=0===c.messages.length,t.history=c.messages.concat(t.history),l=t.history.findIndex(e=>e.id===o),t.setState({hasNextMedia:t.hasNextMedia(l),hasPreviousMedia:t.hasPreviousMedia(l),firstSliceLoaded:t.firstSliceLoaded,totalCount:c.total_count});case 14:case"end":return e.stop()}}),e)}))),this.loadMedia=(e,t)=>!(e<0)&&(!(e>=this.history.length)&&(this.setState({currentMessageId:this.history[e].id,hasNextMedia:this.hasNextMedia(e),hasPreviousMedia:this.hasPreviousMedia(e)},t),Object(T.D)(e,this.history),!0)),this.moveToNextMedia=(e,t)=>{const a=this.state.currentMessageId,n=e.findIndex(e=>e.id===a);let s=0;for(let o=n-1;o>=0;o--)if(t&&!t.has(e[o].id)){s=e[o].id;break}if(!s)for(let o=n+1;o<e.length;o++)if(t&&!t.has(e[o].id)){s=e[o].id;break}if(!s)return;const i=this.history.findIndex(e=>e.id===s);return this.loadMedia(i,()=>{0===i?this.loadNext():i===this.history.length-1&&this.loadPrevious()})},this.handleDialogOpen=()=>{this.setState({deleteConfirmationOpened:!0})},this.handleDialogClose=()=>{this.setState({deleteConfirmationOpened:!1})},this.handleDone=()=>{this.setState({deleteConfirmationOpened:!1});const e=this.props.chatId,t=this.state,a=t.currentMessageId,n=t.deleteForAll,s=q.a.get(e,a);if(!s)return;const i=s.can_be_deleted_only_for_self,o=s.can_be_deleted_for_all_users;(i||o)&&K.a.send({"@type":"deleteMessages",chat_id:e,message_ids:[a],revoke:o&&n})},this.handleChangeDeleteForAll=e=>{this.setState({deleteForAll:e.target.checked})},this.handleInvertColors=()=>{let e="media-viewer-default";switch(this.state.background){case"media-viewer-default":e="media-viewer-dark";break;case"media-viewer-dark":e="media-viewer-light";break;case"media-viewer-light":e="media-viewer-default"}this.setState({background:e})},this.handleChangeSpeed=()=>{if(!this.contentRef)return;const e=this.contentRef.current;if(!e)return;const t=this.state.speed<1?1:.1;this.setState({speed:t}),e.changeSpeed(t)},this.canBeForwarded=(e,t)=>{const a=q.a.get(e,t);if(!a)return!1;const n=a.can_be_forwarded,s=a.content;if(!s)return!1;switch(s["@type"]){case"messageChatChangePhoto":return!0;default:return n}},this.keyboardHandler=new Xa(this.onKeyDown),this.contentRef=r.a.createRef(),this.history=[];const a=this.props,n=a.chatId,o=a.messageId;this.state={speed:1,background:"media-viewer-default",prevChatId:n,prevMessageId:o,currentMessageId:o,hasNextMedia:!1,hasPreviousMedia:!1,deleteConfirmationOpened:!1,deleteForAll:!0}}shouldComponentUpdate(e,t){const a=this.props,n=a.chatId,s=a.messageId,i=this.state,o=i.background,r=i.currentMessageId,c=i.deleteConfirmationOpened,l=i.firstSliceLoaded,d=i.hasNextMedia,h=i.hasPreviousMedia,u=i.speed,p=i.totalCount;return t.background!==o||(e.chatId!==n||(e.messageId!==s||(t.currentMessageId!==r||(t.hasPrevousMedia!==h||(t.hasNextMedia!==d||(t.firstSliceLoaded!==l||(t.totalCount!==p||(t.deleteConfirmationOpened!==c||t.speed!==u))))))))}componentDidMount(){this.loadHistory(),$a.add(this.keyboardHandler),q.a.on("updateDeleteMessages",this.onUpdateDeleteMessages),q.a.on("updateNewMessage",this.onUpdateNewMessage),q.a.on("updateMessageContent",this.onUpdateMessageContent)}componentWillUnmount(){$a.remove(this.keyboardHandler),q.a.off("updateDeleteMessages",this.onUpdateDeleteMessages),q.a.off("updateNewMessage",this.onUpdateNewMessage),q.a.off("updateMessageContent",this.onUpdateMessageContent)}render(){const e=this.props,t=e.chatId,a=e.t,n=this.state,s=n.background,i=n.currentMessageId,o=n.deleteConfirmationOpened,c=n.deleteForAll,d=n.firstSliceLoaded,h=n.hasNextMedia,u=n.hasPreviousMedia,m=(n.speed,n.totalCount);let f=-1;m&&d&&(f=this.history.findIndex(e=>e.id===i));const C=Math.max(this.history.length,m),S=q.a.get(t,i),k=S.can_be_deleted_for_all_users,M=S.can_be_deleted_only_for_self,I=k||M,w=this.canBeForwarded(t,i);let _="";_=Object(vt.L)(t,i)?a("AreYouSureDeleteVideo"):Object(vt.B)(t,i)?a("AreYouSureDeleteGIF"):a("AreYouSureDeletePhoto");const x=o?r.a.createElement(y.a,{transitionDuration:0,open:o,onClose:this.handleDialogClose,"aria-labelledby":"form-dialog-title"},r.a.createElement(E.a,{id:"form-dialog-title"},a("Confirm")),r.a.createElement(On.a,null,r.a.createElement(Tn.a,null,_),k&&r.a.createElement(An.a,{label:a("DeleteForAll"),control:r.a.createElement(ys.a,{color:"primary",value:"deleteAll",onChange:this.handleChangeDeleteForAll}),checked:c})),r.a.createElement(v.a,null,r.a.createElement(b.a,{onClick:this.handleDialogClose,color:"primary"},a("Cancel")),r.a.createElement(b.a,{onClick:this.handleDone,color:"primary"},a("Ok")))):null,O=Object(T.h)(t,i,p.B),L=Object(g.a)(O,3),P=(L[0],L[1],L[2]),N=P?P.id:0;let D=a("AttachPhoto");return Object(vt.L)(t,i)?D=a("AttachVideo"):Object(vt.B)(t,i)?D=a("AttachGif"):Object(vt.F)(t,i)&&(D=""),r.a.createElement("div",{className:l()("media-viewer",s)},r.a.createElement("div",{className:"media-viewer-footer"},r.a.createElement(nd,{chatId:t,messageId:i}),r.a.createElement(Gl,{title:D,subtitle:C&&f>=0?"".concat(C-f," of ").concat(C):null}),r.a.createElement(Jl,{title:a("Save"),fileId:N,onClick:this.handleSave}),r.a.createElement(ql,{title:a("Forward"),disabled:!w,onClick:this.handleForward},r.a.createElement(Bl,null)),r.a.createElement(ql,{title:a("Delete"),disabled:!I,onClick:this.handleDelete},r.a.createElement(en,null)),r.a.createElement(ql,{title:a("Close"),onClick:this.handleClose},r.a.createElement(U.a,null))),r.a.createElement("div",{className:"media-viewer-wrapper",onClick:this.handlePrevious},r.a.createElement("div",{className:"media-viewer-left-column"},r.a.createElement(Hl,{disabled:!u,grow:!0,onClick:this.handlePrevious},r.a.createElement(jl,null))),r.a.createElement("div",{className:"media-viewer-content-column"},r.a.createElement(id,{ref:this.contentRef,chatId:t,messageId:i,size:p.B,onClick:this.handlePrevious})),r.a.createElement("div",{className:"media-viewer-right-column"},r.a.createElement(Hl,{disabled:!h,grow:!0,onClick:this.handleNext},r.a.createElement(jl,{style:{transform:"rotate(180deg)"}})))),x)}}var rd=Object(f.d)()(od);a(349);class cd extends r.a.Component{constructor(e){super(e),this.onClientUpdateChatBlob=e=>{const t=this.props,a=t.chatId,n=t.photo;if(a===e.chatId&&n.big.id===e.fileId){const t=P.a.get(e.fileId)||this.state.file;this.setState({file:t})}},this.onClientUpdateUserBlob=e=>{const t=this.props,a=t.chatId,n=t.photo;if(Object(w.u)(a)===e.userId&&n.big.id===e.fileId){const t=P.a.get(e.fileId)||this.state.file;this.setState({file:t})}},this.handleContentClick=e=>{e&&e.stopPropagation(),this.props.onClick(e)};const t=this.props,a=t.chatId,n=t.photo;let s=n.big;s=P.a.get(s.id)||s,this.state={prevChatId:a,prevPhoto:n,width:p.db,height:p.db,file:s}}static getDerivedStateFromProps(e,t){const a=e.chatId,n=e.photo;return a!==t.prevChatId||n!==t.prevPhoto?{prevChatId:a,prevPhoto:n,width:p.db,height:p.db,file:n.big}:null}componentDidMount(){P.a.on("clientUpdateChatBlob",this.onClientUpdateChatBlob),P.a.on("clientUpdateUserBlob",this.onClientUpdateUserBlob)}componentWillUnmount(){P.a.off("clientUpdateChatBlob",this.onClientUpdateChatBlob),P.a.off("clientUpdateUserBlob",this.onClientUpdateUserBlob)}render(){const e=this.state,t=(e.width,e.height,e.file);if(!t)return null;const a=P.a.getBlob(t.id)||t.blob,n=P.a.getBlobUrl(a);return r.a.createElement("div",{className:"media-viewer-content"},r.a.createElement("img",{className:"media-viewer-content-image",src:n,alt:"",onClick:this.handleContentClick}),r.a.createElement(ls.a,{file:t}))}}var ld=cd;class dd extends r.a.Component{constructor(e){super(e)}render(){const e=this.props,t=e.chatId,a=e.date;return r.a.createElement("div",{className:"media-info"},r.a.createElement("div",{className:"media-info-wrapper"},r.a.createElement(D,{chatId:t,showSavedMessages:!1}),r.a.createElement("div",{className:"media-info-content"},r.a.createElement("div",{className:"media-info-row"},r.a.createElement(na.a,{chatId:t})),a&&r.a.createElement("div",{className:"media-info-row meta"},r.a.createElement("span",null,a)))))}}var hd=dd;class ud extends r.a.Component{constructor(e){var t;super(e),t=this,this.handleKeyDown=e=>{if(e.preventDefault(),e.stopPropagation(),27===e.keyCode){if(this.state.deleteConfirmationOpened)return;this.handleClose()}else 39===e.keyCode?this.handlePrevious():37===e.keyCode&&this.handleNext()},this.loadHistory=function(){var e=Object(i.a)(s.a.mark((function e(a){var n,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.props.chatId,Object(w.T)(n)){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,K.a.send({"@type":"getUserProfilePhotos",user_id:Object(w.u)(n),offset:0,limit:100});case 5:i=e.sent,t.history=i.photos,t.firstSliceLoaded=0===i.photos.length,0,t.setState({currentIndex:0,hasNextMedia:t.hasNextMedia(0),hasPreviousMedia:t.hasPreviousMedia(0),totalCount:i.total_count}),Object(T.E)(n,0,t.history);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleClose=()=>{Object(G.q)(null)},this.handleSave=()=>{const e=this.props.chatId,t=this.state,a=t.currentIndex,n=t.totalCount,s=L.a.get(e);if(!s)return;let i=-1;n&&(i=a);const o=i>0&&i<this.history.length?Object(I.a)(this.history[i]):Object(w.D)(e);if(!o)return;if(!o.big)return;const r=P.a.get(o.big.id)||o.big;r&&Object(T.G)(r,r.id+".jpg",s,()=>P.a.updateChatPhotoBlob(e,r.id))},this.handleForward=()=>{const e=this.props.chatId,t=this.state,a=t.currentIndex;let n=-1;t.totalCount&&(n=a);let s=null;if(this.history&&n>=0&&n<this.history.length){const e=Object(I.a)(this.history[n]);if(!e)return;let t=e.big;if(!t)return;s={"@type":"inputFileId",id:t.id}}else{const t=Object(w.D)(e);if(!t)return;const a=t.big;if(!a)return;const n=P.a.getBlob(a.id);if(!n)return;s={"@type":"inputFileBlob",data:n,name:""}}if(!s)return;const i={"@type":"inputMessagePhoto",photo:s,thumbnail:null,added_sticker_file_ids:[],width:p.db,height:p.db,caption:{"@type":"formattedText",text:"",entities:null},ttl:0};K.a.clientUpdate({"@type":"clientUpdateForward",info:{inputMessageContent:i}})},this.handleDelete=()=>{const e=this.props,t=e.chatId,a=(e.messageId,this.state),n=a.currentIndex;let s=-1;a.totalCount&&(s=n);const i=s>0&&s<this.history.length?Object(I.a)(this.history[s]):Object(w.D)(t);if(i){let e=i.big;if(e=P.a.get(e.id)||e,e){const t=P.a.getReadWriteStore();P.a.deleteLocalFile(t,e)}}},this.hasPreviousMedia=e=>{if(-1===e)return!1;return e+1<this.history.length},this.handlePrevious=e=>{e&&e.stopPropagation();const t=this.state.currentIndex+1;return this.loadMedia(t,()=>{t===this.history.length-1&&this.loadPrevious()})},this.loadPrevious=Object(i.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return");case 1:case"end":return e.stop()}}),e)}))),this.hasNextMedia=e=>{if(-1===e)return!1;return e-1>=0},this.handleNext=e=>{e&&e.stopPropagation();const t=this.state.currentIndex-1;return this.loadMedia(t,()=>{0===t&&this.loadNext()})},this.loadNext=Object(i.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return");case 1:case"end":return e.stop()}}),e)}))),this.loadMedia=(e,t)=>{if(e<0)return!1;if(e>=this.history.length)return!1;this.setState({currentIndex:e,hasNextMedia:this.hasNextMedia(e),hasPreviousMedia:this.hasPreviousMedia(e)},t);const a=this.props.chatId;return Object(T.E)(a,e,this.history),!0},this.history=[],this.keyboardHandler=new Xa(this.handleKeyDown);const a=this.props,n=a.chatId,o=a.fileId;this.state={prevChatId:n,prevFileId:o,currentIndex:0,hasNextMedia:!1,hasPreviousMedia:!1,deleteConfirmationOpened:!1}}shouldComponentUpdate(e,t){const a=this.props,n=a.chatId,s=a.messageId,i=this.state,o=i.currentFileId,r=i.hasPreviousMedia,c=i.hasNextMedia,l=i.firstSliceLoaded,d=i.totalCount,h=i.deleteConfirmationOpened;return e.chatId!==n||(e.messageId!==s||(t.currentFileId!==o||(t.hasPrevousMedia!==r||(t.hasNextMedia!==c||(t.firstSliceLoaded!==l||(t.totalCount!==d||t.deleteConfirmationOpened!==h))))))}componentDidMount(){const e=this.props.chatId,t=Object(w.D)(e);Object(T.w)(e,[t]),this.loadHistory(t),$a.add(this.keyboardHandler)}componentWillUnmount(){$a.remove(this.keyboardHandler)}render(){const e=this.props,t=e.chatId,a=e.t,n=this.state,s=n.currentIndex,i=n.hasNextMedia,o=n.hasPreviousMedia,c=(n.firstSliceLoaded,n.totalCount);n.deleteConfirmationOpened,n.deleteForAll;let d=-1;c&&(d=s);const h=d>=0&&d<this.history.length,u=h&&0!==d?Object(I.a)(this.history[d]):Object(w.D)(t),p=h?this.history[d]:null,m=u.big;return r.a.createElement("div",{className:l()("media-viewer","media-viewer-default")},r.a.createElement("div",{className:"media-viewer-footer"},r.a.createElement(hd,{chatId:t,date:Object(I.b)(p)}),r.a.createElement(Gl,{title:a("AttachPhoto"),subtitle:c&&d>=0?"".concat(d+1," of ").concat(c):null}),r.a.createElement(Jl,{title:a("Save"),fileId:m.id,onClick:this.handleSave}),r.a.createElement(Jl,{title:a("Forward"),fileId:m.id,onClick:this.handleForward},r.a.createElement(Bl,null)),r.a.createElement(ql,{title:a("Delete"),disabled:!0,onClick:this.handleDelete},r.a.createElement(en,null)),r.a.createElement(ql,{title:a("Close"),onClick:this.handleClose},r.a.createElement(U.a,null))),r.a.createElement("div",{className:"media-viewer-wrapper",onClick:this.handlePrevious},r.a.createElement("div",{className:"media-viewer-left-column"},r.a.createElement(Hl,{disabled:!i,grow:!0,onClick:this.handleNext},r.a.createElement(jl,null))),r.a.createElement("div",{className:"media-viewer-content-column"},r.a.createElement(ld,{chatId:t,photo:u,onClick:this.handlePrevious})),r.a.createElement("div",{className:"media-viewer-right-column"},r.a.createElement(Hl,{disabled:!o,grow:!0,onClick:this.handlePrevious},r.a.createElement(jl,{style:{transform:"rotate(180deg)"}})))),null)}}var pd=Object(f.d)()(ud);a(168);class md extends r.a.Component{constructor(e){var t;super(e),t=this,this.onClientUpdateInstantViewContent=e=>{const t=e.content;this.setState({instantViewContent:t})},this.onClientUpdateOpenChat=e=>{const t=e.chatId,a=e.messageId,n=e.popup;this.handleSelectChat(t,a,n)},this.onClientUpdateOpenUser=e=>{const t=e.userId,a=e.popup;this.handleSelectUser(t,a)},this.onClientUpdateChatDetailsVisibility=e=>{this.setState({isChatDetailsVisible:Z.a.isChatDetailsVisible})},this.onClientUpdateMediaViewerContent=e=>{this.setState({mediaViewerContent:Z.a.mediaViewerContent})},this.onClientUpdateProfileMediaViewerContent=e=>{this.setState({profileMediaViewerContent:Z.a.profileMediaViewerContent})},this.onClientUpdateForward=e=>{const t=e.info;this.setState({forwardInfo:t})},this.handleSelectChat=(e,t=null,a=!1)=>{const n=Z.a.getChatId(),s=Z.a.dialogChatId,i=Z.a.getMessageId();a?s!==e&&K.a.clientUpdate({"@type":"clientUpdateDialogChatId",chatId:e}):n===e&&t&&i===t?(this.dialogDetailsRef.current.scrollToMessage(),t&&Object(G.f)(e,t)):n!==e||t?K.a.setChatId(e,t):this.dialogDetailsRef.current.scrollToStart()},this.handleSelectUser=function(){var e=Object(i.a)(s.a.mark((function e(a,n){var i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,K.a.send({"@type":"createPrivateChat",user_id:a,force:!0});case 4:i=e.sent,t.handleSelectChat(i.id,null,n);case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),this.dialogDetailsRef=r.a.createRef(),this.state={isChatDetailsVisible:Z.a.isChatDetailsVisible,mediaViewerContent:Z.a.mediaViewerContent,profileMediaViewerContent:Z.a.profileMediaViewerContent,forwardInfo:null,instantViewContent:null}}componentDidMount(){_.a.on("clientUpdateOpenUser",this.onClientUpdateOpenUser),L.a.on("clientUpdateOpenChat",this.onClientUpdateOpenChat),Z.a.on("clientUpdateChatDetailsVisibility",this.onClientUpdateChatDetailsVisibility),Z.a.on("clientUpdateMediaViewerContent",this.onClientUpdateMediaViewerContent),Z.a.on("clientUpdateProfileMediaViewerContent",this.onClientUpdateProfileMediaViewerContent),Z.a.on("clientUpdateForward",this.onClientUpdateForward),$l.a.on("clientUpdateInstantViewContent",this.onClientUpdateInstantViewContent)}componentWillUnmount(){_.a.off("clientUpdateOpenUser",this.onClientUpdateOpenUser),L.a.off("clientUpdateOpenChat",this.onClientUpdateOpenChat),Z.a.off("clientUpdateChatDetailsVisibility",this.onClientUpdateChatDetailsVisibility),Z.a.off("clientUpdateMediaViewerContent",this.onClientUpdateMediaViewerContent),Z.a.off("clientUpdateProfileMediaViewerContent",this.onClientUpdateProfileMediaViewerContent),Z.a.off("clientUpdateForward",this.onClientUpdateForward),$l.a.off("clientUpdateInstantViewContent",this.onClientUpdateInstantViewContent)}render(){const e=this.state,t=e.instantViewContent,a=e.isChatDetailsVisible,n=e.mediaViewerContent,s=e.profileMediaViewerContent,i=e.forwardInfo;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:l()("page",{"page-third-column":a})},r.a.createElement(Qs,null),r.a.createElement(mc,{ref:this.dialogDetailsRef}),a&&r.a.createElement(da,null)),t&&r.a.createElement(td,t),n&&r.a.createElement(rd,n),s&&r.a.createElement(pd,s),i&&r.a.createElement(J,i))}}const gd=Object(d.a)(h.a,m);t.default=gd(md)}])]);
//# sourceMappingURL=4.11fc0b47.chunk.js.map