(this.webpackJsonptelegram_react=this.webpackJsonptelegram_react||[]).push([[0],[,function(e,t,a){"use strict";var n=a(6),s=a.n(n),i=a(13),o=a(40),r=a(132),c=a(19),l=a(4),d=a(231),h=a.n(d);class u extends o.a{constructor(){var e;super(),e=this,this.init=e=>{this.setParameters(e);const t=this.parameters,a=t.verbosity,n=t.jsVerbosity,s=t.useTestDC,i=t.readOnly,o=t.fastUpdating,r=t.useDatabase,c=t.mode;!function(e,t){var a=indexedDB.open(e),n=!0;a.onsuccess=function(){a.result.close(),n||indexedDB.deleteDatabase(e),t(n)},a.onupgradeneeded=function(){n=!1}}(s?"tdlib_test":"tdlib",e=>{this.clientUpdate({"@type":"clientUpdateTdLibDatabaseExists",exists:e});let t={logVerbosityLevel:a,jsLogVerbosityLevel:n,mode:c,prefix:s?"tdlib_test":"tdlib",readOnly:i,isBackground:!1,useDatabase:r,wasmUrl:"".concat(l.xb,"?_sw-precache=").concat(l.wb)};console.log("[TdLibController] (fast_updating=".concat(o,") Start client with params=").concat(JSON.stringify(t))),this.client=new h.a(t),this.client.onUpdate=e=>{this.disableLog||("updateFile"===e["@type"]?console.log("receive updateFile file_id="+e.file.id,e):console.log("receive update",e)),this.emit("update",e)}})},this.clientUpdate=e=>{this.disableLog||console.log("clientUpdate",e),this.emit("clientUpdate",e)},this.setParameters=e=>{if(!e)return;const t=e.search;if(!t)return;const a=new URLSearchParams(t.toLowerCase());if(a.has("test")&&(this.parameters.useTestDC=Object(c.w)(a.get("test"))),a.has("verbosity")){const e=parseInt(a.get("verbosity"),10);e>=l.vb&&e<=l.ub&&(this.parameters.verbosity=e)}if(a.has("jsverbosity")){const e=parseInt(a.get("jsverbosity"),10);e>=l.tb&&e<=l.sb&&(this.parameters.jsVerbosity=e)}if(a.has("tag")&&a.has("tagverbosity")){const e=a.get("tag").replace("[","").replace("]","").split(","),t=a.get("tagverbosity").replace("[","").replace("]","").split(",");e&&t&&e.length===t.length&&(this.parameters.tag=e,this.parameters.tagVerbosity=t)}a.has("readonly")&&(this.parameters.readOnly=Object(c.w)(a.get("readonly"))),a.has("fastupdating")&&(this.parameters.fastUpdating=Object(c.w)(a.get("fastupdating"))),a.has("db")&&(this.parameters.useDatabase=Object(c.w)(a.get("db"))),a.has("mode")&&(this.parameters.mode=a.get("mode")),a.has("clientlog")&&(this.disableLog=!Object(c.w)(a.get("clientlog")))},this.send=e=>{if(this.client)return this.disableLog?this.client.send(e):(console.log("send",e),this.client.send(e).then(e=>(console.log("send result",e),e)).catch(e=>{throw console.error("send error",e),e}));console.log("send (none init)",e)},this.sendTdParameters=Object(i.a)(s.a.mark((function t(){var a,n,i,o,l,d;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("593326",a="51296106d99b9e9b5509e329f037624f",n=e.parameters.useTestDC,i=r.version,e.send({"@type":"setTdlibParameters",parameters:{"@type":"tdParameters",use_test_dc:n,api_id:"593326",api_hash:a,system_language_code:navigator.language||"en",device_model:Object(c.d)(),system_version:Object(c.h)(),application_version:i,use_secret_chats:!1,use_message_database:!0,use_file_database:!1,database_directory:"/db",files_directory:"/"}}),e.parameters.tag&&e.parameters.tagVerbosity)for(o=0;o<e.parameters.tag.length;o++)l=e.parameters.tag[o],d=e.parameters.tagVerbosity[o],e.send({"@type":"setLogTagVerbosityLevel",tag:l,new_verbosity_level:d});case 7:case"end":return t.stop()}}),t)}))),this.setChatId=(e,t=null)=>{const a={"@type":"clientUpdateChatId",chatId:e,messageId:t};this.clientUpdate(a)},this.parameters={useTestDC:!1,readOnly:!1,verbosity:1,jsVerbosity:3,fastUpdating:!0,useDatabase:!1,mode:"wasm"},this.disableLog=!0}logOut(){this.send({"@type":"logOut"}).catch(e=>{this.emit("tdlib_auth_error",e)})}setMediaViewerContent(e){this.clientUpdate({"@type":"clientUpdateMediaViewerContent",content:e})}}const p=new u;t.a=p},function(e,t,a){"use strict";var n=a(6),s=a.n(n),i=a(13),o=a(40),r=a(17),c=a(4),l=a(1);class d extends o.a{constructor(){var e;super(),e=this,this.reset=()=>{this.callbacks=[],this.db=null,this.urls=new WeakMap,this.dataUrls=new Map,this.items=new Map,this.blobItems=new Map,this.locationItems=new Map,this.downloads=new Map,this.uploads=new Map},this.onUpdate=function(){var t=Object(i.a)(s.a.mark((function t(a){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=a["@type"],t.next="updateAuthorizationState"===t.t0?3:"updateFile"===t.t0?6:10;break;case 3:return t.next=5,e.onUpdateAuthorizationState(a);case 5:return t.abrupt("break",11);case 6:return e.set(a.file),e.onUpdateFile(a),e.emit(a["@type"],a),t.abrupt("break",11);case 10:return t.abrupt("break",11);case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.onClientUpdate=e=>{switch(e["@type"]){case"clientUpdateAudioThumbnailBlob":case"clientUpdateAudioBlob":case"clientUpdateDocumentBlob":this.emit(e["@type"],e)}},this.addTdLibListener=()=>{l.a.on("update",this.onUpdate),l.a.on("clientUpdate",this.onClientUpdate)},this.removeTdLibListener=()=>{l.a.off("update",this.onUpdate),l.a.off("clientUpdate",this.onClientUpdate)},this.onUpdateAuthorizationState=function(){var t=Object(i.a)(s.a.mark((function t(a){var n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a){t.next=2;break}return t.abrupt("return");case 2:if(n=a.authorization_state){t.next=5;break}return t.abrupt("return");case 5:t.t0=n["@type"],t.next="authorizationStateWaitTdlibParameters"===t.t0?8:"authorizationStateClosed"===t.t0?11:13;break;case 8:return t.next=10,e.initDB();case 10:return t.abrupt("break",13);case 11:return e.reset(),t.abrupt("break",13);case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.onUpdateFile=e=>{if(!e)return;const t=e.file;t&&(this.handleDownloads(t),this.handleUploads(t))},this.handleDownloads=e=>{const t=e.arr,a=e.id,n=(e.idb_key,e.local);if(delete e.arr,!this.downloads.has(a))return;if(!n.is_downloading_completed)return;const s=this.downloads.get(a);if(!s)return;this.downloads.delete(a);const i=this.getStore();s.forEach(a=>{switch(a["@type"]){case"animation":this.handleAnimation(i,a,e,t,null);break;case"audio":this.handleAudio(i,a,e,t,null);break;case"chat":this.handleChat(i,a,e,t);break;case"document":this.handleDocument(i,a,e,t,null);break;case"game":this.handleGame(i,a,e,t,null);break;case"location":this.handleLocation(i,a,e,t,null);break;case"message":this.handleMessage(i,a,e,t);break;case"pageBlockMap":this.handlePageBlockMap(i,a,e,t,null);break;case"photo":this.handlePhoto(i,a,e,t,null);break;case"sticker":this.handleSticker(i,a,e,t,null);break;case"video":this.handleVideo(i,a,e,t,null);break;case"videoNote":this.handleVideoNote(i,a,e,t,null);break;case"voiceNote":this.handleVoiceNote(i,a,e,t,null);break;case"user":this.handleUser(i,a,e,t);break;default:console.error("FileStore.onUpdateFile unhandled item",a)}})},this.handleUploads=e=>{const t=e.id,a=e.remote;delete e.arr,this.uploads.has(t)&&(a.is_uploading_completed||this.uploads.delete(t))},this.handleChat=(e,t,a,n)=>{t&&this.getLocalFile(e,a,n,()=>this.updateChatPhotoBlob(t.id,a.id),()=>this.getRemoteFile(a.id,c.g,t))},this.handleUser=(e,t,a,n)=>{t&&this.getLocalFile(e,a,n,()=>this.updateUserPhotoBlob(t.id,a.id),()=>this.getRemoteFile(a.id,c.g,t))},this.handleMessage=(e,t,a,n)=>{if(!t)return;const s=t.content;if(s)switch(s["@type"]){case"messageAnimation":{const i=s.animation;this.handleAnimation(e,i,a,n,t);break}case"messageAudio":{const i=s.audio;this.handleAudio(e,i,a,n,t);break}case"messageChatChangePhoto":{const i=s.photo;this.handlePhoto(e,i,a,n,t);break}case"messageDocument":{const i=s.document;this.handleDocument(e,i,a,n,t);break}case"messageGame":{const i=s.game;this.handleGame(e,i,a,n,t);break}case"messageLocation":{const i=s.location;this.handleLocation(e,i,a,n,t);break}case"messagePhoto":{const i=s.photo;this.handlePhoto(e,i,a,n,t);break}case"messageSticker":{const i=s.sticker;this.handleSticker(e,i,a,n,t);break}case"messageText":{const i=s.web_page;if(!i)break;const o=i.animation,r=i.audio,c=i.document,l=i.photo,d=i.sticker,h=i.video,u=i.video_note,p=i.voice_note;o&&this.handleAnimation(e,o,a,n,t),r&&this.handleAudio(e,r,a,n,t),c&&this.handleDocument(e,c,a,n,t),l&&this.handlePhoto(e,l,a,n,t),d&&this.handleSticker(e,d,a,n,t),h&&this.handleVideo(e,h,a,n,t),p&&this.handleVoiceNote(e,p,a,n,t),u&&this.handleVideoNote(e,u,a,n,t);break}case"messageVenue":{const i=s.venue.location;this.handleLocation(e,i,a,n,t);break}case"messageVideo":{const i=s.video;this.handleVideo(e,i,a,n,t);break}case"messageVideoNote":{const i=s.video_note;this.handleVideoNote(e,i,a,n,t);break}case"messageVoiceNote":{const i=s.voice_note;this.handleVoiceNote(e,i,a,n,t);break}}},this.handleAnimation=(e,t,a,n,s)=>{const i=s?s.chat_id:0,o=s?s.id:0;if(t.thumbnail){const r=t.thumbnail.photo;r&&r.id===a.id&&this.getLocalFile(e,r,n,()=>this.updateAnimationThumbnailBlob(i,o,a.id),()=>this.getRemoteFile(a.id,c.ob,s||t))}if(t.animation){const r=t.animation;r&&r.id===a.id&&this.getLocalFile(e,r,n,()=>this.updateAnimationBlob(i,o,a.id),()=>this.getRemoteFile(a.id,c.g,s||t))}},this.handleAudio=(e,t,a,n,s)=>{const i=s?s.chat_id:0,o=s?s.id:0;if(t.album_cover_thumbnail){const r=t.album_cover_thumbnail.photo;r&&r.id===a.id&&this.getLocalFile(e,r,n,()=>this.updateAudioThumbnailBlob(i,o,a.id),()=>this.getRemoteFile(a.id,c.ob,s||t))}if(t.audio){const r=t.audio;r&&r.id===a.id&&this.getLocalFile(e,r,n,()=>this.updateAudioBlob(i,o,a.id),()=>this.getRemoteFile(a.id,c.g,s||t))}},this.handleGame=(e,t,a,n,s)=>{if(!t)return;const i=t.animation,o=t.photo;o&&this.handlePhoto(e,o,a,n,s),i&&this.handleAnimation(e,i,a,n,s)},this.handleDocument=(e,t,a,n,s)=>{const i=s?s.chat_id:0,o=s?s.id:0;if(t.thumbnail){const r=t.thumbnail.photo;r&&r.id===a.id&&this.getLocalFile(e,r,n,()=>this.updateDocumentThumbnailBlob(i,o,a.id),()=>this.getRemoteFile(a.id,c.ob,s||t))}if(t.document){const r=t.document;r&&r.id===a.id&&this.getLocalFile(e,r,n,()=>this.updateDocumentBlob(i,o,a.id),()=>this.getRemoteFile(a.id,c.g,s||t))}},this.handleLocation=(e,t,a,n,s)=>{const i=s?s.chat_id:0,o=s?s.id:0,l=Object(r.m)(t);if(l){const r=this.getLocationFile(l);r&&r.id===a.id&&this.getLocalFile(e,r,n,()=>this.updateLocationBlob(i,o,a.id),()=>this.getRemoteFile(a.id,c.ob,s||t))}},this.handlePageBlockMap=(e,t,a,n,s)=>{const i=s?s.chat_id:0,o=s?s.id:0,l=t.location,d=Object(r.m)(l,c.i,c.h);if(d){const r=this.getLocationFile(d);r&&r.id===a.id&&this.getLocalFile(e,r,n,()=>this.updateLocationBlob(i,o,a.id),()=>this.getRemoteFile(a.id,c.ob,s||t))}},this.handlePhoto=(e,t,a,n,s)=>{const i=s?s.chat_id:0,o=s?s.id:0;if(t)for(let r=0;r<t.sizes.length;r++){const l=t.sizes[r];if(l){const r=l.photo;if(r&&r.id===a.id){this.getLocalFile(e,r,n,()=>this.updatePhotoBlob(i,o,a.id),()=>this.getRemoteFile(a.id,c.g,s||t));break}}}},this.handleSticker=(e,t,a,n,s)=>{const i=s?s.chat_id:0,o=s?s.id:0;if(t.thumbnail){const r=t.thumbnail.photo;r&&r.id===a.id&&this.getLocalFile(e,r,n,()=>this.updateStickerThumbnailBlob(i,o,a.id),()=>this.getRemoteFile(a.id,c.ob,s||t))}if(t.sticker){const r=t.sticker;r&&r.id===a.id&&this.getLocalFile(e,r,n,()=>this.updateStickerBlob(i,o,a.id),()=>this.getRemoteFile(a.id,c.g,s||t))}},this.handleVoiceNote=(e,t,a,n,s)=>{const i=s?s.chat_id:0,o=s?s.id:0;if(t.voice){const r=t.voice;r&&r.id===a.id&&this.getLocalFile(e,r,n,()=>this.updateVoiceNoteBlob(i,o,a.id),()=>this.getRemoteFile(a.id,c.g,s||t))}},this.handleVideoNote=(e,t,a,n,s)=>{const i=s?s.chat_id:0,o=s?s.id:0;if(t.thumbnail){const r=t.thumbnail.photo;r&&r.id===a.id&&this.getLocalFile(e,r,n,()=>this.updateVideoNoteThumbnailBlob(i,o,a.id),()=>this.getRemoteFile(a.id,c.ob,s||t))}if(t.video){const r=t.video;r&&r.id===a.id&&this.getLocalFile(e,r,n,()=>this.updateVideoNoteBlob(i,o,a.id),()=>this.getRemoteFile(a.id,c.g,s||t))}},this.handleVideo=(e,t,a,n,s)=>{const i=s?s.chat_id:0,o=s?s.id:0;if(t.thumbnail){const r=t.thumbnail.photo;r&&r.id===a.id&&this.getLocalFile(e,r,n,()=>this.updateVideoThumbnailBlob(i,o,a.id),()=>this.getRemoteFile(a.id,c.ob,s||t))}if(t.video){const r=t.video;r&&r.id===a.id&&this.getLocalFile(e,r,n,()=>this.updateVideoBlob(i,o,a.id),()=>this.getRemoteFile(a.id,c.g,s||t))}},this.deleteLocalFile=(e,t)=>{},this.get=e=>this.items.get(e),this.set=e=>{this.items.set(e.id,e)},this.getBlob=e=>this.blobItems.get(e),this.setBlob=(e,t)=>{this.blobItems.set(e,t)},this.deleteBlob=e=>{this.blobItems.delete(e)},this.getLocationFile=e=>{const t=this.locationItems.get(e);return this.get(t)},this.setLocationFile=(e,t)=>{this.locationItems.set(e,t.id),this.set(t)},this.getDataUrl=e=>e&&this.dataUrls.has(e)?this.dataUrls.get(e):null,this.setDataUrl=(e,t)=>{this.dataUrls.set(e,t)},this.deleteDataUrl=e=>{this.dataUrls.delete(e)},this.getBlobUrl=e=>{if(!e)return null;if(this.urls.has(e))return this.urls.get(e);const t=URL.createObjectURL(e);return this.urls.set(e,t),t},this.deleteBlobUrl=e=>{this.urls.has(e)&&this.urls.delete(e)},this.updatePhotoBlob=(e,t,a)=>{this.emit("clientUpdatePhotoBlob",{chatId:e,messageId:t,fileId:a})},this.updateAudioThumbnailBlob=(e,t,a)=>{l.a.clientUpdate({"@type":"clientUpdateAudioThumbnailBlob",chatId:e,messageId:t,fileId:a})},this.updateAudioBlob=(e,t,a)=>{l.a.clientUpdate({"@type":"clientUpdateAudioBlob",chatId:e,messageId:t,fileId:a})},this.updateVoiceNoteBlob=(e,t,a)=>{this.emit("clientUpdateVoiceNoteBlob",{chatId:e,messageId:t,fileId:a})},this.updateVideoNoteThumbnailBlob=(e,t,a)=>{this.emit("clientUpdateVideoNoteThumbnailBlob",{chatId:e,messageId:t,fileId:a})},this.updateVideoNoteBlob=(e,t,a)=>{this.emit("clientUpdateVideoNoteBlob",{chatId:e,messageId:t,fileId:a})},this.updateAnimationThumbnailBlob=(e,t,a)=>{this.emit("clientUpdateAnimationThumbnailBlob",{chatId:e,messageId:t,fileId:a})},this.updateAnimationBlob=(e,t,a)=>{this.emit("clientUpdateAnimationBlob",{chatId:e,messageId:t,fileId:a})},this.updateDocumentBlob=(e,t,a)=>{l.a.clientUpdate({"@type":"clientUpdateDocumentBlob",chatId:e,messageId:t,fileId:a})},this.updateVideoThumbnailBlob=(e,t,a)=>{this.emit("clientUpdateVideoThumbnailBlob",{chatId:e,messageId:t,fileId:a})},this.updateVideoBlob=(e,t,a)=>{this.emit("clientUpdateVideoBlob",{chatId:e,messageId:t,fileId:a})},this.updateStickerThumbnailBlob=(e,t,a)=>{this.emit("clientUpdateStickerThumbnailBlob",{chatId:e,messageId:t,fileId:a})},this.updateStickerBlob=(e,t,a)=>{this.emit("clientUpdateStickerBlob",{chatId:e,messageId:t,fileId:a})},this.updateLocationBlob=(e,t,a)=>{this.emit("clientUpdateLocationBlob",{chatId:e,messageId:t,fileId:a})},this.updateDocumentThumbnailBlob=(e,t,a)=>{this.emit("clientUpdateDocumentThumbnailBlob",{chatId:e,messageId:t,fileId:a})},this.reset(),this.addTdLibListener()}initDB(e){var t=this;return Object(i.a)(s.a.mark((function a(){var n;return s.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!t.db){a.next=3;break}return e&&e(),a.abrupt("return");case 3:if(!t.initiatingDB){a.next=6;break}return e&&t.callbacks.push(e),a.abrupt("return");case 6:return e&&t.callbacks.push(e),t.initiatingDB=!0,a.next=10,t.openDB().catch(e=>console.log("[FileStore] initDB error",e));case 10:if(t.db=a.sent,t.initiatingDB=!1,t.callbacks.length){for(n=0;n<t.callbacks.length;n++)t.callbacks[n]();t.callbacks=[]}case 13:case"end":return a.stop()}}),a)})))()}openDB(){return new Promise((e,t)=>{const a=window.indexedDB.open("tdlib");a.onsuccess=()=>e(a.result),a.onerror=()=>t(a.error)})}getStore(){}getReadWriteStore(){}getLocalFile(e,t,a,n,o){var r=this;return(t=this.get(t.id)||t)&&t.local&&!t.local.is_downloading_completed?void o():void function(){var e=Object(i.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.a.send({"@type":"readFile",file_id:t.id});case 2:a=e.sent,r.setBlob(t.id,a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(t).then(n,o)}getRemoteFile(e,t,a){const n=this.downloads.get(e)||[];n.some(e=>e===a)||(n.push(a),this.downloads.set(e,n),l.a.send({"@type":"downloadFile",file_id:e,priority:t}))}cancelGetRemoteFile(e,t){if(this.downloads.has(e)){if(t){const a=this.downloads.get(e).filter(e=>e!==t);this.downloads.set(e,a)}else this.downloads.delete(e);l.a.send({"@type":"cancelDownloadFile",file_id:e,only_if_pending:!1})}}uploadFile(e,t){if(this.uploads.has(e)){this.uploads.get(e).push(t)}else this.uploads.set(e,[t]);console.log("[perf] uploadFile file_id="+e)}cancelUploadFile(e,t){this.uploads.has(e)&&(this.uploads.delete(e),console.log("cancel_upload_message id="+t.id),l.a.send({"@type":"deleteMessages",chat_id:t.chat_id,message_ids:[t.id],revoke:!0}))}updateUserPhotoBlob(e,t){this.emit("clientUpdateUserBlob",{userId:e,fileId:t})}updateChatPhotoBlob(e,t){this.emit("clientUpdateChatBlob",{chatId:e,fileId:t})}}const h=new d;window.file=h,t.a=h},,function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return s})),a.d(t,"c",(function(){return i})),a.d(t,"d",(function(){return o})),a.d(t,"e",(function(){return r})),a.d(t,"f",(function(){return c})),a.d(t,"g",(function(){return l})),a.d(t,"h",(function(){return d})),a.d(t,"i",(function(){return h})),a.d(t,"k",(function(){return u})),a.d(t,"j",(function(){return p})),a.d(t,"l",(function(){return m})),a.d(t,"m",(function(){return g})),a.d(t,"n",(function(){return f})),a.d(t,"o",(function(){return b})),a.d(t,"p",(function(){return C})),a.d(t,"q",(function(){return y})),a.d(t,"r",(function(){return v})),a.d(t,"s",(function(){return E})),a.d(t,"t",(function(){return S})),a.d(t,"u",(function(){return U})),a.d(t,"v",(function(){return k})),a.d(t,"w",(function(){return w})),a.d(t,"x",(function(){return M})),a.d(t,"y",(function(){return I})),a.d(t,"z",(function(){return _})),a.d(t,"A",(function(){return x})),a.d(t,"B",(function(){return O})),a.d(t,"D",(function(){return P})),a.d(t,"E",(function(){return T})),a.d(t,"C",(function(){return N})),a.d(t,"F",(function(){return D})),a.d(t,"G",(function(){return L})),a.d(t,"L",(function(){return j})),a.d(t,"K",(function(){return R})),a.d(t,"I",(function(){return A})),a.d(t,"H",(function(){return F})),a.d(t,"J",(function(){return B})),a.d(t,"R",(function(){return V})),a.d(t,"Q",(function(){return z})),a.d(t,"S",(function(){return H})),a.d(t,"O",(function(){return W})),a.d(t,"N",(function(){return G})),a.d(t,"P",(function(){return K})),a.d(t,"M",(function(){return Z})),a.d(t,"T",(function(){return q})),a.d(t,"U",(function(){return Y})),a.d(t,"V",(function(){return J})),a.d(t,"X",(function(){return Q})),a.d(t,"W",(function(){return X})),a.d(t,"Y",(function(){return $})),a.d(t,"Z",(function(){return ee})),a.d(t,"cb",(function(){return te})),a.d(t,"bb",(function(){return ae})),a.d(t,"ab",(function(){return ne})),a.d(t,"db",(function(){return se})),a.d(t,"eb",(function(){return ie})),a.d(t,"gb",(function(){return oe})),a.d(t,"fb",(function(){return re})),a.d(t,"hb",(function(){return ce})),a.d(t,"ib",(function(){return le})),a.d(t,"jb",(function(){return de})),a.d(t,"kb",(function(){return he})),a.d(t,"lb",(function(){return ue})),a.d(t,"mb",(function(){return pe})),a.d(t,"nb",(function(){return me})),a.d(t,"ob",(function(){return ge})),a.d(t,"pb",(function(){return fe})),a.d(t,"qb",(function(){return be})),a.d(t,"sb",(function(){return Ce})),a.d(t,"tb",(function(){return ye})),a.d(t,"ub",(function(){return ve})),a.d(t,"vb",(function(){return Ee})),a.d(t,"rb",(function(){return Se})),a.d(t,"xb",(function(){return Ue})),a.d(t,"wb",(function(){return ke}));const n=100,s=200,i=300,o="Telegram Web",r=25,c=100,l=1,d=300,h=600,u=800,p=600,m="auth",g="suggested_language_pack_id",f=150,b=2,C=300,y=16,v=10,E=20,S=30,U=600,k=2147483647,w=0,M=5e3,I=5e3,_=500,x=!0,O=1280,P=420,T=65,N=40,D=320,L=90,j=.25,R=0,A=1,F=1.75,B=250,V=255,z=V-79,H=V+99,W=100,G=W-29,K=W+99,Z=10,q=15,Y=5,J=50,Q=204800,X=204800,$=204800,ee=2048e3,te=204800,ae=10485760,ne=204800,se=640,ie=160,oe=0,re=400,ce=777e3,le=30,de=192,he=76,ue=256,pe=64,me=90,ge=32,fe=8,be=8,Ce=20,ye=0,ve=20,Ee=0,Se=5,Ue="93851361833a55534e17170c3e15da85.wasm",ke=Ue.replace(".wasm","")},function(e,t,a){"use strict";var n=a(40),s=a(34),i=a(4);var o=class{constructor(e,t){this.actions=new Map,this.timerId=null,this.chatId=e,this.timeoutCallback=t,this.handleTimer=this.handleTimer.bind(this),this.addAction=this.addAction.bind(this),this.clearAction=this.clearAction.bind(this),this.setActionsTimeout=this.setActionsTimeout.bind(this)}handleTimer(){let e=new Date,t=[];var a=!0,n=!1,i=void 0;try{for(var o,r=this.actions[Symbol.iterator]();!(a=(o=r.next()).done);a=!0){let a=Object(s.a)(o.value,2),n=a[0];a[1].expire-e<=0&&t.push(n)}}catch(h){n=!0,i=h}finally{try{a||null==r.return||r.return()}finally{if(n)throw i}}for(var c=0,l=t;c<l.length;c++){let e=l[c];this.actions.delete(e)}let d={"@type":"updateUserChatAction",chat_id:this.chatId,action:{"@type":"chatActionTimerUpdate"}};this.timeoutCallback(d),this.setActionsTimeout()}addAction(e,t){let a=new Date;a.setSeconds(a.getSeconds()+i.pb),this.actions.set(e,{expire:a,action:t}),this.timerId&&clearTimeout(this.timerId),this.setActionsTimeout()}setActionsTimeout(){let e=new Date,t=1e6;var a=!0,n=!1,i=void 0;try{for(var o,r=this.actions[Symbol.iterator]();!(a=(o=r.next()).done);a=!0){let a=Object(s.a)(o.value,2),n=(a[0],a[1].expire-e);n<t&&(t=n),t<0&&(t=0)}}catch(c){n=!0,i=c}finally{try{a||null==r.return||r.return()}finally{if(n)throw i}}t<1e6&&(this.timerId=setTimeout(this.handleTimer,t))}clearAction(e){this.actions.delete(e),this.timerId&&clearTimeout(this.timerId),this.setActionsTimeout()}},r=a(22),c=a(1);class l extends n.a{constructor(){super(),this.reset=()=>{this.items=new Map,this.typingManagers=new Map,this.onlineMemberCount=new Map,this.counters=new Map,this.skippedUpdates=[],this.chatList=new Map},this.loadClientData=()=>{const e=new Map;try{let t=localStorage.get("clientData");t&&(t=JSON.parse(t),t&&Object.keys(t).forEach(a=>{e.set(Number(a),t[a])}))}catch(t){}this.clientData=e},this.saveClientData=()=>{const e=Array.from(this.clientData.entries()).reduce((e,[t,a])=>(a&&(e[String(t)]=a),e),{});localStorage.setItem("clientData",JSON.stringify(e))},this.onUpdate=e=>{switch(e["@type"]){case"updateAuthorizationState":{const t=e.authorization_state;if(!t)break;switch(t["@type"]){case"authorizationStateClosed":this.reset()}break}case"updateConnectionState":"connectionStateUpdating"===e.state["@type"]?(this.updating=!0,this.skippedUpdates=[]):(this.updating=!1,this.skippedUpdates.length>0&&(c.a.parameters.fastUpdating=!1,this.emitUpdate({"@type":"clientUpdateFastUpdatingComplete",updates:this.skippedUpdates}),this.skippedUpdates=[]));break;case"updateChatActionBar":{const t=e.chat_id,a=e.action_bar,n=this.get(t);n&&this.assign(n,{action_bar:a}),this.emitFastUpdate(e);break}case"updateChatChatList":{const t=e.chat_id,a=e.chat_list,n=this.get(t);n&&this.assign(n,{chat_list:a}),this.updateChatChatList(t,a),this.emitFastUpdate(e);break}case"updateChatDefaultDisableNotification":this.emitFastUpdate(e);break;case"updateChatOnlineMemberCount":this.setOnlineMemberCount(e.chat_id,e.online_member_count),this.emitFastUpdate(e);break;case"updateChatDraftMessage":{const t=e.chat_id,a=e.order,n=e.draft_message,s=this.get(t);s&&this.assign(s,{order:"0"===a?s.order:a,draft_message:n}),this.emitFastUpdate(e);break}case"updateChatIsMarkedAsUnread":{const t=e.chat_id,a=e.is_marked_as_unread,n=this.get(t);n&&this.assign(n,{is_marked_as_unread:a}),this.emitFastUpdate(e);break}case"updateChatIsPinned":{const t=e.chat_id,a=e.order,n=e.is_pinned,s=this.get(t);s&&this.assign(s,{order:a,is_pinned:n}),this.emitFastUpdate(e);break}case"updateChatIsSponsored":{const t=e.chat_id,a=e.order,n=e.is_sponsored,s=this.get(t);s&&this.assign(s,{order:a,is_sponsored:n}),this.emitFastUpdate(e);break}case"updateChatLastMessage":{const t=e.chat_id,a=e.order,n=e.last_message,s=this.get(t);s&&this.assign(s,{order:"0"===a?s.order:a,last_message:n}),this.emitFastUpdate(e);break}case"updateChatNotificationSettings":{const t=e.chat_id,a=e.notification_settings,n=this.get(t);n&&this.assign(n,{notification_settings:a}),this.emitFastUpdate(e);break}case"updateChatOrder":{const t=e.chat_id,a=e.order,n=this.get(t);n&&this.assign(n,{order:a}),this.emitFastUpdate(e);break}case"updateChatPhoto":{const t=e.chat_id,a=e.photo,n=this.get(t);if(n)switch(this.assign(n,{photo:a}),n.type["@type"]){case"chatTypeBasicGroup":case"chatTypeSupergroup":break;case"chatTypePrivate":case"chatTypeSecret":{const t=r.a.get(n.type.user_id);t&&r.a.assign(t,{profile_photo:e.photo});break}}this.emitFastUpdate(e);break}case"updateChatPinnedMessage":{const t=e.chat_id,a=e.pinned_message_id,n=this.get(t);n&&this.assign(n,{pinned_message_id:a}),this.emitFastUpdate(e);break}case"updateChatReadInbox":{const t=e.chat_id,a=e.last_read_inbox_message_id,n=e.unread_count,s=this.get(t);s&&this.assign(s,{last_read_inbox_message_id:a,unread_count:n}),this.emitFastUpdate(e);break}case"updateChatReadOutbox":{const t=e.chat_id,a=e.last_read_outbox_message_id,n=this.get(t);n&&this.assign(n,{last_read_outbox_message_id:a}),this.emitFastUpdate(e);break}case"updateChatReplyMarkup":{const t=e.chat_id,a=e.reply_markup_message_id,n=this.get(t);n&&this.assign(n,{reply_markup_message_id:a}),this.emitFastUpdate(e);break}case"updateChatTitle":{const t=e.chat_id,a=e.title,n=this.get(t);n&&this.assign(n,{title:a}),this.emitFastUpdate(e);break}case"updateChatUnreadMentionCount":{const t=e.chat_id,a=e.unread_mention_count,n=this.get(t);n&&this.assign(n,{unread_mention_count:a}),this.emitFastUpdate(e);break}case"updateNewChat":this.set(e.chat),this.emitFastUpdate(e);break;case"updateSecretChat":case"updateUnreadChatCount":this.emitFastUpdate(e);break;case"updateUserChatAction":{let t=this.getTypingManager(e.chat_id);t||(t=new o(e.chat_id,e=>this.emitUpdate(e)),this.setTypingManager(e.chat_id,t));const a=e.user_id;"chatActionCancel"===e.action["@type"]?t.clearAction(a):t.addAction(a,e.action),this.emitFastUpdate(e);break}case"updateMessageMentionRead":{const t=e.chat_id,a=e.unread_mention_count,n=this.get(t);n&&this.assign(n,{unread_mention_count:a}),this.emitFastUpdate(e);break}}},this.onClientUpdate=e=>{switch(e["@type"]){case"clientUpdateClearHistory":case"clientUpdateCloseArchive":case"clientUpdateCloseContacts":case"clientUpdateCloseSettings":case"clientUpdateLeaveChat":case"clientUpdateOpenArchive":case"clientUpdateOpenChat":case"clientUpdateOpenContacts":case"clientUpdateOpenSettings":this.emitUpdate(e);break;case"clientUpdateSetChatClientData":{const t=e.chatId,a=e.clientData;c.a.send({"@type":"setChatClientData",chat_id:t,client_data:JSON.stringify(a)}),this.setClientData(t,a),this.saveClientData(),this.emitUpdate(e);break}case"clientUpdateUnpin":this.emitUpdate(e)}},this.emitUpdate=e=>{this.emit(e["@type"],e)},this.emitFastUpdate=e=>{this.updating&&c.a.parameters.fastUpdating?this.skippedUpdates.push(e):this.emit(e["@type"],e)},this.addTdLibListener=()=>{c.a.on("update",this.onUpdate),c.a.on("clientUpdate",this.onClientUpdate)},this.removeTdLibListener=()=>{c.a.off("update",this.onUpdate),c.a.off("clientUpdate",this.onClientUpdate)},this.reset(),this.loadClientData(),this.addTdLibListener()}updateChatChatList(e,t){if(!t){var a=!0,n=!1,s=void 0;try{for(var i,o=this.chatList.keys()[Symbol.iterator]();!(a=(i=o.next()).done);a=!0){const t=i.value;this.chatList.get(t).delete(e)}}catch(p){n=!0,s=p}finally{try{a||null==o.return||o.return()}finally{if(n)throw s}}return}let r=this.chatList.get(t["@type"]);r||(r=new Map,this.chatList.set(t["@type"],r)),r.set(e,e);var c=!0,l=!1,d=void 0;try{for(var h,u=this.chatList.keys()[Symbol.iterator]();!(c=(h=u.next()).done);c=!0){const a=h.value;a!==t["@type"]&&this.chatList.get(a).delete(e)}}catch(p){l=!0,d=p}finally{try{c||null==u.return||u.return()}finally{if(l)throw d}}}assign(e,t){this.set(Object.assign({},e,t))}get(e){return this.items.get(e)}set(e){this.items.set(e.id,e)}getCounters(e){return this.counters.get(e)}setCounters(e,t){this.counters.set(e,t)}getClientData(e){return this.clientData.get(e)||{}}setClientData(e,t){this.clientData.set(e,t)}setOnlineMemberCount(e,t){this.onlineMemberCount.set(e,t)}getOnlineMemberCount(e){return this.onlineMemberCount.get(e)||0}getTypingManager(e){return this.typingManagers.get(e)}setTypingManager(e,t){return this.typingManagers.set(e,t)}}const d=new l;window.chat=d;t.a=d},,function(e,t,a){"use strict";var n=a(6),s=a.n(n),i=a(13),o=a(40),r=a(34);var c=class{constructor(e,t){var a=this;this.add=(e,t,a,n)=>{if(this.actions.has(e))return!1;let s=new Date;return s.setMilliseconds(s.getMilliseconds()+t),this.actions.set(e,{expire:s,action:a,cancel:n}),this.timerId&&clearTimeout(this.timerId),this.setTimeout(),!0},this.invoke=function(){var e=Object(i.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.actions.get(t)){e.next=3;break}return e.abrupt("return");case 3:return a.actions.delete(t),e.next=6,a.actionCallback({key:t,action:n.action,cancel:n.cancel});case 6:if(!n.action){e.next=9;break}return e.next=9,n.action();case 9:a.timerId&&clearTimeout(a.timerId),a.setTimeout();case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.remove=e=>{const t=this.actions.get(e);t&&(this.actions.delete(e),this.cancelCallback({key:e,action:t.action,cancel:t.cancel}),t.cancel&&t.cancel(),this.timerId&&clearTimeout(this.timerId),this.setTimeout())},this.setTimeout=()=>{let e=new Date,t=1e6;var a=!0,n=!1,s=void 0;try{for(var i,o=this.actions[Symbol.iterator]();!(a=(i=o.next()).done);a=!0){let a=Object(r.a)(i.value,2),n=(a[0],a[1].expire-e);n<t&&(t=n),t<0&&(t=0)}}catch(c){n=!0,s=c}finally{try{a||null==o.return||o.return()}finally{if(n)throw s}}t<1e6&&(this.timerId=setTimeout(this.handleTimer,t))},this.handleTimer=()=>{let e=new Date,t=[];var a=!0,n=!1,s=void 0;try{for(var i,o=this.actions[Symbol.iterator]();!(a=(i=o.next()).done);a=!0){let a=Object(r.a)(i.value,2),n=a[0],s=a[1];s.expire-e<=0&&t.push({key:n,value:s})}}catch(d){n=!0,s=d}finally{try{a||null==o.return||o.return()}finally{if(n)throw s}}for(var c=0,l=t;c<l.length;c++){let e=l[c];this.actions.delete(e.key),this.actionCallback({key:e.key,action:e.value.action,cancel:e.value.cancel}),e.value.action&&e.value.action()}this.setTimeout()},this.actions=new Map,this.actionCallback=e,this.cancelCallback=t}},l=a(21),d=a(122),h=a(1);class u extends o.a{constructor(){var e;super(),e=this,this.reset=()=>{this.dialogsReady=!1,this.cacheLoaded=!1,this.setPhoneNumberRequest=null,this.chatId=0,this.dialogChatId=0,this.messageId=null,this.statistics=new Map,this.authorizationState=null,this.defaultPhone=null,this.connectionState=null,this.isChatDetailsVisible=!1,this.mediaViewerContent=null,this.profileMediaViewerContent=null,this.dragParams=null,this.actionScheduler=new c(this.handleScheduledAction,this.handleCancelScheduledAction)},this.addScheduledAction=(e,t,a,n)=>this.actionScheduler.add(e,t,a,n),this.invokeScheduledAction=function(){var t=Object(i.a)(s.a.mark((function t(a){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.actionScheduler.invoke(a);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.removeScheduledAction=e=>{this.actionScheduler.remove(e)},this.handleScheduledAction=e=>{console.log("Invoked scheduled action key=",e.key)},this.handleCancelScheduledAction=e=>{console.log("Cancel scheduled action key=",e.key)},this.onUpdate=e=>{switch(e["@type"]){case"updateAuthorizationState":switch(this.authorizationState=e.authorization_state,e.authorization_state["@type"]){case"authorizationStateLoggingOut":this.loggingOut=!0;break;case"authorizationStateWaitTdlibParameters":h.a.sendTdParameters();break;case"authorizationStateWaitEncryptionKey":h.a.send({"@type":"checkDatabaseEncryptionKey"});break;case"authorizationStateWaitPhoneNumber":this.setPhoneNumberRequest&&(this.setPhoneNumberRequest(),this.setPhoneNumberRequest=null);break;case"authorizationStateWaitCode":case"authorizationStateWaitPassword":break;case"authorizationStateReady":this.loggingOut=!1,this.setPhoneNumberRequest=null,Object(d.b)();break;case"authorizationStateClosing":break;case"authorizationStateClosed":this.reset(),this.loggingOut?h.a.init():(document.title+=": Zzz\u2026",h.a.clientUpdate({"@type":"clientUpdateAppInactive"}))}this.emit(e["@type"],e);break;case"updateChatIsMarkedAsUnread":{const t=e.chat_id,a=e.is_marked_as_unread;t===this.chatId&&a&&Object(l.b)();break}case"updateConnectionState":this.connectionState=e.state,this.emit(e["@type"],e);break;case"updateFatalError":this.emit(e["@type"],e);break;case"updateServiceNotification":{const t=e.type,a=e.content;if(!a)return;if("messageText"===a["@type"]){const e=a.text;if(!e)return;if("formattedText"===e["@type"]&&e.text)switch(t){case"AUTH_KEY_DROP_DUPLICATE":window.confirm(e.text)&&h.a.logOut();break;default:alert(e.text)}}break}}},this.onClientUpdate=e=>{switch(e["@type"]){case"clientUpdateAppInactive":this.emit("clientUpdateAppInactive");break;case"clientUpdateCacheLoaded":this.cacheLoaded=!0,this.emit("clientUpdateCacheLoaded");break;case"clientUpdateChatId":{const t={"@type":"clientUpdateChatId",nextChatId:e.chatId,nextMessageId:e.messageId,previousChatId:this.chatId,previousMessageId:this.messageId};this.chatId=e.chatId,this.messageId=e.messageId,this.emit("clientUpdateChatId",t);break}case"clientUpdateTdLibDatabaseExists":this.emit("clientUpdateTdLibDatabaseExists",e);break;case"clientUpdateDeleteMessages":this.emit("clientUpdateDeleteMessages",e);break;case"clientUpdateDialogsReady":this.dialogsReady=!0,this.emit("clientUpdateDialogsReady",e);break;case"clientUpdateDragging":{const t=e.dragging,a=e.files;this.dragParams=t?{dragging:t,files:a}:null,this.emit("clientUpdateDragging",e);break}case"clientUpdateEditMessage":this.emit("clientUpdateEditMessage",e);break;case"clientUpdateMediaViewerContent":{const t=e.content;this.mediaViewerContent=t,this.emit("clientUpdateMediaViewerContent",e);break}case"clientUpdateProfileMediaViewerContent":{const t=e.content;this.profileMediaViewerContent=t,this.emit("clientUpdateProfileMediaViewerContent",e);break}case"clientUpdateSearchChat":this.emit("clientUpdateSearchChat",e);break;case"clientUpdateSetPhone":{const t=e.phone;this.defaultPhone=t,t?this.authorizationState&&"authorizationStateWaitPhoneNumber"===this.authorizationState["@type"]?this.setPhoneNumber(t):this.setPhoneNumberRequest=()=>this.setPhoneNumber(t):(this.setPhoneNumberRequest=null,h.a.clientUpdate({"@type":"clientUpdateSetPhoneCanceled"})),this.emit("clientUpdateSetPhone",e);break}case"clientUpdateSetPhoneResult":this.emit("clientUpdateSetPhoneResult",e);break;case"clientUpdateSetPhoneError":this.emit("clientUpdateSetPhoneError",e);break;case"clientUpdateDialogChatId":{const t=e.chatId;this.dialogChatId=t,this.emit("clientUpdateDialogChatId",e);break}case"clientUpdateFocusWindow":if(!this.authorizationState)break;h.a.send({"@type":"setOption",name:"online",value:{"@type":"optionValueBoolean",value:e.focused}}),this.emit("clientUpdateFocusWindow",e);break;case"clientUpdateForward":this.emit("clientUpdateForward",e);break;case"clientUpdateLeaveChat":e.inProgress&&this.chatId===e.chatId&&h.a.setChatId(0)}},this.setPhoneNumber=e=>{h.a.send({"@type":"setAuthenticationPhoneNumber",phone_number:e}).then(e=>{h.a.clientUpdate({"@type":"clientUpdateSetPhoneResult",result:e})}).catch(e=>{h.a.clientUpdate({"@type":"clientUpdateSetPhoneError",error:e})})},this.onUpdateStatistics=e=>{if(e)if(this.statistics.has(e["@type"])){const t=this.statistics.get(e["@type"]);this.statistics.set(e["@type"],t+1)}else this.statistics.set(e["@type"],1)},this.addTdLibListener=()=>{h.a.on("update",this.onUpdate),h.a.on("clientUpdate",this.onClientUpdate)},this.removeTdLibListener=()=>{h.a.off("update",this.onUpdate),h.a.off("clientUpdate",this.onClientUpdate)},this.addStatistics=()=>{h.a.on("update",this.onUpdateStatistics)},this.setChatId=(e,t=null)=>{const a={"@type":"clientUpdateChatId",nextChatId:e,nextMessageId:t,previousChatId:this.chatId,previousMessageId:this.messageId};this.chatId=e,this.messageId=t,this.emit(a["@type"],a)},this.reset(),this.addTdLibListener(),this.addStatistics()}getChatId(){return this.chatId}getMessageId(){return this.messageId}changeChatDetailsVisibility(e){this.isChatDetailsVisible=e,this.emit("clientUpdateChatDetailsVisibility",e)}getConnectionState(){return this.connectionState}getAuthorizationState(){return this.authorizationState}assign(e,t){Object.assign(e,t)}}const p=new u;window.app=p;t.a=p},function(e,t,a){"use strict";var n=a(40),s=a(1);class i extends n.a{constructor(){super(),this.reset=()=>{this.items=new Map,this.selectedItems=new Map},this.onUpdate=e=>{switch(e["@type"]){case"updateAuthorizationState":{const t=e.authorization_state;if(!t)break;switch(t["@type"]){case"authorizationStateClosed":this.reset()}break}case"updateNewMessage":this.set(e.message),this.emit("updateNewMessage",e);break;case"updateDeleteMessages":this.emit("updateDeleteMessages",e);break;case"updateMessageEdited":{const t=this.items.get(e.chat_id);if(t){const a=t.get(e.message_id);a&&(a.reply_markup=e.reply_markup,a.edit_date=e.edit_date)}this.emit("updateMessageEdited",e);break}case"updateMessageViews":{const t=this.items.get(e.chat_id);if(t){const a=t.get(e.message_id);a&&e.views>a.views&&(a.views=e.views)}this.emit("updateMessageViews",e);break}case"updateMessageContent":{const t=this.items.get(e.chat_id);if(t){const a=t.get(e.message_id);a&&(e.old_content=a.content,a.content=e.new_content)}this.emit("updateMessageContent",e);break}case"updateMessageContentOpened":{const t=e.chat_id,a=e.message_id,n=this.get(t,a);if(n){switch(n.content["@type"]){case"messageVoiceNote":n.content.is_listened=!0;break;case"messageVideoNote":n.content.is_viewed=!0}}this.emit("updateMessageContentOpened",e);break}case"updateMessageSendSucceeded":{const t=this.items.get(e.message.chat_id);if(t){const a=t.get(e.old_message_id);a&&(a.sending_state=e.message.sending_state),e.old_message_id!==e.message.id&&this.set(e.message)}this.set(e.message),this.emit("updateMessageSendSucceeded",e);break}case"updateMessageSendFailed":{e.message.sending_state&&(e.message.sending_state.error_code=e.error_code,e.message.sending_state.error_message=e.error_message);const t=this.items.get(e.message.chat_id);if(t){const a=t.get(e.old_message_id);a&&(a.sending_state=e.message.sending_state,a.sending_state&&(a.sending_state.error_code=e.error_code,a.sending_state.error_message=e.error_message)),e.old_message_id!==e.message.id&&this.set(e.message)}this.emit("updateMessageSendFailed",e);break}}},this.onClientUpdate=e=>{switch(e["@type"]){case"clientUpdateChatId":this.selectedItems.size>0&&(this.selectedItems.clear(),this.emit("clientUpdateClearSelection",{"@type":"clientUpdateClearSelection"}));break;case"clientUpdateClearSelection":this.selectedItems.clear(),this.emit("clientUpdateClearSelection",e);break;case"clientUpdateMessageShake":this.emit("clientUpdateMessageShake",e);break;case"clientUpdateMessageHighlighted":this.emit("clientUpdateMessageHighlighted",e);break;case"clientUpdateMessageSelected":e.selected?this.selectedItems.set("chatId=".concat(e.chatId,"_messageId=").concat(e.messageId),{chatId:e.chatId,messageId:e.messageId}):this.selectedItems.delete("chatId=".concat(e.chatId,"_messageId=").concat(e.messageId)),this.emit("clientUpdateMessageSelected",e);break;case"clientUpdateMessagesInView":this.emit("clientUpdateMessagesInView",e);break;case"clientUpdateOpenReply":this.emit("clientUpdateOpenReply",e);break;case"clientUpdateReply":this.emit("clientUpdateReply",e);break;case"clientUpdateTryEditMessage":this.emit("clientUpdateTryEditMessage",e)}},this.addTdLibListener=()=>{s.a.on("update",this.onUpdate),s.a.on("clientUpdate",this.onClientUpdate)},this.removeTdLibListener=()=>{s.a.off("update",this.onUpdate),s.a.off("clientUpdate",this.onClientUpdate)},this.reset(),this.addTdLibListener()}hasSelectedMessage(e,t){return this.selectedItems.has("chatId=".concat(e,"_messageId=").concat(t))}load(e,t){s.a.send({"@type":"getMessage",chat_id:e,message_id:t}).then(e=>{this.set(e),this.emit("getMessageResult",e)}).catch(a=>{const n={"@type":"deletedMessage",chat_id:e,id:t,content:null};this.set(n),this.emit("getMessageResult",n)})}get(e,t){let a=this.items.get(e);if(!a)return null;let n=a.get(t);return n||null}set(e){if(!e)return;let t=this.items.get(e.chat_id);t||(t=new Map,this.items.set(e.chat_id,t)),t.set(e.id,e)}setItems(e){for(let t=0;t<e.length;t++)this.set(e[t])}}const o=new i;window.message=o,t.a=o},function(e,t,a){"use strict";var n=a(6),s=a.n(n),i=a(13),o=(a(0),a(67)),r=a(28),c=a(30),l=a(5);var d=a(19),h=a(17),u=a(42),p=a(4),m=a(43),g=a(64),f=a(22),b=a(1),C=a(104);function y(e){const t=l.a.get(e);return!!t&&t.pinned_message_id>0}function v(e){const t=l.a.get(e);if(!t)return!1;const a=t.chat_list;return!!a&&"chatListArchive"===a["@type"]}function E(e){const t=l.a.get(e);if(!t)return!1;const a=t.is_sponsored,n=t.chat_list;return!a&&(!!n&&("chatListMain"!==n["@type"]||!Q(e)&&e!==p.hb))}function S(e,t){if(!e&&!t)return!0;if(e&&!t)return!1;if(t&&!e)return!1;const a=e.input_message_text,n=e.reply_to_message_id,s=t.input_message_text;if(n!==t.reply_to_message_id)return!1;if(a["@type"]!==s["@type"])return!1;if("inputMessageText"!==a["@type"])return!0;const i=a.text,o=s.text;if(!i&&!o)return!0;if(i&&!o)return!1;if(o&&!i)return!1;const r=i.text,c=i.entities,l=o.text,d=o.entities;return r===l&&function(e,t){if(!e&&!t)return!0;if(e&&!t)return!1;if(t&&!e)return!1;if(e.length!==t.length)return!1;const a=new Map;return e.forEach(e=>{a.set("".concat(e.type["@type"],"_").concat(e.offset,"_").concat(e.length),e)}),t.every(e=>a.has("".concat(e.type["@type"],"_").concat(e.offset,"_").concat(e.length)))}(c,d)}function U(e){const t=l.a.get(e);if(!t)return null;if(!t.type)return null;let a=l.a.getTypingManager(t.id);if(!a)return null;switch(t.type["@type"]){case"chatTypePrivate":case"chatTypeSecret":{const e=function(e){if(!e)return null;if(e.actions.size>=1){switch(e.actions.values().next().value.action["@type"]){case"chatActionRecordingVideo":return"recording a video";case"chatActionRecordingVideoNote":return"recording a video message";case"chatActionRecordingVoiceNote":return"recording a voice message";case"chatActionStartPlayingGame":return"playing a game";case"chatActionUploadingDocument":return"sending a file";case"chatActionUploadingPhoto":return"sending a photo";case"chatActionUploadingVideo":return"sending a video";case"chatActionUploadingVideoNote":return"sending a video message";case"chatActionUploadingVoiceNote":return"sending a voice message";case"chatActionChoosingContact":case"chatActionChoosingLocation":case"chatActionTyping":default:return"typing"}}return null}(a);return e?e+"...":null}case"chatTypeBasicGroup":case"chatTypeSupergroup":{const e=function(e){if(!e)return null;let t=e.actions.size;if(t>2)return"".concat(t," people are typing");if(t>1){let r,c;var a=!0,n=!1,s=void 0;try{for(var i,o=e.actions.keys()[Symbol.iterator]();!(a=(i=o.next()).done);a=!0){let e=i.value;if(r){if(!c){c=f.a.get(e);break}}else r=f.a.get(e)}}catch(u){n=!0,s=u}finally{try{a||null==o.return||o.return()}finally{if(n)throw s}}return r&&c?(r=r.first_name?r.first_name:r.second_name,c=c.first_name?c.first_name:c.second_name,r&&c?"".concat(r," and ").concat(c," are typing"):"".concat(t," people are typing")):"".concat(t," people are typing")}{let t;if(e.actions.size>=1){var r=!0,c=!1,l=void 0;try{for(var d,h=e.actions.keys()[Symbol.iterator]();!(r=(d=h.next()).done);r=!0){let e=d.value;if(!t){t=f.a.get(e);break}}}catch(u){c=!0,l=u}finally{try{r||null==h.return||h.return()}finally{if(c)throw l}}if(!t)return"1 person is typing";if(t=t.first_name?t.first_name:t.second_name,!t)return"1 person is typing";switch(e.actions.values().next().value.action["@type"]){case"chatActionRecordingVideo":return"".concat(t," is recording a video");case"chatActionRecordingVideoNote":return"".concat(t," is recording a video message");case"chatActionRecordingVoiceNote":return"".concat(t," is recording a voice message");case"chatActionStartPlayingGame":return"".concat(t," is playing a game");case"chatActionUploadingDocument":return"".concat(t," is sending a file");case"chatActionUploadingPhoto":return"".concat(t," is sending a photo");case"chatActionUploadingVideo":return"".concat(t," is sending a video");case"chatActionUploadingVideoNote":return"".concat(t," is sending a video message");case"chatActionUploadingVoiceNote":return"".concat(t," is sending a voice message");case"chatActionChoosingContact":case"chatActionChoosingLocation":case"chatActionTyping":default:return"".concat(t," is typing")}}}return null}(a);return e?e+"...":null}}return null}function k(e,t=(e=>e)){return e?Object(u.b)(e)?null:e.sender_user_id?Object(r.c)(e.sender_user_id,null,t):null:null}function w(e,t=(e=>e)){if(!e)return null;if(Object(u.b)(e))return null;const a=l.a.get(e.chat_id);return a&&"chatTypeBasicGroup"!==a.type["@type"]&&"chatTypeSupergroup"!==a.type["@type"]?null:Object(r.e)(e.sender_user_id,t)}function M(e,t=(e=>e)){return e?w(e.last_message,t):null}function I(e,t=(e=>e)){if(!e)return null;const a=e.last_message;return a?Object(h.f)(a,t):null}function _(e){const t=l.a.get(e);return!!t&&t.unread_mention_count>0}function x(e){const t=l.a.get(e);if(!t)return!1;const a=t.is_marked_as_unread,n=t.unread_count,s=t.unread_mention_count;return n>1||1===n&&0===s||a&&0===n&&0===s}function O(e){const t=l.a.get(e);if(!t)return!1;const a=t.is_marked_as_unread,n=t.unread_count;t.unread_mention_count;return a||n>0}function P(e){return function(e){const t=l.a.get(e);if(!t)return 0;const a=t.notification_settings;if(!a)return 0;const n=a.use_default_mute_for,s=a.mute_for;if(n){const t=D(e);return!!t&&t.mute_for}return s}(e)>0}function T(e){const t=l.a.get(e);if(!t)return!1;const a=t.notification_settings;if(!t)return!1;const n=a.use_default_disable_pinned_message_notifications,s=a.disable_pinned_message_notifications;if(n){const t=D(e);return!!t&&t.disable_pinned_message_notifications}return s}function N(e){const t=l.a.get(e);if(!t)return!1;const a=t.notification_settings;if(!a)return!1;const n=a.use_default_disable_mention_notifications,s=a.disable_mention_notifications;if(n){const t=D(e);return!!t&&t.disable_mention_notifications}return s}function D(e){const t=l.a.get(e);if(!t)return null;switch(t.type["@type"]){case"chatTypePrivate":case"chatTypeSecret":return g.a.settings.get("notificationSettingsScopePrivateChats");case"chatTypeBasicGroup":case"chatTypeSupergroup":{let t=null;return t=Z(e)?g.a.settings.get("notificationSettingsScopeChannelChats"):g.a.settings.get("notificationSettingsScopeGroupChats"),t}}return null}function L(e){const t=new Date(1e3*e.date),a=new Date;if(a.setHours(0,0,0,0),t>a)return Object(o.a)(t,"H:MM");const n=new Date,s=n.getDay(),i=n.getDate()-s+(0===s?-6:1);return t>new Date(n.setDate(i))?Object(o.a)(t,"ddd"):Object(o.a)(t,"d.mm.yyyy")}function j(e){return e&&e.last_message&&e.last_message.date?me(e.id)?null:L(e.last_message):null}function R(e){const t=l.a.get(e);if(!t)return null;const a=t.type;if(!a)return null;switch(a["@type"]){case"chatTypeBasicGroup":{const t=m.a.get(a.basic_group_id);if(t)return function(e,t){if(!e)return null;const a=e.status,n=e.member_count;if(a&&("chatMemberStatusBanned"===a["@type"]||"chatMemberStatusLeft"===a["@type"]||"chatMemberStatusCreator"===a["@type"]&&!a.is_member))return"group is inaccessible";if(!n)return"0 members";if(1===n)return"1 member";const s=l.a.getOnlineMemberCount(t);return s>1?"".concat(n," members, ").concat(s," online"):"".concat(n," members")}(t,e);break}case"chatTypePrivate":case"chatTypeSecret":{const e=f.a.get(a.user_id);if(e)return Object(r.f)(e);break}case"chatTypeSupergroup":{const t=c.a.get(a.supergroup_id);if(t)return function(e,t){if(!e)return null;let a=e.status,n=e.is_channel,s=e.member_count;if(a&&"chatMemberStatusBanned"===a["@type"])return n?"channel is inaccessible":"group is inaccessible";if(!s){const t=c.a.getFullInfo(e.id);t&&(s=t.member_count)}if(!s)return"0 members";if(1===s)return"1 member";const i=l.a.getOnlineMemberCount(t);return i>1?"".concat(s," members, ").concat(i," online"):"".concat(s," members")}(t,e);break}}return null}function A(e,t=!1){if(Q(e)&&t)return null;const a=U(e);return a||R(e)}function F(e,t){if(!e)return null;let a=e.title||t("HiddenName");if(0===a.length)return null;let n=Object(d.g)(a);return n&&n.length>0?n:e.title.charAt(0)}function B(e){const t=l.a.get(e);if(!t)return!1;if(!t.type)return!1;switch(t.type["@type"]){case"chatTypeBasicGroup":return!1;case"chatTypePrivate":case"chatTypeSecret":{const e=f.a.get(t.type.user_id);if(e)return Object(r.i)(e);break}case"chatTypeSupergroup":return!1}return!1}function V(e){return!U(e)&&B(e)}function z(e){const t=l.a.get(e);if(!t)return null;if(!t.type)return null;switch(t.type["@type"]){case"chatTypeBasicGroup":return null;case"chatTypePrivate":case"chatTypeSecret":{const e=f.a.get(t.type.user_id);if(e)return e.username;break}case"chatTypeSupergroup":{const e=c.a.get(t.type.supergroup_id);if(e)return e.username;break}}return null}function H(e){const t=l.a.get(e);if(!t)return null;if(!t.type)return null;switch(t.type["@type"]){case"chatTypeBasicGroup":return null;case"chatTypePrivate":case"chatTypeSecret":{const e=f.a.get(t.type.user_id);if(e)return Object(C.a)(e.phone_number);break}case"chatTypeSupergroup":return null}return null}function W(e){const t=l.a.get(e);if(!t)return null;if(!t.type)return null;switch(t.type["@type"]){case"chatTypeBasicGroup":return null;case"chatTypePrivate":case"chatTypeSecret":{const e=f.a.getFullInfo(t.type.user_id);if(e)return e.bio;break}case"chatTypeSupergroup":{const e=c.a.getFullInfo(t.type.supergroup_id);if(e)return e.description;break}}return null}function G(e){const t=l.a.get(e);if(!t)return!1;if(!t.type)return!1;switch(t.type["@type"]){case"chatTypeBasicGroup":case"chatTypeSupergroup":return!1;case"chatTypePrivate":case"chatTypeSecret":return!0}return!1}function K(e){const t=l.a.get(e);if(!t)return!1;if(!t.type)return!1;switch(t.type["@type"]){case"chatTypeBasicGroup":case"chatTypeSupergroup":return!0;case"chatTypePrivate":case"chatTypeSecret":return!1}return!1}function Z(e){const t=l.a.get(e);if(!t)return!1;if(!t.type)return!1;switch(t.type["@type"]){case"chatTypeSupergroup":{const e=c.a.get(t.type.supergroup_id);return e&&e.is_channel}case"chatTypeBasicGroup":case"chatTypePrivate":case"chatTypeSecret":return!1}return!1}function q(e){const t=l.a.get(e);if(!t)return!1;const a=t.type;if(!a)return!1;switch(a["@type"]){case"chatTypeSupergroup":{const e=c.a.get(a.supergroup_id);if(e&&e.status)switch(e.status["@type"]){case"chatMemberStatusAdministrator":return!0;case"chatMemberStatusBanned":return!1;case"chatMemberStatusCreator":return e.status.is_member;case"chatMemberStatusLeft":return!1;case"chatMemberStatusMember":return!0;case"chatMemberStatusRestricted":return e.status.is_member}break}case"chatTypeBasicGroup":{const e=m.a.get(a.basic_group_id);if(e&&e.status)switch(e.status["@type"]){case"chatMemberStatusAdministrator":return!0;case"chatMemberStatusBanned":return!1;case"chatMemberStatusCreator":return e.status.is_member;case"chatMemberStatusLeft":return!1;case"chatMemberStatusMember":return!0;case"chatMemberStatusRestricted":return e.status.is_member}break}case"chatTypePrivate":case"chatTypeSecret":return!0}return!1}function Y(e,t=!1,a=(e=>e)){const n=l.a.get(e);return n?Q(e)&&t?a("SavedMessages"):n.title||a("HiddenName"):null}function J(e){const t=l.a.get(e);if(!t)return!1;switch(t.type["@type"]){case"chatTypeBasicGroup":case"chatTypeSupergroup":return!1;case"chatTypeSecret":case"chatTypePrivate":{const e=f.a.get(t.type.user_id);return e&&"userTypeDeleted"===e.type["@type"]}}return!1}function Q(e){const t=l.a.get(e);if(!t)return!1;switch(t.type["@type"]){case"chatTypeBasicGroup":case"chatTypeSupergroup":return!1;case"chatTypeSecret":case"chatTypePrivate":return f.a.getMyId()===t.type.user_id}return!1}function X(e){const t=[],a=l.a.get(e);if(!a)return t;switch(a.type["@type"]){case"chatTypeBasicGroup":{const e=m.a.getFullInfo(a.type.basic_group_id);if(e)return e.members||t;break}}return t}function $(e){return ee.apply(this,arguments)}function ee(){return(ee=Object(i.a)(s.a.mark((function e(t){var a,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=l.a.get(t)){e.next=3;break}return e.abrupt("return",null);case 3:if(n=a.type){e.next=6;break}return e.abrupt("return",null);case 6:e.t0=n["@type"],e.next="chatTypePrivate"===e.t0?9:"chatTypeSecret"===e.t0?12:"chatTypeBasicGroup"===e.t0?15:"chatTypeSupergroup"===e.t0?18:21;break;case 9:return e.next=11,b.a.send({"@type":"getUserFullInfo",user_id:n.user_id});case 11:return e.abrupt("return",e.sent);case 12:return e.next=14,b.a.send({"@type":"getUserFullInfo",user_id:n.user_id});case 14:return e.abrupt("return",e.sent);case 15:return e.next=17,b.a.send({"@type":"getBasicGroupFullInfo",basic_group_id:n.basic_group_id});case 17:return e.abrupt("return",e.sent);case 18:return e.next=20,b.a.send({"@type":"getSupergroupFullInfo",supergroup_id:n.supergroup_id});case 20:return e.abrupt("return",e.sent);case 21:return e.abrupt("return",null);case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function te(e,t){const a=l.a.get(e);if(!a)return!1;const n=a.type;return n&&"chatTypeBasicGroup"===n["@type"]&&n.basic_group_id===t}function ae(e){const t=l.a.get(e);if(!t)return!1;const a=t.type;return a&&"chatTypeSupergroup"===a["@type"]}function ne(e){const t=l.a.get(e);if(!t)return!1;const a=t.type;return a&&"chatTypeSupergroup"===a["@type"]?a.supergroup_id:0}function se(e,t){const a=l.a.get(e);if(!a)return!1;const n=a.type;return ae(e)&&n.supergroup_id===t}function ie(e){const t=l.a.get(e);if(!t)return 0;const a=t.type;return!a||"chatTypePrivate"!==a["@type"]&&"chatTypeSecret"!==a["@type"]?0:a.user_id}function oe(e){const t=l.a.get(e);if(!t)return null;if(G(e)){const t=f.a.get(ie(e));if(t)return t.profile_photo}return t.photo}function re(e){const t=l.a.get(e);if(!t)return!1;const a=t.type,n=t.permissions;if(!a)return!1;if(!n)return!1;const s=n.can_send_media_messages;switch(a["@type"]){case"chatTypeBasicGroup":{const e=m.a.get(a.basic_group_id);if(!e)return!1;const t=e.status;if(!t)return!1;const n=t.is_member,s=t.permissions;switch(t["@type"]){case"chatMemberStatusAdministrator":return!0;case"chatMemberStatusBanned":return!1;case"chatMemberStatusCreator":return n;case"chatMemberStatusLeft":return!1;case"chatMemberStatusMember":return!0;case"chatMemberStatusRestricted":return n&&s&&s.can_send_media_messages}break}case"chatTypePrivate":case"chatTypeSecret":return s;case"chatTypeSupergroup":{const e=c.a.get(t.type.supergroup_id);if(!e)return!1;const a=e.status;if(!a)return!1;const n=a.is_member,i=a.permissions;switch(a["@type"]){case"chatMemberStatusAdministrator":return!0;case"chatMemberStatusBanned":return!1;case"chatMemberStatusCreator":return n;case"chatMemberStatusLeft":return!1;case"chatMemberStatusMember":return s&&!e.is_channel;case"chatMemberStatusRestricted":return s&&n&&i&&i.can_send_media_messages}}}return!1}function ce(e,t=!1,a=(e=>e)){if(Q(e)&&t)return a("SavedMessages");const n=l.a.get(e);if(!n)return null;if(!n.type)return null;switch(n.type["@type"]){case"chatTypeBasicGroup":case"chatTypeSupergroup":return n.title;case"chatTypePrivate":case"chatTypeSecret":return Object(r.e)(n.type.user_id,a)}return null}function le(e){const t=l.a.get(e);if(!t)return null;if(!t.type)return null;switch(t.type["@type"]){case"chatTypeBasicGroup":{const e=m.a.get(t.type.basic_group_id);return e?e.member_count:0}case"chatTypeSupergroup":{const e=c.a.get(t.type.supergroup_id);return e?e.member_count:0}case"chatTypePrivate":case"chatTypeSecret":return 0}return 0}function de(e){const t=l.a.get(e);if(!t)return!1;if(!t.type)return!1;switch(t.type["@type"]){case"chatTypeBasicGroup":return!0;case"chatTypeSupergroup":{const e=c.a.get(t.type.supergroup_id);return!e||!Boolean(e.username)}case"chatTypePrivate":case"chatTypeSecret":return!0}return!1}function he(e){return!Q(e)}function ue(e){const t=l.a.get(e);if(!t)return!1;const a=t.type,n=t.permissions;if(!a)return!1;if(!n)return!1;const s=n.can_send_polls;switch(a["@type"]){case"chatTypeBasicGroup":{const e=m.a.get(a.basic_group_id);if(!e)return!1;const t=e.status;if(!t)return!1;const n=t.is_member,s=t.permissions;switch(t["@type"]){case"chatMemberStatusAdministrator":return!0;case"chatMemberStatusBanned":return!1;case"chatMemberStatusCreator":return n;case"chatMemberStatusLeft":return!1;case"chatMemberStatusMember":return!0;case"chatMemberStatusRestricted":return n&&s&&s.can_send_polls}break}case"chatTypePrivate":case"chatTypeSecret":return s;case"chatTypeSupergroup":{const e=c.a.get(a.supergroup_id);if(!e)return!1;const t=e.status;if(!t)return!1;const n=t.is_member,i=t.permissions;switch(t["@type"]){case"chatMemberStatusAdministrator":return!0;case"chatMemberStatusBanned":return!1;case"chatMemberStatusCreator":return n;case"chatMemberStatusLeft":return!1;case"chatMemberStatusMember":return s&&!e.is_channel;case"chatMemberStatusRestricted":return s&&n&&i&&i.can_send_polls}}}return!1}function pe(e){const t=l.a.get(e);if(!t)return!1;const a=t.type,n=t.permissions;if(!a)return!1;if(!n)return!1;const s=n.can_send_messages;switch(a["@type"]){case"chatTypeBasicGroup":{const e=m.a.get(a.basic_group_id);if(!e)return!1;const t=e.status;if(!t)return!1;const n=t.is_member,s=t.permissions;switch(t["@type"]){case"chatMemberStatusAdministrator":return!0;case"chatMemberStatusBanned":return!1;case"chatMemberStatusCreator":return n;case"chatMemberStatusLeft":return!1;case"chatMemberStatusMember":return!0;case"chatMemberStatusRestricted":return n&&s&&s.can_send_messages}break}case"chatTypePrivate":case"chatTypeSecret":return s;case"chatTypeSupergroup":{const e=c.a.get(a.supergroup_id);if(!e)return!1;const t=e.status;if(!t)return!1;const n=t.is_member,i=t.permissions;switch(t["@type"]){case"chatMemberStatusAdministrator":return!0;case"chatMemberStatusBanned":return!1;case"chatMemberStatusCreator":return n;case"chatMemberStatusLeft":return!1;case"chatMemberStatusMember":return s&&!e.is_channel;case"chatMemberStatusRestricted":return s&&n&&i&&i.can_send_messages}}}return!1}function me(e){const t=l.a.get(e);return ge(e)&&0===t.unread_count&&0===t.unread_mention_count}function ge(e){const t=l.a.get(e);if(t){const e=t.draft_message;if(e){const t=e.input_message_text;if(t)return t.text}}return null}function fe(e){let t=0;const a=l.a.get(e);if(a){const e=a.draft_message;e&&(t=e.reply_to_message_id)}return t}function be(e){const t=l.a.get(e);if(!t)return!1;const a=t.type,n=t.permissions;if(!a)return!1;if(!n)return!1;const s=n.can_pin_messages;switch(a["@type"]){case"chatTypeBasicGroup":{const e=m.a.get(a.basic_group_id);if(!e)return!1;const t=e.status;if(!t)return!1;const n=t.is_member,s=t.permissions;switch(t["@type"]){case"chatMemberStatusAdministrator":return t.can_pin_messages;case"chatMemberStatusBanned":case"chatMemberStatusCreator":case"chatMemberStatusLeft":case"chatMemberStatusMember":return!1;case"chatMemberStatusRestricted":return n&&s&&s.can_pin_messages}break}case"chatTypePrivate":case"chatTypeSecret":return s;case"chatTypeSupergroup":{const e=c.a.get(a.supergroup_id);if(!e)return!1;const t=e.status;if(!t)return!1;const n=t.is_member,i=t.permissions;switch(t["@type"]){case"chatMemberStatusAdministrator":return s||t.can_pin_messages;case"chatMemberStatusBanned":return!1;case"chatMemberStatusCreator":return n;case"chatMemberStatusLeft":case"chatMemberStatusMember":return!1;case"chatMemberStatusRestricted":return s&&n&&i&&i.can_pin_messages}}}return!1}function Ce(e){const t=l.a.get(e);if(!t)return!1;const a=t.type;if(!a)return!1;switch(t.type["@type"]){case"chatTypeBasicGroup":return!1;case"chatTypePrivate":case"chatTypeSecret":{const e=f.a.get(a.user_id);return e&&e.is_verified}case"chatTypeSupergroup":{const e=c.a.get(a.supergroup_id);return e&&e.is_verified}}return!1}function ye(e){const t=l.a.get(e);if(!t)return!1;if(!t.type)return!1;switch(t.type["@type"]){case"chatTypeBasicGroup":case"chatTypePrivate":return!1;case"chatTypeSecret":return!0;case"chatTypeSupergroup":return!1}return!1}a.d(t,"h",(function(){return y})),a.d(t,"N",(function(){return v})),a.d(t,"g",(function(){return E})),a.d(t,"i",(function(){return S})),a.d(t,"l",(function(){return T})),a.d(t,"k",(function(){return N})),a.d(t,"T",(function(){return J})),a.d(t,"Y",(function(){return me})),a.d(t,"m",(function(){return ge})),a.d(t,"n",(function(){return fe})),a.d(t,"v",(function(){return U})),a.d(t,"ab",(function(){return _})),a.d(t,"Z",(function(){return x})),a.d(t,"s",(function(){return A})),a.d(t,"t",(function(){return R})),a.d(t,"C",(function(){return M})),a.d(t,"F",(function(){return w})),a.d(t,"E",(function(){return k})),a.d(t,"A",(function(){return I})),a.d(t,"B",(function(){return j})),a.d(t,"D",(function(){return L})),a.d(t,"p",(function(){return F})),a.d(t,"K",(function(){return V})),a.d(t,"L",(function(){return B})),a.d(t,"P",(function(){return P})),a.d(t,"x",(function(){return z})),a.d(t,"q",(function(){return H})),a.d(t,"j",(function(){return W})),a.d(t,"W",(function(){return G})),a.d(t,"U",(function(){return K})),a.d(t,"M",(function(){return Z})),a.d(t,"R",(function(){return O})),a.d(t,"O",(function(){return q})),a.d(t,"S",(function(){return Ce})),a.d(t,"Q",(function(){return ye})),a.d(t,"u",(function(){return Y})),a.d(t,"y",(function(){return X})),a.d(t,"o",(function(){return $})),a.d(t,"I",(function(){return te})),a.d(t,"J",(function(){return se})),a.d(t,"X",(function(){return ae})),a.d(t,"H",(function(){return ne})),a.d(t,"w",(function(){return ie})),a.d(t,"G",(function(){return oe})),a.d(t,"r",(function(){return ce})),a.d(t,"z",(function(){return le})),a.d(t,"V",(function(){return Q})),a.d(t,"a",(function(){return de})),a.d(t,"b",(function(){return he})),a.d(t,"c",(function(){return be})),a.d(t,"d",(function(){return re})),a.d(t,"e",(function(){return pe})),a.d(t,"f",(function(){return ue}))},,,,,function(e,t,a){"use strict";a.d(t,"D",(function(){return G})),a.d(t,"v",(function(){return ue})),a.d(t,"g",(function(){return b})),a.d(t,"t",(function(){return W})),a.d(t,"s",(function(){return $})),a.d(t,"B",(function(){return te})),a.d(t,"a",(function(){return ee})),a.d(t,"u",(function(){return se})),a.d(t,"C",(function(){return ie})),a.d(t,"o",(function(){return ce})),a.d(t,"p",(function(){return de})),a.d(t,"q",(function(){return he})),a.d(t,"r",(function(){return Ee})),a.d(t,"w",(function(){return R})),a.d(t,"z",(function(){return me})),a.d(t,"x",(function(){return pe})),a.d(t,"y",(function(){return A})),a.d(t,"A",(function(){return re})),a.d(t,"E",(function(){return K})),a.d(t,"b",(function(){return Z})),a.d(t,"h",(function(){return Q})),a.d(t,"i",(function(){return Y})),a.d(t,"n",(function(){return ge})),a.d(t,"j",(function(){return fe})),a.d(t,"d",(function(){return be})),a.d(t,"e",(function(){return Ce})),a.d(t,"k",(function(){return ye})),a.d(t,"f",(function(){return ve})),a.d(t,"l",(function(){return J})),a.d(t,"m",(function(){return q})),a.d(t,"c",(function(){return Ue}));var n=a(6),s=a.n(n),i=a(13),o=a(19),r=a(9),c=a(28),l=a(17),d=a(4),h=a(5),u=a(2),p=a(8),m=a(22),g=a(1);function f(e){return e?e<1024?"".concat(e," B"):e<1048576?"".concat((e/1024).toFixed(1)," KB"):e<1073741824?"".concat((e/1024/1024).toFixed(1)," MB"):"".concat((e/1024/1024/1024).toFixed(1)," GB"):"0 B"}function b(e){if(!e)return"";let t=e.size;return t?f(t):""}function C(e,t){if("undefined"!==typeof window.navigator.msSaveBlob)window.navigator.msSaveBlob(e,t);else{let a=window.URL.createObjectURL(e),n=document.createElement("a");n.style.display="none",n.href=a,n.setAttribute("download",t),"undefined"===typeof n.download&&n.setAttribute("target","_blank"),document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(a)}}function y(e,t,a){return v.apply(this,arguments)}function v(){return(v=Object(i.a)(s.a.mark((function e(t,a,n){var i,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return");case 2:if(n){e.next=4;break}return e.abrupt("return");case 4:if(n.length){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,g.a.send({"@type":"getMessages",chat_id:a,message_ids:n});case 8:for((i=e.sent).messages=i.messages.map((e,t)=>e||{"@type":"deletedMessage",chat_id:a,id:n[t],content:null}),p.a.setItems(i.messages),o=n.length-1;o>=0;o--)p.a.emit("getMessageResult",p.a.get(a,n[o]));E(u.a.getStore(),i.messages);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(e,t){for(let a=t.length-1;a>=0;a--){const n=t[a];if(!n)continue;const s=n.content;if(s)switch(s["@type"]){case"messageAnimation":w(e,s.animation,n);break;case"messageAudio":U(e,s.audio,n);break;case"messageChatChangePhoto":L(e,s.photo,n);break;case"messageDocument":_(e,s.document,n);break;case"messageGame":O(e,s.game,n);break;case"messagePhoto":L(e,s.photo,n);break;case"messageSticker":A(e,s.sticker,n);break;case"messageText":{const t=s.web_page;if(!t)break;const a=t.animation,i=t.audio,o=t.document,r=t.photo,c=t.sticker,l=t.video,d=t.video_note;if(r){L(e,r,n);break}if(a){w(e,a,n);break}if(i){U(e,i,n);break}if(o){_(e,o,n);break}if(c){A(e,c,n);break}if(l){B(e,l,n);break}if(d){z(e,d,n);break}break}case"messageVideo":B(e,s.video,n);break;case"messageVideoNote":z(e,s.video_note,n);break}}}function S(e,t,a,n=!0){if(!t)return;let s=t.audio;if(!s)return;s=u.a.get(s.id)||s;const i=s,o=i.id,r=i.size;if(u.a.getBlob(o))return;const c=a?a.chat_id:0,l=a?a.id:0;u.a.getLocalFile(e,s,null,()=>u.a.updateAudioBlob(c,l,o),()=>{(!n||r&&r<d.X)&&u.a.getRemoteFile(o,d.g,a||t)})}function U(e,t,a){if(!t)return!1;const n=t.album_cover_thumbnail;if(!n)return!1;let s=n.photo;if(!s)return!1;s=u.a.get(s.id)||s;const i=s.id;if(u.a.getBlob(s.id))return!0;const o=a?a.chat_id:0,r=a?a.id:0;return u.a.getLocalFile(e,s,null,()=>u.a.updateAudioThumbnailBlob(o,r,i),()=>u.a.getRemoteFile(i,d.ob,a||t)),!0}function k(e,t,a,n=!0){if(!t)return;let s=t.animation;if(!s)return;s=u.a.get(s.id)||s;const i=s,o=i.id,r=i.size;if(u.a.getBlob(o))return;const c=a?a.chat_id:0,l=a?a.id:0;u.a.getLocalFile(e,s,null,()=>u.a.updateAnimationBlob(c,l,o),()=>{(!n||r&&r<d.W)&&u.a.getRemoteFile(o,d.g,a||t)})}function w(e,t,a){if(!t)return!1;const n=t.thumbnail;if(!n)return!1;let s=n.photo;if(!s)return!1;s=u.a.get(s.id)||s;const i=s.id;if(u.a.getBlob(s.id))return!0;const o=a?a.chat_id:0,r=a?a.id:0;return u.a.getLocalFile(e,s,null,()=>u.a.updateAnimationThumbnailBlob(o,r,i),()=>u.a.getRemoteFile(i,d.ob,a||t)),!0}function M(e,t,a){if(!t)return;if(!a)return;const n=t.user_id,s=m.a.get(n);s&&oe(e,s)}function I(e,t,a,n=!0){if(!t)return;let s=t.document;if(!s)return;s=u.a.get(s.id)||s;const i=s,o=i.id,r=i.size;if(u.a.getBlob(o))return;const c=a?a.chat_id:0,l=a?a.id:0;u.a.getLocalFile(e,s,null,()=>u.a.updateDocumentBlob(c,l,o),()=>{(!n||r&&r<d.Y)&&u.a.getRemoteFile(o,d.g,a||t)})}function _(e,t,a){if(!t)return!1;const n=t.thumbnail;if(!n)return!1;let s=n.photo;if(!s)return!1;s=u.a.get(s.id)||s;const i=s.id;if(u.a.getBlob(s.id))return!0;const o=a?a.chat_id:0,r=a?a.id:0;return u.a.getLocalFile(e,s,null,()=>u.a.updateDocumentThumbnailBlob(o,r,i),()=>u.a.getRemoteFile(i,d.ob,a||t)),!0}function x(e,t,a,n=!0){if(!t)return;k(e,t.animation,a,n)}function O(e,t,a){if(!t)return!1;const n=t.photo;return w(e,t.animation,a)||L(e,n,a),!0}function P(){return(P=Object(i.a)(s.a.mark((function e(t,a,n){var i,o,r,c,h,p;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return");case 2:if(i=a.location,o=Object(l.m)(i,d.i,d.h)){e.next=6;break}return e.abrupt("return");case 6:if(r=u.a.getLocationFile(o)){e.next=13;break}return e.next=10,g.a.send({"@type":"getMapThumbnailFile",location:i,width:d.i,height:d.h,zoom:d.q,scale:d.o,chat_id:n?n.chat_id:0});case 10:r=e.sent,u.a.setLocationFile(o,r),t=u.a.getStore();case 13:if(r=u.a.get(r.id)||r,c=r.id,!u.a.getBlob(r.id)){e.next=18;break}return e.abrupt("return");case 18:h=n?n.chat_id:0,p=n?n.id:0,u.a.getLocalFile(t,r,null,()=>u.a.updateLocationBlob(h,p,c),()=>u.a.getRemoteFile(c,d.g,n||a));case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(e,t,a){return N.apply(this,arguments)}function N(){return(N=Object(i.a)(s.a.mark((function e(t,a,n){var i,o,r,c,h;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return");case 2:if(i=Object(l.m)(a)){e.next=5;break}return e.abrupt("return");case 5:if(o=u.a.getLocationFile(i)){e.next=12;break}return e.next=9,g.a.send({"@type":"getMapThumbnailFile",location:a,width:d.p,height:d.n,zoom:d.q,scale:d.o,chat_id:n?n.chat_id:0});case 9:o=e.sent,u.a.setLocationFile(i,o),t=u.a.getStore();case 12:if(o=u.a.get(o.id)||o,r=o.id,!u.a.getBlob(o.id)){e.next=17;break}return e.abrupt("return");case 17:c=n?n.chat_id:0,h=n?n.id:0,u.a.getLocalFile(t,o,null,()=>u.a.updateLocationBlob(c,h,r),()=>u.a.getRemoteFile(r,d.g,n||a));case 20:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e,t,a){if(!t)return;const n=t.sizes;if(!n)return;const s=Object(o.l)(n,d.B);if(!s)return;let i=s.photo;if(!i)return;i=u.a.get(i.id)||i;const r=i.id;if(u.a.getBlob(r))return;const c=a?a.chat_id:0,l=a?a.id:0;u.a.getLocalFile(e,i,null,()=>u.a.updatePhotoBlob(c,l,r),()=>u.a.getRemoteFile(r,d.g,a||t))}function L(e,t,a,n=d.F){if(!t)return;const s=t.sizes;if(!s)return;const i=Object(o.i)(s,n);if(!i)return;let r=i.photo;if(!r)return;r=u.a.get(r.id)||r;const c=r.id;if(u.a.getBlob(c))return;const l=a?a.chat_id:0,h=a?a.id:0;u.a.getLocalFile(e,r,null,()=>u.a.updatePhotoBlob(l,h,c),()=>u.a.getRemoteFile(c,d.g,a||t))}function j(e,t,a){if(!t)return!1;if(!a)return!1;const n=Object(o.j)(t.sizes);if(!n)return!1;if(Object(o.i)(t.sizes)===n)return;let s=n.photo;if(!s)return!1;s=u.a.get(s.id)||s;const i=s.id;return u.a.getBlob(i)||u.a.getLocalFile(e,s,null,()=>u.a.updatePhotoBlob(a.chat_id,a.id,i),()=>u.a.getRemoteFile(i,d.ob,a)),!0}function R(e,t,a,n=!0){if(!t)return;let s=t.sticker;if(!s)return;s=u.a.get(s.id)||s;const i=s,o=i.id,r=i.size;if(u.a.getBlob(o))return;const c=a?a.chat_id:0,l=a?a.id:0;u.a.getLocalFile(e,s,null,()=>u.a.updateStickerBlob(c,l,o),()=>{(!n||r&&r<d.Z)&&u.a.getRemoteFile(o,d.g,a||t)})}function A(e,t,a){if(!t)return!1;const n=t.thumbnail;if(!n)return!1;let s=n.photo;if(!s)return!1;s=u.a.get(s.id)||s;const i=s.id;if(u.a.getBlob(i))return!0;const o=a?a.chat_id:0,r=a?a.id:0;return u.a.getLocalFile(e,s,null,()=>u.a.updateStickerThumbnailBlob(o,r,i),()=>u.a.getRemoteFile(i,d.ob,a||t)),!0}function F(e,t,a,n=!0){if(!t)return;let s=t.video;if(!s)return;s=u.a.get(s.id)||s;const i=s,o=i.id,r=i.size;if(u.a.getBlob(o))return;const c=a?a.chat_id:0,l=a?a.id:0;u.a.getLocalFile(e,s,null,()=>u.a.updateVideoBlob(c,l,o),()=>{(!n||r&&r<d.bb)&&u.a.getRemoteFile(o,d.g,a||t)})}function B(e,t,a){if(!t)return!1;const n=t.thumbnail;if(!n)return!1;let s=n.photo;if(!s)return!1;s=u.a.get(s.id)||s;const i=s.id;if(u.a.getBlob(i))return!0;const o=a?a.chat_id:0,r=a?a.id:0;return u.a.getLocalFile(e,s,null,()=>u.a.updateVideoThumbnailBlob(o,r,i),()=>u.a.getRemoteFile(i,d.ob,a||t)),!0}function V(e,t,a,n=!0){if(!t)return;let s=t.video;if(!s)return;s=u.a.get(s.id)||s;const i=s,o=i.id,r=i.size;if(u.a.getBlob(o))return;const c=a?a.chat_id:0,l=a?a.id:0;u.a.getLocalFile(e,s,null,()=>u.a.updateVideoNoteBlob(c,l,o),()=>{(!n||r&&r<d.ab)&&u.a.getRemoteFile(o,d.g,a||t)})}function z(e,t,a){if(!t)return!1;const n=t.thumbnail;if(!n)return!1;let s=n.photo;if(!s)return!1;s=u.a.get(s.id)||s;const i=s.id;if(u.a.getBlob(i))return!0;const o=a?a.chat_id:0,r=a?a.id:0;return u.a.getLocalFile(e,s,null,()=>u.a.updateVideoNoteThumbnailBlob(o,r,i),()=>u.a.getRemoteFile(i,d.ob,a||t)),!0}function H(e,t,a,n=!0){if(!t)return;let s=t.voice;if(!s)return;s=u.a.get(s.id)||s;const i=s,o=i.id,r=i.size;if(u.a.getBlob(o))return;const c=a?a.chat_id:0,l=a?a.id:0;u.a.getLocalFile(e,s,null,()=>u.a.updateVoiceNoteBlob(c,l,o),()=>{(!n||r&&r<d.cb)&&u.a.getRemoteFile(o,d.g,a||t)})}function W(e,t){const a=new Map;let n=0;const s=new Map;for(let i=t.length-1;i>=0;i--){const o=t[i];if(!o)continue;const r=o.chat_id,c=o.content,l=o.sender_user_id,d=o.reply_to_message_id;if(l&&a.set(l,l),d&&(n=r,s.set(d,d)),c)switch(c["@type"]){case"messageAnimation":{const t=c.animation;k(e,t,o),w(e,t,o);break}case"messageAudio":{const t=c.audio;S(e,t,o),U(e,t,o);break}case"messageChatChangePhoto":{const t=c.photo;L(e,t,o),D(e,t,o);break}case"messageContact":M(e,c.contact,o);break;case"messageDocument":{const t=c.document;I(e,t,o),_(e,t,o);break}case"messageGame":{const t=c.game;x(e,t,o),O(e,t,o);break}case"messageLocation":T(e,c.location,o);break;case"messageText":{const t=c.web_page;if(!t)break;const a=t.animation,n=t.audio,s=t.document,i=t.photo,r=t.sticker,l=t.video,d=t.video_note,h=t.voice_note;let u=!0;a&&(k(e,a,o),u=!w(e,a,o)),n&&(S(e,n,o),u=!U(e,n,o)),s&&(I(e,s,o),u=!_(e,s,o)),r&&(R(e,r,o),u=!A(e,r,o)),l&&(u=!B(e,l,o)),d&&(V(e,d,o),u=!z(e,d,o)),h&&H(e,h,o),u&&(D(e,i,o),L(e,i,o),j(e,i,o));break}case"messagePhoto":{const t=c.photo;D(e,t,o),L(e,t,o),j(e,t,o);break}case"messageSticker":{const t=c.sticker;R(e,t,o),A(e,t,o);break}case"messageVenue":T(e,c.venue.location,o);break;case"messageVideo":B(e,c.video,o);break;case"messageVideoNote":{const t=c.video_note;V(e,t,o),z(e,t,o);break}case"messageVoiceNote":H(e,c.voice_note,o);break}}re(e,[...a.keys()]),y(e,n,[...s.keys()])}function G(e,t){if(e)switch(e["@type"]){case"animation":!function(e,t){const a=t?t.chat_id:0,n=t?t.id:0;if(!e)return;const s=e.animation,i=e.file_name;if(!s)return;const o=s.id;K(s,i||o,t||e,()=>u.a.updateAnimationBlob(a,n,o))}(e,t);break;case"document":!function(e,t){const a=t?t.chat_id:0,n=t?t.id:0;if(!e)return;const s=e.document,i=e.file_name;if(!s)return;const o=s.id;K(s,i||o,t||e,()=>u.a.updateDocumentBlob(a,n,o))}(e,t);break;case"photo":!function(e,t){const a=t?t.chat_id:0,n=t?t.id:0;if(!e)return;const s=Object(o.l)(e.sizes,d.B);if(!s)return;const i=s.photo;if(!i)return;const r=i.id;K(i,r+".jpg",t||e,()=>u.a.updatePhotoBlob(a,n,r))}(e,t);break;case"video":!function(e,t){const a=t?t.chat_id:0,n=t?t.id:0;if(!e)return;const s=e.video,i=e.file_name;if(!s)return;const o=s.id;K(s,i||o,t||e,()=>u.a.updateVideoBlob(a,n,o))}(e,t)}}function K(e,t,a,n){if(!e)return;if(!t)return;if(e.arr)return void function(e,t,a){let n=new Blob([e],{type:a||"application/octet-stream"});if("undefined"!==typeof window.navigator.msSaveBlob)window.navigator.msSaveBlob(n,t);else{let e=window.URL.createObjectURL(n),a=document.createElement("a");a.style.display="none",a.href=e,a.setAttribute("download",t),"undefined"===typeof a.download&&a.setAttribute("target","_blank"),document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(e)}}(e.arr,t);let s=u.a.getBlob(e.id)||e.blob;s?C(s,t):Z(e,a,()=>{n&&n(),s=u.a.getBlob(e.id)||e.blob,s&&C(s,t)})}function Z(e,t,a){if(!e)return;const n=e.id,s=e.local;if(!u.a.getBlob(n))if(s.is_downloading_completed){const n=u.a.getStore();u.a.getLocalFile(n,e,null,a,()=>{s.can_be_downloaded&&u.a.getRemoteFile(e.id,d.g,t)})}else s.can_be_downloaded&&u.a.getRemoteFile(n,d.g,t)}function q(e){if(!e)return[0,0,null];switch(e["@type"]){case"animation":case"document":{const t=e.thumbnail;if(t)return[t.width,t.height,t.photo];break}case"photo":return J(e,d.F);case"video":{const t=e.thumbnail;if(t)return[t.width,t.height,t.photo];break}default:return[0,0,null]}return[0,0,null]}function Y(e,t){const a=p.a.get(e,t);if(!a)return[0,0,null];const n=a.content;if(!n)return[0,0,null];switch(n["@type"]){case"messageAnimation":{const e=n.animation;if(e&&e.thumbnail)return[e.thumbnail.width,e.thumbnail.height,e.thumbnail.photo];break}case"messageChatChangePhoto":return Q(e,t,d.F);case"messageDocument":{const e=n.document;if(e)return[50,50,e.document];break}case"messagePhoto":return Q(e,t,d.F);case"messageText":{const a=n.web_page;if(a){const n=a.animation,s=a.document,i=a.video,o=a.photo;if(n&&n.thumbnail)return[n.thumbnail.width,n.thumbnail.height,n.thumbnail.photo];if(s)return[50,50,s.document];if(i&&i.thumbnail)return[i.thumbnail.width,i.thumbnail.height,i.thumbnail.photo];if(o)return Q(e,t,d.F)}break}case"messageVideo":{const e=n.video;if(e.thumbnail)return[e.thumbnail.width,e.thumbnail.height,e.thumbnail.photo];break}default:return[0,0,null]}return[0,0,null]}function J(e,t){if(!t)return[0,0,null];switch(e["@type"]){case"animation":return[e.width,e.height,e.animation];case"photo":{const a=Object(o.l)(e.sizes,t);if(a)return[a.width,a.height,a.photo];break}case"document":return[50,50,document.document];case"video":return[e.width,e.height,e.video]}return[0,0,null]}function Q(e,t,a){if(!a)return[0,0,null];const n=p.a.get(e,t);if(!n)return[0,0,null];const s=n.content;if(!s)return[0,0,null];switch(s["@type"]){case"messageAnimation":{const e=s.animation;if(e)return[e.width,e.height,e.animation];break}case"messageChatChangePhoto":{const e=s.photo;if(e){const t=Object(o.l)(e.sizes,a);if(t)return[t.width,t.height,t.photo]}break}case"messageDocument":{const e=s.document;if(e)return[50,50,e.document];break}case"messagePhoto":{const e=s.photo;if(e){const t=Object(o.l)(e.sizes,a);if(t)return[t.width,t.height,t.photo]}break}case"messageText":{const e=s.web_page;if(e){const t=e.animation,n=e.document,s=e.photo,i=e.video;if(t)return[t.width,t.height,t.animation];if(n)return[50,50,n.document];if(s){const e=Object(o.l)(s.sizes,a);if(e)return[e.width,e.height,e.photo];break}if(i)return[i.width,i.height,i.video]}break}case"messageVideo":{const e=s.video;if(e)return[e.width,e.height,e.video];break}}return[0,0,null]}function X(e){if(e&&e.length)for(let t=0;t<e.length;t++){let a=e[t];const n=a.content;if(n)switch(n["@type"]){case"messagePhoto":{const e=n.photo;if(!e)break;const t=Object(o.l)(e.sizes,d.B);if(!t)break;const a=t.photo;if(a.blob||u.a.getBlob(a.id))return;u.a.cancelGetRemoteFile(a.id);break}case"messageVideo":{const e=n.video;if(!e)break;if(e.thumbnail){const t=e.thumbnail.photo;if(t.blob||u.a.getBlob(t.id))break;u.a.cancelGetRemoteFile(t.id)}const t=e.video;if(!t)break;if(t.blob||u.a.getBlob(t.id))break;u.a.cancelGetRemoteFile(t.id);break}case"messageText":{const e=a.content.web_page;if(e){const t=e.video;if(t){if(t.thumbnail){const e=t.thumbnail.photo;if(e.blob||u.a.getBlob(e.id))break;u.a.cancelGetRemoteFile(e.id)}const e=t.video;if(!e)break;if(e.blob||u.a.getBlob(e.id))break;u.a.cancelGetRemoteFile(e.id)}}break}}}}function $(e,t=!1){if(!e)return;if(!e.length)return;const a=u.a.getStore();for(let n=0;n<e.length;n++){let s=e[n];const i=s.content;if(i)switch(i["@type"]){case"messageAnimation":{const e=i.animation;k(a,e,s,t),w(a,e,s);break}case"messageChatChangePhoto":D(a,i.photo,s);break;case"messageDocument":I(a,i.document,s,t);break;case"messagePhoto":D(a,i.photo,s);break;case"messageText":{const e=s.content.web_page;if(!e)break;const n=e.animation,i=e.document,o=e.photo,r=e.video;let c=!0;n&&(k(a,n,s,t),c=!w(a,n,s)),i&&(I(a,i,s,t),c=!1),r&&(F(a,r,s,t),c=!B(a,r,s)),c&&D(a,o,s);break}case"messageVideo":{const e=i.video;B(a,e,s),F(a,e,s,t);break}}}}function ee(e,t){if(!t.length)return;const a=[];e>0&&a.push(t[e-1]),e<t.length-1&&a.push(t[e+1]),X([t[e]]),X(a)}function te(e,t){if(!t.length)return;const a=[];e>0&&a.push(t[e-1]),e<t.length-1&&a.push(t[e+1]),$([t[e]],!1),$(a,!0)}function ae(e,t,a){if(!t)return;const n=t.id;t=u.a.get(n)||t;const s=m.a.get(a);s&&(t.blob||u.a.getBlob(n)||u.a.getLocalFile(e,t,null,()=>u.a.updateUserPhotoBlob(a,n),()=>u.a.getRemoteFile(n,d.ob,s)))}function ne(e,t,a){if(!t)return;const n=t.id;t=u.a.get(n)||t;const s=h.a.get(a);s&&(u.a.getDataUrl(n)||t.blob||u.a.getBlob(n)||u.a.getLocalFile(e,t,null,()=>u.a.updateChatPhotoBlob(a,n),()=>u.a.getRemoteFile(n,d.ob,s)))}function se(e,t){if(!t)return;const a=u.a.getStore();t.forEach(t=>{switch(t["@type"]){case"chatPhoto":{const n=t,s=n.small,i=n.big;ne(a,s,e),ne(a,i,e);break}case"profilePhoto":{const n=Object(r.w)(e),s=t,i=s.small,o=s.big;ae(a,i,n),ae(a,o,n);break}case"userProfilePhoto":{if(!(t=Object(c.a)(t)))break;const n=Object(r.w)(e),s=t,i=s.small,o=s.big;ae(a,i,n),ae(a,o,n);break}}})}function ie(e,t,a){if(!a.length)return;const n=[];t>0&&n.push(a[t-1]),t<a.length-1&&n.push(a[t+1]),t>=0&&t<a.length&&n.push(a[t]),se(e,n)}function oe(e,t){const a=m.a.get(t);if(!a)return;const n=a.profile_photo;n&&ae(e,n.small,t)}function re(e,t){t&&t.forEach(t=>oe(e,t))}function ce(e,t){const a=h.a.get(t);a&&le(e,a.photo,a.id)}function le(e,t,a){if(!t)return;ne(e,t.small,a)}function de(e,t){t&&t.forEach(t=>ce(e,t))}function he(e,t){const a=h.a.get(t);if(!a)return;const n=a.draft_message;if(!n)return;const s=n.reply_to_message_id;s&&y(e,t,[s])}function ue(e,t){if(!t)return;me(e,t.stickers)}function pe(e,t){if(!t)return;me(e,t.stickers)}function me(e,t){t&&t.forEach(t=>{A(e,t,null),t.is_animated&&R(e,t,null)})}function ge(e){return e&&"image/gif"===e.toLowerCase()}function fe(e){const t=e&&u.a.getDataUrl(e.id);if(t)return t;const a=be(e);return u.a.getBlobUrl(a)||""}function be(e){return e?u.a.getBlob(e.id)||e.blob:null}function Ce(e){return e&&e.local&&e.local.is_downloading_active?f(e.local.downloaded_size):"0"}function ye(e){return e&&e.remote&&e.remote.is_uploading_active?f(e.remote.uploaded_size):"0"}function ve(e){if(!e)return"";const t=e.split(".");return 1===t.length||""===t[0]&&2===t.length?"":t.pop().toLowerCase()}function Ee(e){if(!e)return;const t=e.page_blocks;if(!t)return;const a=u.a.getStore();t.forEach(e=>function e(t,a){if(!a)return;switch(a["@type"]){case"pageBlockAnchor":break;case"pageBlockAnimation":{const n=a.animation,s=a.caption;w(t,n,null),k(t,n,null),e(t,s);break}case"pageBlockAudio":{const n=a.audio,s=a.caption;U(t,n,null),S(t,n,null),e(t,s);break}case"pageBlockAuthorDate":{const e=a.author;Se(t,e);break}case"pageBlockBlockQuote":case"pageBlockCaption":{const e=a.text,n=a.credit;Se(t,e),Se(t,n);break}case"pageBlockChatLink":{const e=a.photo;le(t,e,0);break}case"pageBlockCollage":{const n=a.page_blocks,s=a.caption;e(t,s),n.forEach(a=>e(t,a));break}case"pageBlockCover":{const n=a.cover;e(t,n);break}case"pageBlockDetails":{const n=a.header,s=a.page_blocks;e(t,n),s.forEach(a=>e(t,a));break}case"pageBlockDivider":break;case"pageBlockEmbedded":{const n=a.poster_photo,s=a.caption;L(t,n,null),e(t,s);break}case"pageBlockEmbeddedPost":{const n=a.author_photo,s=a.page_blocks,i=a.caption;L(t,n,null),s.forEach(a=>e(t,a)),e(t,i);break}case"pageBlockFooter":{const e=a.footer;Se(t,e);break}case"pageBlockHeader":{const e=a.header;Se(t,e);break}case"pageBlockKicker":{const e=a.kicker;Se(t,e);break}case"pageBlockList":a.items.forEach(a=>e(t,a));break;case"pageBlockListItem":a.page_blocks.forEach(a=>e(t,a));break;case"pageBlockMap":{const n=a.caption;!function(e,t,a){P.apply(this,arguments)}(t,a,null),e(t,n);break}case"pageBlockParagraph":{const e=a.text;Se(t,e);break}case"pageBlockPhoto":{const n=a.photo,s=a.caption;L(t,n,null,d.k),e(t,s);break}case"pageBlockPreformatted":{const e=a.text;Se(t,e);break}case"pageBlockPullQuote":{const e=a.text,n=a.credit;Se(t,e),Se(t,n);break}case"pageBlockRelatedArticles":{const n=a.header,s=a.articles;Se(t,n),s.forEach(a=>e(t,a));break}case"pageBlockRelatedArticle":{const e=a.photo;L(t,e,null);break}case"pageBlockSlideshow":{const n=a.page_blocks,s=a.caption;e(t,s),n.forEach(a=>e(t,a));break}case"pageBlockSubheader":{const e=a.subheader;Se(t,e);break}case"pageBlockSubtitle":{const e=a.subtitle;Se(t,e);break}case"pageBlockTable":{const n=a.caption,s=a.cells;Se(t,n),s.forEach(a=>a.forEach(a=>e(t,a)));break}case"pageBlockTableCell":{const e=a.text;Se(t,e);break}case"pageBlockTitle":{const e=a.title;Se(t,e);break}case"pageBlockVideo":{const n=a.video,s=a.caption;B(t,n,null),F(t,n,null),e(t,s);break}}}(a,e))}function Se(e,t){if(t)switch(t["@type"]){case"richTextAnchor":case"richTextBold":case"richTextEmailAddress":case"richTextFixed":{const a=t.text;Se(e,a);break}case"richTextIcon":{const a=t.document;_(e,a,null),I(e,a,null,!1);break}case"richTextItalic":case"richTextMarked":case"richTextPhoneNumber":case"richTextPlain":{const a=t.text;Se(e,a);break}case"richTexts":t.texts.forEach(t=>Se(e,t));break;case"richTextStrikethrough":case"richTextSubscript":case"richTextSuperscript":case"richTextUnderline":case"richTextUrl":{const a=t.text;Se(e,a);break}}}function Ue(e){return new Promise(t=>{if(!e)return void t(null);const a=u.a.getBlob(e.id);if(!a)return void t(null);const n=new FileReader;n.onload=e=>t(JSON.parse(e.target.result)),n.onerror=()=>t(null),n.onabort=()=>t(null),n.readAsText(a)})}},,,function(e,t,a){"use strict";var n=a(6),s=a.n(n),i=a(13),o=a(0),r=a.n(o),c=a(162),l=a.n(c),d=a(133),h=a(116),u=a(16),p=a.n(u),m=a(10),g=a(84),f=a(104),b=a(28),C=a(22);a(319);class y extends r.a.Component{render(){const e=this.props,t=e.contact,a=e.title,n=e.openMedia,s=e.meta,i=e.caption,o=e.t;if(!t)return null;const c=t.user_id,l=t.first_name,d=t.last_name,h=t.phone_number,u=C.a.get(c)||{"@type":"user",type:{"@type":"userTypeRegular"},id:c,first_name:l,last_name:d},m=Object(b.c)(c,u,o),y=Object(f.a)(h);return r.a.createElement("div",{className:p()("contact",{"media-title":a})},r.a.createElement("div",{className:"contact-tile"},r.a.createElement(g.a,{userId:c,firstName:l,lastName:d})),r.a.createElement("div",{className:"contact-content"},r.a.createElement("div",{className:"contact-name"},c>0?r.a.createElement("a",{onClick:n},m):r.a.createElement("span",null,m)),r.a.createElement("div",{className:"contact-phone"},y,!i&&s)))}}var v=Object(m.c)()(y),E=a(180),S=a(79),U=a(19),k=a(14),w=a(4);a(323);class M extends r.a.Component{constructor(...e){super(...e),this.getContent=()=>{const e=this.props,t=e.chatId,a=e.messageId,n=e.game,s=e.size,i=e.displaySize,o=e.openMedia;if(!n)return null;const c=n.photo,l=n.animation;if(l){if(Object(k.j)(l.animation)||l.thumbnail)return r.a.createElement(h.a,{chatId:t,messageId:a,animation:l,openMedia:o})}if(c){let e={width:0,height:0};const n=Object(U.l)(c.sizes,s);if(n){const t=Object(U.f)(n,i);t&&(e.width=t.width,e.height=t.height)}return r.a.createElement(S.a,{chatId:t,messageId:a,photo:c,style:e,openMedia:o})}return null}}render(){const e=this.props,t=e.game,a=e.t;if(!t)return null;const n=t.title,s=t.text,i=t.description,o=Ge(s,a);return r.a.createElement("div",{className:"game"},r.a.createElement("div",{className:"border"}),r.a.createElement("div",{className:"game-wrapper"},n&&r.a.createElement("div",{className:"game-title"},n),o&&r.a.createElement("div",{className:"game-text"},o),i&&r.a.createElement("div",{className:"game-description"},i),this.getContent()))}}M.defaultProps={size:w.F,displaySize:w.D};var I=Object(m.c)()(M),_=a(137),x=a(274),O=a(501),P=a(488),T=a(489),N=a(490),D=a(491),L=a(21),j=a(1),R=(a(325),a(9));class A extends r.a.Component{constructor(e){var t;super(e),t=this,this.handleClick=function(){var e=Object(i.a)(s.a.mark((function e(a){var n,i,o,r,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.stopPropagation(),a.preventDefault(),n=t.props,i=n.userId,o=n.username,r=n.popup,!i){e.next=7;break}Object(L.j)(i,r),e.next=12;break;case 7:if(!o){e.next=12;break}return e.next=10,j.a.send({"@type":"searchPublicChat",username:o}).catch(()=>{t.setState({error:!0})});case 10:(c=e.sent)&&(Object(R.U)(c.id)?Object(L.h)(c.id,null,!1):Object(L.h)(c.id,null,r));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleClose=()=>{this.setState({error:!1})},this.handleDialogClick=e=>{e.preventDefault(),e.stopPropagation()},this.state={}}static getDerivedStateFromProps(e,t){const a=e.userId,n=e.username;return t.prevUserId!==a||t.prevUsername!==n?{prevUserId:a,prevUsername:n,error:!1}:null}render(){const e=this.props,t=e.children,a=e.t,n=e.title,s=e.username,i=this.state.error;return r.a.createElement(r.a.Fragment,null,r.a.createElement("a",{title:n,onClick:this.handleClick},t),i&&r.a.createElement(O.a,{transitionDuration:0,open:!0,onClose:this.handleClose,onClick:this.handleDialogClick,"aria-labelledby":"confirm-dialog-title"},r.a.createElement(P.a,{id:"confirm-dialog-title"},a("Error")),r.a.createElement(T.a,{classes:{root:"safe-link-content-root"}},r.a.createElement(N.a,null,"Can't find username ".concat(s,"."))),r.a.createElement(D.a,null,r.a.createElement(x.a,{onClick:this.handleClose},a("Ok")))))}}A.defaultProps={popup:!0};var F=Object(m.c)()(A);class B{constructor(e){this.fireworks=e,this.type=0,this.colorType=0,this.side=0,this.typeSize=4,this.xFinished=!1,this.finishedStart=!1,this.x=0,this.y=0,this.rotation=0,this.moveX=0,this.moveY=0}draw(e){e.fillStyle=this.colorType,0===this.type?(e.beginPath(),e.arc(this.x,this.y,this.typeSize,0,2*Math.PI,!1),e.fill()):(e.save(),e.translate(this.x,this.y),e.rotate(this.rotation*Math.PI/180),function(e,t,a,n,s,i,o,r){if("undefined"===typeof r&&(r=!0),"undefined"===typeof i&&(i=5),"number"===typeof i)i={tl:i,tr:i,br:i,bl:i};else{var c={tl:0,tr:0,br:0,bl:0};for(var l in c)i[l]=i[l]||c[l]}e.beginPath(),e.moveTo(t+i.tl,a),e.lineTo(t+n-i.tr,a),e.quadraticCurveTo(t+n,a,t+n,a+i.tr),e.lineTo(t+n,a+s-i.br),e.quadraticCurveTo(t+n,a+s,t+n-i.br,a+s),e.lineTo(t+i.bl,a+s),e.quadraticCurveTo(t,a+s,t,a+s-i.bl),e.lineTo(t,a+i.tl),e.quadraticCurveTo(t,a,t+i.tl,a),e.closePath(),o&&e.fill(),r&&e.stroke()}(e,-this.typeSize,-2,2*this.typeSize,4,2,!0,!1),e.restore())}update(e){const t=e/16;if(this.x+=this.moveX*t,this.y+=this.moveY*t,0!==this.xFinished){const e=.5;1===this.xFinished?(this.moveX+=e*t*.05,this.moveX>=e&&(this.xFinished=2)):(this.moveX-=e*t*.05,this.moveX<=-e&&(this.xFinished=1))}else 0===this.side?this.moveX>0&&(this.moveX-=.05*t,this.moveX<=0&&(this.moveX=0,this.xFinished=this.finishedStart)):this.moveX<0&&(this.moveX+=.05*t,this.moveX>=0&&(this.moveX=0,this.xFinished=this.finishedStart));const a=this.moveY<-.5;return this.moveY>-.5?this.moveY+=1/3*t*this.fireworks.speedCoef:this.moveY+=1/3*t,a&&this.moveY>-.5&&this.fireworks.fallingDownCount++,1===this.type&&(this.rotation+=10*t,this.rotation>360&&(this.rotation-=360)),this.y>=this.fireworks.getMeasuredHeight()}}function V(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e))+e}class z{constructor(e){this.context=e,this.particlesCount=60,this.fallParticlesCount=30,this.particles=[],this.speedCoef=1,this.fallingDownCount=0}getMeasuredHeight(){return this.context.canvas.clientHeight}getMeasuredWidth(){return this.context.canvas.clientWidth}createParticle(e){const t=new B(this);if(t.colorType=z.colors[V(0,z.colors.length)],t.type=V(0,2),t.side=V(0,2),t.finishedStart=1+V(0,2),0===t.type?t.typeSize=4+2*Math.random():t.typeSize=4+4*Math.random(),e)t.y=-Math.random()*this.getMeasuredHeight()*1.2,t.x=5+V(0,this.getMeasuredWidth()-10),t.xFinished=t.finishedStart;else{const e=4+V(0,10),a=this.getMeasuredHeight()/4;0===t.side?t.x=-e:t.x=this.getMeasuredWidth()+e,t.rotation=360*Math.random(),t.moveX=(0===t.side?1:-1)*(1.2+4*Math.random()),t.moveY=-(4+4*Math.random()),t.y=a/2+V(0,2*a)}return t}start(){if(!this.started){this.particles=[],this.started=!0,this.startedFall=!1,this.fallingDownCount=0,this.speedCoef=1,this.lastUpdateTime=0;for(let e=0;e<this.particlesCount;e++)this.particles.push(this.createParticle(!1));this.draw()}}startFall(){if(!this.startedFall){this.startedFall=!0;for(let e=0;e<this.fallParticlesCount;e++)this.particles.push(this.createParticle(!0))}}draw(){const e=Date.now();let t=e-this.lastUpdateTime;this.lastUpdateTime=e,t>18&&(t=16),this.context.clearRect(0,0,this.getMeasuredWidth(),this.getMeasuredHeight());for(let a=0,n=this.particles.length;a<n;a++){const e=this.particles[a];e.draw(this.context),e.update(t)&&(this.particles.splice(a,1),a--,n--)}this.fallingDownCount>=this.particlesCount/2&&this.speedCoef>.2&&(this.startFall(),this.speedCoef-=t/16*.15,this.speedCoef<.2&&(this.speedCoef=.2)),this.particles.length?window.requestAnimationFrame(()=>this.draw()):(this.started=!1,this.context.clearRect(0,0,this.getMeasuredWidth(),this.getMeasuredHeight()))}}z.colors=["#E8BC2C","#D0049E","#02CBFE","#5723FD","#FE8C27","#6CB859"];class H extends r.a.Component{constructor(e){super(e),this.onResize=()=>{const e=this.canvasRef.current;e&&(e.setAttribute("width",this.parentNode.clientWidth+18),e.setAttribute("height",this.parentNode.clientHeight+12))},this.canvasRef=r.a.createRef()}componentDidMount(){this.attachToParent()}componentWillUnmount(){this.detachFromParent()}attachToParent(){const e=this.canvasRef.current;if(!e)return;const t=e.parentNode;t&&(this.parentNode=t,e.setAttribute("width",this.parentNode.clientWidth+18),e.setAttribute("height",this.parentNode.clientHeight+12),window.addEventListener("resize",this.onResize))}detachFromParent(){const e=this.canvasRef.current;e&&e.parentNode&&(this.parentNode=null,window.removeEventListener("resize",this.onResize))}start(){const e=this.canvasRef.current.getContext("2d");new z(e).start()}render(){return r.a.createElement("canvas",{ref:this.canvasRef,style:{zIndex:2,position:"absolute",left:0,top:0,width:"100%",height:"100%",pointerEvents:"none"}})}}var W=H,G=a(525),K=a(23),Z=Object(K.a)(r.a.createElement("path",{d:"M4.70710678,12.2928932 C4.31658249,11.9023689 3.68341751,11.9023689 3.29289322,12.2928932 C2.90236893,12.6834175 2.90236893,13.3165825 3.29289322,13.7071068 L8.29289322,18.7071068 C8.68341751,19.0976311 9.31658249,19.0976311 9.70710678,18.7071068 L20.7071068,7.70710678 C21.0976311,7.31658249 21.0976311,6.68341751 20.7071068,6.29289322 C20.3165825,5.90236893 19.6834175,5.90236893 19.2928932,6.29289322 L9,16.5857864 L4.70710678,12.2928932 Z"}),"Check"),q=a(41),Y=a(549),J=a(272),Q=a(236),X=a.n(Q);a(326);class $ extends r.a.Component{render(){const e=this.props,t=e.chosen,a=e.beingChosen,n=e.hidden,s=e.onChange;return r.a.createElement("div",{className:p()("poll-radio",{"poll-radio-hidden":n})},r.a.createElement(Y.a,{color:"primary",classes:{root:"poll-radio-root",colorPrimary:"message-control",disabled:"message-control-disabled"},TouchRippleProps:{classes:{child:"touch-ripple-current-color"}},checked:t||a,onChange:s,checkedIcon:r.a.createElement(X.a,{classes:{root:a?"poll-radio-icon":null}})}),a&&r.a.createElement(J.a,{size:20,thickness:4.4,classes:{root:"poll-radio-progress-root",colorPrimary:"message-control"}}))}}var ee=$;a(327);class te extends r.a.Component{constructor(e){super(e),this.updateAnimation=()=>{this.stopAnimation(),this.handle=requestAnimationFrame(this.onAnimationFrame)},this.stopAnimation=()=>{this.handle&&(cancelAnimationFrame(this.handle),this.handle=null)},this.onAnimationFrame=()=>{const e=this.state,t=e.startTime,a=e.from,n=e.to,s=Date.now()-t;if(s>=w.b)this.setState({animated:n}),this.stopAnimation();else{const e=a+Math.floor((n-a)*s/w.b);this.setState({animated:e}),this.handle=requestAnimationFrame(this.onAnimationFrame)}},this.handle=null;const t=e.value;this.state={from:t,to:t,animated:t,prevPropsValue:t}}shouldComponentUpdate(e,t,a){const n=this.props,s=n.closed,i=n.theme,o=n.value,r=this.state.animated;return s!==e.closed||(i!==e.theme||(o!==e.value||r!==t.animated))}static getDerivedStateFromProps(e,t){return e.value!==t.prevPropsValue?{startTime:Date.now(),from:t.animated,to:e.value,prevPropsValue:e.value}:null}componentDidUpdate(e,t,a){e.value!==this.props.value&&this.updateAnimation()}componentWillUnmount(){this.stopAnimation()}render(){const e=this.props,t=(e.chosen,e.closed,e.onClick,this.state.animated);return r.a.createElement("div",{className:"poll-percentage"},r.a.createElement(r.a.Fragment,null,t+"%"))}}var ae=te;a(328);class ne extends r.a.Component{constructor(...e){super(...e),this.getTitleString=(e,t=(e=>e))=>this.props.canBeSelected?null:e?1===e?"1 vote":e+" votes":t("NoVotes").toLowerCase(),this.handleClick=e=>{const t=this.props,a=t.canBeSelected,n=t.onVote;a&&(e.stopPropagation(),n())}}render(){const e=this.props,t=e.option,a=e.onChange,n=e.canBeSelected,s=e.closed,i=e.maxVoterCount,o=e.t,c=e.type,l=e.isCorrect;if(!t)return null;const d=t.text,h=t.voter_count,u=t.vote_percentage,m=t.is_chosen,g=t.isMultiChoosen,f=t.is_being_chosen;let b=1.5;return h&&(b=h/i*100),r.a.createElement("div",{className:"poll-option",onClick:this.handleClick},r.a.createElement("div",{className:p()("poll-option-wrapper",n?"poll-option-unselected":"poll-option-selected")},r.a.createElement("div",{className:"poll-option-text-wrapper",title:this.getTitleString(h,o)},r.a.createElement(ae,{value:u,chosen:m,closed:s}),r.a.createElement(ee,{hidden:!n,chosen:m||g,beingChosen:f,onChange:a}),(m||l)&&r.a.createElement("div",{className:p()("poll-option-mark",{"poll-option-mark-correct":"correct"===c},{"poll-option-mark-incorrect":"incorrect"===c})},"incorrect"===c?r.a.createElement(q.a,{className:"poll-option-mark-icon"}):r.a.createElement(Z,{className:"poll-option-mark-icon"})),r.a.createElement("div",{className:"poll-option-text"},d))),r.a.createElement(G.a,{classes:{root:"poll-option-progress-root",bar:p()("poll-option-progress-bar",{"poll-option-progress-bar-correct":"correct"===c},{"poll-option-progress-bar-incorrect":"incorrect"===c})},color:"primary",variant:"determinate",value:n?0:Math.max(1.5,b)}))}}var se=Object(m.c)()(ne),ie=a(144),oe=a(8),re=(a(329),a(493)),ce=a(140);a(332),a(196);class le extends r.a.Component{render(){const e=this.props,t=e.index,a=e.showStatus,n="".concat(20+10*Math.sin(t),"%"),s="".concat(30+10*Math.cos(t),"%");return r.a.createElement("div",{className:"user-placeholder"},r.a.createElement("div",{className:"user-wrapper"},r.a.createElement("div",{className:"user-placeholder-tile"}),r.a.createElement("div",{className:"user-placeholder-inner-wrapper"},r.a.createElement("div",{className:"tile-first-row"},r.a.createElement("div",{className:"dialog-placeholder-title",style:{width:n}}),r.a.createElement("div",{className:"dialog-placeholder-title",style:{width:s,marginLeft:8}})),a&&r.a.createElement("div",{className:"tile-second-row"},r.a.createElement("div",{className:"dialog-placeholder-content",style:{width:s}})))))}}le.defaultProps={showStatus:!0};var de=le;a(333);class he extends r.a.Component{constructor(...e){super(...e),this.onClick=()=>{const e=this.props.userId;e&&(Object(L.j)(e,!0),setTimeout(()=>{j.a.clientUpdate({"@type":"clientUpdateClosePollResults"})},0))}}render(){const e=this.props,t=e.index,a=e.userId,n=a?r.a.createElement(ce.a,{userId:a,showStatus:!1}):r.a.createElement(de,{index:t,showStatus:!1});return r.a.createElement(re.a,{button:!0,className:"user-list-item",onClick:this.onClick},n)}}var ue=he,pe=a(2);a(334);class me extends r.a.Component{constructor(e){super(e),this.handleShowMore=()=>{const e=this.props.option,t=this.state.count,a=t,n=Math.min(e.voter_count,t+w.V);this.setState({offset:a,count:n},()=>{this.updateVoters(a,n,!0)})},this.handleCollapse=e=>{e.preventDefault(),e.stopPropagation();const t=this.props.option,a=t&&t.voter_count<=w.T?t.voter_count:w.T-w.U;this.setState({voters:this.state.voters.slice(0,a),offset:0,count:a})};const t=this.props.option,a=t&&t.voter_count<=w.T?t.voter_count:w.T-w.U;this.state={voters:[],offset:0,count:a}}updateVoters(e,t,a){var n=this;return Object(i.a)(s.a.mark((function o(){var r,c,l,d,h,u,p,m,g;return s.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(r=n.props,c=r.chatId,l=r.messageId,d=r.optionId,h=r.option,u=n.state.voters,!(t<=0)){o.next=4;break}return o.abrupt("return");case 4:return p=t-e,o.next=7,j.a.send({"@type":"getPollVoters",chat_id:c,message_id:l,option_id:d,offset:e,limit:p});case 7:if(m=o.sent,n.props.option===h){o.next=10;break}return o.abrupt("return");case 10:g=pe.a.getStore(),Object(k.A)(g,m.user_ids),n.setState({voters:[...u,...m.user_ids]},Object(i.a)(s.a.mark((function i(){var o;return s.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:m.user_ids.length<p&&a&&(o=e+m.user_ids.length,n.updateVoters(o,t,!1));case 1:case"end":return s.stop()}}),i)}))));case 13:case"end":return o.stop()}}),o)})))()}componentDidMount(){const e=this.state,t=e.offset,a=e.count;this.updateVoters(t,a,!0)}render(){const e=this.props,t=e.option,a=e.isQuiz,n=e.t,s=this.state,i=s.voters,o=s.count,c=t.text,l=t.voter_count,d=t.vote_percentage;if(0===l)return null;const h=[];for(let f=0;f<o;f++){const e=f<i.length?i[f]:null;h.push(r.a.createElement(ue,{key:"".concat(f,"_userId=").concat(e),index:f,userId:e}))}const u="".concat(l,a?1!==l?" answers":" answer":1!==l?" votes":" vote");let p=null;const m=l-o;if(m>0){const e="".concat(m,a?1!==m?" answers":" answer":1!==m?" votes":" vote");p=r.a.createElement(x.a,{classes:{root:"poll-option-results-button"},color:"primary",fullWidth:!0,onClick:this.handleShowMore},n("ShowVotesOT").replace("%1$d",e))}const g=o>w.T-w.U&&l>w.T;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"poll-option-results-caption"},r.a.createElement("div",{className:"poll-option-results-answer"},"".concat(c," \u2014 ").concat(d,"%")),g?r.a.createElement("a",{onClick:this.handleCollapse},n("PollCollapse")):r.a.createElement("div",{className:"poll-option-results-count"},u)),h,p)}}var ge=Object(m.c)()(me),fe=a(47);a(335);class be extends r.a.Component{constructor(...e){super(...e),this.onClientUpdateClosePollResults=e=>{(0,this.props.onClose)()},this.handleClose=e=>{e.preventDefault(),e.stopPropagation(),(0,this.props.onClose)()},this.handleClick=e=>{e.preventDefault(),e.stopPropagation()},this.handleContextMenu=e=>{e.preventDefault(),e.stopPropagation()}}componentDidMount(){fe.a.on("clientUpdateClosePollResults",this.onClientUpdateClosePollResults)}componentWillUnmount(){fe.a.off("clientUpdateClosePollResults",this.onClientUpdateClosePollResults)}render(){const e=this.props,t=e.chatId,a=e.messageId,n=e.poll,s=e.t;if(!n)return;const i=n.options,o=n.type,c=n.question,l=o&&"pollTypeQuiz"===o["@type"];return r.a.createElement(O.a,{classes:{root:"chat-info-dialog-root",container:"chat-info-dialog-container",paper:"chat-info-dialog-paper"},transitionDuration:0,open:!0,onClick:this.handleClick,onContextMenu:this.handleContextMenu,onClose:this.handleClose,"aria-labelledby":"poll-results-title"},r.a.createElement(P.a,{id:"poll-results-title"},s(l?"QuizAnswers":"PollResults")),r.a.createElement(T.a,{classes:{root:"poll-results-content"}},r.a.createElement("div",{className:"poll-results-question"},c),i.map((e,n)=>r.a.createElement(ge,{key:n,isQuiz:l,chatId:t,messageId:a,optionId:n,option:e}))))}}var Ce=Object(m.c)()(be);class ye extends r.a.Component{constructor(e){super(e),this.getTotalVoterCountString=(e,t=(e=>e))=>e?1===e?"1 answer":e+" answers":t("NoVotes"),this.handleSubmit=e=>{e.preventDefault(),e.stopPropagation();const t=this.props,a=t.chatId,n=t.messageId,s=t.poll;if(!s)return;const i=s.type;if(!i)return;if(this.viewResults(s))return;if(!i.allow_multiple_answers)return;const o=[];s.options.forEach((e,t)=>{e.isMultiChoosen&&o.push(t)}),o.length&&Object(ie.b)(a,n,o)},this.handleVote=e=>{const t=this.props,a=t.chatId,n=t.messageId,s=t.poll;if(!s)return;const i=s.type;i&&("pollTypeRegular"===i["@type"]&&i.allow_multiple_answers?(s.options[e].isMultiChoosen=!s.options[e].isMultiChoosen,this.forceUpdate()):Object(ie.b)(a,n,[e]))},this.handleOpenResults=e=>{e.preventDefault(),e.stopPropagation();const t=this.props.poll;this.setState({viewResultsPoll:t})},this.handleCloseResults=()=>{this.setState({viewResultsPoll:null})},this.fireworksRef=r.a.createRef(),this.state={}}componentDidUpdate(e,t,a){const n=this.props,s=n.chatId,i=n.messageId,o=n.poll;if(o&&"pollTypeQuiz"===o.type["@type"]){if(-1===e.poll.type.correct_option_id&&-1!==o.type.correct_option_id){const e=this.fireworksRef.current;if(!e)return;o.options[o.type.correct_option_id].is_chosen?e.start():j.a.clientUpdate({"@type":"clientUpdateMessageShake",chatId:s,messageId:i})}}}viewResults(e){if(!e)return!1;const t=e.options,a=e.is_closed;return!e.is_anonymous&&(a||t.some(e=>e.is_chosen))}getOptionType(e,t){const a=["regular","correct","incorrect"];if(!t)return a[0];const n=t.options[e];if(!n)return a[0];if(!n.is_chosen)return a[0];const s=t.type;if(!s)return a[0];if("pollTypeQuiz"!==s["@type"])return a[0];const i=s.correct_option_id;return-1===i?a[0]:i===e?a[1]:a[2]}getOptionIsCorrect(e,t){if(!t)return!1;if(!t.options[e])return!1;const a=t.type;if(!a)return!1;if("pollTypeQuiz"!==a["@type"])return!1;const n=a.correct_option_id;return-1!==n&&n===e}render(){const e=this.props,t=e.chatId,a=e.messageId,n=e.poll,s=e.t,i=e.meta,o=this.state.viewResultsPoll,c=n.question,l=n.options,d=n.total_voter_count,h=n.type,u=n.is_closed,p=n.is_anonymous,m=n.recent_voter_user_ids;let f=s("FinalResults");if(!u)switch(h["@type"]){case"pollTypeRegular":f=s(p?"AnonymousPoll":"PublicPoll");break;case"pollTypeQuiz":f=s(p?"AnonymousQuizPoll":"QuizPoll")}if(!oe.a.get(t,a))return null;const b=h&&"pollTypeQuiz"===h["@type"],C=!u&&l.every(e=>!e.is_chosen),y=!u&&l.some(e=>e.is_chosen),v=Math.max(...l.map(e=>e.voter_count)),E=this.viewResults(n),S=h.allow_multiple_answers&&!y||E,U=E||l.some(e=>e.isMultiChoosen);let k=[];return m&&(k=m.map(e=>r.a.createElement(g.a,{poll:!0,userId:e}))),r.a.createElement("div",{className:"poll"},b&&r.a.createElement(W,{ref:this.fireworksRef}),r.a.createElement("div",{className:"poll-question"},r.a.createElement("div",{className:"poll-question-title"},c),r.a.createElement("div",{className:"poll-question-subtitle"},r.a.createElement("span",{style:{marginRight:6}},f),k)),r.a.createElement("div",{className:"poll-options"},l.map((e,t)=>r.a.createElement(se,{key:t,type:this.getOptionType(t,n),isCorrect:this.getOptionIsCorrect(t,n),option:e,canBeSelected:C,closed:u,maxVoterCount:v,onVote:()=>this.handleVote(t)}))),S?r.a.createElement(x.a,{fullWidth:!0,color:"primary",classes:{root:"poll-button",textPrimary:"message-control",disabled:"message-control-disabled"},TouchRippleProps:{classes:{child:"touch-ripple-current-color"}},disabled:!U,onClick:E?this.handleOpenResults:this.handleSubmit},s(E?"PollViewResults":"PollSubmitVotes")):r.a.createElement("div",{className:"poll-total-count"},this.getTotalVoterCountString(d,s),i),Boolean(o)&&r.a.createElement(Ce,{chatId:t,messageId:a,poll:o,onClose:this.handleCloseResults}))}}var ve=Object(m.c)()(ye),Ee=a(88),Se=a(68);a(339);class Ue extends r.a.Component{render(){const e=this.props,t=e.chatId,a=e.messageId,n=e.venue,s=e.openMedia,i=e.meta,o=e.caption;if(!n)return null;const c=n.title,l=n.address,d=n.location;if(!d)return null;const h=d.longitude,u=d.latitude,p="https://maps.google.com/?q=".concat(u,",").concat(h);return r.a.createElement("div",{className:"venue"},r.a.createElement(_.a,{type:"venue",chatId:t,messageId:a,location:d,openMedia:s}),r.a.createElement("div",{className:"venue-content"},r.a.createElement("a",{href:p,target:"_blank",rel:"noopener noreferrer"},r.a.createElement("div",{className:"venue-title"},c)),r.a.createElement("div",{className:"venue-subtitle"},l,!o&&i)))}}var ke=Ue,we=a(141),Me=a(170),Ie=a(181),_e=a(67),xe=a(37),Oe=a(105),Pe=a(42),Te=a(7),Ne=a(5),De=a(492),Le=a(172),je=a.n(Le);a(345);class Re extends r.a.Component{render(){const e=this.props,t=e.chatId,a=e.messageId,n=e.duration,s=(e.openMedia,e.title),i=e.meta,o=Object(xe.d)(t,a),c=Object(U.e)(Math.floor(n||0));return r.a.createElement("div",{className:p()("document",{"media-title":s})},r.a.createElement(De.a,{color:"primary","aria-label":"Call"},r.a.createElement(je.a,{fontSize:"large"})),r.a.createElement("div",{className:"document-content"},r.a.createElement("div",{className:"document-title"},o),r.a.createElement("div",{className:"document-action"},c,i)))}}var Ae=Re;function Fe(e,t){const a=oe.a.get(e,t);if(!a)return!1;const n=a.content;if(!n)return!1;const s=n.caption;if(s&&s.text&&s.text.length>0)return!1;switch(n["@type"]){case"messageAnimation":case"messageLocation":case"messagePhoto":case"messageSticker":case"messageVideo":case"messageVideoNote":return!0}return!1}function Be(e,t){const a=Ne.a.get(e);if(!a)return!1;const n=a.last_read_inbox_message_id,s=a.last_read_outbox_message_id,i=oe.a.get(e,t);if(!i)return!1;const o=i.id,r=i.is_outgoing,c=Object(R.V)(e);return(!r||!c)&&(r?o>s:o>n)}function Ve(e,t=(e=>e)){if(!e)return null;const a=e.sender_user_id,n=e.chat_id;if(a){if(C.a.get(a))return Object(b.c)(a,null,t)}if(n){const e=Ne.a.get(n);if(e)return e.title}return null}function ze(e,t,a){return t<0&&(t=0),t>e.length-1&&(t=e.length-1),a<t&&(a=t),a>e.length&&(a=e.length),e.substring(t,a)}function He(e){e.stopPropagation()}function We(e,t){e.stopPropagation(),e.preventDefault();const a=Te.a.chatId;Object(L.l)(a,t)}function Ge(e,t=(e=>e)){if("formattedText"!==e["@type"])return null;const a=e.text,n=e.entities;if(!a)return null;if(!n)return a;let s=!1,i=[],o=0;for(let c=0;c<n.length;c++){const e=n[c],l=e.offset,d=e.length,h=e.type;if(o>l)continue;let u=ze(a,o,l);const p=u.length;u&&(s&&u.length>0&&"\n"===u[0]&&(u=u.substr(1),s=!1),u&&i.push(u));const m=l;let g=ze(a,l,l+d);switch(s&&g.length>0&&"\n"===g[0]&&(g=g.substr(1),s=!1),h["@type"]){case"textEntityTypeBold":i.push(r.a.createElement("strong",{key:m},g));break;case"textEntityTypeBotCommand":{const e=g.length>0&&"/"===g[0]?ze(g,1):g;i.push(r.a.createElement("a",{key:m,onClick:He,href:"tg://bot_command?command=".concat(e,"&bot=")},g));break}case"textEntityTypeCashtag":i.push(r.a.createElement("a",{key:m,onClick:e=>We(e,g)},g));break;case"textEntityTypeCode":i.push(r.a.createElement("code",{key:m},g));break;case"textEntityTypeEmailAddress":i.push(r.a.createElement("a",{key:m,href:"mailto:".concat(g),onClick:He,target:"_blank",rel:"noopener noreferrer"},g));break;case"textEntityTypeHashtag":i.push(r.a.createElement("a",{key:m,onClick:e=>We(e,g)},g));break;case"textEntityTypeItalic":i.push(r.a.createElement("em",{key:m},g));break;case"textEntityTypeMentionName":i.push(r.a.createElement(F,{key:m,userId:h.user_id,title:Object(b.c)(h.user_id,null,t)},g));break;case"textEntityTypeMention":i.push(r.a.createElement(F,{key:m,username:g},g));break;case"textEntityTypePhoneNumber":i.push(r.a.createElement("a",{key:m,href:"tel:".concat(g),onClick:He},g));break;case"textEntityTypePre":i.push(r.a.createElement("pre",{key:m},g)),s=!0;break;case"textEntityTypePreCode":i.push(r.a.createElement("pre",{key:m},r.a.createElement("code",null,g))),s=!0;break;case"textEntityTypeTextUrl":{const e=h.url?h.url:g;i.push(r.a.createElement(Ee.a,{key:m,url:e},g));break}case"textEntityTypeUrl":i.push(r.a.createElement(Ee.a,{key:m,url:g},g));break;default:i.push(g)}o+=p+e.length}if(o<a.length){let e=a.substring(o);s&&e.length>0&&"\n"===e[0]&&(e=e.substr(1)),e&&i.push(e)}return i}function Ke(e,t,a=(e=>e)){if(!e)return null;let n=[];const s=e.content;if(!s)return[...n,t];const i=s.text,o=s.caption;if(i&&"formattedText"===i["@type"]&&i.text)n=Ge(i,a);else if(o&&"formattedText"===o["@type"]&&o.text){const e=Ge(o,a);e&&(n=n.concat(e))}return n&&n.length>0?[...n,t]:[]}function Ze(e){return e&&e.content?e.content.web_page:null}function qe(e){if(!e)return null;const t=new Date(1e3*e);return Object(_e.a)(t,"H:MM")}function Ye(e){if(!e)return null;const t=new Date(1e3*e);return Object(_e.a)(t,"H:MM:ss d.mm.yyyy")}function Je(e,t,a=!1,n=!1,s=null){if(!e)return null;const i=e.chat_id,o=e.id,c=e.content;if(!c)return null;switch(c["@type"]){case"messageAnimation":return r.a.createElement(h.a,{type:"message",title:a,caption:n,chatId:i,messageId:o,animation:c.animation,openMedia:t});case"messageAudio":return r.a.createElement(d.a,{title:a,caption:n,chatId:i,messageId:o,audio:c.audio,openMedia:t,meta:s});case"messageCall":return r.a.createElement(Ae,{title:a,caption:n,chatId:i,messageId:o,duraton:c.duration,discardReason:c.discard_reason,openMedia:t,meta:s});case"messageContact":return r.a.createElement(v,{title:a,caption:n,chatId:i,messageId:o,contact:c.contact,openMedia:t,meta:s});case"messageDocument":return r.a.createElement(E.a,{title:a,caption:n,chatId:i,messageId:o,document:c.document,openMedia:t,meta:s});case"messageGame":return r.a.createElement(I,{chatId:i,messageId:o,game:c.game,openMedia:t});case"messageLocation":return r.a.createElement(_.a,{type:"message",title:a,caption:n,chatId:i,messageId:o,location:c.location,openMedia:t});case"messagePhoto":return r.a.createElement(S.a,{type:"message",title:a,caption:n,chatId:i,messageId:o,photo:c.photo,openMedia:t});case"messagePoll":return r.a.createElement(ve,{chatId:i,messageId:o,poll:c.poll,openMedia:t,meta:s});case"messageSticker":return r.a.createElement(Se.b,{chatId:i,messageId:o,sticker:c.sticker,source:Se.a.MESSAGE,openMedia:t});case"messageText":return null;case"messageVenue":return r.a.createElement(ke,{type:"message",title:a,caption:n,chatId:i,messageId:o,venue:c.venue,openMedia:t,meta:s});case"messageVideo":return r.a.createElement(we.a,{type:"message",title:a,caption:n,chatId:i,messageId:o,video:c.video,openMedia:t});case"messageVideoNote":return r.a.createElement(Me.a,{type:"message",title:a,caption:n,chatId:i,messageId:o,videoNote:c.video_note,openMedia:t});case"messageVoiceNote":return r.a.createElement(Ie.a,{type:"message",title:a,caption:n,chatId:i,messageId:o,voiceNote:c.voice_note,openMedia:t,meta:s});default:return["[".concat(c["@type"],"]"),s]}}function Qe(e){if(!e)return!1;const t=e.origin;if(!t)return!1;switch(t["@type"]){case"messageForwardOriginUser":return!1;case"messageForwardOriginHiddenUser":return!0;case"messageForwardOriginChannel":return!1}return!1}function Xe(e,t=(e=>e)){if(!e)return"";const a=e.origin;if(!a)return"";switch(a["@type"]){case"messageForwardOriginUser":{const e=a.sender_user_id;return Object(b.c)(e,null,t)}case"messageForwardOriginHiddenUser":return a.sender_name;case"messageForwardOriginChannel":{const e=a.chat_id,n=a.author_signature;return Object(R.u)(e,!1,t)+(n?" (".concat(n,")"):"")}}return""}function $e(e){return e?e.sender_user_id:null}function et(e,t){if(0===e.messages.length)return;if(0===t.length)return;const a=t.reduce((function(e,t){return e.set(t.id,t.id),e}),new Map);e.messages=e.messages.filter(e=>!a.has(e.id))}function tt(e){return e.filter(e=>"messageChatUpgradeTo"!==e.content["@type"])}function at(e,t=(e=>e)){if(!e)return null;const a=e.content;if(!a)return null;let n="";if(a.caption&&a.caption.text&&(n=", ".concat(a.caption.text)),e.ttl>0)return Object(Pe.a)(e);switch(a["@type"]){case"messageAnimation":return t("AttachGif")+n;case"messageAudio":return t("AttachMusic")+n;case"messageBasicGroupChatCreate":return Object(Pe.a)(e);case"messageCall":return t("Call")+n;case"messageChatAddMembers":case"messageChatChangePhoto":case"messageChatChangeTitle":case"messageChatDeleteMember":case"messageChatDeletePhoto":case"messageChatJoinByLink":case"messageChatSetTtl":case"messageChatUpgradeFrom":case"messageChatUpgradeTo":return Object(Pe.a)(e);case"messageContact":return t("AttachContact")+n;case"messageContactRegistered":case"messageCustomServiceAction":return Object(Pe.a)(e);case"messageDocument":{const e=a.document;return e&&e.file_name?e.file_name+n:t("AttachDocument")+n}case"messageExpiredPhoto":return t("AttachPhoto")+n;case"messageExpiredVideo":return t("AttachVideo")+n;case"messageGame":return t("AttachGame")+n;case"messageGameScore":case"messageInvoice":return Object(Pe.a)(e);case"messageLocation":return t("AttachLocation")+n;case"messagePassportDataReceived":case"messagePassportDataSent":case"messagePaymentSuccessful":case"messagePaymentSuccessfulBot":return Object(Pe.a)(e);case"messagePhoto":return t("AttachPhoto")+n;case"messagePoll":return"\ud83d\udcca "+(a.poll.question||t("Poll"))+n;case"messagePinMessage":case"messageScreenshotTaken":return Object(Pe.a)(e);case"messageSticker":{const e=a.sticker;let s="";return e&&e.emoji&&(s=e.emoji),t("AttachSticker")+(s?" ".concat(s):"")+n}case"messageSupergroupChatCreate":return Object(Pe.a)(e);case"messageText":return a.text.text+n;case"messageUnsupported":return Object(Pe.a)(e);case"messageVenue":return t("AttachLocation")+n;case"messageVideo":return t("AttachVideo")+n;case"messageVideoNote":return t("AttachRound")+n;case"messageVoiceNote":return t("AttachAudio")+n;case"messageWebsiteConnected":return Object(Pe.a)(e);default:return t("UnsupportedAttachment")}}function nt(e){return!!e&&"messagePhoto"===e["@type"]}function st(e,t=w.p,a=w.n,n=w.q,s=w.o){if(!e)return null;const i=e.longitude,o=e.latitude;return"loc=".concat(o,",").concat(i,"&size=").concat(t,",").concat(a,"&scale=").concat(s,"&zoom=").concat(n)}function it(e,t){const a=oe.a.get(e,t);if(!a)return!1;const n=a.content;if(!n)return!1;switch(n["@type"]){case"messageVideo":return!0;case"messageText":{const e=n.web_page;return Boolean(e.video)}default:return!1}}function ot(e,t){const a=oe.a.get(e,t);if(!a)return!1;const n=a.content;if(!n)return!1;switch(n["@type"]){case"messageDocument":{const e=n.document;if(!e)return!1;const t=e.file_name;return t&&t.toLowerCase().endsWith(".json")}case"messageText":{const e=n.web_page;if(!e)return!1;const t=e.document;if(!t)return!1;const a=t.file_name;return a&&a.toLowerCase().endsWith(".json")}default:return!1}}function rt(e,t){const a=oe.a.get(e,t);if(!a)return!1;const n=a.content;if(!n)return!1;switch(n["@type"]){case"messageAnimation":return!0;case"messageText":{const e=n.web_page;return Boolean(e.animation)}default:return!1}}function ct(e,t){const a=oe.a.get(e,t);if(!a)return!0;const n=a.content;if(!n)return!0;switch(n["@type"]){case"messageVoiceNote":return n.is_listened;case"messageVideoNote":return n.is_viewed;default:return!0}}function lt(e,t=(e=>e)){if(!e)return null;const a=e.content;if(!a)return null;switch(a["@type"]){case"messageAudio":{const e=a.audio;if(e)return Object(xe.c)(e);break}case"messageText":{const e=a.web_page;if(e){const t=e.audio;if(t)return Object(xe.c)(t);break}}}return function(e,t=(e=>e)){if(!e)return null;const a=e.forward_info;if(a)switch(a["@type"]){case"messageForwardedFromUser":if(a.sender_user_id>0){if(C.a.get(a.sender_user_id))return Object(b.c)(a.sender_user_id,null,t)}break;case"messageForwardedPost":{const e=Ne.a.get(a.chat_id);if(e)return e.title;break}}return Ve(e,t)}(e,t)}function dt(e,t){const a=oe.a.get(e,t);if(!a)return!1;const n=a.content;if(!n)return!1;switch(n["@type"]){case"messageAudio":if(n.audio)return!0;break;case"messageText":{const e=n.web_page;if(e){if(e.audio)return!0}break}}return!1}function ht(e,t){const a=oe.a.get(e,t);if(!a)return!1;const n=a.content;if(!n)return!1;switch(n["@type"]){case"messageVideoNote":if(n.video_note)return!0;break;case"messageText":{const e=n.web_page;if(e){if(e.video_note)return!0}break}}return!1}function ut(e,t){const a=oe.a.get(e,t);if(!a)return null;const n=a.content;if(!n)return null;switch(n["@type"]){case"messageAudio":if(n.audio)return{"@type":"searchMessagesFilterAudio"};break;case"messageVoiceNote":if(n.voice_note)return{"@type":"searchMessagesFilterVoiceNote"};break;case"messageVideoNote":if(n.video_note)return null;break;case"messageText":{const e=n.web_page;if(e){const t=e.audio,a=e.voice_note,n=e.video_note;if(t)return null;if(a)return null;if(n)return null;break}}}return null}function pt(e,t,a){if(!e)return;if(!t)return;const n=t.chat_id,s=t.id;let i=e.animation;i&&(i=pe.a.get(i.id)||i,a&&i.local.is_downloading_active?pe.a.cancelGetRemoteFile(i.id,t):a&&i.remote.is_uploading_active?pe.a.cancelUploadFile(i.id,t):(j.a.clientUpdate({"@type":"clientUpdateActiveAnimation",chatId:n,messageId:s}),j.a.send({"@type":"openMessageContent",chat_id:n,message_id:s}),Object(L.p)({chatId:n,messageId:s})))}function mt(e,t,a){if(!e)return;if(!t)return;const n=t.chat_id,s=t.id;let i=e.audio;i&&(i=pe.a.get(i.id)||i,a&&i.local.is_downloading_active?pe.a.cancelGetRemoteFile(i.id,t):a&&i.remote.is_uploading_active?pe.a.cancelUploadFile(i.id,t):(Object(k.b)(i,t,()=>pe.a.updateAudioBlob(n,s,i.id)),j.a.send({"@type":"openMessageContent",chat_id:n,message_id:s}),j.a.clientUpdate({"@type":"clientUpdateMediaActive",chatId:n,messageId:s})))}function gt(e,t,a){if(!e)return;if(!t)return;const n=t.chat_id,s=t.id;let i=e.document;i&&(i=pe.a.get(i.id)||i,a&&i.local.is_downloading_active?pe.a.cancelGetRemoteFile(i.id,t):a&&i.remote.is_uploading_active?pe.a.cancelUploadFile(i.id,t):(j.a.send({"@type":"openMessageContent",chat_id:n,message_id:s}),ot(n,s)?(j.a.send({"@type":"openMessageContent",chat_id:n,message_id:s}),Object(L.p)({chatId:n,messageId:s})):Object(k.E)(i,e.file_name,t)))}function ft(e,t,a){if(!e)return;if(!t)return;const n=t.chat_id,s=t.id,i=Object(U.i)(e.sizes);if(!i)return;let o=i.photo;o&&(o=pe.a.get(o.id)||o,a&&o.local.is_downloading_active?pe.a.cancelGetRemoteFile(o.id,t):a&&o.remote.is_uploading_active?pe.a.cancelUploadFile(o.id,t):(Object(k.b)(o,t,()=>pe.a.updatePhotoBlob(n,s,o.id)),j.a.send({"@type":"openMessageContent",chat_id:n,message_id:s}),Object(L.p)({chatId:n,messageId:s})))}function bt(e,t,a){return Ct.apply(this,arguments)}function Ct(){return(Ct=Object(i.a)(s.a.mark((function e(t,a,n){var i,o,r,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:if(a){e.next=4;break}return e.abrupt("return");case 4:if(i=a.chat_id,o=a.id,j.a.send({"@type":"openMessageContent",chat_id:i,message_id:o}),r=t.set_id){e.next=9;break}return e.abrupt("return");case 9:return e.next=11,j.a.send({"@type":"getStickerSet",set_id:r});case 11:if(c=e.sent){e.next=14;break}return e.abrupt("return");case 14:j.a.clientUpdate({"@type":"clientUpdateStickerSet",stickerSet:c});case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function yt(e,t,a){if(!e)return;if(!t)return;const n=t.chat_id,s=t.id;let i=e.video;i&&(i=pe.a.get(i.id)||i,a&&i.local.is_downloading_active?pe.a.cancelGetRemoteFile(i.id,t):a&&i.remote.is_uploading_active?pe.a.cancelUploadFile(i.id,t):(j.a.send({"@type":"openMessageContent",chat_id:n,message_id:s}),Object(L.p)({chatId:n,messageId:s})))}function vt(e,t,a){if(!e)return;if(!t)return;const n=t.chat_id,s=t.id;let i=e.video;i&&(i=pe.a.get(i.id)||i,a&&i.local.is_downloading_active?pe.a.cancelGetRemoteFile(i.id,t):a&&i.remote.is_uploading_active?pe.a.cancelUploadFile(i.id,t):(Object(k.b)(i,t,()=>pe.a.updateVideoNoteBlob(n,s,i.id)),j.a.send({"@type":"openMessageContent",chat_id:n,message_id:s}),j.a.clientUpdate({"@type":"clientUpdateMediaActive",chatId:n,messageId:s})))}function Et(e,t,a){if(!e)return;if(!t)return;const n=t.chat_id,s=t.id;let i=e.voice;i&&(i=pe.a.get(i.id)||i,a&&i.local.is_downloading_active?pe.a.cancelGetRemoteFile(i.id,t):a&&i.remote.is_uploading_active?pe.a.cancelUploadFile(i.id,t):(Object(k.b)(i,t,()=>pe.a.updateVoiceNoteBlob(n,s,i.id)),j.a.send({"@type":"openMessageContent",chat_id:n,message_id:s}),j.a.clientUpdate({"@type":"clientUpdateMediaActive",chatId:n,messageId:s})))}function St(e,t,a=!0){const n=oe.a.get(e,t);if(!n)return;const s=n.content;if(!s)return null;switch(s["@type"]){case"messageAnimation":{const e=s.animation;e&&pt(e,n,a);break}case"messageAudio":{const e=s.audio;e&&mt(e,n,a);break}case"messageChatChangePhoto":{const e=s.photo;e&&function(e,t,a){if(!e)return;if(!t)return;const n=t.chat_id,s=t.id,i=Object(U.i)(e.sizes);if(!i)return;let o=i.photo;o&&(o=pe.a.get(o.id)||o,a&&o.local.is_downloading_active?pe.a.cancelGetRemoteFile(o.id,t):a&&o.remote.is_uploading_active?pe.a.cancelUploadFile(o.id,t):(Object(k.b)(o,t,()=>pe.a.updatePhotoBlob(n,s,o.id)),j.a.send({"@type":"openMessageContent",chat_id:n,message_id:s}),Object(L.p)({chatId:n,messageId:s})))}(e,n,a);break}case"messageContact":{const e=s.contact;e&&function(e,t,a){if(!e)return;if(!t)return;const n=t.chat_id,s=t.id;j.a.send({"@type":"openMessageContent",chat_id:n,message_id:s}),Object(L.j)(e.user_id,!0)}(e,n);break}case"messageDocument":{const e=s.document;e&&gt(e,n,a);break}case"messageGame":{const e=s.game;e&&function(e,t,a){if(!e)return;if(!t)return;const n=t.chat_id,s=t.id,i=e.animation;if(i){let e=i.animation;if(!e)return;if(e=pe.a.get(e.id)||e,a&&e.local.is_downloading_active)return void pe.a.cancelGetRemoteFile(e.id,t);if(a&&e.remote.is_uploading_active)return void pe.a.cancelUploadFile(e.id,t);Object(k.b)(e,t,()=>pe.a.updateAnimationBlob(n,s,e.id))}j.a.send({"@type":"openMessageContent",chat_id:n,message_id:s}),j.a.clientUpdate({"@type":"clientUpdateActiveAnimation",chatId:n,messageId:s})}(e,n,a);break}case"messagePhoto":{const e=s.photo;e&&ft(e,n,a);break}case"messageSticker":{const e=s.sticker;e&&bt(e,n,a);break}case"messageText":{const e=s.web_page;if(e){const t=e.animation,s=e.audio,i=e.document,o=e.photo,r=e.sticker,c=e.video,l=e.video_note,d=e.voice_note;t&&pt(t,n,a),s&&mt(s,n,a),i&&gt(i,n,a),r&&bt(r,n,a),c&&yt(c,n,a),l&&vt(l,n,a),d&&Et(d,n,a),o&&ft(o,n,a)}break}case"messageVideo":{const e=s.video;e&&yt(e,n,a);break}case"messageVideoNote":{const e=s.video_note;e&&vt(e,n,a);break}case"messageVoiceNote":{const e=s.voice_note;e&&Et(e,n,a);break}}}function Ut(e){return e&&"deletedMessage"===e["@type"]}function kt(e,t){const a=oe.a.get(e,t);if(!a)return;const n=a.content;if(!n)return null;switch(n["@type"]){case"messageAnimation":{const e=n.animation;return e&&e.minithumbnail||null}case"messageAudio":return null;case"messageChatChangePhoto":{const e=n.photo;return e&&e.minithumbnail||null}case"messageDocument":{const e=n.document;return e&&e.minithumbnail||null}case"messageGame":{const e=n.game;if(!e)return null;const t=e.animation,a=e.photo;if(t){const e=t.minithumbnail;if(e)return e}return a&&a.minithumbnail||null}case"messagePhoto":{const e=n.photo;return e&&e.minithumbnail||null}case"messageSticker":return null;case"messageText":{const e=n.web_page;if(e){const t=e.animation,a=e.audio,n=e.document,s=e.photo,i=e.sticker,o=e.video,r=e.video_note;if(s)return s.minithumbnail||null;if(t){return t.minithumbnail||null}if(a)return null;if(n){return n.minithumbnail||null}if(i)return null;if(o){return o.minithumbnail||null}if(r){return r.minithumbnail||null}}break}case"messageVideo":{const e=n.video;return e&&e.minithumbnail||null}case"messageVideoNote":{const e=n.video_note;return e&&e.minithumbnail||null}}return null}function wt(e,t){const a=oe.a.get(e,t);if(!a)return;const n=a.content;if(!n)return null;switch(n["@type"]){case"messageAnimation":{const e=n.animation;return e&&e.thumbnail||null}case"messageAudio":{const e=n.audio;return e&&e.album_cover_thumbnail||null}case"messageChatChangePhoto":{const e=n.photo;return e?Object(U.i)(e.sizes):null}case"messageDocument":{const e=n.document;return e&&e.thumbnail||null}case"messageGame":{const e=n.game;if(!e)return null;const t=e.animation,a=e.photo;if(t){const e=t.thumbnail;if(e)return e}return a?Object(U.i)(a.sizes):null}case"messagePhoto":{const e=n.photo;return e?Object(U.i)(e.sizes):null}case"messageSticker":{const e=n.sticker;return e&&e.thumbnail||null}case"messageText":{const e=n.web_page;if(e){const t=e.animation,a=e.audio,n=e.document,s=e.photo,i=e.sticker,o=e.video,r=e.video_note;if(s)return Object(U.i)(s.sizes);if(t){return t.thumbnail||null}if(a){return a.album_cover_thumbnail||null}if(n){return n.thumbnail||null}if(i){return i.thumbnail||null}if(o){return o.thumbnail||null}if(r){return r.thumbnail||null}}break}case"messageVideo":{const e=n.video;return e&&e.thumbnail||null}case"messageVideoNote":{const e=n.video_note;return e&&e.thumbnail||null}}return null}function Mt(e,t){const a=oe.a.get(e,t);if(!a)return 0;const n=a.content;if(!n)return 0;if("messageText"!==n["@type"])return 0;const s=n.text;if(!s)return;if("formattedText"!==s["@type"])return 0;const i=s.text,o=s.entities;if(!i)return 0;if(o&&o.length>0)return 0;let r,c=0,d=0;const h=l()();do{if(r=h.exec(i),r){if(d+=1,c!==r.index){d=0;break}if(d>3){d=0;break}c=h.lastIndex}if(!r&&c!==i.length){d=0;break}}while(r);return d}function It(e,t){return e.id-t.id}function _t(e){const t=e.chat_id;return function(e){return e&&e.contains_unread_mention}(e)?Object(R.k)(t):function(e){return e&&"messagePinMessage"===e.content["@type"]}(e)?Object(R.l)(t):Object(R.P)(t)}function xt(e,t){if(!t)return!1;if(!t.length)return!1;for(let a=0;a<t.length;a++)if(e>=t[a].offset&&e<t[a].offset+t[a].length)return!0;return!1}function Ot(e,t,a){if(!a)return!1;if(!a.length)return!1;for(let n=0;n<a.length;n++)if(e<=a[n].offset&&a[n].offset+a[n].length-1<=t)return!0;return!1}function Pt(e,t,a){return!xt(e,a)&&!xt(t,a)&&!Ot(e,t,a)}function Tt(e,t,a){a&&a.length&&a.forEach(a=>{a.offset>e&&(a.offset-=t)})}function Nt(e,t,a){a&&a.length&&a.forEach(a=>{a.offset>e&&(a.offset+=t)})}function Dt(e,t,a){if(a&&a.length)for(let n=0;n<a.length;n++){const s=a[n],i=s.offset,o=s.offset+s.length-1;(e<=i&&i<=t||e<=o&&o<=t||i<e&&t>o)&&a.splice(n--,1)}}function Lt(e,t,a,n){const s=document.createTextNode(a.substr(e,t));n.push(s)}function jt(e,t,a=(e=>e)){if(!e)return[];t=(t||[]).sort((e,t)=>e.offset-t.offset!==0?e.offset-t.offset:t.length-e.length);let n=[],s=0,i=null;return t.forEach(t=>{if(t.offset-s>0&&(Lt(s,t.offset-s,e,n),s=t.offset),!i||!xt(t.offset,[i])){switch(t.type["@type"]){case"textEntityTypeBold":{const a=document.createElement("b");a.innerText=e.substr(t.offset,t.length),n.push(a);break}case"textEntityTypeBotCommand":case"textEntityTypeCashtag":Lt(t.offset,t.length,e,n);break;case"textEntityTypeCode":{const a=document.createTextNode("`"+e.substr(t.offset,t.length)+"`");n.push(a);break}case"textEntityTypeEmailAddress":case"textEntityTypeHashtag":Lt(t.offset,t.length,e,n);break;case"textEntityTypeItalic":{const a=document.createElement("i");a.innerText=e.substr(t.offset,t.length),n.push(a);break}case"textEntityTypeMention":Lt(t.offset,t.length,e,n);break;case"textEntityTypeMentionName":try{const s=t.type.user_id;if(C.a.get(s)){const i=document.createElement("a");i.title=Object(b.c)(s,null,a),i.dataset.userId=s,i.innerText=e.substr(t.offset,t.length),n.push(i)}else Lt(t.offset,t.length,e,n)}catch(o){Lt(t.offset,t.length,e,n)}break;case"textEntityTypePhoneNumber":Lt(t.offset,t.length,e,n);break;case"textEntityTypePre":case"textEntityTypePreCode":{const a=document.createTextNode("```"+e.substr(t.offset,t.length)+"```");n.push(a);break}case"textEntityTypeTextUrl":try{const a=t.type.url,s=document.createElement("a");s.href=Object(Oe.a)(a,!1),s.title=Object(Oe.a)(a,!1),s.target="_blank",s.rel="noopener noreferrer",s.innerText=e.substr(t.offset,t.length),n.push(s)}catch(r){Lt(t.offset,t.length,e,n)}break;case"textEntityTypeUrl":default:Lt(t.offset,t.length,e,n)}i=t,s+=t.length}}),s<e.length&&Lt(s,e.length-s,e,n),n}function Rt(e){const t=[];if(!e)return{text:e,entities:t};e=e.split("<br>").join("\n");let a=-1,n=0,s=-1,i=!1;const o=(new DOMParser).parseFromString(e,"text/html");let r=0,c=0,l="";for(o.body.childNodes.forEach(e=>{const a=e.textContent,n=e.nodeName;if(c=a.length,l+=a,Pt(r,r+c-1,t))switch(n){case"#text":r+=c;break;case"A":e.dataset.userId?t.push({"@type":"textEntity",offset:r,length:c,type:{"@type":"textEntityTypeMentionName",user_id:e.dataset.userId},textContent:l.substring(r,r+c)}):e.href&&t.push({"@type":"textEntity",offset:r,length:c,type:{"@type":"textEntityTypeTextUrl",url:e.href},textContent:l.substring(r,r+c)}),r+=c;break;case"B":case"STRONG":t.push({"@type":"textEntity",offset:r,length:c,type:{"@type":"textEntityTypeBold"},textContent:l.substring(r,r+c)}),r+=c;break;case"BR":break;case"CODE":t.push({"@type":"textEntity",offset:r,length:c,type:{"@type":"textEntityTypeCode"},textContent:l.substring(r,r+c)}),r+=c;break;case"I":case"EM":t.push({"@type":"textEntity",offset:r,length:c,type:{"@type":"textEntityTypeItalic"},textContent:l.substring(r,r+c)}),r+=c;break;case"PRE":t.push({"@type":"textEntity",offset:r,length:c,type:{"@type":"textEntityTypePre"},textContent:l.substring(r,r+c)}),r+=c;break;default:r+=c}}),e=l;-1!==(a=e.indexOf(i?"```":"`",n));)if(-1===s)i=e.length-a>2&&"`"===e[a+1]&&"`"===e[a+2],s=a,n=a+(i?3:1);else{for(let t=a+(i?3:1);t<e.length&&"`"===e[t];t++)a++;if(n=a+(i?3:1),i){let i=e.substring(0,s),o=e.substring(s+3,a),l=e.substring(a+3,e.length);if(o.length>0){r=s,c=a-s-3;const d={"@type":"textEntity",offset:r,length:c,language:"",type:{"@type":"textEntityTypePre"},textContent:(e=i+o+l).substring(r,r+c)};if(Dt(r,r+c-1+6),Tt(r+c,6,t),t.push(d),n-=6,i.length>0){const a=i[i.length-1];"\n"!==a&&(" "===a||"\xa0"===a?(i=i.substr(0,i.length-1)+"\n",e=i+o+l):(i+="\n",e=i+o+l,Nt(r-1,1,t),n+=1))}if(l.length>0){const a=l[0];"\n"!==a&&(" "===a||"\xa0"===a?(l="\n"+l.substr(1),e=i+o+l):(l="\n"+l,e=i+o+l,Nt(r+c-1,1,t),n+=1))}o.length>2&&"\n"===o[0]&&(o=o.substring(1),e=i+o+l,d.length-=1,d.textContent=o,Tt(d.offset+d.length-1,1,t),n-=1),o.length>2&&"\n"===o[o.length-1]&&(o=o.substring(0,o.length-1),e=i+o+l,d.length-=1,d.textContent=o,Tt(d.offset+d.length-1,1,t),n-=1)}}else if(s+1!==a){r=s,c=a-s-1,e=e.substring(0,s)+e.substring(s+1,a)+e.substring(a+1,e.length);const i={"@type":"textEntity",offset:r,length:c,type:{"@type":"textEntityTypeCode"},textContent:e.substring(r,r+c)};Dt(r,r+c-1+2),Tt(r+c,2,t),t.push(i),n-=2}s=-1,i=!1}if(-1!==s&&i&&(r=s,c=1,Pt(r,r+c+2-1,t))){e=e.substring(0,s)+e.substring(s+2,e.length);const a={"@type":"textEntity",offset:r,length:c,type:{"@type":"textEntityTypeCode"},textContent:e.substring(r,r+c)};Dt(r,r+c-1+2),Tt(r+c,2,t),t.push(a)}for(let d=0;d<2;d++){n=0,s=-1;const i=0===d?"**":"__",o=0===d?"*":"_";for(;-1!==(a=e.indexOf(i,n));)if(-1===s){const i=0===a?" ":e[a-1];xt(a,t)||" "!==i&&"\xa0"!==i&&"\n"!==i||(s=a),n=a+2}else{for(let t=a+2;t<e.length&&e[t]===o;t++)a++;if(n=a+2,xt(a,t)||Ot(s,a,t)){s=-1;continue}if(s+2!==a){r=s,c=a-s-2,e=e.substring(0,s)+e.substring(s+2,a)+e.substring(a+2,e.length);const i={"@type":"textEntity",offset:r,length:c,language:"",type:{"@type":0===d?"textEntityTypeBold":"textEntityTypeItalic"},textContent:e.substring(r,r+c)};Tt(r+c,4,t),t.push(i),n-=4}s=-1}}return{text:e,entities:t}}function At(e,t){const a=oe.a.get(e,t);return!!a&&a.can_be_edited}function Ft(e,t){const a=oe.a.get(e,t);if(!a)return!1;const n=a.forward_info,s=a.content;return n&&s&&"messageSticker"!==s["@type"]&&"messageAudio"!==s["@type"]}function Bt(e,t){const a=oe.a.get(e,t);if(!a)return!1;const n=a.content;return n&&"messageText"===n["@type"]}function Vt(e,t){const a=Ne.a.get(e);return!!a&&a.pinned_message_id===t}function zt(e,t){const a=oe.a.get(e,t);if(!a)return!1;const n=a.content;if(!n)return;if("messagePoll"!==n["@type"])return;const s=n.poll;if(!s)return!1;const i=s.type,o=s.is_closed,r=s.options;return!!i&&("pollTypeRegular"===i["@type"]&&(!o&&r.some(e=>e.is_chosen||e.is_being_chosen)))}function Ht(e,t){const a=oe.a.get(e,t);if(!a)return!1;const n=a.content,s=a.can_be_edited;return n&&"messagePoll"===n["@type"]?s:void 0}a.d(t,"I",(function(){return Fe})),a.d(t,"H",(function(){return Be})),a.d(t,"q",(function(){return kt})),a.d(t,"F",(function(){return _t})),a.d(t,"p",(function(){return jt})),a.d(t,"j",(function(){return Rt})),a.d(t,"b",(function(){return At})),a.d(t,"N",(function(){return Ft})),a.d(t,"J",(function(){return Bt})),a.d(t,"G",(function(){return Vt})),a.d(t,"c",(function(){return zt})),a.d(t,"a",(function(){return Ht})),a.d(t,"v",(function(){return Ve})),a.d(t,"u",(function(){return Ke})),a.d(t,"k",(function(){return Ge})),a.d(t,"w",(function(){return Ze})),a.d(t,"f",(function(){return at})),a.d(t,"g",(function(){return qe})),a.d(t,"h",(function(){return Ye})),a.d(t,"n",(function(){return Je})),a.d(t,"C",(function(){return Qe})),a.d(t,"l",(function(){return Xe})),a.d(t,"t",(function(){return $e})),a.d(t,"d",(function(){return et})),a.d(t,"e",(function(){return tt})),a.d(t,"E",(function(){return nt})),a.d(t,"B",(function(){return Ut})),a.d(t,"K",(function(){return it})),a.d(t,"z",(function(){return rt})),a.d(t,"D",(function(){return ot})),a.d(t,"m",(function(){return st})),a.d(t,"A",(function(){return ct})),a.d(t,"o",(function(){return lt})),a.d(t,"x",(function(){return dt})),a.d(t,"y",(function(){return ht})),a.d(t,"s",(function(){return ut})),a.d(t,"M",(function(){return St})),a.d(t,"r",(function(){return wt})),a.d(t,"i",(function(){return Mt})),a.d(t,"L",(function(){return It})),a.d(t,"O",(function(){return ze}))},function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(6),s=a.n(n),i=a(13),o=a(40),r=a(17),c=a(4),l=a(8),d=a(1),h=a(19);const u=Object.freeze({NONE:"NONE",REPEAT:"REPEAT",REPEAT_ONE:"REPEAT_ONE"});class p extends o.a{constructor(){var e;super(),e=this,this.reset=()=>{this.playlist=null,this.message=null,this.time=null,this.videoStream=null,this.instantView=null,this.pageBlock=null},this.addTdLibListener=()=>{d.a.on("update",this.onUpdate),d.a.on("clientUpdate",this.onClientUpdate)},this.removeTdLibListener=()=>{d.a.off("update",this.onUpdate),d.a.off("clientUpdate",this.onClientUpdate)},this.onUpdate=function(){var t=Object(i.a)(s.a.mark((function t(a){var n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=a["@type"],t.next="updateAuthorizationState"===t.t0?3:12;break;case 3:if(n=a.authorization_state){t.next=6;break}return t.abrupt("break",13);case 6:t.t1=n["@type"],t.next="authorizationStateClosed"===t.t1?9:11;break;case 9:return e.reset(),t.abrupt("break",11);case 11:case 12:return t.abrupt("break",13);case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.close=()=>{d.a.clientUpdate({"@type":"clientUpdateMediaClose"})},this.onClientUpdate=e=>{switch(e["@type"]){case"clientUpdateMediaClose":this.reset(),this.emit(e["@type"],e);break;case"clientUpdateMediaActive":{const t=e.chatId,a=e.messageId,n=e.instantView,s=e.pageBlock,i=l.a.get(t,a);if(i)return this.message=i,this.emit(e["@type"],e),void this.getPlaylist(t,a);n&&s&&(this.instantView=n,this.pageBlock=s,this.emit(e["@type"],e));break}case"clientUpdateMediaVolume":{const t=e.volume;this.volume=t,this.savePlayerSettings(),this.emit(e["@type"],e);break}case"clientUpdateMediaRepeat":{const t=e.repeat;this.repeat=t,this.emit(e["@type"],e);break}case"clientUpdateMediaShuffle":{const t=e.shuffle;this.shuffle=t,this.emit(e["@type"],e);break}case"clientUpdateMediaPlaybackRate":{const t=e.playbackRate;this.playbackRate=t,this.savePlayerSettings(),this.emit(e["@type"],e);break}case"clientUpdateMediaPlay":this.playing=!0,this.emit(e["@type"],e);break;case"clientUpdateMediaTitleMouseOver":this.emit(e["@type"],e);break;case"clientUpdateMediaPause":this.playing=!1,this.emit(e["@type"],e);break;case"clientUpdateMediaStop":this.emit(e["@type"],e);break;case"clientUpdateMediaNext":this.emit(e["@type"],e),this.moveToNextMedia(!1);break;case"clientUpdateMediaPrev":this.emit(e["@type"],e),this.moveToPrevMedia();break;case"clientUpdateMediaEnding":this.emit(e["@type"],e);break;case"clientUpdateMediaEnd":this.emit(e["@type"],e),e.moveNext&&this.moveToNextMedia(!0)||this.close();break;case"clientUpdateMediaTime":{const t=e.duration,a=e.currentTime,n=e.timestamp;this.time={currentTime:a,duration:t,timestamp:n},this.emit(e["@type"],e);break}case"clientUpdateMediaCaptureStream":this.videoStream=e.stream,this.emit(e["@type"],e);break;case"clientUpdateMediaViewerPlay":case"clientUpdateMediaViewerPause":case"clientUpdateMediaViewerEnded":case"clientUpdateMediaPlaylistLoading":case"clientUpdateMediaPlaylistPrev":case"clientUpdateMediaPlaylist":case"clientUpdateMediaPlaylistNext":this.emit(e["@type"],e)}},this.moveToPrevMedia=()=>{if(!this.playlist)return;if(!this.message)return;const e=this.message,t=e.chat_id,a=e.id,n=this.playlist.messages;if(!n)return;const s=n.findIndex(e=>e.chat_id===t&&e.id===a);if(-1!==s&&s+1<n.length){const e=n[s+1];Object(r.M)(e.chat_id,e.id,!1)}},this.moveToNextMedia=e=>{if(!this.playlist)return!1;if(!this.message)return!1;const t=this.message,a=t.chat_id,n=t.id,s=this.playlist.messages;if(!s)return!1;const i=s.findIndex(e=>e.chat_id===a&&e.id===n);if(-1===i)return!1;let o=-1;if(e)switch(this.repeat){case u.NONE:o=this.shuffle?Object(h.k)(0,s.length):i-1;break;case u.REPEAT_ONE:o=i;break;case u.REPEAT:o=this.shuffle?Object(h.k)(0,s.length):i-1>=0?i-1:s.length-1}else o=i-1;if(o>=0){const e=s[o];return Object(r.M)(e.chat_id,e.id,!1),!0}return!1},this.getPlaylist=function(){var t=Object(i.a)(s.a.mark((function t(a,n){var i,o,c,h,u;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(i=e.playlist)){t.next=5;break}if(!(o=i.messages)||-1===o.findIndex(e=>e.chat_id===a&&e.id===n)){t.next=5;break}return t.abrupt("return");case 5:if(d.a.clientUpdate({"@type":"clientUpdateMediaPlaylistLoading",chatId:a,messageId:n}),c=Object(r.s)(a,n)){t.next=11;break}return e.playlist={chatId:a,messageId:n,totalCount:1,messages:[l.a.get(a,n)]},d.a.clientUpdate({"@type":"clientUpdateMediaPlaylist",playlist:e.playlist}),t.abrupt("return");case 11:return t.next=13,d.a.send({"@type":"searchChatMessages",chat_id:a,query:"",sender_user_id:0,from_message_id:n,offset:-50,limit:100,filter:c});case 13:h=t.sent,l.a.setItems(h.messages),u=h.total_count,o=h.messages,e.playlist={chatId:a,messageId:n,totalCount:u,messages:o},d.a.clientUpdate({"@type":"clientUpdateMediaPlaylist",playlist:e.playlist});case 18:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}();const t=this.loadPlayerSettings(),a=t.playbackRate,n=t.volume;this.playbackRate=a,this.volume=n,this.repeat=u.NONE,this.shuffle=!1,this.reset(),this.addTdLibListener()}loadPlayerSettings(){const e=localStorage.getItem("player")||{};let t=e.playbackRate,a=e.volume;return t=t&&Number(t)>=1&&Number(t)<=2?Number(t):c.I,a=a&&Number(a)>=0&&Number(a)<=1?Number(a):c.L,{playbackRate:t,volume:a}}savePlayerSettings(){const e=this.volume,t=this.playbackRate;localStorage.setItem("player",JSON.stringify({volume:e,playbackRate:t}))}}const m=new p;window.player=m,t.b=m},function(e,t,a){"use strict";a.d(t,"r",(function(){return s})),a.d(t,"q",(function(){return i})),a.d(t,"s",(function(){return o})),a.d(t,"d",(function(){return l})),a.d(t,"h",(function(){return c})),a.d(t,"w",(function(){return d})),a.d(t,"u",(function(){return h})),a.d(t,"l",(function(){return m})),a.d(t,"j",(function(){return u})),a.d(t,"i",(function(){return p})),a.d(t,"f",(function(){return g})),a.d(t,"t",(function(){return f})),a.d(t,"x",(function(){return b})),a.d(t,"c",(function(){return C})),a.d(t,"g",(function(){return v})),a.d(t,"v",(function(){return E})),a.d(t,"a",(function(){return S})),a.d(t,"p",(function(){return U})),a.d(t,"b",(function(){return k})),a.d(t,"e",(function(){return w})),a.d(t,"k",(function(){return M})),a.d(t,"o",(function(){return r})),a.d(t,"m",(function(){return I})),a.d(t,"n",(function(){return _}));var n=a(4);function s(){return navigator.userAgent.toLowerCase().indexOf("android")>-1||i()||o()}function i(){return!!(navigator.platform&&["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].indexOf(navigator.platform)>-1)||/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream}function o(){return!!navigator.userAgent.match(/Windows Phone/i)||(!!navigator.userAgent.match(/iemobile/i)||!!navigator.userAgent.match(/WPDesktop/i))}function r(){const e=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod","MacIntel"];return navigator.platform?e.indexOf(navigator.platform)>-1:/iPad|iPhone|iPod|Mac\sOS\sX/.test(navigator.userAgent)&&!window.MSStream}function c(){let e="Unknown";return-1!==window.navigator.userAgent.indexOf("Windows NT 10.0")&&(e="Windows 10"),-1!==window.navigator.userAgent.indexOf("Windows NT 6.2")&&(e="Windows 8"),-1!==window.navigator.userAgent.indexOf("Windows NT 6.1")&&(e="Windows 7"),-1!==window.navigator.userAgent.indexOf("Windows NT 6.0")&&(e="Windows Vista"),-1!==window.navigator.userAgent.indexOf("Windows NT 5.1")&&(e="Windows XP"),-1!==window.navigator.userAgent.indexOf("Windows NT 5.0")&&(e="Windows 2000"),-1!==window.navigator.userAgent.indexOf("Mac")&&(e="Mac/iOS"),-1!==window.navigator.userAgent.indexOf("X11")&&(e="UNIX"),-1!==window.navigator.userAgent.indexOf("Linux")&&(e="Linux"),e}function l(){let e="",t=!!!document.documentMode&&!!window.StyleMedia;return e=-1===navigator.userAgent.indexOf("Chrome")||t?-1===navigator.userAgent.indexOf("Safari")||t?-1!==navigator.userAgent.indexOf("Firefox")?"Firefox":-1!==navigator.userAgent.indexOf("MSIE")||!0===!!document.documentMode?"IE":t?"Edge":"Unknown":"Safari":"Chrome",e}function d(e){switch(e.toLowerCase().trim()){case"true":case"yes":case"1":return!0;case"false":case"no":case"0":case null:return!1;default:return Boolean(e)}}function h(e,t){let a=e.length-t.length;return 0!==a?a<0?-1:1:e===t?0:e>t?1:-1}function u(e){return m(e,n.G)}function p(e,t=n.F){return m(e,t)}function m(e,t){if(!e)return null;if(0===e.length)return null;if(0===t)return null;let a=e[0].width>=e[0].height,n=Math.abs(t-(a?e[0].width:e[0].height)),s=0;for(let i=1;i<e.length;i++){if("i"===e[i].type&&!e[i].photo.local.is_downloading_completed)continue;let o=Math.abs(t-(a?e[i].width:e[i].height));o<n&&(s=i,o=n)}return e[s]}function g(e,t,a=!0){return e?!a&&e.width<t&&e.height<t?e:e.width>e.height?{width:t,height:Math.floor(e.height*t/e.width)}:{width:Math.floor(e.width*t/e.height),height:t}:{width:0,height:0}}function f(e,t){let a=e.current,n=t?t.current:a;const s=[];for(let i=0;i<n.children.length;i++){let e=n.children[i];e.offsetTop+e.offsetHeight>=a.scrollTop&&e.offsetTop<=a.scrollTop+a.offsetHeight&&s.push(i)}return s}function b(e,t,a){var n,s,i,o=null,r=0;a||(a={});var c=function(){r=!1===a.leading?0:Date.now(),o=null,i=e.apply(n,s),o||(n=s=null)};return function(){var l=Date.now();r||!1!==a.leading||(r=l);var d=t-(l-r);return n=this,s=arguments,d<=0||d>t?(o&&(clearTimeout(o),o=null),r=l,i=e.apply(n,s),o||(n=s=null)):o||!1===a.trailing||(o=setTimeout(c,d)),i}}function C(e,t,a){var n;return function(){var s=this,i=arguments,o=function(){n=null,a||e.apply(s,i)},r=a&&!n;clearTimeout(n),n=setTimeout(o,t),r&&e.apply(s,i)}}function y(e){if(!e)return"";for(let t=0;t<e.length;t++){if(e[t].toUpperCase()!==e[t].toLowerCase())return e[t];if(e[t]>="0"&&e[t]<="9")return e[t]}return""}function v(e){if(!e)return null;if(0===e.length)return null;const t=e.split(" ");return 1===t.length?y(t[0]):t.length>1?y(t[0])+y(t[1]):null}function E(e,t){const a=new FileReader;a.addEventListener("load",(function(){const n=new Image;n.addEventListener("load",(function(){e.photoWidth=n.width,e.photoHeight=n.height,t(e)})),n.src=a.result})),a.readAsDataURL(e)}function S(e){for(var t="",a=new Uint8Array(e),n=a.byteLength,s=0;s<n;s++)t+=String.fromCharCode(a[s]);return window.btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=+$/,"")}function U(e){return!!e&&"authorizationStateReady"===e["@type"]}function k(e,t,a,n=!1){return n?e>=t&&e<=a:e>t&&e<a}function w(e){let t=Math.floor(e/3600),a=Math.floor((e-3600*t)/60),n=e-3600*t-60*a;return t>0&&a<10&&(a="0"+a),n<10&&(n="0"+n),(t>0?t+":":"")+a+":"+n}function M(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e))+e}function I(e,t){return!(!e&&t)&&(!(e&&!t)&&(!e&&!t||(0===e.length&&0===t.length||e===t)))}function _(e,t,a){let n=0;for(;n<e.length&&a(e[n],t)<0;n++);return[...e.slice(0,n),t,...e.slice(n)]}},,function(e,t,a){"use strict";a.d(t,"g",(function(){return s})),a.d(t,"d",(function(){return i})),a.d(t,"c",(function(){return o})),a.d(t,"k",(function(){return r})),a.d(t,"e",(function(){return c})),a.d(t,"j",(function(){return l})),a.d(t,"h",(function(){return d})),a.d(t,"b",(function(){return h})),a.d(t,"i",(function(){return u})),a.d(t,"f",(function(){return p})),a.d(t,"m",(function(){return m})),a.d(t,"a",(function(){return g})),a.d(t,"o",(function(){return f})),a.d(t,"p",(function(){return b})),a.d(t,"q",(function(){return C})),a.d(t,"n",(function(){return y})),a.d(t,"l",(function(){return v}));var n=a(1);function s(){n.a.clientUpdate({"@type":"clientUpdateOpenArchive"})}function i(e,t){n.a.clientUpdate({"@type":"clientUpdateEditMessage",chatId:e,messageId:t})}function o(e,t){n.a.clientUpdate({"@type":"clientUpdateDeleteMessages",chatId:e,messageIds:t})}function r(e,t){n.a.clientUpdate({"@type":"clientUpdateReply",chatId:e,messageId:t})}function c(e,t){n.a.clientUpdate({"@type":"clientUpdateForward",info:{chatId:e,messageIds:t}})}function l(e,t=!1){n.a.clientUpdate({"@type":"clientUpdateOpenUser",userId:e,popup:t})}function d(e,t=null,a=!1){n.a.clientUpdate({"@type":"clientUpdateOpenChat",chatId:e,messageId:t,popup:a})}function h(){n.a.clientUpdate({"@type":"clientUpdateOpenChat",chatId:0,messageId:null,popup:!1})}function u(e,t){n.a.clientUpdate({"@type":"clientUpdateOpenReply",chatId:e,messageId:t})}function p(e,t){n.a.clientUpdate({"@type":"clientUpdateMessageHighlighted",chatId:e,messageId:t})}function m(e,t,a){n.a.clientUpdate({"@type":"clientUpdateMessageSelected",chatId:e,messageId:t,selected:a})}function g(){n.a.clientUpdate({"@type":"clientUpdateClearSelection"})}function f(e){n.a.clientUpdate({"@type":"clientUpdateInstantViewViewerContent",content:e})}function b(e){n.a.clientUpdate({"@type":"clientUpdateMediaViewerContent",content:e})}function C(e){n.a.clientUpdate({"@type":"clientUpdateProfileMediaViewerContent",content:e})}function y(e){n.a.clientUpdate({"@type":"clientUpdateInstantViewContent",content:e})}function v(e,t=null){n.a.clientUpdate({"@type":"clientUpdateSearchChat",chatId:e,query:t})}},function(e,t,a){"use strict";var n=a(40),s=a(53),i=a(1);class o extends n.a{constructor(){super(),this.reset=()=>{this.items=new Map,this.fullInfoItems=new Map},this.onUpdate=e=>{switch(e["@type"]){case"updateAuthorizationState":{const t=e.authorization_state;if(!t)break;switch(t["@type"]){case"authorizationStateClosed":this.reset()}break}case"updateUser":this.set(e.user),this.emit(e["@type"],e);break;case"updateUserFullInfo":this.setFullInfo(e.user_id,e.user_full_info),this.emit(e["@type"],e);break;case"updateUserStatus":{let t=this.get(e.user_id);t&&this.assign(t,{status:e.status}),this.emit(e["@type"],e);break}}},this.onClientUpdate=e=>{switch(e["@type"]){case"clientUpdateOpenUser":this.emit(e["@type"],e)}},this.addTdLibListener=()=>{i.a.on("update",this.onUpdate),i.a.on("clientUpdate",this.onClientUpdate)},this.removeTdLibListener=()=>{i.a.off("update",this.onUpdate),i.a.off("clientUpdate",this.onClientUpdate)},this.reset(),this.addTdLibListener()}assign(e,t){Object.assign(e,t)}getMyId(){const e=s.a.get("my_id");return e&&e.value?e.value:null}get(e){return this.items.get(e)}set(e){this.items.set(e.id,e)}getFullInfo(e){return this.fullInfoItems.get(e)}setFullInfo(e,t){this.fullInfoItems.set(e,t)}}const r=new o;window.user=r,t.a=r},,function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"d",(function(){return r})),a.d(t,"c",(function(){return c})),a.d(t,"b",(function(){return l}));var n=a(125),s=a(0),i=a.n(s);function o(...e){return e.reduce((e,t)=>(...a)=>e(t(...a)),e=>e)}function r(){return e=>i.a.forwardRef((t,a)=>i.a.createElement(e,Object.assign({},t,{forwardedRef:a})))}function c(){return e=>class extends i.a.Component{render(){const t=this.props,a=t.forwardedRef,s=Object(n.a)(t,["forwardedRef"]);return i.a.createElement(e,Object.assign({},s,{ref:a}))}}}function l(e){return e.displayName||e.name||"Component"}},,,,function(e,t,a){"use strict";a.d(t,"f",(function(){return r})),a.d(t,"i",(function(){return c})),a.d(t,"c",(function(){return l})),a.d(t,"h",(function(){return h})),a.d(t,"d",(function(){return u})),a.d(t,"g",(function(){return p})),a.d(t,"a",(function(){return m})),a.d(t,"b",(function(){return g})),a.d(t,"e",(function(){return d}));var n=a(67),s=a(19),i=a(4),o=a(22);function r(e){if(!e)return null;if(!e.status)return null;if(e.id===i.hb)return"service notifications";if(e.type&&"userTypeBot"===e.type["@type"])return"bot";switch(e.status["@type"]){case"userStatusEmpty":return"last seen a long time ago";case"userStatusLastMonth":return"last seen within a month";case"userStatusLastWeek":return"last seen within a week";case"userStatusOffline":{let t=e.status.was_online;if(!t)return"offline";const a=new Date,s=new Date(1e3*t);if(s>a)return"last seen just now";let i=new Date(a-s);if(i.getTime()/1e3<60)return"last seen just now";if(i.getTime()/1e3<3600){const e=Math.floor(i.getTime()/1e3/60);return"last seen ".concat(1===e?"1 minute":e+" minutes"," ago")}const o=new Date;if(o.setHours(0,0,0,0),s>o){if(i.getTime()/1e3<21600){const e=Math.floor(i.getTime()/1e3/60/60);return"last seen ".concat(1===e?"1 hour":e+" hours"," ago")}return"last seen today at ".concat(Object(n.a)(s,"H:MM"))}let r=new Date;return r.setDate(a.getDate()-1),o.setHours(0,0,0,0),s>r?"last seen yesterday at ".concat(Object(n.a)(s,"H:MM")):"last seen ".concat(Object(n.a)(s,"dd.mm.yyyy"))}case"userStatusOnline":return"online";case"userStatusRecently":return"last seen recently"}return null}function c(e){if(!e)return!1;const t=e.id,a=e.status,n=e.type;return!!a&&(!!n&&(t!==i.hb&&("userStatusOnline"===a["@type"]&&"userTypeBot"!==n["@type"])))}function l(e,t,a=(e=>e)){if(!(t=o.a.get(e)||t))return null;const n=t,s=n.type,i=n.first_name,r=n.last_name;if(!s)return null;switch(s["@type"]){case"userTypeBot":case"userTypeRegular":if(i&&r)return"".concat(i," ").concat(r);if(i)return i;if(r)return r;case"userTypeDeleted":case"userTypeUnknown":return a("HiddenName")}return null}function d(e,t=(e=>e)){const a=o.a.get(e);if(!a)return null;const n=a.type,s=a.first_name,i=a.last_name;if(!n)return null;switch(n["@type"]){case"userTypeBot":case"userTypeRegular":if(s)return s;if(i)return i;case"userTypeDeleted":case"userTypeUnknown":return t("HiddenName")}return null}function h(e){const t=o.a.getFullInfo(e);return!!t&&t.is_blocked}function u(e,t,a,n){const i=o.a.get(e);if(!i&&!t&&!a)return null;const r=l(e,null,n)||"".concat(t," ").concat(a).trim(),c=Object(s.g)(r);return c&&c.length>0?c:i?i.first_name?i.first_name.charAt(0):i.last_name?i.last_name.charAt(0):"":t?t.charAt(0):a?a.charAt(0):""}function p(e){if(!e)return 0;if(!e.status)return 0;if("userTypeBot"===e.type["@type"])return 0;switch(e.status["@type"]){case"userStatusEmpty":return 1;case"userStatusLastMonth":return 10;case"userStatusLastWeek":return 100;case"userStatusOffline":return e.status.was_online;case"userStatusOnline":return e.status.expires;case"userStatusRecently":return 1e3}}function m(e){if(!e)return null;const t=e.id,a=e.sizes;return a&&a.length?{"@type":"profilePhoto",id:t,small:Object(s.l)(a,i.eb).photo,big:Object(s.l)(a,i.db).photo}:null}function g(e){if(!e)return null;const t=e.added_date;if(!t)return null;const a=new Date(1e3*t);return Object(n.a)(a,"H:MM:ss d.mm.yyyy")}},,function(e,t,a){"use strict";var n=a(40),s=a(1);class i extends n.a{constructor(){super(),this.reset=()=>{this.items=new Map,this.fullInfoItems=new Map},this.onUpdate=e=>{switch(e["@type"]){case"updateAuthorizationState":{const t=e.authorization_state;if(!t)break;switch(t["@type"]){case"authorizationStateClosed":this.reset()}break}case"updateSupergroup":this.set(e.supergroup),this.emit(e["@type"],e);break;case"updateSupergroupFullInfo":this.setFullInfo(e.supergroup_id,e.supergroup_full_info),this.emit(e["@type"],e)}},this.onClientUpdate=e=>{},this.addTdLibListener=()=>{s.a.on("update",this.onUpdate),s.a.on("clientUpdate",this.onClientUpdate)},this.removeTdLibListener=()=>{s.a.off("update",this.onUpdate),s.a.off("clientUpdate",this.onClientUpdate)},this.reset(),this.addTdLibListener()}get(e){return this.items.get(e)}set(e){this.items.set(e.id,e)}getFullInfo(e){return this.fullInfoItems.get(e)}setFullInfo(e,t){this.fullInfoItems.set(e,t)}}const o=new i;window.supergroup=o,t.a=o},,,,,,,function(e,t,a){"use strict";a.d(t,"d",(function(){return o})),a.d(t,"i",(function(){return r})),a.d(t,"j",(function(){return c})),a.d(t,"h",(function(){return l})),a.d(t,"c",(function(){return d})),a.d(t,"a",(function(){return h})),a.d(t,"b",(function(){return u})),a.d(t,"g",(function(){return p})),a.d(t,"f",(function(){return m})),a.d(t,"e",(function(){return C}));var n=a(34),s=a(4),i=a(8);function o(e,t){const a=i.a.get(e,t);if(!a)return null;const n=a.content,s=a.is_outgoing;if("messageCall"!==n["@type"])return null;const o=n.discard_reason;n.duration;return s?"callDiscardReasonMissed"===o["@type"]?"Cancelled Call":"Outgoing Call":"callDiscardReasonMissed"===o["@type"]?"Missed Call":"callDiscardReasonDeclined"===o["@type"]?"Declined Call":"Incoming Call"}function r(e,t){const a=i.a.get(e,t);if(a){switch(a.content["@type"]){case"messageAnimation":case"messageAudio":case"messageDocument":case"messagePhoto":case"messageVideo":return!0}return!1}}function c(e,t,a){if(!e)return!1;if(!e.is_animated)return!1;const n=i.a.get(t,a);if(n){if(n.sending_state&&!e.set_id)return!1}return!0}function l(e,t=s.nb){return!!e&&Math.max(e.width,e.height)<t}function d(e){if(!e)return null;const t=e.file_name,a=e.title,n=e.performer,s=a?a.trim():"",i=n?n.trim():"";return s||i?"".concat(i||"Unknown Artist"," \u2014 ").concat(s||"Unknown Track"):t}function h(e){if(!e)return null;const t=e.file_name,a=e.title,n=e.performer,s=a?a.trim():"",i=n?n.trim():"";return s||i?"".concat(i||"Unknown Artist"):t}function u(e){if(!e)return null;const t=e.title;return(t?t.trim():"")||"Unknown Track"}function p(e){return e.reduce((e,t)=>e.concat(t.stickers),[])}function m(e,t,a){const s=[],i=function(e,t,a){const n=t.findIndex(t=>t.id===e.set_id);if(-1===n)return[-1,-1];const s=t[n].stickers.findIndex(t=>t.sticker.id===e.sticker.id);if(-1===s)return[-1,-1];let i=0;for(let o=0;o<n;o++)i+=Math.ceil(t[o].stickers.length/a);return[i+Math.floor(s/a),s%a]}(e,t,a),o=Object(n.a)(i,2),r=o[0],c=o[1];if(-1===r)return[];if(-1===c)return[];const l=r-2,d=r-1,h=r+1,u=r+2,m=c-1,f=c+1;let b=d<0,C=l<0;if(!b){if(m>=0){let e=g(d,m,t,a);-1===e&&(b=!0,e=C?-1:g(l,m,t,a),C=-1===e),-1!==e&&s.push(e)}let e=b?-1:g(d,c,t,a);if(-1===e&&(b=!0,e=C?-1:g(l,c,t,a),C=-1===e),-1!==e&&s.push(e),f<a){let e=b?-1:g(d,f,t,a);-1===e&&(e=C?-1:g(l,f,t,a)),-1!==e&&s.push(e)}}if(m>=0){const e=g(r,m,t,a);-1!==e&&s.push(e)}if(f<a){const e=g(r,f,t,a);-1!==e&&s.push(e)}let y=t.reduce((e,t)=>e+Math.ceil(t.stickers.length/a),0),v=h>=y,E=h>=y;if(!v){if(m>=0){let e=g(h,m,t,a);-1===e&&(v=!0,e=E?-1:g(u,m,t,a),E=-1===e),-1!==e&&s.push(e)}let e=v?-1:g(h,c,t,a);if(-1===e&&(v=!0,e=E?-1:g(u,c,t,a),E=-1===e),-1!==e&&s.push(e),f<a){let e=v?-1:g(h,f,t,a);-1===e&&(e=E?-1:g(u,f,t,a)),-1!==e&&s.push(e)}}const S=p(t);return s.map(e=>S[e])}function g(e,t,a,n){let s=-1,i=0,o=-1;for(let l=0;l<a.length;l++){if(i+=Math.ceil(a[l].stickers.length/n),i>e){o=l;break}}if(-1===o)return s;let r=e,c=t;for(let l=0;l<o;l++){r-=Math.ceil(a[l].stickers.length/n)}if(s=n*r+c,s>=a[o].stickers.length)return-1;for(let l=0;l<o;l++)s+=a[l].stickers.length;return s}function f(e){if(!e)return null;const t=e.photo,a=e.width,n=e.height;return t?{"@type":"inputThumbnail",thumbnail:{"@type":"inputFileId",id:t.id},width:a,height:n}:null}function b(e){return e?{"@type":"formattedText",text:e,entities:null}:null}function C(e,t){if(!e)return null;switch(e["@type"]){case"animation":{const a=e.animation,n=e.thumbnail,s=e.width,i=e.height,o=e.duration;return{"@type":"inputMessageAnimation",animation:{"@type":"inputFileId",id:a.id},thumbnail:f(n),duration:o,width:s,height:i,caption:b(t)}}case"audio":{const a=e.audio,n=e.album_cover_thumbnail,s=e.title,i=e.performer,o=e.duration;return{"@type":"inputMessageAudio",audio:{"@type":"inputFileId",id:a.id},album_cover_thumbnail:f(n),duration:o,title:s,performer:i,caption:b(t)}}case"contact":return{"@type":"inputMessageContact",contact:e};case"document":{const a=e.document,n=e.thumbnail;return{"@type":"inputMessageDocument",document:{"@type":"inputFileId",id:a.id},thumbnail:f(n),caption:b(t)}}case"game":case"invoice":return null;case"location":return{"@type":"inputMessageLocation",location:e,live_period:0};case"photo":{const a=e.sizes;if(!a.length)return null;const n=a[0],s=a[a.length-1];if(!s)return null;const i=s.photo,o=s.width,r=s.height;return{"@type":"inputMessagePhoto",photo:{"@type":"inputFileId",id:i.id},thumbnail:f(n),added_sticker_file_ids:[],width:o,height:r,caption:b(t),ttl:0}}case"poll":return null;case"sticker":{const a=e.sticker,n=e.thumbnail,s=e.width,i=e.height;return{"@type":"inputMessageSticker",sticker:{"@type":"inputFileId",id:a.id},thumbnail:f(n),width:s,height:i,caption:b(t)}}case"venue":return{"@type":"inputMessageVenue",venue:e};case"video":{const a=e.video,n=e.thumbnail,s=e.width,i=e.height,o=e.duration,r=e.supports_streaming;return{"@type":"inputMessageVideo",video:{"@type":"inputFileId",id:a.id},thumbnail:f(n),added_sticker_file_ids:[],duration:o,width:s,height:i,supports_streaming:r,caption:b(t),ttl:0}}case"videoNote":{const t=e.video,a=e.thumbnail,n=e.duration,s=e.length;return{"@type":"inputMessageVideoNote",video:{"@type":"inputFileId",id:t.id},thumbnail:f(a),duration:n,length:s,ttl:0}}case"voiceNote":{const t=e.voice,a=e.duration,n=e.waveform;return{"@type":"inputMessageVideoNote",voice_note:{"@type":"inputFileId",id:t.id},duration:a,waveform:n}}}return null}},function(e,t,a){"use strict";var n=a(0),s=a.n(n),i=a(10),o=a(16),r=a.n(o),c=a(28),l=a(9),d=a(21),h=a(22),u=a(5);a(313);class p extends s.a.Component{constructor(...e){super(...e),this.handleSelect=e=>{const t=this.props,a=t.chatId,n=t.userId,s=t.openUser,i=t.openChat;return s&&n?(e.stopPropagation(),void Object(d.j)(n,!0)):i&&a?(e.stopPropagation(),void Object(d.h)(a,null,!0)):void 0}}render(){const e=this.props,t=e.t,a=e.chatId,n=e.userId,i=e.openUser,o=e.openChat;if(h.a.get(n)){const e=Object(l.W)(a)?"message-author-color":"user_color_".concat(Math.abs(n)%8+1),o=r()([e],"message-author"),d=Object(c.c)(n,null,t);return i?s.a.createElement("a",{className:o,onClick:this.handleSelect},d):s.a.createElement(s.a.Fragment,null,d)}if(u.a.get(a)){const e=r()("message-author-color","message-author"),n=Object(l.u)(a,!1,t);return o?s.a.createElement("a",{className:e,onClick:this.handleSelect},n):s.a.createElement(s.a.Fragment,null,n)}return null}}p.defaultProps={openUser:!1,openChat:!1},t.a=Object(i.c)()(p)},,function(e,t,a){"use strict";t.a=class{constructor(){this.observers={}}on(e,t){return e.split(" ").forEach(e=>{this.observers[e]=this.observers[e]||[],this.observers[e].push(t)}),this}off(e,t){this.observers[e]&&(t?this.observers[e]=this.observers[e].filter(e=>e!==t):delete this.observers[e])}emit(e,...t){if(this.observers[e]){[].concat(this.observers[e]).forEach(e=>{e(...t)})}if(this.observers["*"]){[].concat(this.observers["*"]).forEach(a=>{a.apply(a,[e,...t])})}}}},function(e,t,a){"use strict";var n=a(0),s=a.n(n),i=a(23);t.a=Object(i.a)(s.a.createElement("path",{d:"M5.29289322,5.29289322 C5.68341751,4.90236893 6.31658249,4.90236893 6.70710678,5.29289322 L6.70710678,5.29289322 L12,10.585 L17.2928932,5.29289322 C17.6834175,4.90236893 18.3165825,4.90236893 18.7071068,5.29289322 C19.0976311,5.68341751 19.0976311,6.31658249 18.7071068,6.70710678 L13.415,12 L18.7071068,17.2928932 C19.0675907,17.6533772 19.0953203,18.2206082 18.7902954,18.6128994 L18.7071068,18.7071068 C18.3165825,19.0976311 17.6834175,19.0976311 17.2928932,18.7071068 L17.2928932,18.7071068 L12,13.415 L6.70710678,18.7071068 C6.31658249,19.0976311 5.68341751,19.0976311 5.29289322,18.7071068 C4.90236893,18.3165825 4.90236893,17.6834175 5.29289322,17.2928932 L10.585,12 L5.29289322,6.70710678 C4.93240926,6.34662282 4.90467972,5.77939176 5.20970461,5.38710056 Z"}),"Close")},function(e,t,a){"use strict";var n=a(0),s=a.n(n);var i=new class{constructor(){this.list=new Map([["AED","\u062f.\u0625"],["AFN","\u060b"],["ARS","$"],["AUD","$"],["AZN","\u20bc"],["BND","B$"],["BRL","R$"],["CAD","$"],["CHF","Fr"],["CLP","$"],["CNY","\xa5"],["COP","$"],["EGP","E\xa3"],["EUR","\u20ac"],["GBP","\xa3"],["HKD","$"],["IDR","Rp"],["ILS","\u20aa"],["INR","\u20b9"],["ISK","kr"],["JPY","\xa5"],["KRW","\u20a9"],["KZT","\u20b8"],["MXN","$"],["MYR","RM"],["NOK","kr"],["NZD","$"],["PHP","\u20b1"],["RUB","\u20bd"],["SAR","SR"],["SEK","kr"],["SGD","$"],["TRY","\u20ba"],["TTD","$"],["TWD","$"],["TZS","TSh"],["UAH","\u20b4"],["UGX","USh"],["USD","$"],["UYU","$"],["VND","\u20ab"],["YER","\ufdfc"],["ZAR","R"],["IRR","\ufdfc"],["IQD","\u0639.\u062f"],["VEF","Bs.F."]])}get(e){return this.list.get(e)}set(e,t){this.list.set(e,t)}getPow(e){return"CLF"===e?4:["BHD","IQD","JOD","KWD","LYD","OMR","TND"].includes(e)?3:["BIF","BYR","CLP","CVE","DJF","GNF","ISK","JPY","KMF","KRW","MGA","PYG","RWF","UGX","UYI","VND","VUV","XAF","XOF","XPF"].includes(e)?0:"MRO"===e?1:2}getString(e,t){const a=(e/Math.pow(10,this.getPow(t))).toFixed(2);return"".concat(a," ").concat(this.get(t))}},o=a(38),r=a(5),c=a(22),l=(a(30),a(8));a.d(t,"b",(function(){return h})),a.d(t,"a",(function(){return u}));let d=new Map;function h(e){return!!e&&(!!e.content&&(d.has(e.content["@type"])||e.ttl>0))}function u(e,t=!1){if(!e)return null;if(!e.content)return null;const a=e.sender_user_id===c.a.getMyId(),n=r.a.get(e.chat_id),d="chatTypeSupergroup"===n.type["@type"]&&n.type.is_channel,u=e.ttl,p=e.sender_user_id,m=e.content;if(u>0)switch(m["@type"]){case"messagePhoto":return a?"You sent a self-destructing photo. Please view it on your mobile":s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{userId:p,openUser:t})," sent a self-destructing photo. Please view it on your mobile");case"messageVideo":return a?"You sent a self-destructing video. Please view it on your mobile":s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{userId:p,openUser:t})," sent a self-destructing video. Please view it on your mobile");default:return a?"You sent a self-destructing message. Please view it on your mobile":s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{userId:p,openUser:t})," sent a self-destructing message. Please view it on your mobile")}switch(m["@type"]){case"messageBasicGroupChatCreate":{const n=r.a.get(e.chat_id).title;return a?"You created group \xab".concat(n,"\xbb"):s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{userId:p,openUser:t})," created group \xab".concat(n,"\xbb"))}case"messageChatAddMembers":{const n=m.member_user_ids.map(e=>s.a.createElement(o.a,{key:e,userId:e,openUser:t})).reduce((e,t,a,n)=>{const s=a===n.length-1?" and ":", ";return null===e?[t]:[...e,s,t]},null);return a?1===m.member_user_ids.length&&m.member_user_ids[0]===c.a.getMyId()?"You joined the group":s.a.createElement(s.a.Fragment,null,"You added ",n):1===m.member_user_ids.length&&m.member_user_ids[0]===e.sender_user_id?s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{userId:p,openUser:t})," joined the group"):s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{userId:p,openUser:t})," added ",n)}case"messageChatChangePhoto":return d?"Channel photo updated":a?"You updated group photo":s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{userId:p,openUser:t})," updated group photo");case"messageChatChangeTitle":{const e=m.title;return d?"Channel name was changed to \xab".concat(e,"\xbb"):a?"You changed group name to \xab".concat(e,"\xbb"):s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{userId:p,openUser:t})," changed group name to \xab".concat(e,"\xbb"))}case"messageChatDeleteMember":return a?m.user_id===c.a.getMyId()?"You left the group":s.a.createElement(s.a.Fragment,null,"You removed ",s.a.createElement(o.a,{userId:m.user_id,openUser:t})):m.user_id===p?s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{userId:p,openUser:t})," left the group"):s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{userId:p,openUser:t})," removed ",s.a.createElement(o.a,{userId:m.user_id,openUser:t}));case"messageChatDeletePhoto":return d?"Channel photo removed":a?"You removed group photo":s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{userId:p,openUser:t})," removed group photo");case"messageChatJoinByLink":return a?"You joined the group via invite link":s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{userId:p,openUser:t})," joined the group via invite link");case"messageChatSetTtl":{const e=m.ttl,n=function(e){if(e<60){const t=1===e?"second":"seconds";return"".concat(e," ").concat(t)}if(e<3600){const t=1===Math.floor(e/60)?"minute":"minutes";return"".concat(e," ").concat(t)}if(e<86400){const t=1===Math.floor(e/60/60)?"hour":"hours";return"".concat(e," ").concat(t)}if(e<604800){const t=1===Math.floor(e/60/60/24)?"day":"days";return"".concat(e," ").concat(t)}return 604800===e?"1 week":"".concat(e," seconds")}(e);return e<=0?a?"You disabled the self-destruct timer":s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{userId:p,openUser:t})," disabled the self-destruct timer"):a?"You set the self-destruct timer to ".concat(n):s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{userId:p,openUser:t})," set the self-destruct timer to ".concat(n))}case"messageChatUpgradeFrom":return"The group was upgraded to a supergroup";case"messageChatUpgradeTo":return"Group migrated to a supergroup";case"messageContactRegistered":return s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{userId:p,openUser:t})," just joined Telegram");case"messageCustomServiceAction":return m.text;case"messageGameScore":{const n=l.a.get(e.chat_id,m.game_message_id);if(n&&n.content&&"messageGame"===n.content["@type"]&&n.content.game){const e=n.content.game;return a?"You scored ".concat(m.score," in \xab").concat(e.title,"\xbb"):s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{userId:n.sender_user_id,openUser:t})," scored ".concat(m.score," in \xab").concat(e.title,"\xbb"))}return a?"You scored ".concat(m.score):s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{userId:p,openUser:t})," scored ".concat(m.score))}case"messagePassportDataReceived":return"Telegram Passport data received";case"messagePassportDataSent":{const a=r.a.get(e.chat_id),n=m.types.map(e=>function(e){switch(e["@type"]){case"passportElementTypeAddress":return"Address";case"passportElementTypeBankStatement":return"Bank Statement";case"passportElementTypeDriverLicense":return"Driver Licence";case"passportElementTypeEmailAddress":return"Email";case"passportElementTypeIdentityCard":return"Identity Card";case"passportElementTypeInternalPassport":return"Internal Passport";case"passportElementTypePassport":return"Passport";case"passportElementTypePassportRegistration":return"Passport Registration";case"passportElementTypePersonalDetails":return"Personal details";case"passportElementTypePhoneNumber":return"Phone Number";case"passportElementTypeRentalAgreement":return"Tenancy Agreement";case"passportElementTypeTemporaryRegistration":return"Temporary Registration";case"passportElementTypeUtilityBill":return"Utility Bill"}return""}(e)).reduce((e,t)=>null===e?[t]:[...e,", ",t],null);return s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{userId:a.type.user_id,openUser:t})," received the following documents: ",n)}case"messagePaymentSuccessful":{const a=r.a.get(e.chat_id),n=l.a.get(e.chat_id,m.invoice_message_id);if(n&&n.content&&"messageInvoice"===n.content["@type"]&&n.content.invoice){const e=n.content.invoice;return s.a.createElement(s.a.Fragment,null,"You have just successfully transferred ".concat(i.getString(m.total_amount,m.currency)," to "),s.a.createElement(o.a,{userId:a.type.user_id,openUser:t})," for ".concat(e.title))}return s.a.createElement(s.a.Fragment,null,"You have just successfully transferred ".concat(i.getString(m.total_amount,m.currency)," to "),s.a.createElement(o.a,{userId:a.type.user_id,openUser:t}))}case"messagePaymentSuccessfulBot":return"Payment successful";case"messagePinMessage":{const a=function(e,t){if(!e)return null;const a=e.chat_id,n=e.sender_user_id;if(0!==n)return s.a.createElement(o.a,{userId:n,openUser:t});const i=r.a.get(a);return i?i.title:null}(e,t),n=l.a.get(e.chat_id,m.message_id);if(!n||!n.content)return s.a.createElement(s.a.Fragment,null,a," pinned a message");let i=" pinned a message";if(h(n))i=" pinned a service message";else switch(n.content["@type"]){case"messageAnimation":i=" pinned a GIF";break;case"messageAudio":i=" pinned a track";break;case"messageCall":i=" pinned a call";break;case"messageContact":i=" pinned a contact";break;case"messageDocument":i=" pinned a file";break;case"messageExpiredPhoto":i=" pinned a photo";break;case"messageExpiredVideo":i=" pinned a video";break;case"messageGame":i=" pinned a game";break;case"messageInvoice":i=" pinned an invoice";break;case"messageLocation":i=" pinned a map";break;case"messagePhoto":i=" pinned a photo";break;case"messagePoll":i=" pinned a poll";break;case"messageSticker":i=" pinned a sticker";break;case"messageText":{const e=16,t=n.content.text.text;i=t.length<=e?" pinned \xab".concat(t,"\xbb"):" pinned \xab".concat(t.substring(0,e),"...\xbb");break}case"messageUnsupported":i=" pinned unsupported message";break;case"messageVenue":i=" pinned a venue";break;case"messageVideo":i=" pinned a video";break;case"messageVideoNote":i=" pinned a video message";break;case"messageVoiceNote":i=" pinned a voice message"}return s.a.createElement(s.a.Fragment,null,a,i)}case"messageScreenshotTaken":return a?"You took a screenshot!":s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{userId:p,openUser:t})," took a screenshot!");case"messageSupergroupChatCreate":{const e=m.title;return d?"Channel created":a?"You created group \xab".concat(e,"\xbb"):s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{userId:p,openUser:t})," created group \xab".concat(e,"\xbb"))}case"messageUnsupported":return"Unsupported message";case"messageWebsiteConnected":return"You allowed this bot to message you when you logged in on ".concat(m.domain_name,".")}return"[".concat(e.content["@type"],"]")}d.set("messageBasicGroupChatCreate","messageBasicGroupChatCreate"),d.set("messageChatAddMembers","messageChatAddMembers"),d.set("messageChatChangePhoto","messageChatChangePhoto"),d.set("messageChatChangeTitle","messageChatChangeTitle"),d.set("messageChatDeleteMember","messageChatDeleteMember"),d.set("messageChatDeletePhoto","messageChatDeletePhoto"),d.set("messageChatJoinByLink","messageChatJoinByLink"),d.set("messageChatSetTtl","messageChatSetTtl"),d.set("messageChatUpgradeFrom","messageChatUpgradeFrom"),d.set("messageChatUpgradeTo","messageChatUpgradeTo"),d.set("messageContactRegistered","messageContactRegistered"),d.set("messageCustomServiceAction","messageCustomServiceAction"),d.set("messageGameScore","messageGameScore"),d.set("messagePassportDataReceived","messagePassportDataReceived"),d.set("messagePassportDataSent","messagePassportDataSent"),d.set("messagePaymentSuccessful","messagePaymentSuccessful"),d.set("messagePaymentSuccessfulBot","messagePaymentSuccessfulBot"),d.set("messagePinMessage","messagePinMessage"),d.set("messageScreenshotTaken","messageScreenshotTaken"),d.set("messageSupergroupChatCreate","messageSupergroupChatCreate"),d.set("messageUnsupported","messageUnsupported"),d.set("messageWebsiteConnected","messageWebsiteConnected")},function(e,t,a){"use strict";var n=a(40),s=a(1);class i extends n.a{constructor(){super(),this.reset=()=>{this.items=new Map,this.fullInfoItems=new Map},this.onUpdate=e=>{switch(e["@type"]){case"updateAuthorizationState":{const t=e.authorization_state;if(!t)break;switch(t["@type"]){case"authorizationStateClosed":this.reset()}break}case"updateBasicGroup":this.set(e.basic_group),this.emit(e["@type"],e);break;case"updateBasicGroupFullInfo":this.setFullInfo(e.basic_group_id,e.basic_group_full_info),this.emit(e["@type"],e)}},this.onClientUpdate=e=>{},this.addTdLibListener=()=>{s.a.on("update",this.onUpdate),s.a.on("clientUpdate",this.onClientUpdate)},this.removeTdLibListener=()=>{s.a.off("update",this.onUpdate),s.a.off("clientUpdate",this.onClientUpdate)},this.reset(),this.addTdLibListener()}get(e){return this.items.get(e)}set(e){this.items.set(e.id,e)}getFullInfo(e){return this.fullInfoItems.get(e)}setFullInfo(e,t){this.fullInfoItems.set(e,t)}}const o=new i;window.basicgroup=o,t.a=o},function(e,t,a){"use strict";var n=a(40),s=a(1);class i extends n.a{constructor(){super(),this.reset=()=>{this.items=[]},this.onUpdate=e=>{switch(e["@type"]){case"updateAuthorizationState":{const t=e.authorization_state;if(!t)break;switch(t["@type"]){case"authorizationStateClosed":this.reset()}break}}},this.onClientUpdate=e=>{switch(e["@type"]){case"clientUpdateBlocksInView":this.emit("clientUpdateBlocksInView",e);break;case"clientUpdateInstantViewContent":{const t=e.content;t?this.items.push(t.instantView):this.items=[],this.emit("clientUpdateInstantViewContent",e);break}case"clientUpdateInstantViewUrl":this.emit("clientUpdateInstantViewUrl",e);break;case"clientUpdateInstantViewViewerContent":{const t=e.content;this.viewerContent=t,this.emit("clientUpdateInstantViewViewerContent",e);break}case"clientUpdatePrevInstantView":{if(this.items.length<=1)return;this.items.pop();const e=this.items.pop();s.a.clientUpdate({"@type":"clientUpdateInstantViewContent",content:{instantView:e}});break}}},this.addTdLibListener=()=>{s.a.on("update",this.onUpdate),s.a.on("clientUpdate",this.onClientUpdate)},this.removeTdLibListener=()=>{s.a.off("update",this.onUpdate),s.a.off("clientUpdate",this.onClientUpdate)},this.reset(),this.addTdLibListener()}hasPrev(){return this.items.length>1}getCurrent(){return this.items.length>0?this.items[this.items.length-1]:null}}const o=new i;window.instantView=o,t.a=o},,,function(e,t,a){"use strict";var n=a(35),s=a(40),i=a(1),o=a(152);class r extends s.a{constructor(){super(),this.reset=()=>{this.poll=null},this.onUpdate=e=>{switch(e["@type"]){case"updateAuthorizationState":{const t=e.authorization_state;if(!t)break;switch(t["@type"]){case"authorizationStateClosed":this.reset()}break}}},this.onClientUpdate=e=>{switch(e["@type"]){case"clientUpdateClosePollResults":this.emit("clientUpdateClosePollResults",e);break;case"clientUpdateNewPoll":this.set({type:{"@type":"pollTypeRegular",allow_multiple_answers:!1},id:Date.now(),question:"",options:[],is_anonymous:!0}),this.emit("clientUpdateNewPoll",e);break;case"clientUpdatePollChangeAnonymous":{const t=this.poll,a=t&&t.is_anonymous;this.assign(this.poll,{is_anonymous:!a}),this.emit("clientUpdatePollChangeAnonymous",e);break}case"clientUpdatePollChangeAllowMultipleAnswers":{const t=this.poll,a=t.type;if("pollTypeRegular"===a["@type"]){const e=t&&t.type.allow_multiple_answers,s=Object(n.a)({},a,{allow_multiple_answers:!e});this.assign(this.poll,{type:s})}this.emit("clientUpdatePollChangeAllowMultipleAnswers",e);break}case"clientUpdatePollChangeType":if("pollTypeRegular"===this.poll.type["@type"]){const e={"@type":"pollTypeQuiz",correct_option_id:-1};this.assign(this.poll,{type:e})}else{const e={"@type":"pollTypeRegular",allow_multiple_answers:!1};this.assign(this.poll,{type:e})}this.emit("clientUpdatePollChangeType",e);break;case"clientUpdatePollChooseOption":{const t=e.id,a=this.poll.options;this.assign(this.poll,{options:a.map(e=>e.id===t?Object(n.a)({},e,{is_chosen:!0}):Object(n.a)({},e,{is_chosen:!1}))}),this.emit("clientUpdatePollChooseOption",e);break}case"clientUpdatePollQuestion":{const t=e.question;this.assign(this.poll,{question:t}),this.emit("clientUpdatePollQuestion",e);break}case"clientUpdatePollOption":{const t=e.id,a=e.text,s=this.poll.options;this.assign(this.poll,{options:s.map(e=>e.id===t?Object(n.a)({},e,{text:a}):Object(n.a)({},e))}),this.emit("clientUpdatePollOption",e);break}case"clientUpdateNewPollOption":{const t=e.option,a=this.poll.options;this.assign(this.poll,{options:[...a,t]}),this.emit("clientUpdateNewPollOption",e);break}case"clientUpdateDeletePollOption":{const t=e.id,a=this.poll.options;this.assign(this.poll,{options:a.filter(e=>e.id!==t)}),this.emit("clientUpdateDeletePollOption",e);break}case"clientUpdateDeletePoll":this.set(null),this.emit("clientUpdateDeletePoll",e)}},this.addTdLibListener=()=>{i.a.on("update",this.onUpdate),i.a.on("clientUpdate",this.onClientUpdate)},this.removeTdLibListener=()=>{i.a.off("update",this.onUpdate),i.a.off("clientUpdate",this.onClientUpdate)},this.reset(),this.addTdLibListener()}assign(e,t){this.set(Object.assign({},e,t))}set(e){this.poll=e}getInputMessagePoll(){if(!this.poll)return null;if(!Object(o.b)(this.poll))return null;const e=this.poll,t=e.question,a=e.options,n=e.type,s=e.is_anonymous;return"pollTypeQuiz"===n["@type"]&&(n.correct_option_id=a.findIndex(e=>e.is_chosen),-1===n.correct_option_id)?null:{"@type":"inputMessagePoll",question:t,options:a.filter(e=>Boolean(e.text)).map(e=>e.text),is_anonymous:s,type:n,is_closed:!1}}}const c=new r;window.poll=c,t.a=c},function(e,t,a){"use strict";var n=a(40),s=a(1);class i extends n.a{constructor(){super(),this.reset=()=>{this.stickerSet=null,this.hint=null,this.animationData=new WeakMap},this.onUpdate=e=>{switch(e["@type"]){case"updateAuthorizationState":{const t=e.authorization_state;if(!t)break;switch(t["@type"]){case"authorizationStateClosed":this.reset()}break}case"updateInstalledStickerSets":{const t=e.sticker_set_ids;if(this.stickerSet){const e=this.stickerSet,a=e.id,n=e.is_installed;n!==t.some(e=>e===a)&&(this.stickerSet=Object.assign({},this.stickerSet,{is_installed:!n}))}this.emit("updateInstalledStickerSets",e);break}case"updateRecentStickers":this.emit("updateRecentStickers",e)}},this.onClientUpdate=e=>{switch(e["@type"]){case"clientUpdateStickerSend":this.emit("clientUpdateStickerSend",e);break;case"clientUpdateLocalStickersHint":{const t=e.hint;this.hint=t,this.emit("clientUpdateLocalStickersHint",e);break}case"clientUpdateRemoteStickersHint":{const t=e.hint;this.hint&&this.hint.timestamp===t.timestamp&&(this.hint=Object.assign({},this.hint,{foundStickers:t.stickers})),this.emit("clientUpdateRemoteStickersHint",e);break}case"clientUpdateStickerSet":{const t=e.stickerSet;this.stickerSet=t,this.emit("clientUpdateStickerSet",e);break}case"clientUpdateStickerSetPosition":this.emit("clientUpdateStickerSetPosition",e);break;case"clientUpdateStickerPreview":this.emit("clientUpdateStickerPreview",e)}},this.addTdLibListener=()=>{s.a.on("update",this.onUpdate),s.a.on("clientUpdate",this.onClientUpdate)},this.removeTdLibListener=()=>{s.a.off("update",this.onUpdate),s.a.off("clientUpdate",this.onClientUpdate)},this.reset(),this.addTdLibListener()}getAnimationData(e){return this.animationData.get(e)}setAnimationData(e,t){this.animationData.set(e,t)}}const o=new i;window.sticker=o,t.a=o},,,,,function(e,t,a){"use strict";var n=a(40),s=a(4),i=a(1);class o extends n.a{constructor(){super(),this.reset=()=>{this.items=new Map},this.onUpdate=e=>{switch(e["@type"]){case"updateAuthorizationState":{const t=e.authorization_state;if(!t)break;switch(t["@type"]){case"authorizationStateClosed":this.reset()}break}case"updateOption":const t=e.name,a=e.value;this.set(t,a),t===s.m&&localStorage.setItem(t,a.value),this.emit("updateOption",e)}},this.onClientUpdate=e=>{},this.addTdLibListener=()=>{i.a.on("update",this.onUpdate),i.a.on("clientUpdate",this.onClientUpdate)},this.removeTdLibListener=()=>{i.a.off("update",this.onUpdate),i.a.off("clientUpdate",this.onClientUpdate)},this.reset(),this.addTdLibListener()}get(e){return this.items.get(e)}set(e,t){this.items.set(e,t)}}const r=new o;window.option=r,t.a=r},,,,,,,,,,,function(e,t,a){"use strict";var n=a(40),s=a(17),i=a(4),o=a(5),r=a(8),c=a(1);class l extends n.a{constructor(){super(),this.reset=()=>{this.chatStore=o.a,this.messageStore=r.a,this.appInactive=!1,this.newMessages=new Map,this.settings=new Map,this.windowFocused=!0,this.timerHandler=null,this.nextSoundAt=new Date,this.enableSound=!1},this.onTimer=()=>{const e=this.getUnreadCount();if(document.title===i.d&&e>0){let t="+99 notifications";1===e?t="1 notification":e<99&&(t="".concat(e," notifications")),document.title=t,document.getElementById("favicon").href="favicon_unread.ico"}else document.title=i.d+(this.appInactive?": Zzz\u2026":""),document.getElementById("favicon").href="favicon.ico"},this.onUpdate=e=>{switch(e["@type"]){case"updateAuthorizationState":{const t=e.authorization_state;if(!t)break;switch(t["@type"]){case"authorizationStateClosed":this.reset()}break}case"updateChatReadInbox":if(!this.windowFocused){const t=e.chat_id,a=e.last_read_inbox_message_id,n=this.newMessages.get(t);if(n){const e=new Map([...n].filter(([e,t])=>t.id>a));e.size<n.size&&(this.newMessages.set(t,e),this.updateTimer())}}break;case"updateChatNotificationSettings":this.windowFocused||this.updateTimer();break;case"updateDeleteMessages":if(!this.windowFocused){const t=e.chat_id,a=e.message_ids;if(e.is_permanent&&a.length>0){const e=this.newMessages.get(t);if(e){const n=new Map(a.map(e=>[e,e])),s=new Map([...e].filter(([e,t])=>!n.has(e)));s.size<e.size&&(this.newMessages.set(t,s),this.updateTimer())}}}break;case"updateNewMessage":if(!this.windowFocused){const t=e.message,a=t.chat_id,n=t.id,o=this.newMessages.get(a)||new Map;if(o.set(n,t),this.newMessages.set(a,o),this.updateTimer(),!t.is_outgoing&&!Object(s.F)(t)&&this.enableSound){if(new Date>this.nextSoundAt){new Audio("sound_a.mp3").play();const e=new Date;e.setMilliseconds(e.getMilliseconds()+i.x),this.nextSoundAt=e}}}break;case"updateScopeNotificationSettings":{const t=e.scope,a=e.notification_settings;this.settings.set(t["@type"],a),this.windowFocused||this.updateTimer(),this.emit("updateScopeNotificationSettings",e);break}}},this.onClientUpdate=e=>{switch(e["@type"]){case"clientUpdateAppInactive":this.appInactive=!0,this.newMessages=new Map,this.updateTimer();break;case"clientUpdateFocusWindow":{const t=e.focused;this.windowFocused=t,t&&(this.newMessages=new Map,this.updateTimer());break}}},this.addTdLibListener=()=>{c.a.on("update",this.onUpdate),c.a.on("clientUpdate",this.onClientUpdate)},this.removeTdLibListener=()=>{c.a.off("update",this.onUpdate),c.a.off("clientUpdate",this.onClientUpdate)},this.reset(),this.addTdLibListener()}getUnreadCount(){let e=0;return this.newMessages.forEach(t=>{t.forEach(t=>{t.is_outgoing||Object(s.F)(t)||e++})}),e}updateTimer(){this.getUnreadCount()>0?this.timerHandler||(this.onTimer(),this.timerHandler=setInterval(this.onTimer,1e3)):this.timerHandler&&(clearInterval(this.timerHandler),this.timerHandler=null,this.onTimer())}}const d=new l;window.notifications=d,t.a=d},,,function(e,t,a){"use strict";const n=function(){const e=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZWN]|"[^"]*"|'[^']*'/g,t=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,a=/[^-+\dA-Z]/g;return function(c,l,d,h){if(1!==arguments.length||"string"!==r(c)||/\d/.test(c)||(l=c,c=void 0),(c=c||new Date)instanceof Date||(c=new Date(c)),isNaN(c))throw TypeError("Invalid date");var u=(l=String(n.masks[l]||l||n.masks.default)).slice(0,4);"UTC:"!==u&&"GMT:"!==u||(l=l.slice(4),d=!0,"GMT:"===u&&(h=!0));var p=d?"getUTC":"get",m=c[p+"Date"](),g=c[p+"Day"](),f=c[p+"Month"](),b=c[p+"FullYear"](),C=c[p+"Hours"](),y=c[p+"Minutes"](),v=c[p+"Seconds"](),E=c[p+"Milliseconds"](),S=d?0:c.getTimezoneOffset(),U=i(c),k=o(c),w={d:m,dd:s(m),ddd:n.i18n.dayNames[g],dddd:n.i18n.dayNames[g+7],m:f+1,mm:s(f+1),mmm:n.i18n.monthNames[f],mmmm:n.i18n.monthNames[f+12],yy:String(b).slice(2),yyyy:b,h:C%12||12,hh:s(C%12||12),H:C,HH:s(C),M:y,MM:s(y),s:v,ss:s(v),l:s(E,3),L:s(Math.round(E/10)),t:C<12?n.i18n.timeNames[0]:n.i18n.timeNames[1],tt:C<12?n.i18n.timeNames[2]:n.i18n.timeNames[3],T:C<12?n.i18n.timeNames[4]:n.i18n.timeNames[5],TT:C<12?n.i18n.timeNames[6]:n.i18n.timeNames[7],Z:h?"GMT":d?"UTC":(String(c).match(t)||[""]).pop().replace(a,""),o:(S>0?"-":"+")+s(100*Math.floor(Math.abs(S)/60)+Math.abs(S)%60,4),S:["th","st","nd","rd"][m%10>3?0:(m%100-m%10!=10)*m%10],W:U,N:k};return l.replace(e,(function(e){return e in w?w[e]:e.slice(1,e.length-1)}))}}();function s(e,t){for(e=String(e),t=t||2;e.length<t;)e="0"+e;return e}function i(e){var t=new Date(e.getFullYear(),e.getMonth(),e.getDate());t.setDate(t.getDate()-(t.getDay()+6)%7+3);var a=new Date(t.getFullYear(),0,4);a.setDate(a.getDate()-(a.getDay()+6)%7+3);var n=t.getTimezoneOffset()-a.getTimezoneOffset();t.setHours(t.getHours()-n);var s=(t-a)/6048e5;return 1+Math.floor(s)}function o(e){var t=e.getDay();return 0===t&&(t=7),t}function r(e){return null===e?"null":void 0===e?"undefined":"object"!==typeof e?typeof e:Array.isArray(e)?"array":{}.toString.call(e).slice(8,-1).toLowerCase()}n.masks={default:"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:sso",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'",expiresHeaderFormat:"ddd, dd mmm yyyy HH:MM:ss Z"},n.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"],timeNames:["a","p","am","pm","A","P","AM","PM"]},t.a=n},function(e,t,a){"use strict";var n=a(35),s=a(6),i=a.n(s),o=a(13),r=a(0),c=a.n(r),l=a(16),d=a.n(l),h=a(169),u=a(37),p=a(19),m=a(14);function g(){return"$"+Math.random().toString(36).slice(2,10)}var f=a(237);const b=new(a.n(f).a),C=new Map;function y(e){return v.apply(this,arguments)}function v(){return(v=Object(o.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=g(),e.abrupt("return",new Promise((e,n)=>{C.set(a,{resolve:e,reject:n}),b.postMessage({key:a,blob:t})}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}b.onmessage=e=>{const t=e.data;if(!t)return;const a=t.key,n=t.error,s=t.result,i=t.msg,o=C.get(a),r=o.resolve,c=o.reject;C.delete(a),n?c(i):r(s)};var E=a(4),S=a(7),U=a(2),k=a(8),w=a(48),M=(a(338),a(44));a.d(t,"a",(function(){return I}));const I=Object.freeze({HINTS:"HINTS",MESSAGE:"MESSAGE",PICKER_HEADER:"PICKER_HEADER",PICKER:"PICKER",PREVIEW:"PREVIEW",STICKER_SET:"STICKER_SET",UNKNOWN:"UNKNOWN"});class _ extends c.a.Component{constructor(e){var t;super(e),t=this,this.onClientUpdateInstantViewContent=e=>{this.openIV=Boolean(M.a.getCurrent()),this.startStopAnimation()},this.onClientUpdateDialogChatId=e=>{this.dialogChatId=S.a.dialogChatId,this.startStopAnimation()},this.onClientUpdateMediaViewerContent=e=>{this.openMediaViewer=Boolean(S.a.mediaViewerContent),this.startStopAnimation()},this.onClientUpdateProfileMediaViewerContent=e=>{this.openProfileMediaViewer=Boolean(S.a.profileMediaViewerContent),this.startStopAnimation()},this.onClientUpdateStickerPreview=e=>{this.stickerPreview=e.sticker,this.startStopAnimation()},this.onClientUpdateMessagesInView=e=>{const t=this.props,a=t.chatId,n=t.messageId,s="".concat(a,"_").concat(n);this.inView=e.messages.has(s),this.startStopAnimation()},this.onClientUpdateStickerSet=e=>{const t=e.stickerSet;this.openedStickerSet=t,this.startStopAnimation()},this.onClientUpdateFocusWindow=e=>{const t=e.focused,a=this.props,n=a.chatId,s=a.messageId,i=a.sticker;Object(u.j)(i,n,s)&&(this.windowFocused=t,this.startStopAnimation())},this.onClientUpdateStickerBlob=e=>{const t=this.props.sticker,a=t.sticker,n=t.is_animated,s=e.fileId;a&&a.id===s&&(n?this.loadContent():this.forceUpdate())},this.onClientUpdateStickerThumbnailBlob=e=>{const t=this.props.sticker.thumbnail;if(!t)return;const a=e.fileId;t.photo&&t.photo.id===a&&this.forceUpdate()},this.loadContent=Object(o.a)(i.a.mark((function e(){var a,n,s,o,r,c,l,d,h,p,g,f;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.props,n=a.chatId,s=a.messageId,o=a.sticker,r=a.autoplay,c=a.play,l=o.is_animated,d=o.sticker,h=Object(u.j)(o,n,s),l){e.next=5;break}return e.abrupt("return");case 5:if(h){e.next=7;break}return e.abrupt("return");case 7:if(c){e.next=9;break}return e.abrupt("return");case 9:if(p=Object(m.d)(d)){e.next=12;break}return e.abrupt("return");case 12:return g=null,e.prev=13,e.next=16,y(p);case 16:if(f=e.sent){e.next=19;break}return e.abrupt("return");case 19:g=JSON.parse(f),e.next=25;break;case 22:e.prev=22,e.t0=e.catch(13),console.log("[Sticker] loadContent error",e.t0);case 25:if(g){e.next=27;break}return e.abrupt("return");case 27:r?t.setState({animationData:g}):t.animationData=g;case 28:case"end":return e.stop()}}),e,null,[[13,22]])}))),this.handleMouseEnter=e=>{const t=this.animationData;t&&this.setState({animationData:t},()=>{this.handleAnimationMouseEnter()})},this.handleAnimationMouseEnter=()=>{if(this.props.autoplay)return;this.entered=!0,this.lottieRef.current&&(this.loopCount=0,this.startStopAnimation())},this.handleAnimationLoopComplete=()=>{if(this.props.autoplay)return;if(this.lottieRef.current&&(this.entered||(this.loopCount+=1),this.loopCount>2)){this.state.animationData&&this.setState({animationData:null})}},this.handleAnimationMouseOut=()=>{this.entered=!1},this.lottieRef=c.a.createRef(),this.windowFocused=window.hasFocus,this.inView=!1,this.stickerPreview=w.a.stickerPreview,this.openMediaViewer=Boolean(S.a.mediaViewerContent),this.openProfileMediaViewer=Boolean(S.a.profileMediaViewerContent),this.openIV=Boolean(M.a.getCurrent()),this.dialogChatId=S.a.dialogChatId,this.state={animationDate:null,hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){console.log("[Sticker] render error",e,t)}shouldComponentUpdate(e,t,a){const n=this.props,s=n.chatId,i=n.messageId,o=n.sticker,r=n.blur,c=n.displaySize;return this.state.animationData!==t.animationData||(s!==e.chatId||(i!==e.messageId||(o!==e.sticker||(r!==e.blur||c!==e.displaySize))))}componentDidUpdate(e,t,a){e.sticker!==this.props.sticker&&this.loadContent()}componentDidMount(){this.loadContent(),S.a.on("clientUpdateDialogChatId",this.onClientUpdateDialogChatId),S.a.on("clientUpdateFocusWindow",this.onClientUpdateFocusWindow),S.a.on("clientUpdateMediaViewerContent",this.onClientUpdateMediaViewerContent),S.a.on("clientUpdateProfileMediaViewerContent",this.onClientUpdateProfileMediaViewerContent),M.a.on("clientUpdateInstantViewContent",this.onClientUpdateInstantViewContent),U.a.on("clientUpdateStickerThumbnailBlob",this.onClientUpdateStickerThumbnailBlob),U.a.on("clientUpdateStickerBlob",this.onClientUpdateStickerBlob),k.a.on("clientUpdateMessagesInView",this.onClientUpdateMessagesInView),w.a.on("clientUpdateStickerPreview",this.onClientUpdateStickerPreview),w.a.on("clientUpdateStickerSet",this.onClientUpdateStickerSet)}componentWillUnmount(){S.a.off("clientUpdateDialogChatId",this.onClientUpdateDialogChatId),S.a.off("clientUpdateFocusWindow",this.onClientUpdateFocusWindow),S.a.off("clientUpdateMediaViewerContent",this.onClientUpdateMediaViewerContent),S.a.off("clientUpdateProfileMediaViewerContent",this.onClientUpdateProfileMediaViewerContent),M.a.off("clientUpdateInstantViewContent",this.onClientUpdateInstantViewContent),U.a.off("clientUpdateStickerThumbnailBlob",this.onClientUpdateStickerThumbnailBlob),U.a.off("clientUpdateStickerBlob",this.onClientUpdateStickerBlob),k.a.off("clientUpdateMessagesInView",this.onClientUpdateMessagesInView),w.a.off("clientUpdateStickerPreview",this.onClientUpdateStickerPreview),w.a.off("clientUpdateStickerSet",this.onClientUpdateStickerSet)}startStopAnimation(){const e=this.props.autoplay,t=this.lottieRef.current;if(t){if(this.windowFocused&&!this.stickerPreview&&!this.openMediaViewer&&!this.openProfileMediaViewer&&!this.openIV&&!this.dialogChatId){if(this.entered)return t.play(),void(this.pause=!1);if(!this.openedStickerSet){if(this.paused)return t.play(),void(this.paused=!1);if(e&&this.inView)return t.play(),void(this.paused=!1)}}this.paused=t.pause()}}render(){const e=this.props,t=e.chatId,a=e.messageId,s=e.autoplay,i=e.className,o=e.displaySize,r=e.blur,l=e.sticker,g=e.style,f=e.openMedia,b=e.preview,C=l.thumbnail,y=l.sticker,v=l.width,E=l.height,S=this.state,U=S.animationData,k=S.hasError,w=Object(u.j)(l,t,a),M=Object(m.j)(C?C.photo:null),I=Object(m.j)(y),_=Object(u.h)(C);if(k){const e={width:o,height:o};return c.a.createElement("div",{className:d()("sticker",i),style:e,onClick:f},c.a.createElement("img",{className:d()("sticker-image",{"media-blurred":_&&r}),draggable:!1,src:M,alt:""}))}let x=null;const O=Object(p.f)({width:v,height:E},o);O&&(x=w?c.a.createElement(c.a.Fragment,null,U?c.a.createElement(h.default,{ref:this.lottieRef,options:{autoplay:s,loop:!0,animationData:U,renderer:"svg",rendererSettings:{preserveAspectRatio:"xMinYMin slice",clearCanvas:!1,progressiveLoad:!0,hideOnTransparent:!0,className:"lottie-svg"}},eventListeners:[{eventName:"loopComplete",callback:this.handleAnimationLoopComplete}],onMouseOut:this.handleAnimationMouseOut}):c.a.createElement("img",{className:d()("sticker-image",{"media-blurred":_&&r}),draggable:!1,src:M,alt:""})):c.a.createElement(c.a.Fragment,null,I&&!b?c.a.createElement("img",{className:"sticker-image",draggable:!1,src:I,alt:""}):c.a.createElement("img",{className:d()("sticker-image",{"media-blurred":_&&r}),draggable:!1,src:M,alt:""})));const P=Object(n.a)({width:O?O.width:0,height:O?O.height:0},g);return c.a.createElement("div",{className:d()("sticker",i),style:P,onClick:f,onMouseEnter:this.handleMouseEnter},x)}}_.defaultProps={chatId:0,messageId:0,openMedia:()=>{},autoplay:!0,play:!0,blur:!0,displaySize:E.jb,preview:!1,source:I.UNKNOWN};t.b=_},,,,,,function(e,t,a){"use strict";var n=a(34),s=a(0),i=a.n(s),o=a(16),r=a.n(o),c=a(272),l=a(41),d=a(4),h=a(2);a(312);class u extends i.a.Component{constructor(e){super(e),this.onUpdateFile=e=>{const t=this.state.file,a=e.file;t&&t.id===a.id&&(this.fileEquals(a,t)||this.setState({file:a,prevFile:t}))},this.isDownloading=(e,t)=>{if(!this.props.download)return!1;const a=t&&t.local&&t.local.is_downloading_active,n=e&&e.local&&e.local.is_downloading_active;return a||n},this.isUploading=(e,t)=>{if(!this.props.upload)return!1;const a=t&&t.remote&&t.remote.is_uploading_active,n=e&&e.remote&&e.remote.is_uploading_active;return a||n},this.getProgressParams=(e,t)=>{const a=e.local,n=e.remote;let s=!1,i=!1,o=!1,r=0,c=0;return this.isDownloading(e,t)?(s=t&&t.local&&t.local.is_downloading_active,i=a.is_downloading_active,o=a.is_downloading_completed,r=a.downloaded_size,c=e.size):this.isUploading(e,t)&&(s=t&&t.remote&&t.remote.is_uploading_active,i=n.is_uploading_active,o=n.is_uploading_completed,r=n.uploaded_size,c=e.size),[s,i,o,r,c]},this.completeAnimation=!1;const t=this.props.file;this.state={prevPropsFile:t,prevFile:null,file:h.a.get(t.id)||t}}static getDerivedStateFromProps(e,t){const a=e.file,n=t.prevPropsFile;return a&&n&&a.id!==n.id?{prevPropsFile:a,prevFile:null,file:h.a.get(a.id)||a}:null}shouldComponentUpdate(e,t){const a=this.props,n=a.download,s=a.upload,i=a.icon,o=a.thumbnailSrc;if(e.thumbnailSrc!==o)return!0;if(e.icon!==i)return!0;if(this.isDownloading(t.file,t.prevFile)&&!n)return!1;if(this.isUploading(t.file,t.prevFile)&&!s)return!1;const r=t.file?t.file.local:null,c=t.file?t.file.idb_key:null,l=this.state.prevFile?this.state.prevFile.local:null,d=this.state.prevFile?this.state.prevFile.idb_key:null,h=l&&r&&!l.is_downloading_completed&&r.is_downloading_completed,u=c&&!d;return(t.file.id!==this.state.file.id||!h||!u)&&(t.file!==this.state.file||t.prevFile!==this.state.prevFile)}componentDidMount(){this.mount=!0,h.a.on("updateFile",this.onUpdateFile)}componentWillUnmount(){this.mount=!1,h.a.off("updateFile",this.onUpdateFile)}fileEquals(e,t){if(e===t&&null===e)return!0;if(null!==e&&null===t)return!1;if(null===e&&null!==t)return!1;const a=e.local,n=e.remote,s=t.local,i=t.remote;return a.can_be_deleted===s.can_be_deleted&&(a.can_be_downloaded===s.can_be_downloaded&&(a.download_offset===s.download_offset&&(a.downloaded_prefix_size===s.downloaded_prefix_size&&(a.downloaded_size===s.downloaded_size&&(a.is_downloading_active===s.is_downloading_active&&(a.is_downloading_completed===s.is_downloading_completed&&(a.path===s.path&&(n.id===i.id&&(n.is_uploading_active===i.is_uploading_active&&(n.is_uploading_completed===i.is_uploading_completed&&n.uploaded_size===i.uploaded_size))))))))))}render(){let e=this.props,t=e.thumbnailSrc,a=e.cancelButton,s=e.zIndex,o=e.icon,h=e.completeIcon;const u=this.state,p=u.file,m=u.prevFile;if(!p)return null;const g=this.getProgressParams(p,m),f=Object(n.a)(g,5),b=f[0],C=f[1],y=f[2],v=f[3],E=f[4];let S=C,U=0;C&&(U=v&&E?100-(E-v)/E*100:1),b&&!C&&(this.completeAnimation=!0,U=y?100:0,S=!0,setTimeout(()=>{this.completeAnimation=!1,this.mount&&this.setState({prevFile:null})},d.c));const k={zIndex:s,background:t||"undefined"===typeof t?"rgba(0, 0, 0, 0.25)":null};return p&&p.local&&(p.local.is_downloading_completed||p.idb_key||p.local.is_uploading_completed)&&!this.completeAnimation&&!C?h?i.a.createElement("div",{className:r()("file-progress","file-progress-complete"),style:k},h):null:S||this.completeAnimation?i.a.createElement("div",{className:"file-progress",style:k},i.a.createElement(c.a,{className:"file-progress-indicator",classes:{circle:"file-progress-circle"},variant:"static",value:U,size:48,thickness:2}),a&&i.a.createElement(l.a,null)):o?i.a.createElement("div",{className:"file-progress",style:k},o):null}}u.defaultProps={cancelButton:!1,download:!0,upload:!1},t.a=u},,,,,function(e,t,a){"use strict";var n=a(35),s=a(0),i=a.n(s),o=a(16),r=a.n(o),c=a(74),l=a(19),d=a(14),h=a(37),u=a(4),p=a(2);a(322);class m extends i.a.Component{constructor(e){super(e),this.onClientUpdatePhotoBlob=e=>{const t=this.state,a=t.photoSize,n=t.thumbSize,s=e.fileId;(a&&a.photo&&a.photo.id===s||n&&n.photo&&n.photo.id===s)&&this.forceUpdate()},this.state={}}static getDerivedStateFromProps(e,t){const a=e.photo,n=e.size,s=e.thumbnailSize;return a!==t.prevPhoto?{prevPhoto:a,photoSize:Object(l.l)(a.sizes,n),thumbSize:Object(l.l)(a.sizes,s),minithumbnail:a?a.minithumbnail:null}:null}componentDidMount(){p.a.on("clientUpdatePhotoBlob",this.onClientUpdatePhotoBlob)}componentWillUnmount(){p.a.off("clientUpdatePhotoBlob",this.onClientUpdatePhotoBlob)}render(){const e=this.props,t=e.className,a=e.displaySize,s=e.openMedia,o=e.showProgress,u=e.title,p=e.caption,m=e.type,g=e.style,f=this.state,b=f.thumbSize,C=f.photoSize,y=f.minithumbnail;if(!C)return null;const v=y?"data:image/jpeg;base64, "+y.data:null,E=Object(d.j)(b?b.photo:null),S=Object(d.j)(C.photo),U=!E&&v||Object(h.h)(b),k=Object(l.f)(C,a,!1);if(!k)return null;const w=Object(n.a)({width:k.width,height:k.height},g),M=Boolean(S||E||v);return i.a.createElement("div",{className:r()(t,"photo",{"photo-big":"message"===m,"photo-title":u,"photo-caption":p,pointer:s}),style:w,onClick:s},M&&i.a.createElement("img",{className:r()("photo-image",{"media-blurred":!S&&U,"media-mini-blurred":!S&&!E&&U}),draggable:!1,src:S||E||v,alt:""}),o&&i.a.createElement(c.a,{file:C.photo,download:!0,upload:!0,cancelButton:!0}))}}m.defaultProps={size:u.F,thumbnailSize:u.G,displaySize:u.D,showProgress:!0},t.a=m},,,,,function(e,t,a){"use strict";var n=a(0),s=a.n(n),i=a(16),o=a.n(i),r=a(10),c=a(28),l=a(14),d=a(22),h=a(5),u=a(2);a(318);class p extends n.Component{constructor(e){super(e),this.onClientUpdateUserBlob=e=>{this.props.userId===e.userId&&(this.state.loaded?this.setState({loaded:!1}):this.forceUpdate())},this.onClientUpdateChatBlob=e=>{const t=this.props.userId,a=e.chatId,n=h.a.get(a);if(n&&n.type)switch(n.type["@type"]){case"chatTypeBasicGroup":case"chatTypeSupergroup":return;case"chatTypePrivate":case"chatTypeSecret":if(n.type.user_id!==t)return;this.state.loaded?this.setState({loaded:!1}):this.forceUpdate()}},this.onUpdateChatPhoto=e=>{const t=this.props.userId,a=e.chat_id,n=e.photo,s=h.a.get(a);if(s&&s.type)switch(s.type["@type"]){case"chatTypeBasicGroup":case"chatTypeSupergroup":return;case"chatTypePrivate":case"chatTypeSecret":if(s.type.user_id!==t)return;if(this.state.loaded?this.setState({loaded:!1}):this.forceUpdate(),n){const e=u.a.getStore();Object(l.o)(e,s)}}},this.onUpdateChatTitle=e=>{const t=this.props.userId,a=h.a.get(e.chat_id);if(a&&a.type)switch(a.type["@type"]){case"chatTypeBasicGroup":case"chatTypeSupergroup":return;case"chatTypePrivate":case"chatTypeSecret":if(a.type.user_id!==t&&!a.photo)return;this.forceUpdate()}},this.handleSelect=e=>{const t=this.props,a=t.userId,n=t.onSelect;n&&(e.stopPropagation(),n(a))},this.handleLoad=()=>{this.setState({loaded:!0})},this.state={loaded:!1}}shouldComponentUpdate(e,t){return e.userId!==this.props.userId||t.loaded!==this.state.loaded}componentDidMount(){u.a.on("clientUpdateUserBlob",this.onClientUpdateUserBlob),u.a.on("clientUpdateChatBlob",this.onClientUpdateChatBlob),h.a.on("updateChatPhoto",this.onUpdateChatPhoto),h.a.on("updateChatTitle",this.onUpdateChatTitle)}componentWillUnmount(){u.a.off("clientUpdateUserBlob",this.onClientUpdateUserBlob),u.a.off("clientUpdateChatBlob",this.onClientUpdateChatBlob),h.a.off("updateChatPhoto",this.onUpdateChatPhoto),h.a.off("updateChatTitle",this.onUpdateChatTitle)}render(){const e=this.props,t=e.className,a=e.userId,n=e.fistName,i=e.lastName,r=e.onSelect,h=e.small,u=e.poll,p=e.t,m=this.state.loaded,g=d.a.get(a);if(!g&&!n&&!i)return null;const f=Object(c.d)(a,n,i,p),b=Object(l.j)(g&&g.profile_photo?g.profile_photo.small:null),C=b&&m,y="tile_color_".concat(Math.abs(a)%8+1);return s.a.createElement("div",{className:o()(t,"user-tile",{[y]:!C},{pointer:r},{"tile-small":h},{"tile-poll":u}),onClick:this.handleSelect},!C&&s.a.createElement("div",{className:"tile-photo"},s.a.createElement("span",{className:"tile-text"},f)),b&&s.a.createElement("img",{className:"tile-photo",src:b,onLoad:this.handleLoad,draggable:!1,alt:""}))}}t.a=Object(r.c)()(p)},,,,function(e,t,a){"use strict";var n=a(6),s=a.n(n),i=a(13),o=a(0),r=a.n(o),c=a(10),l=a(274),d=a(501),h=a(488),u=a(489),p=a(490),m=a(491),g=a(105),f=a(8),b=a(1),C=(a(336),a(21));class y extends r.a.Component{constructor(e){var t;super(e),t=this,this.handleClick=e=>{e.preventDefault(),e.stopPropagation(),this.setState({confirm:!0})},this.handleDialogClick=e=>{e.preventDefault(),e.stopPropagation()},this.handleClose=()=>{this.setState({confirm:!1})},this.handleDone=e=>{this.handleClose();const t=this.props,a=t.url,n=t.onClick;if(a)if(n)n(e);else{const e=window.open();e.opener=null,e.location=a}},this.handleSafeClick=function(){var e=Object(i.a)(s.a.mark((function e(a){var n,i,o,r,c,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.stopPropagation(),n=t.props,i=n.onClick,o=n.url,!t.isTelegramLink(o)){e.next=19;break}return a.preventDefault(),e.prev=4,e.next=7,b.a.send({"@type":"getMessageLinkInfo",url:o});case 7:if(r=e.sent,f.a.setItems([r.message]),c=r.chat_id,l=r.message,!c){e.next=13;break}return Object(C.h)(c,l?l.id:null),e.abrupt("return");case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(4),console.log("[safeLink] messageLinkInfo error",e.t0);case 18:i&&i(a);case 19:i&&(a.preventDefault(),i(a));case 20:case"end":return e.stop()}}),e,null,[[4,15]])})));return function(t){return e.apply(this,arguments)}}(),this.state={}}static getDerivedStateFromProps(e,t){const a=e.displayText,n=e.mail,s=e.url;return t.prevUrl!==s||t.prevDisplayText!==a?{prevUrl:s,prevDisplayText:a,safe:Object(g.c)(a,s),decodedUrl:Object(g.a)(s,n),href:Object(g.b)(s,n),confirm:!1}:null}isTelegramLink(e){if(!e)return!1;const t=e.toLowerCase().replace("https://","").replace("http://","");return t.startsWith("t.me")||t.startsWith("tg://")}render(){const e=this.props,t=e.className,a=e.children,n=e.t,s=e.url,i=this.state,o=i.confirm,c=i.decodedUrl,g=i.href,f=i.safe;return s&&c?r.a.createElement(r.a.Fragment,null,f?r.a.createElement("a",{className:t,href:g,title:c,target:"_blank",rel:"noopener noreferrer",onClick:this.handleSafeClick},a||s):r.a.createElement(r.a.Fragment,null,r.a.createElement("a",{className:t,title:c,onClick:this.handleClick},a||s),o&&r.a.createElement(d.a,{transitionDuration:0,open:o,onClose:this.handleClose,onClick:this.handleDialogClick,"aria-labelledby":"confirm-dialog-title"},r.a.createElement(h.a,{id:"confirm-dialog-title"},n("Confirm")),r.a.createElement(u.a,{classes:{root:"safe-link-content-root"}},r.a.createElement(p.a,null,"Open this link?\n\n".concat(c))),r.a.createElement(m.a,null,r.a.createElement(l.a,{onClick:this.handleClose},n("Cancel")),r.a.createElement(l.a,{onClick:this.handleDone,color:"primary"},n("Open")))))):null}}t.a=Object(c.c)()(y)},,,,function(e,t,a){"use strict";var n=a(6),s=a.n(n),i=a(13),o=a(40),r=a(128),c=a(35);class l{constructor(e){this.store=e.store}setItem(e,t){if(this.store)try{this.store.setItem(e,t)}catch(a){}}getItem(e,t){if(this.store)try{return this.store.getItem(e,t)}catch(a){}}}class d{constructor(e,t={}){this.init(e,t),this.type="backend"}init(e,t={}){this.services=e,this.options=Object(c.a)({},{prefix:"i18next_res_",expirationTime:1/0,versions:{},store:window.localStorage},{},this.options,{},t),this.storage=new l(this.options)}read(e,t,a){const n=(new Date).getTime();if(!this.storage.store)return a(null,null);let s=this.storage.getItem("".concat(this.options.prefix).concat(e,"-").concat(t));return s&&(s=JSON.parse(s),s.i18nStamp&&s.i18nStamp+this.options.expirationTime>n&&this.options.versions[e]===s.i18nVersion)?(delete s.i18nVersion,delete s.i18nStamp,a(null,s)):a(null,null)}save(e,t,a){this.storage.store&&(a.i18nStamp=(new Date).getTime(),this.options.versions[e]&&(a.i18nVersion=this.options.versions[e]),this.storage.setItem("".concat(this.options.prefix).concat(e,"-").concat(t),JSON.stringify(a)))}}d.type="backend";var h=d,u=a(10),p=a(1);const m="translation",g=localStorage.getItem("i18next")||"en";r.a.use(u.b).init({ns:[m,"local"],defaultNS:m,fallbackNS:["local","emoji","settings","translation"],resources:{en:{settings:{ContactJoinedEnabled:"Enabled",ContactJoinedDisabled:"Disabled",NotificationsEnabled:"Enabled",NotificationsDisabled:"Disabled",PreviewEnabled:"Enabled",PreviewDisabled:"Disabled",BioAbout:"Any details such as age, occupation or city.\nExample: 23 y.o. designer from San Francisco.",Archived:"Archived",Saved:"Saved",EditProfile:"Edit Profile",GeneralSettings:"General Settings"},local:{PollQuizOneRightAnswer:"Quiz has only one right answer.",LeftChannel:"Left channel",LeftGroup:"Left group",EnterPassword:"Enter a Password",YourAccountProtectedWithPassword:"Your account is protected with an additional password.",DeletedMessage:"Deleted message",YourPhone:"Your Phone",SignInToTelegram:"Sign in to Telegram",PhoneNumber:"Phone Number",Country:"Country",KeepMeSignedIn:"Keep me signed in",StartText:"Please confirm your country code and enter your phone number.",Next:"Next",InvalidPhoneNumber:"Invalid phone number. Please check the number and try again.",More:"More",SendFileConfirmation:"Are you sure you want to send file?",SendFilesConfirmation:"Are you sure you want to send files?",SendMessage:"Send Message",ChatInfo:"Chat Info",ChannelInfo:"Channel Info",Stickers:"STICKERS",Emoji:"EMOJI",SelectChatToStartMessaging:"Please select a chat to start messaging",Text:"Text",ViewChannelInfo:"View channel info",ViewGroupInfo:"View group info",ViewProfile:"View profile",GoToMessage:"Go to message",PhotosTitle:"Photos",VideosTitle:"Videos",VoiceTitle:"Voice messages",UpdateDraftConfirmation:"Are you sure you want to update draft?"},emoji:{Search:"Search",NotEmojiFound:"No Emoji Found",ChooseDefaultSkinTone:"Choose your default skin tone",SearchResults:"Search Results",Recent:"Frequently Used",SmileysPeople:"Smileys & People",AnimalsNature:"Animals & Nature",FoodDrink:"Food & Drink",Activity:"Activity",TravelPlaces:"Travel & Places",Objects:"Objects",Symbols:"Symbols",Flags:"Flags",Custom:"Custom"},translation:{AppName:"Telegram",Connecting:"Connecting...",ConnectingToProxy:"Connecting to proxy...",Loading:"Loading...",Updating:"Updating...",WaitingForNetwork:"Waiting for network...",ContinueOnThisLanguage:"Continue in English"}},ru:{settings:{ContactJoinedEnabled:"\u0412\u043a\u043b\u044e\u0447\u0435\u043d\u043e",ContactJoinedDisabled:"\u0412\u044b\u043a\u043b\u044e\u0447\u0435\u043d\u043e",NotificationsEnabled:"\u0412\u043a\u043b\u044e\u0447\u0435\u043d\u044b",NotificationsDisabled:"\u0412\u044b\u043a\u043b\u044e\u0447\u0435\u043d\u044b",PreviewEnabled:"\u0412\u043a\u043b\u044e\u0447\u0435\u043d\u043e",PreviewDisabled:"\u0412\u044b\u043a\u043b\u044e\u0447\u0435\u043d\u043e",BioAbout:"\u041b\u044e\u0431\u044b\u0435 \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u043e\u0441\u0442\u0438, \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440: \u0432\u043e\u0437\u0440\u0430\u0441\u0442, \u0440\u043e\u0434 \u0437\u0430\u043d\u044f\u0442\u0438\u0439 \u0438\u043b\u0438 \u0433\u043e\u0440\u043e\u0434.\n\u041f\u0440\u0438\u043c\u0435\u0440: 23 \u0433\u043e\u0434\u0430, \u0434\u0438\u0437\u0430\u0439\u043d\u0435\u0440 \u0438\u0437 \u0421\u0430\u043d\u043a\u0442-\u041f\u0435\u0442\u0435\u0440\u0431\u0443\u0440\u0433\u0430.",Archived:"\u0410\u0440\u0445\u0438\u0432",Saved:"\u0418\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0435",EditProfile:"\u0420\u0435\u0434\u0430\u043a\u0442\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",GeneralSettings:"\u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"},local:{PollQuizOneRightAnswer:"Quiz has only one right answer.",LeftChannel:"\u041a\u0430\u043d\u0430\u043b \u043f\u043e\u043a\u0438\u043d\u0443\u0442",LeftGroup:"\u0413\u0440\u0443\u043f\u043f\u0430 \u043f\u043e\u043a\u0438\u043d\u0443\u0442\u0430",EnterPassword:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c",YourAccountProtectedWithPassword:"\u0412\u0430\u0448 \u0430\u043a\u043a\u0430\u0443\u043d\u0442 \u0437\u0430\u0449\u0438\u0449\u0435\u043d \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u043c \u043f\u0430\u0440\u043e\u043b\u0435\u043c.",DeletedMessage:"\u0423\u0434\u0430\u043b\u0435\u043d\u043d\u043e\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435",YourPhone:"\u0412\u0430\u0448 \u0442\u0435\u043b\u0435\u0444\u043e\u043d",SignInToTelegram:"\u0412\u0445\u043e\u0434 \u0432 Telegram",PhoneNumber:"\u0422\u0435\u043b\u0435\u0444\u043e\u043d\u043d\u044b\u0439 \u043d\u043e\u043c\u0435\u0440",Country:"\u0421\u0442\u0440\u0430\u043d\u0430",KeepMeSignedIn:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044e",StartText:"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0443\u043a\u0430\u0436\u0438\u0442\u0435 \u043a\u043e\u0434 \u0441\u0442\u0440\u0430\u043d\u044b \u0438 \u0441\u0432\u043e\u0439 \u043d\u043e\u043c\u0435\u0440 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430.",Next:"\u0414\u0430\u043b\u0435\u0435",InvalidPhoneNumber:"\u041d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 \u043d\u043e\u043c\u0435\u0440 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430. \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u043d\u043e\u043c\u0435\u0440 \u0438 \u043f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437.",More:"\u0415\u0449\u0451",SendFileConfirmation:"\u0412\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0444\u0430\u0439\u043b?",SendFilesConfirmation:"\u0412\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0444\u0430\u0439\u043b\u044b?",SendMessage:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435",ChatInfo:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0447\u0430\u0442\u0435",ChannelInfo:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u043a\u0430\u043d\u0430\u043b\u0435",Stickers:"\u0421\u0422\u0418\u041a\u0415\u0420\u042b",Emoji:"\u0415\u041c\u041e\u0414\u0417\u0418",SelectChatToStartMessaging:"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435, \u043a\u043e\u043c\u0443 \u0445\u043e\u0442\u0435\u043b\u0438 \u0431\u044b \u043d\u0430\u043f\u0438\u0441\u0430\u0442\u044c",Text:"\u0422\u0435\u043a\u0441\u0442",ViewChannelInfo:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u043a\u0430\u043d\u0430\u043b\u0435",ViewGroupInfo:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0433\u0440\u0443\u043f\u043f\u0435",ViewProfile:"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",GoToMessage:"\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u043a \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044e",PhotosTitle:"\u0424\u043e\u0442\u043e\u0433\u0440\u0430\u0444\u0438\u0438",VideosTitle:"\u0412\u0438\u0434\u0435\u043e\u0437\u0430\u043f\u0438\u0441\u0438",VoiceTitle:"\u0413\u043e\u043b\u043e\u0441\u043e\u0432\u044b\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f",UpdateDraftConfirmation:"\u0412\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0447\u0435\u0440\u043d\u043e\u0432\u0438\u043a \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f?"},emoji:{Search:"\u041f\u043e\u0438\u0441\u043a",NotEmojiFound:"\u0415\u043c\u043e\u0434\u0437\u0438 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u044b",ChooseDefaultSkinTone:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0442\u043e\u043d \u043a\u043e\u0436\u0438 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e",SearchResults:"\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u043f\u043e\u0438\u0441\u043a\u0430",Recent:"\u0427\u0430\u0441\u0442\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0435",SmileysPeople:"\u0421\u043c\u0430\u0439\u043b\u0438\u043a\u0438 \u0438 \u043b\u044e\u0434\u0438",AnimalsNature:"\u0416\u0438\u0432\u043e\u0442\u043d\u044b\u0435 \u0438 \u043f\u0440\u0438\u0440\u043e\u0434\u0430",FoodDrink:"\u0415\u0434\u0430 \u0438 \u043d\u0430\u043f\u0438\u0442\u043a\u0438",Activity:"\u0410\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c",TravelPlaces:"\u041f\u0443\u0442\u0435\u0448\u0435\u0441\u0442\u0432\u0438\u044f \u0438 \u043c\u0435\u0441\u0442\u043d\u043e\u0441\u0442\u0438",Objects:"\u041f\u0440\u0435\u0434\u043c\u0435\u0442\u044b",Symbols:"\u0421\u0438\u043c\u0432\u043e\u043b\u044b",Flags:"\u0424\u043b\u0430\u0433\u0438",Custom:"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u0438\u0435"},translation:{AppName:"Telegram",Connecting:"\u0421\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435...",ConnectingToProxy:"\u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043a \u043f\u0440\u043e\u043a\u0441\u0438...",Loading:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...",Updating:"\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435...",WaitingForNetwork:"\u041e\u0436\u0438\u0434\u0430\u043d\u0438\u0435 \u0441\u0435\u0442\u0438...",ContinueOnThisLanguage:"\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u044c \u043d\u0430 \u0440\u0443\u0441\u0441\u043a\u043e\u043c"}}},lng:g,fallbackLng:"en",interpolation:{escapeValue:!1},react:{wait:!1}});const f=new h(null,{enabled:!0,prefix:"i18next_res_",expirationTime:1/0}),b=f.read("en",m,(e,t)=>t),C=f.read(g,m,(e,t)=>t);r.a.addResourceBundle("en",m,b),r.a.addResourceBundle(g,m,C);class y extends o.a{constructor(){var e;super(),e=this,this.addTdLibListener=()=>{p.a.on("update",this.onUpdate),p.a.on("clientUpdate",this.onClientUpdate)},this.removeTdLibListener=()=>{p.a.off("update",this.onUpdate),p.a.off("clientUpdate",this.onClientUpdate)},this.onUpdate=function(){var t=Object(i.a)(s.a.mark((function t(a){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=a["@type"],t.next="updateAuthorizationState"===t.t0?3:"updateLanguagePackStrings"===t.t0?14:16;break;case 3:t.t1=a.authorization_state["@type"],t.next="authorizationStateWaitTdlibParameters"===t.t1?6:13;break;case 6:return p.a.send({"@type":"setOption",name:"localization_target",value:{"@type":"optionValueString",value:"android"}}),p.a.send({"@type":"setOption",name:"language_pack_id",value:{"@type":"optionValueString",value:g}}),t.next=10,p.a.send({"@type":"getLocalizationTargetInfo",only_local:!1});case 10:return e.info=t.sent,p.a.clientUpdate({"@type":"clientUpdateLanguageChange",language:g}),t.abrupt("break",13);case 13:return t.abrupt("break",16);case 14:return e.emit("updateLanguagePackStrings",a),t.abrupt("break",16);case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.onClientUpdate=function(){var t=Object(i.a)(s.a.mark((function t(a){var n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=a["@type"],t.next="clientUpdateLanguageChange"===t.t0?3:12;break;case 3:return n=a.language,t.next=6,e.loadLanguage(n);case 6:return localStorage.setItem("i18next",n),t.next=9,r.a.changeLanguage(n);case 9:return p.a.send({"@type":"setOption",name:"language_pack_id",value:{"@type":"optionValueString",value:n}}),e.emit("clientUpdateLanguageChange",a),t.abrupt("break",12);case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.processStrings=(e,t)=>{if(!t)return{};const a=t.strings;if(!a)return{};let n={};for(let s=0;s<a.length;s++){const e=a[s].value;switch(e["@type"]){case"languagePackStringValueOrdinary":n[a[s].key]=e.value;break;case"languagePackStringValuePluralized":e.zero_value&&(n[a[s].key+"Z"]=e.zero_value),e.one_value&&(n[a[s].key+"O"]=e.one_value),e.two_value&&(n[a[s].key+"T"]=e.two_value),e.few_value&&(n[a[s].key+"F"]=e.few_value),e.many_value&&(n[a[s].key+"M"]=e.many_value),e.other_value&&(n[a[s].key+"OT"]=e.other_value)}}return n},this.loadLanguage=function(){var t=Object(i.a)(s.a.mark((function t(a){var n,i;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.a.send({"@type":"getLanguagePackStrings",language_pack_id:a,keys:[]});case 2:n=t.sent,i=e.processStrings(a,n),e.cache.save(a,m,i),r.a.addResourceBundle(a,m,i);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.fallbackLng="en",this.i18n=r.a,this.cache=f,this.addTdLibListener()}}const v=new y;window.localization=v;t.a=v},,function(e,t,a){"use strict";var n=a(0),s=a.n(n),i=a(23);t.a=Object(i.a)(s.a.createElement("path",{d:"M5,19 L19,19 C19.5522847,19 20,19.4477153 20,20 C20,20.5128358 19.6139598,20.9355072 19.1166211,20.9932723 L19,21 L5,21 C4.44771525,21 4,20.5522847 4,20 C4,19.4871642 4.38604019,19.0644928 4.88337887,19.0067277 L5,19 L19,19 L5,19 Z M11.8833789,3.00672773 L12,3 C12.5128358,3 12.9355072,3.38604019 12.9932723,3.88337887 L13,4 L13,13.585 L16.2928932,10.2928932 C16.6533772,9.93240926 17.2206082,9.90467972 17.6128994,10.2097046 L17.7071068,10.2928932 C18.0675907,10.6533772 18.0953203,11.2206082 17.7902954,11.6128994 L17.7071068,11.7071068 L12.7071068,16.7071068 C12.3466228,17.0675907 11.7793918,17.0953203 11.3871006,16.7902954 L11.2928932,16.7071068 L6.29289322,11.7071068 C5.90236893,11.3165825 5.90236893,10.6834175 6.29289322,10.2928932 C6.65337718,9.93240926 7.22060824,9.90467972 7.61289944,10.2097046 L7.70710678,10.2928932 L11,13.585 L11,4 C11,3.48716416 11.3860402,3.06449284 11.8833789,3.00672773 L12,3 L11.8833789,3.00672773 Z"}),"Download")},,,,,,,,,,function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return h}));var n=a(6),s=a.n(n),i=a(13);let o=null;function r(){return c.apply(this,arguments)}function c(){return(c=Object(i.a)(s.a.mark((function e(){var t,a,n,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,fetch("data/countries.dat");case 5:return t=e.sent,e.next=8,t.text();case 8:a=e.sent,n=a.split("\n"),i=[],n.forEach(e=>{const t=e.split(";"),a={prefix:t[0],code:t[1],name:t[2],pattern:t[3],count:Number(t[4]),emoji:t[5]};i.push(a)}),i.forEach(e=>{e.phone="+"+e.prefix}),o=i.filter(e=>e.emoji),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(2),console.error(e.t0);case 19:case"end":return e.stop()}}),e,null,[[2,16]])})))).apply(this,arguments)}function l(e){return e?e.replace(/ /g,"").replace("+","").toLowerCase():e}function d(e,t){if(!t)return null;const a=t.findIndex(t=>function(e,t){if(!e)return!1;if(!t)return!1;e=l(e);const a=l(t.phone);return e.startsWith(a)&&t.pattern}(e,t));return-1!==a?t[a]:null}function h(e){if(!e)return e;if(!o)return e.startsWith("+")?e:"+"+e;const t=d(e,o);return t?function(e,t){e=l(e);let a="",n=0;for(let s=0;s<t.length&&n<e.length;s++)t[s]>="0"&&t[s]<="9"?(a+=t[s],e[n]===t[s]&&n++):" "===t[s]?a+=t[s]:"X"===t[s]&&(a+=e[n++]);return a+=" "+e.substring(n),"+"+a}(e,t.pattern):e.startsWith("+")?e:"+"+e}},function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return o})),a.d(t,"d",(function(){return h}));var n=a(168);function s(e,t){return e?t?e.startsWith("mailto:")?e:"mailto:"+e:e.startsWith("http")?e:"http://"+e:null}function i(e,t){return(!e||e===t)&&!function(e){return!!e&&r.test(e)}(t)}function o(e,t){if(!e)return null;const a=s(e,t);try{let e=decodeURI(a);const t=e.match(/^https?:\/\/([^\/:?#]+)(?:[\/:?#]|$)/i)[1];return e=e.replace(t,n.a.ToUnicode(t)),e}catch(i){console.log("SafeLink.getDecodedUrl error ",e,i)}return null}const r=/\u202e/;const c=new RegExp("(?:([a-zA-Z]+):\\/\\/)((?:[A-Za-z\xd0\x90-\xd0\xaf\xd0\x81\xd0\xb0-\xd1\x8f\xd1\x910-9\\-\\_]+\\.){0,10}([A-Za-z\xd1\x80\xd1\x84\\-\\d]{2,22})(\\:\\d+)?)"),l=new RegExp("(?:([a-zA-Z]+):\\/\\/)?((?:[A-Za-z\xd0\x90-\xd0\xaf\xd0\x81\xd0\xb0-\xd1\x8f\xd1\x910-9\\-\\_]+\\.){1,10}([A-Za-z\xd1\x80\xd1\x84\\-\\d]{2,22})(\\:\\d+)?)"),d=new RegExp("^([a-zA-Z]+):\\/\\/");function h(e){const t=e.trim();if(!t)return null;const a=t.match(c);if(!a){const e=t.match(l);return e&&0===e.index?"http://"+t:null}if(0!==a.index)return null;const n=t.match(d);return n&&function(e){return["http","https","tg"].some(t=>0===e.toLowerCase().indexOf(t))}(n[0])?t:null}},,,,,,,,,,function(e,t,a){"use strict";var n=a(0),s=a.n(n),i=a(23);t.a=Object(i.a)(s.a.createElement("path",{transform:"translate(-12.000000, -12.000000)",d:"M19.3717789,13.8876217 L33.8466511,23.2537154 C34.2588127,23.5204082 34.3767385,24.0707284 34.1100457,24.48289 C34.0418356,24.5883056 33.9520666,24.6780745 33.8466511,24.7462846 L19.3717789,34.1123783 C18.9596173,34.3790711 18.4092971,34.2611454 18.1426043,33.8489838 C18.0495218,33.705129 18,33.5374371 18,33.3660938 L18,14.6339062 C18,14.1429865 18.3979691,13.7450173 18.8888889,13.7450173 C19.0602323,13.7450173 19.2279241,13.7945391 19.3717789,13.8876217 Z"}),"PlayArrow")},function(e,t,a){"use strict";var n=a(35),s=a(0),i=a.n(s),o=a(16),r=a.n(o),c=a(10),l=a(74),d=a(19),h=a(37),u=a(14),p=a(4),m=a(7),g=a(2),f=a(44),b=a(8);a(317);class C extends i.a.Component{constructor(e){super(e),this.startStopPlayer=()=>{const e=this.videoRef.current;e&&(this.windowFocused&&(this.inView&&!this.openMediaViewer&&!this.openProfileMediaViewer&&!this.openIV||this.ivInView&&!this.openIVMedia)?e.play():e.pause())},this.onClientUpdateInstantViewContent=e=>{this.openIV=Boolean(f.a.getCurrent()),this.startStopPlayer()},this.onClientUpdateProfileMediaViewerContent=e=>{this.openProfileMediaViewer=Boolean(m.a.profileMediaViewerContent),this.startStopPlayer()},this.onClientUpdateMediaViewerContent=e=>{this.openMediaViewer=Boolean(m.a.mediaViewerContent),this.startStopPlayer()},this.onClientUpdateInstantViewViewerContent=e=>{this.openIVMedia=Boolean(f.a.viewerContent),this.startStopPlayer()},this.onClientUpdateFocusWindow=e=>{this.windowFocused=e.focused,this.startStopPlayer()},this.onClientUpdateMessagesInView=e=>{const t=this.props,a=t.chatId,n=t.messageId,s="".concat(a,"_").concat(n);this.inView=e.messages.has(s),this.startStopPlayer()},this.onClientUpdateBlocksInView=e=>{const t=this.props.pageBlock;t&&(this.ivInView=e.blocks.has(t),this.startStopPlayer())},this.onClientUpdateAnimationBlob=e=>{const t=this.props.animation.animation,a=e.fileId;t&&t.id===a&&this.forceUpdate(()=>{this.startStopPlayer()})},this.onClientUpdateAnimationThumbnailBlob=e=>{const t=this.props.animation.thumbnail;if(!t)return;const a=e.fileId;t.photo&&t.photo.id===a&&this.forceUpdate()},this.videoRef=i.a.createRef(),this.setPlayerParams()}setPlayerParams(){this.windowFocused=window.hasFocus,this.inView=!1,this.openMediaViewer=Boolean(m.a.mediaViewerContent),this.openProfileMediaViewer=Boolean(m.a.profileMediaViewerContent),this.openIV=Boolean(f.a.getCurrent()),this.ivInView=!1,this.openIVMedia=Boolean(f.a.viewerContent)}componentDidUpdate(e,t,a){e.animation!==this.props.animation&&this.setPlayerParams()}componentDidMount(){g.a.on("clientUpdateAnimationThumbnailBlob",this.onClientUpdateAnimationThumbnailBlob),g.a.on("clientUpdateAnimationBlob",this.onClientUpdateAnimationBlob),m.a.on("clientUpdateFocusWindow",this.onClientUpdateFocusWindow),m.a.on("clientUpdateMediaViewerContent",this.onClientUpdateMediaViewerContent),m.a.on("clientUpdateProfileMediaViewerContent",this.onClientUpdateProfileMediaViewerContent),b.a.on("clientUpdateMessagesInView",this.onClientUpdateMessagesInView),f.a.on("clientUpdateInstantViewContent",this.onClientUpdateInstantViewContent),f.a.on("clientUpdateInstantViewViewerContent",this.onClientUpdateInstantViewViewerContent),f.a.on("clientUpdateBlocksInView",this.onClientUpdateBlocksInView)}componentWillUnmount(){g.a.off("clientUpdateAnimationThumbnailBlob",this.onClientUpdateAnimationThumbnailBlob),g.a.off("clientUpdateAnimationBlob",this.onClientUpdateAnimationBlob),m.a.off("clientUpdateFocusWindow",this.onClientUpdateFocusWindow),m.a.off("clientUpdateMediaViewerContent",this.onClientUpdateMediaViewerContent),m.a.off("clientUpdateProfileMediaViewerContent",this.onClientUpdateProfileMediaViewerContent),b.a.off("clientUpdateMessagesInView",this.onClientUpdateMessagesInView),f.a.off("clientUpdateInstantViewContent",this.onClientUpdateInstantViewContent),f.a.off("clientUpdateInstantViewViewerContent",this.onClientUpdateInstantViewViewerContent),f.a.off("clientUpdateBlocksInView",this.onClientUpdateBlocksInView)}render(){const e=this.props,t=e.displaySize,a=e.openMedia,s=e.t,o=e.title,c=e.caption,p=e.type,m=e.style,g=this.props.animation,f=g.minithumbnail,b=g.thumbnail,C=g.animation,y=g.mime_type,v=g.width,E=g.height,S=Object(d.f)({width:v,height:E}||b,t,!1);if(!S)return null;const U=Object(n.a)({width:S.width,height:S.height},m),k=f?"data:image/jpeg;base64, "+f.data:null,w=Object(u.j)(b?b.photo:null),M=Object(u.j)(C),I=w?Object(h.h)(b):Boolean(k),_=Object(u.n)(y);return i.a.createElement("div",{className:r()("animation",{"animation-big":"message"===p,"animation-title":o,"media-title":o,"animation-caption":c,pointer:a}),style:U,onClick:a},M?_?i.a.createElement("img",{className:"animation-preview",src:M,alt:""}):i.a.createElement("video",{ref:this.videoRef,className:"media-viewer-content-animation",src:M,poster:w||k,muted:!0,autoPlay:!0,loop:!0,playsInline:!0,width:U.width,height:U.height}):i.a.createElement(i.a.Fragment,null,i.a.createElement("img",{className:r()("animation-preview",{"media-blurred":I,"media-mini-blurred":!M&&!w&&I}),src:w||k,alt:""}),i.a.createElement("div",{className:"animation-meta"},Object(u.g)(C))),i.a.createElement(l.a,{file:C,download:!0,upload:!0,cancelButton:!0,icon:i.a.createElement("div",{className:"animation-play"},s("AttachGif"))}))}}C.defaultProps={size:p.F,displaySize:p.D,iv:!1},t.a=Object(c.c)()(C)},,,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return u})),a.d(t,"b",(function(){return f}));var n=a(6),s=a.n(n),i=a(13),o=a(19),r=a(4),c=a(7),l=a(64),d=a(1);const h=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function u(){return p.apply(this,arguments)}function p(){return(p=Object(i.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("[SW] Register"),r.A&&localStorage.setItem("register","true"),!("serviceWorker"in navigator)){e.next=16;break}if(new URL("",window.location).origin===window.location.origin){e.next=6;break}return e.abrupt("return");case 6:if("service-worker.js",t="".concat("","/").concat("service-worker.js"),console.log("[SW] Service worker url: ".concat(t)),h){e.next=14;break}return e.next=12,m(t);case 12:e.next=16;break;case 14:return e.next=16,C(t);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return g.apply(this,arguments)}function g(){return(g=Object(i.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[SW] RegisterValidSW"),e.prev=1,e.next=4,navigator.serviceWorker.register(t);case 4:(a=e.sent).onupdatefound=()=>{const e=a.installing;e.onstatechange=()=>{"installed"===e.state&&(navigator.serviceWorker.controller?(console.log("[SW] New content is available; please refresh."),c.a.emit("clientUpdateNewContentAvailable")):console.log("[SW] Content is cached for offline use."))}},e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.error("[SW] Error during service worker registration: ",e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})))).apply(this,arguments)}function f(){return b.apply(this,arguments)}function b(){return(b=Object(i.a)(s.a.mark((function e(){var t,a,n,i,r,h,u,p;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.serviceWorker.ready;case 3:return t=e.sent,e.next=6,t.pushManager.getSubscription();case 6:if(!(a=e.sent)){e.next=10;break}return e.next=10,a.unsubscribe();case 10:return e.next=12,t.pushManager.subscribe({userVisibleOnly:!0});case 12:if(a=e.sent,console.log("[SW] Received push subscription: ",JSON.stringify(a)),n=a.endpoint,i=Object(o.a)(a.getKey("p256dh")),r=Object(o.a)(a.getKey("auth")),!(n&&i&&r)){e.next=26;break}if(h=c.a.authorizationState,!Object(o.p)(h)){e.next=26;break}return u={"@type":"deviceTokenWebPush",endpoint:n,p256dh_base64url:i,auth_base64url:r},console.log("[SW] registerDevice",u),e.next=24,d.a.send({"@type":"registerDevice",device_token:u,other_user_ids:[]});case 24:p=e.sent,console.log("[SW] registerDevice result",p);case 26:e.next=32;break;case 28:e.prev=28,e.t0=e.catch(0),console.error("[SW] Error during service worker push subscription: ",e.t0),l.a.enableSound=!0;case 32:case"end":return e.stop()}}),e,null,[[0,28]])})))).apply(this,arguments)}function C(e){return y.apply(this,arguments)}function y(){return(y=Object(i.a)(s.a.mark((function e(t){var a,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[SW] CheckValidServiceWorker"),e.prev=1,e.next=4,fetch(t);case 4:if(404!==(a=e.sent).status&&-1!==a.headers.get("content-type").indexOf("javascript")){e.next=14;break}return e.next=8,navigator.serviceWorker.ready;case 8:return n=e.sent,e.next=11,n.unregister();case 11:window.location.reload(),e.next=16;break;case 14:return e.next=16,m(t);case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(1),console.log("[SW] No internet connection found. App is running in offline mode.");case 21:case"end":return e.stop()}}),e,null,[[1,18]])})))).apply(this,arguments)}},function(e,t,a){"use strict";var n=a(0),s=a.n(n),i=a(17),o=a(8);class r extends s.a.Component{constructor(e){super(e),this.onUpdateMessageContentOpened=e=>{const t=this.props,a=t.chatId,n=t.messageId;a===e.chat_id&&n===e.message_id&&this.setState({isOpened:Object(i.A)(a,n)})};const t=this.props,a=t.chatId,n=t.messageId;this.state={isOpened:Object(i.A)(a,n)}}componentDidMount(){o.a.on("updateMessageContentOpened",this.onUpdateMessageContentOpened)}componentWillUnmount(){o.a.off("updateMessageContentOpened",this.onUpdateMessageContentOpened)}render(){const e=this.props,t=e.icon,a=e.openedIcon;return this.state.isOpened?a:t}}r.defaultProps={icon:null,openedIcon:null},t.a=r},,,,,,,,,function(e){e.exports=JSON.parse('{"homepage":"https://web.tginfo.me","name":"telegram_react","version":"0.0.595","private":true,"dependencies":{"@material-ui/core":"^4.8.0","@material-ui/icons":"^4.5.1","@material-ui/lab":"^4.0.0-alpha.36","classnames":"^2.2.6","emoji-mart":"^2.11.2","emoji-regex":"^8.0.0","i18next":"^15.0.7","iframe-resizer":"^4.2.9","lottie-web":"^5.5.10","notistack":"^0.5.1","pako":"^1.0.10","react":"^16.12.0","react-custom-scrollbars":"^4.2.1","react-dom":"^16.12.0","react-i18next":"^10.6.0","react-router-dom":"^5.0.0","react-scripts":"^3.1.1","tdweb":"1.6.0"},"lint-staged":{"src/**/*.{js,jsx,json,css}":["prettier --print-width 120 --tab-width 4 --single-quote --jsx-single-quote --jsx-bracket-same-line --bracket-spacing --write","git add"]},"scripts":{"precommit":"lint-staged","start":"react-app-rewired start","build":"react-app-rewired build && sw-precache-cra --config sw-config.js --no-minify","test":"react-app-rewired test --env=jsdom","eject":"react-scripts eject","predeploy":"npm run build && echo web.tginfo.me > build/CNAME","deploy":"gh-pages -d build ${CI_REPO}","stats":"react-app-rewired build --bundle-report && npx webpack-bundle-analyzer ./build/bundle-stats.json"},"devDependencies":{"prop-types":"^15.7.2","customize-cra":"^0.5.0","husky":"^1.3.1","gh-pages":"^2.0.1","lint-staged":"^8.1.5","prettier":"^1.16.4","react-app-rewired":"^2.1.3","sw-precache-cra":"^1.0.0-alpha.2","webpack-bundle-analyzer":"^3.3.2","worker-loader":"^2.0.0"},"browserslist":[">0.2%","not dead","not ie <= 11","not op_mini all"]}')},function(e,t,a){"use strict";var n=a(0),s=a.n(n),i=a(16),o=a.n(i),r=a(94),c=a(115),l=a(134),d=a(135),h=a(136),u=a(37),p=a(18);a(316);class m extends s.a.Component{constructor(e){super(e),this.onClientUpdateMediaEnd=e=>{const t=this.props,a=t.chatId,n=t.messageId;a===e.chatId&&n===e.messageId&&this.setState({active:!1,playing:!1,currentTime:0})},this.onClientUpdateMediaPlay=e=>{const t=this.props,a=t.chatId,n=t.messageId;t.playing;a===e.chatId&&n===e.messageId?this.setState({playing:!0}):this.setState({playing:!1})},this.onClientUpdateMediaPause=e=>{const t=this.props,a=t.chatId,n=t.messageId;a===e.chatId&&n===e.messageId&&this.setState({playing:!1})},this.onClientUpdateMediaActive=e=>{const t=this.props,a=t.chatId,n=t.messageId;a===e.chatId&&n===e.messageId?this.state.active||this.setState({active:!0,currentTime:0,playing:!0}):this.state.active&&this.setState({active:!1,currentTime:0,playing:!1})};const t=e.chatId,a=e.messageId,n=p.b.time,s=p.b.message,i=p.b.playing,o=s&&s.chat_id===t&&s.id===a;this.state={active:o,playing:!!o&&i,currentTime:o&&n?n.currentTime:0,duration:o&&n?n.duration:0}}shouldComponentUpdate(e,t,a){const n=this.state,s=n.active,i=n.playing,o=n.currentTime,r=n.duration;return t.active!==s||(t.playing!==i||(t.currentTime!==o||t.duration!==r))}componentDidMount(){p.b.on("clientUpdateMediaActive",this.onClientUpdateMediaActive),p.b.on("clientUpdateMediaPlay",this.onClientUpdateMediaPlay),p.b.on("clientUpdateMediaPause",this.onClientUpdateMediaPause),p.b.on("clientUpdateMediaEnd",this.onClientUpdateMediaEnd)}componentWillUnmount(){p.b.off("clientUpdateMediaActive",this.onClientUpdateMediaActive),p.b.off("clientUpdateMediaPlay",this.onClientUpdateMediaPlay),p.b.off("clientUpdateMediaPause",this.onClientUpdateMediaPause),p.b.off("clientUpdateMediaEnd",this.onClientUpdateMediaEnd)}render(){const e=this.props,t=e.chatId,a=e.messageId,n=e.audio,i=e.openMedia,p=e.title,m=e.meta,g=e.caption,f=this.state.playing;if(!n)return null;const b=n.album_cover_thumbnail,C=n.duration,y=n.audio,v=Object(u.a)(n),E=Object(u.b)(n);return s.a.createElement("div",{className:o()("audio","document",{"media-title":p})},s.a.createElement(d.a,{thumbnail:b,file:y,openMedia:i,icon:s.a.createElement(r.a,null),completeIcon:f?s.a.createElement(l.a,null):s.a.createElement(c.a,null)}),s.a.createElement("div",{className:"document-content"},s.a.createElement("div",{className:"document-title"},s.a.createElement("a",{className:"document-name",onClick:i,title:v},v)),s.a.createElement("div",{className:"audio-action"},E),s.a.createElement(h.a,{chatId:t,messageId:a,duration:C,file:y,meta:g?null:m})))}}t.a=m},function(e,t,a){"use strict";var n=a(0),s=a.n(n),i=a(23);t.a=Object(i.a)(s.a.createElement("path",{transform:"translate(-15.000000, -15.000000)",d:"M23,16 C23.5522847,16 24,16.4477153 24,17 L24,37 C24,37.5522847 23.5522847,38 23,38 L18,38 C17.4477153,38 17,37.5522847 17,37 L17,17 C17,16.4477153 17.4477153,16 18,16 L23,16 Z M36,16 C36.5522847,16 37,16.4477153 37,17 L37,37 C37,37.5522847 36.5522847,38 36,38 L31,38 C30.4477153,38 30,37.5522847 30,37 L30,17 C30,16.4477153 30.4477153,16 31,16 L36,16 Z"}),"Pause")},function(e,t,a){"use strict";var n=a(0),s=a.n(n),i=a(16),o=a.n(i),r=a(74),c=a(14),l=a(2);a(314);class d extends s.a.Component{constructor(e){super(e),this.onClientUpdateDocumentThumbnailBlob=e=>{const t=this.props.thumbnail;if(!t)return;const a=t.photo;if(!a)return;const n=e.fileId;a.id===n&&this.forceUpdate()},this.handleLoad=()=>{this.setState({loaded:!0})},this.state={loaded:!1}}componentDidMount(){l.a.on("clientUpdateDocumentThumbnailBlob",this.onClientUpdateDocumentThumbnailBlob),l.a.on("clientUpdateAudioThumbnailBlob",this.onClientUpdateDocumentThumbnailBlob)}componentWillUnmount(){l.a.off("clientUpdateDocumentThumbnailBlob",this.onClientUpdateDocumentThumbnailBlob),l.a.off("clientUpdateAudioThumbnailBlob",this.onClientUpdateDocumentThumbnailBlob)}render(){const e=this.props,t=e.minithumbnail,a=e.thumbnail,n=e.file,i=e.icon,l=e.completeIcon,d=e.openMedia,h=this.state.loaded,u=t?"data:image/jpeg;base64, "+t.data:null,p=Object(c.j)(a?a.photo:null),m=p&&h,g=p||u;return s.a.createElement("div",{className:o()("document-tile",{"document-tile-image":!g},{pointer:d}),onClick:d},n&&s.a.createElement(r.a,{file:n,thumbnailSrc:g,download:!0,upload:!0,cancelButton:!0,zIndex:1,icon:i,completeIcon:"function"===typeof l?l(g):l}),g&&s.a.createElement("img",{className:"tile-photo",src:g,onLoad:this.handleLoad,draggable:!1,alt:""}),!m&&s.a.createElement("div",{className:"document-tile-background"}))}}t.a=d},function(e,t,a){"use strict";var n=a(0),s=a.n(n),i=a(14),o=a(19),r=a(2),c=a(18);a(315);class l extends s.a.Component{constructor(e){super(e),this.onClientUpdateMediaEnd=e=>{const t=this.props,a=t.chatId,n=t.messageId,s=t.duration,i=this.state,o=(i.active,i.file);a===e.chatId&&n===e.messageId&&this.setState({active:!1,currentTime:0,timeString:this.getTimeString(0,s,!1,o)})},this.onClientUpdateMediaTime=e=>{const t=this.props,a=t.chatId,n=t.messageId,s=t.duration,i=this.state,o=i.active,r=i.file;if(a===e.chatId&&n===e.messageId){const t=e.duration>=0&&e.duration<1/0?e.duration:s;this.setState({currentTime:e.currentTime,duration:t,timeString:this.getTimeString(e.currentTime,t,o,r)})}},this.onClientUpdateMediaActive=e=>{const t=this.props,a=t.chatId,n=t.messageId,s=t.duration,i=this.state,o=i.active,r=i.currentTime,c=i.file;a===e.chatId&&n===e.messageId?this.setState({active:!0,currentTime:o?r:0,timeString:this.getTimeString(o?r:0,s,!0,c)}):o&&this.setState({active:!1,currentTime:0,timeString:this.getTimeString(0,s,!1,c)})},this.onUpdateFile=e=>{const t=this.state.file,a=e.file;t&&t.id===a.id&&this.setState({file:a,prevFile:t})},this.getTimeString=(e,t,a,n)=>{const s=n.local&&n.local.is_downloading_completed,i=(n.remote&&n.remote.is_uploading_completed,Object(o.e)(Math.floor(t||0))),r=Object(o.e)(Math.floor(e||0));return a&&s?"".concat(r,"/").concat(i):"".concat(i)};const t=c.b.message,a=c.b.time,n=this.props,s=n.chatId,i=n.messageId,l=n.duration,d=n.file,h=t&&t.chat_id===s&&t.id===i,u=h&&a?a.currentTime:0,p=h&&a&&a.duration?a.duration:l,m=r.a.get(d.id)||d;this.state={active:h,currentTime:u,duration:p,timeString:this.getTimeString(u,l,h,m),prevFile:null,file:m}}shouldComponentUpdate(e,t){const a=this.props.theme,n=this.state,s=n.active,i=n.timeString,o=n.file,r=n.prevFile;return e.theme!==a||(t.timeString!==i||(t.active!==s||(t.file!==o||t.prevFile!==r)))}componentDidMount(){r.a.on("updateFile",this.onUpdateFile),c.b.on("clientUpdateMediaActive",this.onClientUpdateMediaActive),c.b.on("clientUpdateMediaTime",this.onClientUpdateMediaTime),c.b.on("clientUpdateMediaEnd",this.onClientUpdateMediaEnd)}componentWillUnmount(){r.a.off("updateFile",this.onUpdateFile),c.b.off("clientUpdateMediaActive",this.onClientUpdateMediaActive),c.b.off("clientUpdateMediaTime",this.onClientUpdateMediaTime),c.b.off("clientUpdateMediaEnd",this.onClientUpdateMediaEnd)}render(){const e=this.props,t=e.title,a=e.meta,n=this.state,o=n.active,r=n.file,c=n.timeString;if(!r)return null;const l=r.local&&r.local.is_downloading_active,d=r.remote&&r.remote.is_uploading_active,h=r.local&&r.local.is_downloading_completed,u=(r.remote&&r.remote.is_uploading_completed,Object(i.g)(r));let p=null;l?p=Object(i.e)(r):d&&(p=Object(i.k)(r));const m=p?"".concat(p,"/").concat(u):"".concat(u);return s.a.createElement("div",{className:"audio-action"},!o&&s.a.createElement("span",null,t),!h&&s.a.createElement("span",null,"".concat(m,", ")),s.a.createElement("span",null,c),a)}}t.a=l},function(e,t,a){"use strict";var n=a(35),s=a(0),i=a.n(s),o=a(16),r=a.n(o),c=a(233),l=a.n(c),d=a(17),h=a(14),u=a(4),p=a(2);a(324);class m extends i.a.Component{constructor(...e){super(...e),this.onClientUpdateLocationBlob=e=>{const t=e.fileId,a=this.props,n=a.location,s=a.width,i=a.height,o=a.zoom,r=a.scale,c=Object(d.m)(n,s,i,o,r),l=p.a.getLocationFile(c);l&&l.id===t&&this.forceUpdate()},this.handleClick=e=>{e.stopPropagation()}}componentDidMount(){p.a.on("clientUpdateLocationBlob",this.onClientUpdateLocationBlob)}componentWillUnmount(){p.a.off("clientUpdateLocationBlob",this.onClientUpdateLocationBlob)}render(){const e=this.props,t=e.location,a=e.width,s=e.height,o=e.zoom,c=e.scale,u=e.type,m=e.style,g=e.title,f=e.caption;if(!t)return null;const b=Object(d.m)(t,a,s,o,c),C=p.a.getLocationFile(b),y=Object(h.j)(C),v=t.longitude,E=t.latitude,S="https://maps.google.com/?q=".concat(E,",").concat(v),U=Object(n.a)({width:a,height:s},m);return i.a.createElement("div",{className:r()("location",{"location-message":"message"===u,"location-venue":"venue"===u,"location-title":g,"location-caption":f}),style:U},i.a.createElement("a",{href:S,target:"_blank",rel:"noopener noreferrer",onClick:this.handleClick},i.a.createElement("div",{className:"location-wrapper"},i.a.createElement("img",{className:"location-image",draggable:!1,alt:S,src:y}),i.a.createElement("div",{className:"location-icon"},i.a.createElement(l.a,{fontSize:"large",color:"primary"})))))}}m.defaultProps={width:u.p,height:u.n,zoom:u.q,scale:u.o},t.a=m},,,function(e,t,a){"use strict";var n=a(0),s=a.n(n),i=a(10),o=a(84),r=a(196),c=a(28),l=a(22);a(331);class d extends s.a.Component{constructor(e){super(e),this.handleClick=()=>{const e=this.props,t=e.userId,a=e.onSelect;a&&a(t)},this.state={user:l.a.get(e.userId)}}shouldComponentUpdate(e,t){return e.userId!==this.props.userId}render(){const e=this.props,t=e.userId,a=e.t,n=e.showStatus,i=Object(c.c)(t,null,a);return s.a.createElement("div",{className:"user",onClick:this.handleClick},s.a.createElement("div",{className:"user-wrapper"},s.a.createElement(o.a,{userId:t}),s.a.createElement("div",{className:"user-inner-wrapper"},s.a.createElement("div",{className:"tile-first-row"},s.a.createElement("div",{className:"user-title"},i)),n&&s.a.createElement("div",{className:"tile-second-row"},s.a.createElement(r.a,{userId:t})))))}}d.defaultProps={showStatus:!0},t.a=Object(i.c)()(d)},function(e,t,a){"use strict";var n=a(35),s=a(0),i=a.n(s),o=a(16),r=a.n(o),c=a(115),l=a(19),d=a(14),h=a(37),u=a(4),p=a(2);a(340);class m extends i.a.Component{constructor(...e){super(...e),this.onClientUpdateVideoThumbnailBlob=e=>{const t=this.props.video.thumbnail,a=e.fileId;t&&t.photo&&t.photo.id===a&&this.forceUpdate()}}componentDidMount(){p.a.on("clientUpdateVideoThumbnailBlob",this.onClientUpdateVideoThumbnailBlob)}componentWillUnmount(){p.a.off("clientUpdateVideoThumbnailBlob",this.onClientUpdateVideoThumbnailBlob)}render(){const e=this.props,t=e.displaySize,a=e.openMedia,s=e.title,o=e.caption,u=e.type,p=e.style,m=this.props.video,g=m.minithumbnail,f=m.thumbnail,b=m.video,C=m.width,y=m.height,v=m.duration,E=Object(l.f)({width:C,height:y}||f,t);if(!E)return null;const S=Object(n.a)({width:E.width,height:E.height},p),U=g?"data:image/jpeg;base64, "+g.data:null,k=Object(d.j)(f?f.photo:null),w=k?Object(h.h)(f):Boolean(U);return i.a.createElement("div",{className:r()("video",{"video-big":"message"===u,"video-title":s,"video-caption":o,pointer:a}),style:S,onClick:a},i.a.createElement("img",{className:r()("video-preview",{"media-blurred":w,"media-mini-blurred":!k&&w}),src:k||U,alt:""}),i.a.createElement("div",{className:"video-play"},i.a.createElement(c.a,null)),i.a.createElement("div",{className:"video-meta"},Object(l.e)(v)+" "+Object(d.g)(b)))}}m.defaultProps={size:u.F,displaySize:u.D},t.a=m},,,function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return i})),a.d(t,"c",(function(){return o}));var n=a(1);function s(e,t,a){n.a.send({"@type":"setPollAnswer",chat_id:e,message_id:t,option_ids:a})}function i(e,t){n.a.send({"@type":"setPollAnswer",chat_id:e,message_id:t,option_ids:[]})}function o(e,t){n.a.send({"@type":"stopPoll",chat_id:e,message_id:t,reply_markup:null})}},,,,,,,,function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return o}));var n=a(4);function s(e){if(!e)return!1;const t=e.question,a=e.options;if(!function(e){return!!e&&e.length<=n.R}(t))return!1;const s=a.filter(e=>Boolean(e.text));return!(s.length<=1)&&s.every(i)}function i(e){return!!e&&(!!e.text&&e.text.length<=n.O)}function o(e){if(!e)return!1;const t=e.question,a=e.options;return!!t||a.some(e=>Boolean(e.text))}},,,,,,,,function(e,t,a){"use strict";var n=a(0),s=a.n(n),i=a(68),o=a(4),r=a(1);a(465);class c extends s.a.Component{constructor(...e){super(...e),this.state={emoji:null,prevPropsSticker:null},this.loadStickerEmojis=e=>{const t=e.sticker.id;r.a.send({"@type":"getStickerEmojis",sticker:{"@type":"inputFileId",id:t}}).then(t=>{this.props.sticker===e&&this.setState({emoji:t.emojis.join(" ")})})}}static getDerivedStateFromProps(e,t){const a=e.sticker,n=t.prevPropsSticker;return a&&n?{prevPropsSticker:a,emoji:null}:null}componentDidUpdate(e,t,a){const n=this.props.sticker;n&&n!==e.sticker&&this.loadStickerEmojis(n)}componentDidMount(){const e=this.props.sticker;e&&this.loadStickerEmojis(e)}render(){const e=this.props.sticker,t=this.state.emoji;return e?s.a.createElement("div",{className:"sticker-preview"},s.a.createElement("div",{className:"sticker-preview-emoji"},t),s.a.createElement(i.b,{sticker:e,displaySize:o.lb,source:i.a.PREVIEW})):null}}t.a=c},,,,,,,,function(e,t,a){"use strict";const n=new function(){this.utf16={decode:function(e){for(var t,a,n=[],s=0,i=e.length;s<i;){if(55296===(63488&(t=e.charCodeAt(s++)))){if(a=e.charCodeAt(s++),55296!==(64512&t)||56320!==(64512&a))throw new RangeError("UTF-16(decode): Illegal UTF-16 sequence");t=((1023&t)<<10)+(1023&a)+65536}n.push(t)}return n},encode:function(e){for(var t,a=[],n=0,s=e.length;n<s;){if(55296===(63488&(t=e[n++])))throw new RangeError("UTF-16(encode): Illegal UTF-16 value");t>65535&&(t-=65536,a.push(String.fromCharCode(t>>>10&1023|55296)),t=56320|1023&t),a.push(String.fromCharCode(t))}return a.join("")}};var e=2147483647;function t(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function a(e,t,a){var n;for(e=a?Math.floor(e/700):e>>1,e+=Math.floor(e/t),n=0;e>455;n+=36)e=Math.floor(e/35);return Math.floor(n+36*e/(e+38))}this.decode=function(t,n){var s,i,o,r,c,l,d,h,u,p,m,g,f,b,C=[],y=[],v=t.length;for(s=128,o=0,r=72,(c=t.lastIndexOf("-"))<0&&(c=0),l=0;l<c;++l){if(n&&(y[C.length]=t.charCodeAt(l)-65<26),t.charCodeAt(l)>=128)throw new RangeError("Illegal input >= 0x80");C.push(t.charCodeAt(l))}for(d=c>0?c+1:0;d<v;){for(h=o,u=1,p=36;;p+=36){if(d>=v)throw RangeError("punycode_bad_input(1)");if((m=(b=t.charCodeAt(d++))-48<10?b-22:b-65<26?b-65:b-97<26?b-97:36)>=36)throw RangeError("punycode_bad_input(2)");if(m>Math.floor((e-o)/u))throw RangeError("punycode_overflow(1)");if(o+=m*u,m<(g=p<=r?1:p>=r+26?26:p-r))break;if(u>Math.floor(e/(36-g)))throw RangeError("punycode_overflow(2)");u*=36-g}if(r=a(o-h,i=C.length+1,0===h),Math.floor(o/i)>e-s)throw RangeError("punycode_overflow(3)");s+=Math.floor(o/i),o%=i,n&&y.splice(o,0,t.charCodeAt(d-1)-65<26),C.splice(o,0,s),o++}if(n)for(o=0,f=C.length;o<f;o++)y[o]&&(C[o]=String.fromCharCode(C[o]).toUpperCase().charCodeAt(0));return this.utf16.encode(C)},this.encode=function(n,s){var i,o,r,c,l,d,h,u,p,m,g,f;s&&(f=this.utf16.decode(n));var b=(n=this.utf16.decode(n.toLowerCase())).length;if(s)for(d=0;d<b;d++)f[d]=n[d]!=f[d];var C,y,v=[];for(i=128,o=0,l=72,d=0;d<b;++d)n[d]<128&&v.push(String.fromCharCode(f?(C=n[d],y=f[d],(C-=(C-97<26)<<5)+((!y&&C-65<26)<<5)):n[d]));for(r=c=v.length,c>0&&v.push("-");r<b;){for(h=e,d=0;d<b;++d)(g=n[d])>=i&&g<h&&(h=g);if(h-i>Math.floor((e-o)/(r+1)))throw RangeError("punycode_overflow (1)");for(o+=(h-i)*(r+1),i=h,d=0;d<b;++d){if((g=n[d])<i&&++o>e)return Error("punycode_overflow(2)");if(g==i){for(u=o,p=36;!(u<(m=p<=l?1:p>=l+26?26:p-l));p+=36)v.push(String.fromCharCode(t(m+(u-m)%(36-m),0))),u=Math.floor((u-m)/(36-m));v.push(String.fromCharCode(t(u,s&&f[d]?1:0))),l=a(o,r+1,r==c),o=0,++r}}++o,++i}return v.join("")},this.ToASCII=function(e){for(var t=e.split("."),a=[],s=0;s<t.length;++s){var i=t[s];a.push(i.match(/[^A-Za-z0-9-]/)?"xn--"+n.encode(i):i)}return a.join(".")},this.ToUnicode=function(e){for(var t=e.split("."),a=[],s=0;s<t.length;++s){var i=t[s];a.push(i.match(/^xn--/)?n.decode(i.slice(4)):i)}return a.join(".")}};t.a=n},function(e,t,a){"use strict";a.r(t);var n=a(125),s=a(35),i=a(0),o=a.n(i),r=a(198),c=a.n(r);a(337);class l extends o.a.Component{componentDidMount(){const e=this.props,t=e.options,a=e.eventListeners,n=t.loop,i=t.autoplay,o=t.animationData,r=t.rendererSettings,l=t.segments;this.options={container:this.el,renderer:"svg",loop:Boolean(n),autoplay:Boolean(i),segments:Boolean(l),animationData:o,rendererSettings:r},this.options=Object(s.a)({},this.options,{},t),this.anim=c.a.loadAnimation(this.options),this.registerEvents(a)}componentWillUpdate(e,t,a){this.options.animationData===e.options.animationData&&this.options.path===e.options.path||(this.unregisterEvents(this.props.eventListeners),this.destroy(),this.options=Object(s.a)({},this.options,{},e.options),this.anim=c.a.loadAnimation(this.options),this.registerEvents(e.eventListeners))}componentDidUpdate(e,t,a){this.setSpeed(),this.setDirection()}componentWillUnmount(){this.unregisterEvents(this.props.eventListeners),this.destroy(),this.options.animationData=null,this.options.path=null,this.anim=null}getCurrentRawFrame(){return this.anim.currentRawFrame}getCurrentFrame(){return this.anim.currentFrame}setSpeed(){this.anim.setSpeed(this.props.speed)}setDirection(){this.anim.setDirection(this.props.direction)}play(){this.anim.play()}playSegments(e,t){this.anim.playSegments(e,t)}stop(){this.anim.stop()}pause(){return!this.anim.isPaused&&(this.anim.pause(),!0)}destroy(){this.anim.destroy()}registerEvents(e){this.anim&&e&&e.forEach(({eventName:e,callback:t})=>{this.anim.addEventListener(e,t)})}unregisterEvents(e){this.anim&&e&&e.forEach(({eventName:e,callback:t})=>{this.anim.removeEventListener(e,t)})}render(){const e=this.props,t=e.width,a=e.height,i=e.ariaRole,r=e.ariaLabel,c=e.title,l=(e.eventListeners,e.onComplete,e.onMouseEnter),d=e.onMouseOut,h=Object(n.a)(e,["width","height","ariaRole","ariaLabel","title","eventListeners","onComplete","onMouseEnter","onMouseOut"]),u=e=>{let t;return t="number"===typeof e?"".concat(e,"px"):e||"100%",t},p=Object(s.a)({width:u(t),height:u(a),overflow:"hidden",margin:"0 auto",outline:"none"},this.props.style);return o.a.createElement("div",Object.assign({ref:e=>{this.el=e},style:p,title:c,role:i,"aria-label":r,tabIndex:"0"},h,{onMouseEnter:l,onMouseOut:d}))}}l.defaultProps={eventListeners:[],speed:1,ariaRole:"button",ariaLabel:"animation",title:""},t.default=l},function(e,t,a){"use strict";var n=a(0),s=a.n(n),i=a(16),o=a.n(i),r=a(153),c=a.n(r),l=a(94),d=a(272),h=a(74),u=a(123),p=a(14),m=a(37),g=a(19),f=a(4),b=a(18),C=a(2),y=a(8),v=a(7),E=(a(341),a(44));const S={circle:"video-note-progress-circle"};class U extends s.a.Component{constructor(e){super(e),this.startStopPlayer=()=>{const e=this.videoRef.current;if(e)if(!this.inView||!this.windowFocused||this.openMediaViewer||this.openProfileMediaViewer||this.openIV){if(this.state.active)return;e.pause()}else e.play()},this.onClientUpdateInstantViewContent=e=>{this.openIV=Boolean(E.a.getCurrent()),this.startStopPlayer()},this.onClientUpdateProfileMediaViewerContent=e=>{this.openProfileMediaViewer=Boolean(v.a.profileMediaViewerContent),this.startStopPlayer()},this.onClientUpdateMediaViewerContent=e=>{this.openMediaViewer=Boolean(v.a.mediaViewerContent),this.startStopPlayer()},this.onClientUpdateFocusWindow=e=>{this.windowFocused=e.focused,this.startStopPlayer()},this.onClientUpdateMessagesInView=e=>{const t=this.props,a=t.chatId,n=t.messageId,s="".concat(a,"_").concat(n);this.inView=e.messages.has(s),this.startStopPlayer()},this.onClientUpdateMediaCaptureStream=e=>{const t=this.props,a=t.chatId,n=t.messageId;if(a===e.chatId&&n===e.messageId){this.videoRef.current&&this.setState({srcObject:e.stream},()=>{this.updateVideoSrc()})}},this.onClientUpdateMediaTime=e=>{const t=this.props,a=t.chatId,n=t.messageId;if(a===e.chatId&&n===e.messageId){this.videoRef.current&&this.setState({currentTime:e.currentTime,videoDuration:e.duration})}},this.onClientUpdateMediaEnd=e=>{const t=this.props,a=t.chatId,n=t.messageId;a===e.chatId&&n===e.messageId&&this.setState({active:!1,srcObject:null,currentTime:0},()=>{const e=this.videoRef.current;e&&(this.updateVideoSrc(),window.hasFocus||e.pause())})},this.onClientUpdateMediaActive=e=>{const t=this.props,a=t.chatId,n=t.messageId;this.props.videoNote.video;a===e.chatId&&n===e.messageId?this.state.active||this.setState({active:!0,currentTime:null}):this.state.active&&this.setState({active:!1,srcObject:null,currentTime:0},()=>{const e=this.videoRef.current;e&&(this.updateVideoSrc(),window.hasFocus||e.pause())})},this.onClientUpdateVideoNoteBlob=e=>{const t=this.props.videoNote.video,a=e.fileId;t&&t.id===a&&this.setState({src:Object(p.j)(t)},()=>{this.updateVideoSrc()})},this.onClientUpdateVideoNoteThumbnailBlob=e=>{const t=this.props.videoNote.thumbnail;if(!t)return;const a=e.fileId;t.photo&&t.photo.id===a&&this.forceUpdate()},this.handleCanPlay=()=>{},this.videoRef=s.a.createRef();const t=e.chatId,a=e.messageId,n=e.videoNote.video,i=b.b.time,o=b.b.message,r=b.b.videoStream,c=o&&o.chat_id===t&&o.id===a;this.state={active:c,srcObject:c?r:null,src:Object(p.j)(n),currentTime:c&&i?i.currentTime:0,videoDuration:c&&i?i.duration:0},this.windowFocused=window.hasFocus,this.inView=!1,this.openMediaViewer=Boolean(v.a.mediaViewerContent),this.openProfileMediaViewer=Boolean(v.a.profileMediaViewerContent),this.openIV=Boolean(E.a.getCurrent())}updateVideoSrc(){const e=this.state,t=e.srcObject,a=e.src,n=this.videoRef.current;if(!n)return;if(t)return void(n.srcObject=t);const s=n.srcObject;if(s){s.getTracks().forEach(e=>{e.stop()})}n.srcObject&&(n.srcObject=null),n.src!==a&&(n.src=a)}componentDidMount(){this.updateVideoSrc(),C.a.on("clientUpdateVideoNoteThumbnailBlob",this.onClientUpdateVideoNoteThumbnailBlob),C.a.on("clientUpdateVideoNoteBlob",this.onClientUpdateVideoNoteBlob),y.a.on("clientUpdateMessagesInView",this.onClientUpdateMessagesInView),v.a.on("clientUpdateFocusWindow",this.onClientUpdateFocusWindow),v.a.on("clientUpdateMediaViewerContent",this.onClientUpdateMediaViewerContent),v.a.on("clientUpdateProfileMediaViewerContent",this.onClientUpdateProfileMediaViewerContent),E.a.on("clientUpdateInstantViewContent",this.onClientUpdateInstantViewContent),b.b.on("clientUpdateMediaActive",this.onClientUpdateMediaActive),b.b.on("clientUpdateMediaCaptureStream",this.onClientUpdateMediaCaptureStream),b.b.on("clientUpdateMediaTime",this.onClientUpdateMediaTime),b.b.on("clientUpdateMediaEnd",this.onClientUpdateMediaEnd)}componentWillUnmount(){C.a.off("clientUpdateVideoNoteThumbnailBlob",this.onClientUpdateVideoNoteThumbnailBlob),C.a.off("clientUpdateVideoNoteBlob",this.onClientUpdateVideoNoteBlob),y.a.off("clientUpdateMessagesInView",this.onClientUpdateMessagesInView),v.a.off("clientUpdateFocusWindow",this.onClientUpdateFocusWindow),v.a.off("clientUpdateMediaViewerContent",this.onClientUpdateMediaViewerContent),v.a.off("clientUpdateProfileMediaViewerContent",this.onClientUpdateProfileMediaViewerContent),E.a.off("clientUpdateInstantViewContent",this.onClientUpdateInstantViewContent),b.b.off("clientUpdateMediaActive",this.onClientUpdateMediaActive),b.b.off("clientUpdateMediaCaptureStream",this.onClientUpdateMediaCaptureStream),b.b.off("clientUpdateMediaTime",this.onClientUpdateMediaTime),b.b.off("clientUpdateMediaEnd",this.onClientUpdateMediaEnd)}render(){const e=this.props,t=(e.displaySize,e.chatId),a=e.messageId,n=e.openMedia,i=this.state,r=i.active,f=i.currentTime,b=i.videoDuration,C=this.props.videoNote,v=C.minithumbnail,E=C.thumbnail,U=C.video,k=C.duration;if(!y.a.get(t,a))return null;const w={width:200,height:200};if(!w)return null;const M=v?"data:image/jpeg;base64, "+v.data:null,I=Object(p.j)(E?E.photo:null),_=Object(p.j)(U),x=I?Object(m.h)(E):Boolean(M);let O=0;if(b&&f){O=(f+.25)/b*100}return s.a.createElement("div",{className:o()("video-note",{"video-note-playing":r}),style:w,onClick:n},_?s.a.createElement(s.a.Fragment,null,s.a.createElement("video",{ref:this.videoRef,className:o()("media-viewer-content-image","video-note-round"),poster:I||M,muted:!0,autoPlay:!0,loop:!0,playsInline:!0,width:w.width,height:w.height,onCanPlay:this.handleCanPlay}),s.a.createElement("div",{className:"video-note-player"},s.a.createElement("div",{className:"video-note-progress"},s.a.createElement(d.a,{classes:S,variant:"static",value:O,size:200,thickness:1})),s.a.createElement("div",{className:"animation-meta"},Object(g.e)(r?Math.floor(f):k),s.a.createElement(u.a,{chatId:t,messageId:a,icon:"\xa0\u2022"})),s.a.createElement("div",{className:"video-note-muted"},s.a.createElement(c.a,null)))):s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"video-note-round"},s.a.createElement("img",{className:o()("animation-preview",{"media-blurred":x,"media-mini-blurred":!_&&!I&&x}),style:w,src:I||M,alt:""})),s.a.createElement("div",{className:"animation-meta"},Object(g.e)(k)+" "+Object(p.g)(U),s.a.createElement(u.a,{chatId:t,messageId:a,icon:"\xa0\u2022"})),s.a.createElement("div",{className:"video-note-muted"},s.a.createElement(c.a,null))),s.a.createElement(h.a,{file:U,download:!0,upload:!0,cancelButton:!0,icon:s.a.createElement(l.a,null)}))}}U.defaultProps={size:f.F,displaySize:f.D},t.a=U},function(e,t,a){"use strict";var n=a(0),s=a.n(n),i=a(94),o=a(115),r=a(134),c=a(135),l=a(18);a(342);class d extends s.a.Component{constructor(e){super(e),this.onClientUpdateMediaEnd=e=>{const t=this.props,a=t.chatId,n=t.messageId;a===e.chatId&&n===e.messageId&&this.setState({active:!1,playing:!1,currentTime:0})},this.onClientUpdateMediaPlay=e=>{const t=this.props,a=t.chatId,n=t.messageId;a===e.chatId&&n===e.messageId?this.setState({playing:!0}):this.setState({playing:!1})},this.onClientUpdateMediaPause=e=>{const t=this.props,a=t.chatId,n=t.messageId;a===e.chatId&&n===e.messageId&&this.setState({playing:!1})},this.onClientUpdateMediaActive=e=>{const t=this.props,a=t.chatId,n=t.messageId;a===e.chatId&&n===e.messageId?this.state.active||this.setState({active:!0,currentTime:0,playing:!0}):this.state.active&&this.setState({active:!1,currentTime:0,playing:!1})};const t=e.chatId,a=e.messageId,n=l.b.time,s=l.b.message,i=l.b.playing,o=s&&s.chat_id===t&&s.id===a;this.state={active:o,playing:!!o&&i,currentTime:o&&n?n.currentTime:0,duration:o&&n?n.duration:0}}componentDidMount(){l.b.on("clientUpdateMediaActive",this.onClientUpdateMediaActive),l.b.on("clientUpdateMediaPlay",this.onClientUpdateMediaPlay),l.b.on("clientUpdateMediaPause",this.onClientUpdateMediaPause),l.b.on("clientUpdateMediaEnd",this.onClientUpdateMediaEnd)}componentWillUnmount(){l.b.off("clientUpdateMediaActive",this.onClientUpdateMediaActive),l.b.off("clientUpdateMediaPlay",this.onClientUpdateMediaPlay),l.b.off("clientUpdateMediaPause",this.onClientUpdateMediaPause),l.b.off("clientUpdateMediaEnd",this.onClientUpdateMediaEnd)}render(){const e=this.props,t=e.file,a=e.openMedia,n=this.state.playing;return s.a.createElement(c.a,{thumbnail:null,file:t,openMedia:a,icon:s.a.createElement(i.a,null),completeIcon:n?s.a.createElement(r.a,null):s.a.createElement(o.a,null)})}}t.a=d},,,,,,,,,function(e,t,a){"use strict";var n=a(0),s=a.n(n),i=a(16),o=a.n(i),r=a(94),c=a(23),l=Object(c.a)(s.a.createElement("g",{fillRule:"evenodd"},s.a.createElement("path",{d:"M6,0 L33.5147186,0 C35.1060176,6.45011102e-15 36.632141,0.632141042 37.7573593,1.75735931 L52.2426407,16.2426407 C53.367859,17.367859 54,18.8939824 54,20.4852814 L54,48 C54,51.3137085 51.3137085,54 48,54 L6,54 C2.6862915,54 4.05812251e-16,51.3137085 0,48 L0,6 C-4.05812251e-16,2.6862915 2.6862915,6.08718376e-16 6,0 Z"}),s.a.createElement("path",{d:"M33.5147186,0 C35.1060176,6.45011102e-15 36.632141,0.632141042 37.7573593,1.75735931 L52.2426407,16.2426407 C53.367859,17.367859 54,18.8939824 54,20.4852814 L54,22 C54,19.790861 52.209139,18 50,18 L40,18 C37.790861,18 36,16.209139 36,14 L36,4 C36,1.790861 34.209139,-3.88578059e-16 32,0 L33.5147186,0 Z",fill:"#000000",style:{mixBlendMode:"normal"},opacity:"0.15"})),"Document"),d=a(135),h=a(14),u=a(2);a(320);class p extends s.a.Component{constructor(e){super(e),this.onUpdateFile=e=>{const t=this.state.file,a=e.file;t&&t.id===a.id&&this.setState({file:a,prevFile:t})};const t=this.props.file;this.state={prevPropsFile:t,prevFile:null,file:u.a.get(t.id)||t}}componentDidMount(){u.a.on("updateFile",this.onUpdateFile)}componentWillUnmount(){u.a.off("updateFile",this.onUpdateFile)}static getDerivedStateFromProps(e,t){const a=e.file,n=t.prevPropsFile;return a&&n&&a.id!==n.id?{prevPropsFile:a,prevFile:null,file:u.a.get(a.id)||a}:null}shouldComponentUpdate(e,t){const a=this.props.theme,n=this.state,s=n.file,i=n.prevFile;return e.theme!==a||(t.file!==s||t.prevFile!==i)}render(){const e=this.props.meta,t=this.state.file;if(!t)return null;const a=t.local&&t.local.is_downloading_active,n=t.remote&&t.remote.is_uploading_active,i=Object(h.g)(t);let o=null;a?o=Object(h.e)(t):n&&(o=Object(h.k)(t));const r=o?"".concat(o,"/").concat(i):"".concat(i);return s.a.createElement("div",{className:"document-action"},s.a.createElement("span",null,r),e)}}var m=p;a(321);class g extends s.a.Component{render(){const e=this.props,t=e.document,a=e.openMedia,n=e.width,i=e.height,c=e.meta,u=e.title,p=e.caption;if(!t)return null;const g=t.minithumbnail,f=t.thumbnail,b=t.file_name,C=t.document,y=n&&i?{width:n,height:i}:null;return s.a.createElement("div",{className:o()("document",{"media-title":u}),style:y},s.a.createElement(d.a,{minithumbnail:g,thumbnail:f,file:C,openMedia:a,icon:s.a.createElement(r.a,null),completeIcon:e=>e?null:s.a.createElement("div",{className:"document-tile-complete-icon"},s.a.createElement(l,{className:"document-tile-icon-fill",viewBox:"0 0 54 54"}),s.a.createElement("div",{className:"document-tile-file-ext"},Object(h.f)(b)))}),s.a.createElement("div",{className:"document-content"},s.a.createElement("div",{className:"document-title"},s.a.createElement("a",{className:"document-name",onClick:a,title:b,"data-name":b,"data-ext":"."+Object(h.f)(b)},b)),s.a.createElement(m,{file:C,meta:p?null:c})))}}t.a=g},function(e,t,a){"use strict";var n=a(0),s=a.n(n),i=a(16),o=a.n(i),r=a(136),c=a(171),l=a(123),d=a(552),h=a(4),u=a(18);a(343);class p extends s.a.Component{constructor(e){super(e),this.reset=()=>{const e=this.props.duration;1===this.state.value?(this.setState({active:!1,currentTime:0}),setTimeout(()=>{this.state.currentTime||this.setState({value:this.getValue(0,e,!1)})},h.J)):this.setState({active:!1,currentTime:0,value:this.getValue(0,e,!1)})},this.onClientUpdateMediaEnd=e=>{const t=this.props,a=t.chatId,n=t.messageId;a===e.chatId&&n===e.messageId&&this.reset()},this.onClientUpdateMediaTime=e=>{const t=this.props,a=t.chatId,n=t.messageId,s=t.duration,i=this.state.active;if(a===e.chatId&&n===e.messageId){const t=e.duration>=0&&e.duration<1/0?e.duration:s,a=this.getValue(e.currentTime,t,i);this.setState({currentTime:e.currentTime,duration:t,value:a})}},this.onClientUpdateMediaActive=e=>{const t=this.props,a=t.chatId,n=t.messageId,s=t.duration,i=this.state,o=i.active,r=i.currentTime;if(a===e.chatId&&n===e.messageId){const t=e.duration>=0&&e.duration<1/0?e.duration:s,a=this.getValue(o?r:0,t,!0);this.setState({active:!0,currentTime:o?r:0,value:a})}else o&&this.reset()},this.getValue=(e,t,a)=>a?e/t:0;const t=u.b.message,a=u.b.time,n=this.props,s=n.chatId,i=n.messageId,o=n.duration,r=t&&t.chat_id===s&&t.id===i,c=r&&a?a.currentTime:0,l=r&&a&&a.duration?a.duration:o;this.state={active:r,currentTime:c,duration:l,value:this.getValue(c,l,r)}}shouldComponentUpdate(e,t){const a=this.state,n=a.active,s=a.value;return t.value!==s||t.active!==n}componentDidMount(){u.b.on("clientUpdateMediaActive",this.onClientUpdateMediaActive),u.b.on("clientUpdateMediaTime",this.onClientUpdateMediaTime),u.b.on("clientUpdateMediaEnd",this.onClientUpdateMediaEnd)}componentWillUnmount(){u.b.off("clientUpdateMediaActive",this.onClientUpdateMediaActive),u.b.off("clientUpdateMediaTime",this.onClientUpdateMediaTime),u.b.off("clientUpdateMediaEnd",this.onClientUpdateMediaEnd)}render(){const e=this.state.value;return s.a.createElement("div",{className:"voice-note-slider"},s.a.createElement(d.a,{className:"voice-note-slider-component",classes:{track:"voice-note-slider-track",thumb:"voice-note-slider-thumb"},min:0,max:1,value:e}))}}var m=p;a(344);class g extends s.a.Component{render(){const e=this.props,t=e.chatId,a=e.messageId,n=e.voiceNote,i=e.openMedia,d=e.title,h=e.meta,u=e.caption;if(!n)return null;const p=n.duration,g=n.voice;return s.a.createElement("div",{className:o()("voice-note","document",{"media-title":d})},s.a.createElement(c.a,{chatId:t,messageId:a,file:g,openMedia:i}),s.a.createElement("div",{className:"voice-note-content"},s.a.createElement(m,{chatId:t,messageId:a,duration:p,file:g}),s.a.createElement("div",{className:"voice-note-meta"},s.a.createElement(r.a,{chatId:t,messageId:a,duration:p,file:g}),s.a.createElement(l.a,{chatId:t,messageId:a,icon:"\xa0\u2022"}),!u&&h)))}}t.a=g},,,,,,,,,,,,function(e,t,a){},function(e,t,a){},,function(e,t,a){"use strict";var n=a(0),s=a.n(n),i=a(16),o=a.n(i),r=a(28),c=a(22);a(330);class l extends s.a.Component{constructor(e){super(e),this.onUpdateUserStatus=e=>{const t=this.props.userId,a=c.a.get(t);t===e.user_id&&this.setState({status:Object(r.f)(a),isAccent:Object(r.i)(a)})};const t=this.props.userId,a=c.a.get(t);this.state={prevUserId:t,status:Object(r.f)(a),isAccent:Object(r.i)(a)}}static getDerivedStateFromProps(e,t){if(e.userId!==t.prevUserId){const t=e.userId,a=c.a.get(t);return{prevUserId:t,status:Object(r.f)(a),isAccent:Object(r.i)(a)}}return null}shouldComponentUpdate(e,t){const a=this.props.userId,n=this.state,s=n.status,i=n.isAccent;return e.userId!==a||(t.status!==s||t.isAccent!==i)}componentDidMount(){c.a.on("updateUserStatus",this.onUpdateUserStatus)}componentWillUnmount(){c.a.off("updateUserStatus",this.onUpdateUserStatus)}render(){const e=this.state,t=e.status,a=e.isAccent;return s.a.createElement("div",{className:o()("user-content","dialog-content",{"user-status-accent":a})},t)}}t.a=l},,,,,,,,,,,,,,,,,,,,function(e,t,a){},function(e,t,a){},,,,,,,function(e,t,a){"use strict";var n=a(0),s=a.n(n),i=a(23);t.a=Object(i.a)(s.a.createElement("path",{d:"M12,1 C18.0751322,1 23,5.92486775 23,12 C23,18.0751322 18.0751322,23 12,23 C5.92486775,23 1,18.0751322 1,12 C1,5.92486775 5.92486775,1 12,1 Z M12,3 C7.02943725,3 3,7.02943725 3,12 C3,16.9705627 7.02943725,21 12,21 C16.9705627,21 21,16.9705627 21,12 C21,7.02943725 16.9705627,3 12,3 Z M6.66607426,13.6501686 C7.13342047,13.4117012 7.7055954,13.5972442 7.94406273,14.0645904 C8.71613228,15.5776856 10.2710663,16.5499921 12,16.5499921 C13.7262991,16.5499921 15.2792455,15.5806677 16.0525854,14.0711462 C16.2918118,13.6041881 16.8642875,13.419575 17.3312456,13.6588014 C17.7982037,13.8980278 17.9828168,14.4705034 17.7435904,14.9374615 C16.6482438,17.0755242 14.4462205,18.4499921 12,18.4499921 C9.55003677,18.4499921 7.34521255,17.0713067 6.2516524,14.928157 C6.01318507,14.4608108 6.19872805,13.8886359 6.66607426,13.6501686 Z M8.75,8 C9.44035594,8 10,8.67157288 10,9.5 C10,10.3284271 9.44035594,11 8.75,11 C8.05964406,11 7.5,10.3284271 7.5,9.5 C7.5,8.67157288 8.05964406,8 8.75,8 Z M15.25,8 C15.9403559,8 16.5,8.67157288 16.5,9.5 C16.5,10.3284271 15.9403559,11 15.25,11 C14.5596441,11 14,10.3284271 14,9.5 C14,8.67157288 14.5596441,8 15.25,8 Z"}),"Smile")},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,,,,,,,,function(e,t,a){e.exports=function(){return new Worker(a.p+"2ad607ca1f48cc2f0b33.worker.js")}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){e.exports=a(482)},,,,,,,,,,,,,,,,,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,,,,,,,,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,,,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),i=a(33),o=a.n(i),r=a(269),c=a(120),l=a(6),d=a.n(l),h=a(13),u=a(24),p=a(10),m=a(92);var g=function(e){class t extends s.a.Component{render(){const t=m.a.i18n;return s.a.createElement(p.a,{i18n:t},s.a.createElement(e,this.props))}}return t.displayName="WithLanguage(".concat(Object(u.b)(e),")"),t},f=a(197),b=a.n(f),C=a(526),y=a(150),v=a(7);function E(e,t){let a={},n={};"light"===e&&(a={child:{color:"dark"===e?"currentColor":"rgba(112, 117, 121)"},rippleVisible:{opacity:.08},"@keyframes enter":{"0%":{transform:"scale(0)",opacity:.03},"100%":{transform:"scale(1)",opacity:.08}}},n={hover:"rgba(112, 117, 121, 0.08)",hoverOpacity:.08});const s=b()({palette:{type:e,primary:t,secondary:{main:"#E53935"},action:n},typography:{useNextVariants:!0},shape:{borderRadius:8},overrides:{MuiOutlinedInput:{input:{padding:"17.5px 14px"}},MuiAutocomplete:{option:{paddingLeft:0,paddingTop:0,paddingRight:0,paddingBottom:0},paper:{"& > ul":{maxHeight:308}}},MuiMenuList:{root:{minWidth:150}},MuiList:{root:{minWidth:150}},MuiTouchRipple:a}});return"dark"===e?function(e){const t=document.documentElement.style;t.setProperty("--text-primary",e.palette.text.primary),t.setProperty("--text-secondary",e.palette.text.secondary),t.setProperty("--text-disabled",e.palette.text.disabled),t.setProperty("--error","#E53935"),t.setProperty("--tile-size","54px"),t.setProperty("--user-tile-size","48px"),t.setProperty("--tile-size-extra-small","16px"),t.setProperty("--tile-size-small","33px"),t.setProperty("--tile-size-big","120px"),t.setProperty("--z-index-modal",e.zIndex.modal),t.setProperty("--color-accent-main",e.palette.primary.main),t.setProperty("--color-accent-main22",e.palette.primary.main+"22"),t.setProperty("--color-accent-dark",e.palette.primary.dark),t.setProperty("--color-accent-light",e.palette.primary.light),t.setProperty("--color-grey700",e.palette.grey[700]),t.setProperty("--color-grey","#9AA7B2"),t.setProperty("--color-search-input","#424242"),t.setProperty("--header-color","#ffffff"),t.setProperty("--header-subtle-color",e.palette.text.secondary),t.setProperty("--badge-unmuted","#4DCD5E"),t.setProperty("--badge-muted","rgba(255, 255, 255, 0.5)"),t.setProperty("--online-indicator","#0AC630"),t.setProperty("--message-service-color","#FFFFFF"),t.setProperty("--message-service-background","#303030"),t.setProperty("--panel-background","#303030"),t.setProperty("--border",e.palette.divider),t.setProperty("--chat-background",e.palette.grey[900]),t.setProperty("--background",e.palette.grey[900]),t.setProperty("--background-paper",e.palette.background.paper),t.setProperty("--shared-media-background",e.palette.background.paper),t.setProperty("--dialog-color","#ffffff"),t.setProperty("--dialog-subtle-color",e.palette.text.secondary),t.setProperty("--dialog-meta-color",e.palette.text.secondary),t.setProperty("--dialog-meta-read-color","#4FAE4E"),t.setProperty("--media-in-tile-background",e.palette.primary.main),t.setProperty("--media-out-tile-background",e.palette.primary.main),t.setProperty("--message-in-link",e.palette.primary.main),t.setProperty("--message-in-author",e.palette.primary.main),t.setProperty("--message-in-background","#303030"),t.setProperty("--message-in-color","#FFFFFF"),t.setProperty("--message-in-subtle-color","rgba(255, 255, 255, 0.7)"),t.setProperty("--message-in-meta-color","rgba(255, 255, 255, 0.7)"),t.setProperty("--message-in-reply-title",e.palette.primary.main),t.setProperty("--message-in-reply-border",e.palette.primary.main),t.setProperty("--message-in-control",e.palette.primary.main),t.setProperty("--message-in-control-hover",e.palette.primary.main+"22"),t.setProperty("--message-in-control-border",e.palette.primary.main+"77"),t.setProperty("--message-in-control-border-hover",e.palette.primary.main),t.setProperty("--message-out-link",e.palette.primary.main),t.setProperty("--message-out-author",e.palette.primary.main),t.setProperty("--message-out-background","#303030"),t.setProperty("--message-out-color","#FFFFFF"),t.setProperty("--message-out-subtle-color","rgba(255, 255, 255, 0.7)"),t.setProperty("--message-out-meta-color","rgba(255, 255, 255, 0.7)"),t.setProperty("--message-out-reply-title",e.palette.primary.main),t.setProperty("--message-out-reply-border",e.palette.primary.main),t.setProperty("--message-out-control",e.palette.primary.main),t.setProperty("--message-out-control-hover",e.palette.primary.main+"22"),t.setProperty("--message-out-control-border",e.palette.primary.main+"77"),t.setProperty("--message-out-control-border-hover",e.palette.primary.main)}(s):function(e){const t=document.documentElement.style;t.setProperty("--text-primary","#000000"),t.setProperty("--text-secondary","#707579"),t.setProperty("--text-disabled","rgba(0, 0, 0, 0.38)"),t.setProperty("--error","#E53935"),t.setProperty("--tile-size","54px"),t.setProperty("--user-tile-size","48px"),t.setProperty("--tile-size-extra-small","16px"),t.setProperty("--tile-size-small","33px"),t.setProperty("--tile-size-big","120px"),t.setProperty("--z-index-modal",e.zIndex.modal),t.setProperty("--color-accent-main",e.palette.primary.main),t.setProperty("--color-accent-main22",e.palette.primary.main+"22"),t.setProperty("--color-accent-dark",e.palette.primary.dark),t.setProperty("--color-accent-light",e.palette.primary.light),t.setProperty("--color-grey700",e.palette.grey[700]),t.setProperty("--color-grey","#9AA7B2"),t.setProperty("--color-search-input","#f4f4f5"),t.setProperty("--header-color","#000000"),t.setProperty("--header-subtle-color","#707579"),t.setProperty("--badge-unmuted","#4DCD5E"),t.setProperty("--badge-muted","#C4C9CC"),t.setProperty("--online-indicator","#0AC630"),t.setProperty("--message-service-color","#FFFFFF"),t.setProperty("--message-service-background","#00000033"),t.setProperty("--panel-background","#ffffff"),t.setProperty("--border","#DADCE0"),t.setProperty("--chat-background","#e6ebee"),t.setProperty("--background","#ffffff"),t.setProperty("--background-paper",e.palette.background.paper),t.setProperty("--shared-media-background",e.palette.background.default),t.setProperty("--dialog-color","#000000"),t.setProperty("--dialog-subtle-color","#707579"),t.setProperty("--dialog-meta-color","#5F6369"),t.setProperty("--dialog-meta-read-color","#4FAE4E"),t.setProperty("--media-in-tile-background",e.palette.primary.main),t.setProperty("--media-out-tile-background","#4FAE4E"),t.setProperty("--message-in-link",e.palette.primary.main),t.setProperty("--message-in-author",e.palette.primary.main),t.setProperty("--message-in-background","#FFFFFF"),t.setProperty("--message-in-color","#000000"),t.setProperty("--message-in-subtle-color","#707579"),t.setProperty("--message-in-meta-color","#8D969C"),t.setProperty("--message-in-reply-title",e.palette.primary.main),t.setProperty("--message-in-reply-border",e.palette.primary.main),t.setProperty("--message-in-control",e.palette.primary.main),t.setProperty("--message-in-control-hover",e.palette.primary.main+"22"),t.setProperty("--message-in-control-border",e.palette.primary.main+"77"),t.setProperty("--message-in-control-border-hover",e.palette.primary.main),t.setProperty("--message-out-link","#4FAE4E"),t.setProperty("--message-out-author","#4FAE4E"),t.setProperty("--message-out-background","#EEFFDE"),t.setProperty("--message-out-color","#000000"),t.setProperty("--message-out-subtle-color","#4FAE4E"),t.setProperty("--message-out-meta-color","#4FAE4E"),t.setProperty("--message-out-reply-title","#4FAE4E"),t.setProperty("--message-out-reply-border","#4FAE4E"),t.setProperty("--message-out-control","#4FAE4E"),t.setProperty("--message-out-control-hover","#4FAE4E22"),t.setProperty("--message-out-control-border","#4FAE4E77"),t.setProperty("--message-out-control-border-hover","#4FAE4E")}(s),s}var S=function(e){class t extends s.a.Component{constructor(e){super(e),this.onClientUpdateThemeChanging=e=>{const t=e.type,a=e.primary,n=E(t,a);localStorage.setItem("themeOptions",JSON.stringify({type:t,primary:a})),this.setState({theme:n},()=>v.a.emit("clientUpdateThemeChange"))};let t="light",a={main:"#50A2E9"};try{const e=JSON.parse(localStorage.getItem("themeOptions"));e&&(t=e.type,a=e.primary)}catch(s){}const n=E(t,a);this.state={theme:n}}componentDidMount(){v.a.on("clientUpdateThemeChanging",this.onClientUpdateThemeChanging)}componentWillUnmount(){v.a.off("clientUpdateThemeChanging",this.onClientUpdateThemeChanging)}render(){const t=this.state.theme;return s.a.createElement(y.b,{injectFirst:!0},s.a.createElement(C.a,{theme:t},s.a.createElement(e,this.props)))}}return t.displayName="WithTheme(".concat(Object(u.b)(e),")"),t},U=a(131),k=a.n(U),w=a(274),M=a(501),I=a(491),_=a(489),x=a(490),O=a(488),P=a(132),T=a(34);function N(){return(N=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function D(e,t){if(null==e)return{};var a,n,s=function(e,t){if(null==e)return{};var a,n,s={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(s[a]=e[a]);return s}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(s[a]=e[a])}return s}var L=s.a.createElement("g",{id:"Login",stroke:"none",strokeWidth:1,fillRule:"evenodd"},s.a.createElement("g",{id:"Login_5_Phone",transform:"translate(-760.000000, -186.000000)"},s.a.createElement("path",{d:"M840,346 C795.81722,346 760,310.18278 760,266 C760,221.81722 795.81722,186 840,186 C884.18278,186 920,221.81722 920,266 C920,310.18278 884.18278,346 840,346 Z M794.596303,264.66919 C790.659174,266.234556 788.596733,267.765936 788.408978,269.263329 C788.048509,272.138166 792.188142,273.033142 797.396667,274.725906 C801.643184,276.106018 807.355495,277.720609 810.325092,277.784753 C813.018799,277.842938 816.025284,276.732617 819.344546,274.453789 C841.998088,259.16492 853.691946,251.437186 854.426119,251.270588 C854.944065,251.153055 855.661811,251.005273 856.148118,251.437434 C856.634425,251.869594 856.586618,252.688022 856.535106,252.907586 C856.123224,254.663156 834.84286,274.015606 833.61816,275.287388 C828.938462,280.146996 823.615302,283.120543 831.826781,288.530755 C838.932147,293.212193 843.067503,296.19863 850.387542,300.996094 C855.065474,304.061953 858.733031,307.697601 863.562866,307.253237 C865.785287,307.048765 868.080902,304.959403 869.246762,298.727987 C872.002037,284.001293 877.417883,252.09303 878.669527,238.944397 C878.779187,237.792407 878.641237,236.318088 878.530455,235.670896 C878.419672,235.023705 878.188168,234.101592 877.346762,233.418979 C876.350285,232.610561 874.811937,232.440083 874.123923,232.4522 C870.995743,232.507295 866.196346,234.175802 843.099163,243.78089 C835.009657,247.144954 818.842037,254.107721 794.596303,264.66919 Z"})));const j=e=>{let t=e.svgRef,a=e.title,n=D(e,["svgRef","title"]);return s.a.createElement("svg",N({className:"telegram-logo",width:"160px",height:"160px",viewBox:"0 0 160 160",ref:t},n),a?s.a.createElement("title",null,a):null,L)},R=s.a.forwardRef((e,t)=>s.a.createElement(j,N({svgRef:t},e)));a.p;var A=a(169),F=a(40),B=a(4),V=a(1);class z extends F.a{constructor(){super(),this.reset=()=>{this.current=null},this.onUpdate=e=>{switch(e["@type"]){case"updateAuthorizationState":{const t=e.authorization_state;this.current=t,this.save(t),this.emit(e["@type"],e);break}}},this.onClientUpdate=e=>{switch(e["@type"]){case"clientUpdateMonkeyIdle":case"clientUpdateMonkeyTracking":case"clientUpdateMonkeyClose":case"clientUpdateMonkeyPeek":this.emit(e["@type"],e)}},this.addTdLibListener=()=>{V.a.on("update",this.onUpdate),V.a.on("clientUpdate",this.onClientUpdate)},this.removeTdLibListener=()=>{V.a.off("update",this.onUpdate),V.a.off("clientUpdate",this.onClientUpdate)},this.reset(),this.load(),this.addTdLibListener()}load(){try{const e=localStorage.getItem(B.l);this.current=e?JSON.parse(e):null}catch(e){}}save(e){e?localStorage.setItem(B.l,JSON.stringify(e)):localStorage.removeItem(B.l)}}const H=new z;window.authorization=H;var W=H;a(358);class G extends s.a.Component{constructor(e){super(e),this.onClientUpdateMonkeyIdle=e=>{const t=this.state.idleData;this.setState({data:t,lastUpdate:e},()=>{const e=this.lottieRef.current;e&&e.anim.playSegments([0,180],!0)})},this.onClientUpdateMonkeyTracking=e=>{const t=e.code,a=e.prevCode,n=this.state.trackingData,s=Math.min(15*a.length,180),i=Math.min(15*t.length,180);this.setState({data:n,lastUpdate:e},()=>{const e=this.lottieRef.current;e&&e.anim.playSegments([s,i],!0)})},this.onClientUpdateMonkeyClose=e=>{const t=this.state.closeData;this.setState({data:t,lastUpdate:e},()=>{const e=this.lottieRef.current;e&&e.anim.playSegments([0,49],!0)})},this.onClientUpdateMonkeyPeek=e=>{const t=e.peek,a=this.state,n=a.peekData,s=a.lastUpdate;s&&"clientUpdateMonkeyPeek"===s["@type"]&&s.peek===t||this.setState({data:n,lastUpdate:e},()=>{const e=this.lottieRef.current;e&&(t?e.anim.playSegments([0,15],!0):e.anim.playSegments([15,33],!0))})},this.state={data:null,lastUpdate:null},this.lottieRef=s.a.createRef()}loadData(){var e=this;return Object(h.a)(d.a.mark((function t(){var a,n,s,i,o,r,c,l;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=[fetch("data/TwoFactorSetupMonkeyClose.json"),fetch("data/TwoFactorSetupMonkeyIdle.json"),fetch("data/TwoFactorSetupMonkeyPeek.json"),fetch("data/TwoFactorSetupMonkeyTracking.json")],t.next=4,Promise.all(a);case 4:return n=t.sent,t.next=7,Promise.all(n.map(e=>e.json()));case 7:s=t.sent,i=Object(T.a)(s,4),o=i[0],r=i[1],c=i[2],l=i[3],e.setState({closeData:o,idleData:r,peekData:c,trackingData:l},()=>{const t=e.state.lastUpdate;if(t)switch(t["@type"]){case"clientUpdateMonkeyIdle":e.onClientUpdateMonkeyIdle(t);break;case"clientUpdateMonkeyTracking":e.onClientUpdateMonkeyTracking(t);break;case"clientUpdateMonkeyClose":e.onClientUpdateMonkeyClose(t);break;case"clientUpdateMonkeyPeek":e.onClientUpdateMonkeyPeek(t)}}),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(0),console.error(t.t0);case 19:case"end":return t.stop()}}),t,null,[[0,16]])})))()}componentDidMount(){var e=this;return Object(h.a)(d.a.mark((function t(){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.loadData(),W.on("clientUpdateMonkeyIdle",e.onClientUpdateMonkeyIdle),W.on("clientUpdateMonkeyTracking",e.onClientUpdateMonkeyTracking),W.on("clientUpdateMonkeyClose",e.onClientUpdateMonkeyClose),W.on("clientUpdateMonkeyPeek",e.onClientUpdateMonkeyPeek);case 5:case"end":return t.stop()}}),t)})))()}componentWillUnmount(){W.off("clientUpdateMonkeyIdle",this.onClientUpdateMonkeyIdle),W.off("clientUpdateMonkeyTracking",this.onClientUpdateMonkeyTracking),W.off("clientUpdateMonkeyClose",this.onClientUpdateMonkeyClose),W.off("clientUpdateMonkeyPeek",this.onClientUpdateMonkeyPeek)}render(){const e=this.props.state,t=this.state.data;let a=null;switch(e["@type"]){case"authorizationStateWaitPhoneNumber":case"authorizationStateWaitEncryptionKey":case"authorizationStateWaitTdlibParameters":case"authorizationStateWaitTdlib":a=s.a.createElement(R,{className:"auth-caption-telegram-logo"});break;case"authorizationStateWaitCode":case"authorizationStateWaitPassword":a=s.a.createElement("div",{className:"auth-caption-telegram-logo"},s.a.createElement(A.default,{ref:this.lottieRef,options:{autoplay:!1,loop:!1,animationData:t,renderer:"svg",rendererSettings:{preserveAspectRatio:"xMinYMin slice",clearCanvas:!1,progressiveLoad:!0,hideOnTransparent:!0,className:"auth-caption-lottie"}}}))}return s.a.createElement("div",{className:"auth-caption"},a)}}var K=G,Z=a(16),q=a.n(Z),Y=a(106),J=a(492),Q=a(240),X=a.n(Q),$=a(546);a(359);class ee extends s.a.Component{render(){return s.a.createElement(s.a.Fragment,null,s.a.createElement("span",{className:"header-progress"},"."),s.a.createElement("span",{className:"header-progress"},"."),s.a.createElement("span",{className:"header-progress"},"."))}}var te=ee,ae=a(35),ne=a(548),se=a(550),ie=a(530);a(360);var oe=function({emoji:e,name:t,phone:a}){return s.a.createElement("div",{className:"country"},s.a.createElement("span",{className:"country-emoji"},e),s.a.createElement("span",{className:"country-name"},t),s.a.createElement("span",{className:"country-phone"},a))},re=a(53);a(361);function ce(e){return e?e.replace("...","").replace("\u2026",""):e}function le(e){if(!e)return!1;switch(e["@type"]){case"connectionStateConnecting":case"connectionStateConnectingToProxy":return!0;case"connectionStateReady":case"connectionStateUpdating":case"connectionStateWaitingForNetwork":return!1}return!1}function de(e){const t=W.data;if(!t)return e;const a=pe(e,t);return a?function(e,t){e=ue(e);let a="",n=0;for(let s=0;s<t.length&&n<e.length;s++)t[s]>="0"&&t[s]<="9"?(a+=t[s],e[n]===t[s]&&n++):" "===t[s]?a+=t[s]:"X"===t[s]&&(a+=e[n++]);return a+=" "+e.substring(n),"+"+a}(e,a.pattern):e}function he(e){return e>="0"&&e<="9"||(" "===e||"+"===e)}function ue(e){return e?e.replace(/ /g,"").replace("+","").toLowerCase():e}function pe(e,t){if(!t)return null;const a=t.findIndex(t=>function(e,t){if(!e)return!1;if(!t)return!1;e=ue(e);const a=ue(t.phone);return e.startsWith(a)}(e,t));return-1!==a?t[a]:null}function me(e,t){if(!e)return null;if(!t)return null;const a=t.findIndex(t=>t.code.toLowerCase()===e.toLowerCase());return-1!==a?t[a]:null}class ge extends s.a.Component{constructor(e){super(e),this.onUpdateConnectionState=e=>{const t=e.state;"connectionStateReady"===t["@type"]&&this.setCountryCode(),this.setState({connecting:le(t)})},this.onClientUpdateSetPhoneCanceled=e=>{this.setState({loading:!1})},this.onClientUpdateSetPhoneError=e=>{const t=e.error;let a=null;if(t&&"error"===t["@type"]&&t.message){if("PHONE_NUMBER_INVALID"===t.message)return void this.setState({error:{code:"InvalidPhoneNumber"},loading:!1});a=t.message}else a=JSON.stringify(t);this.setState({error:{string:a},loading:!1})},this.onClientUpdateSetPhoneResult=e=>{this.setState({loading:!1})},this.onUpdateOption=e=>{"suggested_language_pack_id"===e.name&&this.setSuggestedLanguagePackId()},this.handleKeyPress=e=>{"Enter"===e.key?(e.preventDefault(),this.handleDone()):he(e.key)||(e.preventDefault(),e.stopPropagation())},this.handleDone=()=>{const e=this.state.phone;!function(e){if(!e)return!1;let t=!e.match(/^[\d\-+\s]+$/);return t||(e=e.replace(/\D/g,"")).length<7&&(t=!0),!t}(e)?this.setState({error:{code:"InvalidPhoneNumber"}}):(this.setState({error:null,loading:!0}),V.a.clientUpdate({"@type":"clientUpdateSetPhone",phone:e}))},this.handleChangeLanguage=()=>{const e=this.props.i18n,t=this.state.suggestedLanguage;if(!e)return;if(!t)return;const a=t===e.language?m.a.fallbackLng:t;V.a.clientUpdate({"@type":"clientUpdateLanguageChange",language:a})},this.handleFilterOptions=(e,{inputValue:t})=>{if(!e)return;let a=t.toLowerCase().replace(/ /g,"");return a=a.length>0&&"+"===a[0]?a.substring(1):a,e.filter(e=>function(e,t){if(!e)return!1;if(!t)return!0;t.length>0&&"("===t[0]&&(t=t.substring(1));const a=e.name.toLowerCase().split(" ");for(let s=0;s<a.length;s++)a[s].length>0&&"("===a[s][0]&&(a[s]=a[s].substring(1));const n=ue(e.phone);return!!a.some(e=>e.startsWith(t))||!(!n.startsWith(t)&&!t.startsWith(n))}(e,a))},this.handleCountryChange=(e,t)=>{if(!t)return;const a=this.state,n=a.phone,s=a.country,i=s?n.replace(s.phone,""):n,o=t.phone+" "+i.trimStart();this.setState({country:t,phone:o},()=>{this.phoneInputRef.current.focus()})},this.handleKeepChange=(e,t)=>{this.setState({keep:!this.state.keep})},this.handlePhoneChange=e=>{let t=e.target.value;const a=this.props.data;let n=this.state.country;var s,i;n&&(t.startsWith(n.phone)||(n=null)),!n&&a&&t&&(n=pe(t,a),n&&(s=t,i=n.phone,ue(s)===ue(i))&&(t="+"+ue(t)+" ")),this.setState({phone:t,country:n})},this.handlePaste=e=>{const t=e.clipboardData.getData("text/plain");if(t){e.preventDefault();let a="";for(let e=0;e<t.length;e++)he(t.charAt(e))&&(a+=t.charAt(e));document.execCommand("insertText",!1,a)}};const t=e.defaultPhone||"",a=pe(t,e.data);this.state={connecting:le(v.a.connectionState),error:null,loading:!1,suggestedLanguage:localStorage.getItem(B.m),keep:!0,phone:t,country:a,countryCode:null},this.phoneInputRef=s.a.createRef()}setCountryCode(){var e=this;return Object(h.a)(d.a.mark((function t(){var a,n,s,i,o,r;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(a=e.state.countryCode)){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,V.a.send({"@type":"getCountryCode"});case 5:if(n=t.sent){t.next=8;break}return t.abrupt("return");case 8:s=e.props.data,i=e.state,o=i.country,r=i.phone,o||r||!s||(o=me(n.text,s))&&(r="+"+ue(o.phone)+" "),e.setState({phone:r,country:o,countryCode:a});case 12:case"end":return t.stop()}}),t)})))()}shouldComponentUpdate(e,t,a){return!0}componentDidMount(){this.setSuggestedLanguagePackId(),v.a.on("clientUpdateSetPhoneCanceled",this.onClientUpdateSetPhoneCanceled),v.a.on("clientUpdateSetPhoneError",this.onClientUpdateSetPhoneError),v.a.on("clientUpdateSetPhoneResult",this.onClientUpdateSetPhoneResult),v.a.on("updateConnectionState",this.onUpdateConnectionState),re.a.on("updateOption",this.onUpdateOption)}componentWillUnmount(){v.a.off("clientUpdateSetPhoneCanceled",this.onClientUpdateSetPhoneCanceled),v.a.off("clientUpdateSetPhoneError",this.onClientUpdateSetPhoneError),v.a.off("clientUpdateSetPhoneResult",this.onClientUpdateSetPhoneResult),v.a.off("updateConnectionState",this.onUpdateConnectionState),re.a.off("updateOption",this.onUpdateOption)}setSuggestedLanguagePackId(){var e=this;return Object(h.a)(d.a.mark((function t(){var a,n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.props.i18n){t.next=3;break}return t.abrupt("return");case 3:if(a=re.a.get("suggested_language_pack_id")){t.next=6;break}return t.abrupt("return");case 6:return n=a.value,t.next=9,m.a.loadLanguage(n);case 9:e.setState({suggestedLanguage:n});case 10:case"end":return t.stop()}}),t)})))()}render(){const e=this.props,t=e.data,a=e.i18n,n=e.t,i=this.state,o=i.connecting,r=i.loading,c=i.error,l=i.suggestedLanguage,d=i.keep,h=i.phone,u=i.country;let p="";if(c){const e=c.code,t=c.string;p=e?n(e):t}const g=o?ce(n("Connecting")):n("SignInToTelegram"),f=l===a.language?m.a.fallbackLng:l;return s.a.createElement("form",{className:"auth-root",autoComplete:"off"},s.a.createElement(Y.a,{variant:"body1",className:"auth-title"},s.a.createElement("span",null,g),o&&s.a.createElement(te,null)),s.a.createElement(Y.a,{variant:"body1",className:"auth-subtitle",style:{width:254}},n("StartText")),s.a.createElement(ne.a,{debug:!1,id:"country-select",noOptionsText:n("NoResult"),options:t,disabled:r,autoHighlight:!0,getOptionLabel:e=>e.name,renderOption:e=>s.a.createElement(oe,{name:e.name,emoji:e.emoji,phone:e.phone}),renderInput:e=>s.a.createElement($.a,Object.assign({classes:{root:"auth-input"}},e,{label:n("Country"),variant:"outlined",inputProps:Object(ae.a)({},e.inputProps),fullWidth:!0,autoComplete:"off"})),filterOptions:this.handleFilterOptions,value:u,onChange:this.handleCountryChange}),s.a.createElement($.a,{id:"phoneNumber",classes:{root:"auth-input"},inputRef:this.phoneInputRef,variant:"outlined",color:"primary",label:n("PhoneNumber"),disabled:r,error:Boolean(p),helperText:p,fullWidth:!0,autoFocus:!0,autoComplete:"off",value:h,onChange:this.handlePhoneChange,onKeyPress:this.handleKeyPress,onPaste:this.handlePaste}),s.a.createElement("div",{className:"sign-in-keep"},s.a.createElement(se.a,{color:"primary",checked:d,disabled:r,onChange:this.handleKeepChange}),s.a.createElement(Y.a,{variant:"body1"},n("KeepMeSignedIn"))),s.a.createElement(w.a,{classes:{root:"auth-button"},variant:"contained",disableElevation:!0,fullWidth:!0,color:"primary",disabled:r,onClick:this.handleDone},n("Next")),s.a.createElement(Y.a,{className:"sign-in-continue-on"},s.a.createElement(ie.a,{onClick:this.handleChangeLanguage},Boolean(f)?n("ContinueOnThisLanguage",{lng:f}):" ")))}}var fe=Object(p.c)()(ge);a(362);class be extends s.a.Component{constructor(e){super(e),this.onUpdateConnectionState=e=>{const t=e.state;this.setState({connecting:le(t)})},this.handleNext=()=>{this.code&&this.isValid(this.code)?(this.setState({error:""}),this.handleDone()):this.setState({error:"Invalid code. Please try again."})},this.handleDone=()=>{const e=this.props.t,t=this.code;this.setState({loading:!0}),V.a.send({"@type":"checkAuthenticationCode",code:t,first_name:"A",last_name:"B"}).then(e=>{}).catch(t=>{let a=null;a=t&&"error"===t["@type"]&&t.message?"PHONE_CODE_INVALID"===t.message?e("InvalidCode"):t.message:JSON.stringify(t),this.setState({error:a},()=>{setTimeout(()=>this.inputRef.current.focus(),100)})}).finally(()=>{this.setState({loading:!1})})},this.handleBack=()=>{this.props.onChangePhone()},this.handleChange=e=>{const t=this.code||"";this.code=e.target.value||"",V.a.clientUpdate({"@type":"clientUpdateMonkeyTracking",prevCode:t,code:this.code}),this.code&&this.codeLength>0&&this.code.length===this.codeLength&&this.handleNext()},this.handleKeyPress=e=>{"Enter"===e.key&&(e.preventDefault(),this.handleNext())},this.state={connecting:le(v.a.connectionState),error:"",loading:!1},this.inputRef=s.a.createRef()}componentDidMount(){V.a.clientUpdate({"@type":"clientUpdateMonkeyIdle"}),v.a.on("updateConnectionState",this.onUpdateConnectionState)}componentWillUnmount(){v.a.off("updateConnectionState",this.onUpdateConnectionState)}isValid(e){let t=!e.match(/^[\d\-+\s]+$/);return t||5!==(e=e.replace(/\D/g,"")).length&&(t=!0),!t}getPhoneNumber(e){return e?e.phone_number:null}getCodeLength(e){if(!e)return 0;if(!e.type)return 0;switch(e.type["@type"]){case"authenticationCodeTypeCall":return e.type.length;case"authenticationCodeTypeFlashCall":return 0;case"authenticationCodeTypeSms":case"authenticationCodeTypeTelegramMessage":return e.type.length}return 0}getSubtitle(e,t=(e=>e)){if(!e)return"Subtitle";if(!e.type)return"Subtitle";switch(e.type["@type"]){case"authenticationCodeTypeCall":case"authenticationCodeTypeFlashCall":return"Telegram dialed your number";case"authenticationCodeTypeSms":return"We have sent you a message with activation code to your phone. Please enter it below.";case"authenticationCodeTypeTelegramMessage":return"Please enter the code you've just received in your previous Telegram app."}return"Subtitle"}render(){const e=this.props,t=e.codeInfo,a=e.t,n=this.state,i=n.connecting,o=n.loading,r=n.error;this.phoneNumber=this.getPhoneNumber(t),this.codeLength=this.getCodeLength(t);const c=this.getSubtitle(t);let l="Title";return i?l=ce(a("Connecting")):this.phoneNumber&&(l=de(this.phoneNumber)),s.a.createElement("form",{className:"auth-root",autoComplete:"off"},s.a.createElement("div",{className:q()("code-title","auth-title")},s.a.createElement(Y.a,{variant:"body1",className:"auth-title-typography"},s.a.createElement("span",null,l),i&&s.a.createElement(te,null)),s.a.createElement(J.a,{"aria-label":"edit",onClick:this.handleBack,disabled:o},s.a.createElement(X.a,{fontSize:"small"}))),s.a.createElement(Y.a,{variant:"body1",className:"auth-subtitle",style:{width:300}},c),s.a.createElement($.a,{classes:{root:"auth-input"},inputRef:this.inputRef,variant:"outlined",color:"primary",disabled:o,error:Boolean(r),helperText:r,fullWidth:!0,autoFocus:!0,autoComplete:"off",label:a("Code"),maxLength:this.codeLength>0?this.codeLength:256,onChange:this.handleChange,onKeyPress:this.handleKeyPress}))}}var Ce=Object(p.c)()(be),ye=a(531),ve=a(528),Ee=a(551),Se=a(527),Ue=a(529),ke=a(176),we=a.n(ke),Me=a(241),Ie=a.n(Me);a(363);class _e extends s.a.Component{constructor(e){super(e),this.onUpdateConnectionState=e=>{const t=e.state;this.setState({connecting:le(t)})},this.handleNext=()=>{this.password?(this.setState({error:""}),this.handleDone()):this.setState({error:"Invalid password. Please try again."})},this.handleBack=()=>{this.props.onChangePhone()},this.handleDone=()=>{const e=this.password;this.setState({loading:!0}),V.a.send({"@type":"checkAuthenticationPassword",password:e}).then(e=>{}).catch(e=>{let t=null;t=e&&"error"===e["@type"]&&e.message?e.message:JSON.stringify(e),this.setState({error:t},()=>{setTimeout(()=>this.inputRef.current.focus(),100)})}).finally(()=>{this.setState({loading:!1})})},this.handleMouseDownPassword=e=>{e.preventDefault()},this.handleClickShowPassword=()=>{this.setState({showPassword:!this.state.showPassword}),this.sendMonkeyPeek()},this.handleChange=e=>{this.password=e.target.value},this.handleKeyPress=e=>{"Enter"===e.key&&(e.preventDefault(),this.handleNext())},this.state={connecting:le(v.a.connectionState),password:"",showPassword:!1,error:""},this.inputRef=s.a.createRef(),this.sendMonkeyPeek=function(e,t,a){let n;return function(){let s=this,i=arguments,o=function(){n=null,a||e.apply(s,i)},r=a&&!n;clearTimeout(n),n=setTimeout(o,t),r&&e.apply(s,i)}}(this.sendMonkeyPeek,200,!1)}componentDidMount(){V.a.clientUpdate({"@type":"clientUpdateMonkeyClose"}),v.a.on("updateConnectionState",this.onUpdateConnectionState)}componentWillUnmount(){v.a.off("updateConnectionState",this.onUpdateConnectionState)}sendMonkeyPeek(){V.a.clientUpdate({"@type":"clientUpdateMonkeyPeek",peek:this.state.showPassword})}render(){const e=this.props,t=e.passwordHint,a=e.t,n=this.state,i=n.connecting,o=n.loading,r=n.error,c=n.showPassword;let l=a("EnterPassword");return i&&(l=ce(a("Connecting"))),s.a.createElement("form",{className:"auth-root",autoComplete:"off"},s.a.createElement(Y.a,{variant:"body1",className:"auth-title"},s.a.createElement("span",null,l),i&&s.a.createElement(te,null)),s.a.createElement(Y.a,{variant:"body1",className:"auth-subtitle",style:{width:235}},a("YourAccountProtectedWithPassword")),s.a.createElement(Se.a,{className:"auth-input",fullWidth:!0,variant:"outlined"},s.a.createElement(ve.a,{htmlFor:"adornment-password",error:Boolean(r)},a("LoginPassword")),s.a.createElement(Ee.a,{fullWidth:!0,autoFocus:!0,autoComplete:"off",id:"adornment-password",inputRef:this.inputRef,type:c?"text":"password",disabled:o,error:Boolean(r),onChange:this.handleChange,onKeyPress:this.handleKeyPress,endAdornment:s.a.createElement(ye.a,{position:"end"},s.a.createElement(J.a,{"aria-label":"Toggle password visibility",onClick:this.handleClickShowPassword,onMouseDown:this.handleMouseDownPassword,edge:"end"},c?s.a.createElement(we.a,null):s.a.createElement(Ie.a,null))),labelWidth:70}),t&&s.a.createElement(Ue.a,{id:"password-hint-text"},t),r&&s.a.createElement(Ue.a,{id:"password-error-text",error:!0},r)),s.a.createElement(w.a,{classes:{root:"auth-button"},fullWidth:!0,color:"primary",variant:"contained",disableElevation:!0,onClick:this.handleNext,disabled:o},a("Next")))}}var xe=Object(p.c)()(_e);class Oe extends s.a.Component{constructor(e){super(e),this.state={open:!1,error:null},this.handleAuthError=this.handleAuthError.bind(this),this.handleClose=this.handleClose.bind(this),this.handleKeyDown=this.handleKeyDown.bind(this)}componentDidMount(){V.a.on("tdlib_auth_error",this.handleAuthError)}componentWillUnmount(){V.a.off("tdlib_auth_error",this.handleAuthError)}handleAuthError(e){this.setState({open:!0,error:e})}handleClose(){this.setState({open:!1})}handleKeyDown(e){"Enter"===e.key&&(e.preventDefault(),this.handleClose())}render(){let e=null;return e=this.state.error&&"error"===this.state.error["@type"]&&this.state.error.message?this.state.error.message:JSON.stringify(this.state.error),s.a.createElement(M.a,{transitionDuration:0,open:this.state.open,onKeyDown:this.handleKeyDown,onClose:this.handleClose,"aria-labelledby":"form-dialog-title"},s.a.createElement(O.a,{id:"form-dialog-title"},"Error"),s.a.createElement(_.a,null,s.a.createElement(x.a,null,e)),s.a.createElement(I.a,null,s.a.createElement(w.a,{onClick:this.handleClose,color:"primary"},"Ok")))}}var Pe=Oe;a(364);class Te extends s.a.Component{constructor(...e){super(...e),this.state={data:null}}componentDidMount(){this.loadData()}loadData(){var e=this;return Object(h.a)(d.a.mark((function t(){var a,n,s,i;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.state.data){t.next=3;break}return t.abrupt("return");case 3:return t.prev=3,t.next=6,fetch("data/countries.dat");case 6:return a=t.sent,t.next=9,a.text();case 9:n=t.sent,s=n.split("\n"),i=[],s.forEach(e=>{const t=e.split(";"),a={prefix:t[0],code:t[1],name:t[2],pattern:t[3],count:Number(t[4]),emoji:t[5]};i.push(a)}),i.forEach(e=>{e.phone="+"+e.prefix}),W.data=i.filter(e=>e.emoji),e.setState({data:W.data}),t.next=21;break;case 18:t.prev=18,t.t0=t.catch(3),console.error(t.t0);case 21:case"end":return t.stop()}}),t,null,[[3,18]])})))()}render(){const e=this.props.authorizationState,t=this.state.data,a=v.a.defaultPhone;let n=null;switch(e["@type"]){case"authorizationStateWaitPhoneNumber":case"authorizationStateWaitEncryptionKey":case"authorizationStateWaitTdlibParameters":case"authorizationStateWaitTdlib":n=s.a.createElement(fe,{defaultPhone:a,data:t});break;case"authorizationStateWaitCode":{const a=this.props.onChangePhone,i=e.terms_of_service,o=e.code_info;n=s.a.createElement(Ce,{termsOfService:i,codeInfo:o,onChangePhone:a,data:t});break}case"authorizationStateWaitPassword":{const t=this.props.onChangePhone,a=e.password_hint,i=e.has_recovery_email_address,o=e.recovery_email_address_pattern;n=s.a.createElement(xe,{passwordHint:a,hasRecoveryEmailAddress:i,recoveryEmailAddressPattern:o,onChangePhone:t});break}}return s.a.createElement("div",{className:"authorization-form"},s.a.createElement("div",{className:"authorization-form-content"},s.a.createElement(K,{state:e}),n),s.a.createElement(Pe,null))}}var Ne=Te,De=a(177),Le=a.n(De);a(365);class je extends s.a.Component{static handleReload(){window.location.reload()}render(){return s.a.createElement("div",{className:"app-inactive"},s.a.createElement("div",{className:"app-inactive-wrapper"},s.a.createElement("img",{className:"app-inactive-image",src:"Manytabs_2x.png",alt:"",onClick:je.handleReload}),s.a.createElement("h3",{className:"app-inactive-title"},"Such error, many tabs"),s.a.createElement("div",{className:"app-inactive-description"},"Telegram supports only one active tab with the app.",s.a.createElement("br",null),"Please reload this page to continue using this tab or close it."),s.a.createElement("div",{className:"app-inactive-actions"},s.a.createElement(Le.a,{color:"primary",onClick:je.handleReload},"Reload app"))))}}var Re=je;a(369);class Ae extends s.a.PureComponent{render(){return s.a.createElement("div",{className:"footer-wrapper"},s.a.createElement("span",null,P.version))}}var Fe=Ae;class Be extends s.a.Component{render(){return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"header-wrapper"}),s.a.createElement("div",{className:"page"},s.a.createElement(Re,null)),s.a.createElement(Fe,null))}}var Ve=Be,ze=a(19);a(370);class He extends s.a.Component{render(){let e="Android_2x.jpg";return Object(ze.q)()?e="iOS_2x.jpg":Object(ze.s)()&&(e="WP_2x.jpg"),s.a.createElement("div",{className:"app-inactive"},s.a.createElement("div",{className:"app-inactive-wrapper"},s.a.createElement("img",{src:e,alt:"",className:"app-inactive-image",onClick:He.handleInstall}),s.a.createElement("h3",{className:"app-inactive-title"},"Work is in progress!"),s.a.createElement("div",{className:"app-inactive-description"},"This client has not been optimized for mobile devices yet.",s.a.createElement("br",null),"Please consider using our native mobile app."),s.a.createElement("div",{className:"app-inactive-actions"},s.a.createElement(w.a,{color:"primary",onClick:He.handleInstall},"Install app"))))}}He.handleInstall=()=>{Object(ze.q)()?window.location.href="https://telegram.org/dl/ios":Object(ze.s)()?window.location.href="https://telegram.org/dl/wp":window.location.href="https://telegram.org/dl/android"};var We=He;class Ge extends s.a.Component{render(){return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"header-wrapper"}),s.a.createElement("div",{className:"page",style:{background:"#FFFFFF",color:"#000000"}},s.a.createElement(We,null)),s.a.createElement(Fe,null))}}var Ke=Ge,Ze=a(9);a(371);class qe extends s.a.Component{render(){const e=this.props,t=e.chatId,a=e.index,n=e.showTitle;let i=null;n&&(i=Object(Ze.u)(t,!0));const o="".concat(50+10*Math.sin(a),"%"),r="".concat(70+10*Math.cos(a),"%");return s.a.createElement("div",{className:"dialog-placeholder"},s.a.createElement("div",{className:"dialog-placeholder-wrapper"},s.a.createElement("div",{className:"dialog-placeholder-tile"}),s.a.createElement("div",{className:"dialog-placeholder-inner-wrapper"},s.a.createElement("div",{className:"tile-first-row"},n?i:s.a.createElement("div",{className:"dialog-placeholder-title",style:{width:o}})),s.a.createElement("div",{className:"tile-second-row"},s.a.createElement("div",{className:"dialog-placeholder-content",style:{width:r}})))))}}var Ye=qe,Je=a(23),Qe=Object(Je.a)(s.a.createElement("path",{d:"M4,16 L20,16 C20.5522847,16 21,16.4477153 21,17 C21,17.5128358 20.6139598,17.9355072 20.1166211,17.9932723 L20,18 L4,18 C3.44771525,18 3,17.5522847 3,17 C3,16.4871642 3.38604019,16.0644928 3.88337887,16.0067277 L4,16 L20,16 L4,16 Z M4,11 L20,11 C20.5522847,11 21,11.4477153 21,12 C21,12.5128358 20.6139598,12.9355072 20.1166211,12.9932723 L20,13 L4,13 C3.44771525,13 3,12.5522847 3,12 C3,11.4871642 3.38604019,11.0644928 3.88337887,11.0067277 L4,11 Z M4,6 L20,6 C20.5522847,6 21,6.44771525 21,7 C21,7.51283584 20.6139598,7.93550716 20.1166211,7.99327227 L20,8 L4,8 C3.44771525,8 3,7.55228475 3,7 C3,6.48716416 3.38604019,6.06449284 3.88337887,6.00672773 L4,6 Z"}),"Menu");a(372);class Xe extends s.a.Component{constructor(e){super(e),this.onClientUpdateCacheLoaded=e=>{const t=v.a.cacheLoaded;this.setState({cacheLoaded:t})},this.onClientUpdateChatId=e=>{const t=e.nextChatId;this.setState({chatId:t})},this.onClientUpdateDialogsReady=e=>{const t=v.a.dialogsReady;this.setState({dialogsReady:t})};const t=v.a.chatId,a=v.a.dialogsReady,n=v.a.cacheLoaded;this.state={chatId:t,dialogsReady:a,cacheLoaded:n}}shouldComponentUpdate(e,t,a){return t.chatId!==this.state.chatId||(t.dialogsReady!==this.state.dialogsReady||t.cacheLoaded!==this.state.cacheLoaded)}componentDidMount(){v.a.on("clientUpdateChatId",this.onClientUpdateChatId),v.a.on("clientUpdateDialogsReady",this.onClientUpdateDialogsReady),v.a.on("clientUpdateCacheLoaded",this.onClientUpdateCacheLoaded)}componentWillUnmount(){v.a.off("clientUpdateChatId",this.onClientUpdateChatId),v.a.off("clientUpdateDialogsReady",this.onClientUpdateDialogsReady),v.a.off("clientUpdateCacheLoaded",this.onClientUpdateCacheLoaded)}render(){const e=this.props,t=e.t,a=(e.force,this.state),n=a.chatId;a.dialogsReady,a.cacheLoaded;return n?null:s.a.createElement("div",{className:"placeholder"},s.a.createElement("div",{className:"placeholder-wrapper"},s.a.createElement("div",{className:"placeholder-meta"},t("SelectChatToStartMessaging"))))}}var $e=Object(p.c)()(Xe),et=Object(Je.a)(s.a.createElement("path",{d:"M9.5,3 C13.0898509,3 16,5.91014913 16,9.5 C16,10.9337106 15.5358211,12.2590065 14.7495478,13.3338028 L19.7071068,18.2928932 C20.0976311,18.6834175 20.0976311,19.3165825 19.7071068,19.7071068 C19.3466228,20.0675907 18.7793918,20.0953203 18.3871006,19.7902954 L18.2928932,19.7071068 L13.3338028,14.7495478 C12.2590065,15.5358211 10.9337106,16 9.5,16 C5.91014913,16 3,13.0898509 3,9.5 C3,5.91014913 5.91014913,3 9.5,3 Z M9.5,5 C7.01471863,5 5,7.01471863 5,9.5 C5,11.9852814 7.01471863,14 9.5,14 C11.9852814,14 14,11.9852814 14,9.5 C14,7.01471863 11.9852814,5 9.5,5 Z"}),"Search"),tt=(a(193),a(216),a(217),a(194),a(242)),at=a.n(tt),nt=(a(373),a(21));class st extends s.a.Component{constructor(...e){super(...e),this.handleSelect=e=>{0===e.button&&Object(nt.g)()}}shouldComponentUpdate(e,t,a){const n=this.props,s=n.title,i=n.theme;return e.theme!==i||e.title!==s}render(){const e=this.props,t=e.t,a=e.title;return s.a.createElement("div",{ref:this.dialog,className:"dialog",onMouseDown:this.handleSelect,onContextMenu:this.handleContextMenu},s.a.createElement("div",{className:"dialog-wrapper"},s.a.createElement("div",{className:"chat-tile"},s.a.createElement("div",{className:"archive-tile-background tile-photo"},s.a.createElement("div",{className:"tile-saved-messages"},s.a.createElement(at.a,{fontSize:"default"})))),s.a.createElement("div",{className:"dialog-inner-wrapper"},s.a.createElement("div",{className:"tile-first-row"},s.a.createElement("div",{className:"dialog-title"},s.a.createElement("span",{className:"dialog-title-span"},t("ArchivedChats")))),s.a.createElement("div",{className:"tile-second-row"},s.a.createElement("div",{className:"dialog-content"},a)))))}}Object(p.c)()(st);var it=a(535),ot=a(497),rt=a(496),ct=Object(Je.a)(s.a.createElement("path",{d:"M17,2 C19.209139,2 21,3.790861 21,6 L21,20.2543508 C21,21.3589203 20.1045695,22.2543871 19,22.2543871 C18.5225775,22.2543871 18.0609035,22.0835665 17.6984173,21.772864 L12,16.8885064 L6.30158275,21.772864 C5.46293106,22.4917083 4.2003311,22.3945852 3.4814868,21.5559335 C3.17078432,21.1934473 3,20.7317733 3,20.2543508 L3,6 C3,3.790861 4.790861,2 7,2 L17,2 Z M17,4 L7,4 C5.8954305,4 5,4.8954305 5,6 L5,20.2543508 L10.6984173,15.3699931 C11.4473967,14.7280108 12.5526033,14.7280108 13.3015827,15.3699931 L19,20.2543508 L19,6 C19,4.8954305 18.1045695,4 17,4 Z"}),"Saved"),lt=Object(Je.a)(s.a.createElement("g",{transform:"translate(3.000000, 0.600000)"},s.a.createElement("path",{d:"M9,0 C13.9705627,-9.13077564e-16 18,4.02943725 18,9 L18,23 L18,23 L15,20 L12,23 L9,20 L6,23 L3,20 L0,23 L0,9 C-6.08718376e-16,4.02943725 4.02943725,9.13077564e-16 9,0 Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinejoin:"round",fill:"none"}),s.a.createElement("circle",{cx:"5",cy:"9",r:"2"}),s.a.createElement("circle",{cx:"13",cy:"9",r:"2"})),"DeletedAccount"),dt=a(28),ht=a(22);a(374);class ut extends s.a.Component{constructor(e){super(e),this.onUpdateUserStatus=e=>{const t=this.state.userId;if(e.user_id!==t)return;const a=ht.a.get(t);a&&this.setState({online:Object(dt.i)(a)})};const t=Object(Ze.w)(e.chatId),a=ht.a.get(t);this.state={userId:t,online:Object(dt.i)(a)}}componentDidMount(){ht.a.on("updateUserStatus",this.onUpdateUserStatus)}componentWillUnmount(){ht.a.off("updateUserStatus",this.onUpdateUserStatus)}render(){const e=this.props,t=e.size,a=e.borderSize;return this.state.online?s.a.createElement("div",{className:"chat-status",style:{width:t,height:t}},s.a.createElement("div",{className:"chat-status-icon",style:{padding:a}},s.a.createElement("div",{className:"chat-status-indicator"}))):null}}ut.defaultProps={size:14,borderSize:2};var pt=ut,mt=a(14),gt=a(5),ft=a(2);a(375);class bt extends n.Component{constructor(e){super(e),this.onFastUpdatingComplete=e=>{this.forceUpdate()},this.onClientUpdateChatBlob=e=>{this.props.chatId===e.chatId&&(this.state.loaded?this.setState({loaded:!1}):this.forceUpdate())},this.onUpdateChatPhoto=e=>{const t=this.props.chatId,a=e.chat_id,n=e.photo;if(a===t&&(this.state.loaded?this.setState({loaded:!1}):this.forceUpdate(),n)){const e=ft.a.getStore();Object(mt.o)(e,t)}},this.onUpdateChatTitle=e=>{const t=this.props.chatId;e.chat_id===t&&this.forceUpdate()},this.handleSelect=e=>{const t=this.props,a=t.chatId,n=t.onSelect;n&&(e.stopPropagation(),n(a))},this.handleLoad=()=>{this.setState({loaded:!0})},this.state={loaded:!1}}shouldComponentUpdate(e,t){const a=this.props.chatId,n=this.state.loaded;return e.chatId!==a||t.loaded!==n}componentDidMount(){gt.a.on("clientUpdateFastUpdatingComplete",this.onFastUpdatingComplete),gt.a.on("updateChatPhoto",this.onUpdateChatPhoto),gt.a.on("updateChatTitle",this.onUpdateChatTitle),ft.a.on("clientUpdateChatBlob",this.onClientUpdateChatBlob)}componentWillUnmount(){gt.a.off("clientUpdateFastUpdatingComplete",this.onFastUpdatingComplete),gt.a.off("updateChatPhoto",this.onUpdateChatPhoto),gt.a.off("updateChatTitle",this.onUpdateChatTitle),ft.a.off("clientUpdateChatBlob",this.onClientUpdateChatBlob)}render(){const e=this.props,t=e.chatId,a=e.showOnline,n=e.showSavedMessages,i=e.onSelect,o=e.small,r=e.big,c=e.size,l=e.t,d=this.state.loaded;let h=null;if(c&&(h={width:c,height:c}),Object(Ze.T)(t))return s.a.createElement("div",{className:q()("chat-tile",{"tile-small":o},{"tile-big":r}),style:h,onClick:this.handleSelect},s.a.createElement("div",{className:q()("tile-photo","tile_color_0",{pointer:i})},s.a.createElement("div",{className:"tile-saved-messages"},s.a.createElement(lt,{fontSize:r?"large":"default"}))));if(Object(Ze.V)(t)&&n)return s.a.createElement("div",{className:q()("chat-tile",{"tile-small":o},{"tile-big":r}),style:h,onClick:this.handleSelect},s.a.createElement("div",{className:q()("tile-photo","tile_color_4",{pointer:i})},s.a.createElement("div",{className:"tile-saved-messages"},s.a.createElement(ct,{fontSize:r?"large":"default"}))));const u=gt.a.get(t);if(!u)return null;const p=u.photo,m=Object(Ze.p)(u,l),g=Object(mt.j)(p?p.small:null),f=g&&d,b="tile_color_".concat(Math.abs(t)%8+1);return s.a.createElement("div",{className:q()("chat-tile",{[b]:!f},{pointer:i},{"tile-small":o},{"tile-big":r}),style:h,onClick:this.handleSelect},!f&&s.a.createElement("div",{className:"tile-photo"},s.a.createElement("span",{className:"tile-text"},m)),g&&s.a.createElement("img",{className:"tile-photo",src:g,onLoad:this.handleLoad,draggable:!1,alt:""}),a&&Object(Ze.W)(t)&&s.a.createElement(pt,{chatId:t}))}}bt.defaultProps={showSavedMessages:!0,showOnline:!1};var Ct=Object(p.c)()(bt);a(376);class yt extends s.a.Component{constructor(...e){super(...e),this.onClientUpdateClearHistory=e=>{this.props.chatId===e.chatId&&(this.clearHistory=e.inProgress,this.forceUpdate())},this.onFastUpdatingComplete=e=>{this.forceUpdate()},this.onUpdate=e=>{this.props.chatId===e.chat_id&&this.forceUpdate()}}shouldComponentUpdate(e,t){const a=this.props,n=a.chatId,s=a.t;return e.chatId!==n||e.t!==s}componentDidMount(){gt.a.on("clientUpdateFastUpdatingComplete",this.onFastUpdatingComplete),gt.a.on("clientUpdateClearHistory",this.onClientUpdateClearHistory),gt.a.on("updateChatDraftMessage",this.onUpdate),gt.a.on("updateChatLastMessage",this.onUpdate),gt.a.on("updateChatReadInbox",this.onUpdate),gt.a.on("updateUserChatAction",this.onUpdate)}componentWillUnmount(){gt.a.off("clientUpdateFastUpdatingComplete",this.onFastUpdatingComplete),gt.a.off("clientUpdateClearHistory",this.onClientUpdateClearHistory),gt.a.off("updateChatDraftMessage",this.onUpdate),gt.a.off("updateChatLastMessage",this.onUpdate),gt.a.off("updateChatReadInbox",this.onUpdate),gt.a.off("updateUserChatAction",this.onUpdate)}render(){const e=this.props,t=e.chatId,a=e.t;if(this.clearHistory)return s.a.createElement("div",{className:"dialog-content"},"\xa0");const n=gt.a.get(t);if(!n)return s.a.createElement("div",{className:"dialog-content"},"\xa0");let i=null;const o=Object(Ze.v)(t);if(o&&(i=s.a.createElement("span",{className:"dialog-content-accent"},o)),!i){const e=Object(Ze.m)(t);if(Object(Ze.Y)(t)){const t=e.text||"\xa0";i=s.a.createElement(s.a.Fragment,null,s.a.createElement("span",{className:"dialog-content-draft"},a("Draft")+": "),t)}}if(!i){const e=Object(Ze.A)(n,a)||"\xa0",t=Object(Ze.C)(n,a);i=s.a.createElement(s.a.Fragment,null,t&&s.a.createElement("span",{className:"dialog-content-accent"},t,": "),e)}return s.a.createElement("div",{className:"dialog-content"},i)}}var vt=Object(p.c)()(yt),Et=Object(Je.a)(s.a.createElement("g",{strokeWidth:"1",fill:"none",fillRule:"evenodd"},s.a.createElement("line",{x1:"10.5",y1:"13.5",x2:"7",y2:"17",id:"Path-51",strokeWidth:"1.66",strokeLinecap:"round"}),s.a.createElement("path",{d:"M15.2734195,6.29329584 L17.7068554,8.72673178 C18.0977149,9.11759123 18.0977149,9.7512996 17.7068554,10.142159 C17.6489915,10.200023 17.5842494,10.2505721 17.5140791,10.2926743 L15.0747102,11.7562956 C15.5465193,13.1717229 15.0755189,14.5863414 13.661709,16.0001513 L8,10.3384422 C9.41380985,8.92463237 10.8284284,8.45363199 12.2438557,8.92544107 L13.707477,6.48607217 C13.991869,6.01208547 14.6066564,5.85838861 15.0806431,6.14278063 C15.1508135,6.18488284 15.2155555,6.2354319 15.2734195,6.29329584 Z",strokeWidth:"1.66",strokeLinecap:"round",strokeLinejoin:"round"})),"Pin"),St=a(64);a(377);class Ut extends s.a.Component{constructor(...e){super(...e),this.onClientUpdateClearHistory=e=>{this.props.chatId===e.chatId&&(this.clearHistory=e.inProgress,this.forceUpdate())},this.onFastUpdatingComplete=e=>{this.forceUpdate()},this.onUpdate=e=>{const t=this.props.chatId;e.chat_id===t&&this.forceUpdate()},this.onUpdateScopeNotificationSettings=e=>{const t=this.props.chatId,a=gt.a.get(t);if(a)switch(e.scope["@type"]){case"notificationSettingsScopeGroupChats":"chatTypeBasicGroup"!==a.type["@type"]&&"chatTypeSupergroup"!==a.type["@type"]||this.forceUpdate();break;case"notificationSettingsScopePrivateChats":"chatTypePrivate"!==a.type["@type"]&&"chatTypeSecret"!==a.type["@type"]||this.forceUpdate()}}}shouldComponentUpdate(e,t){const a=this.props.chatId;return e.chatId!==a}componentDidMount(){gt.a.on("clientUpdateFastUpdatingComplete",this.onFastUpdatingComplete),gt.a.on("clientUpdateClearHistory",this.onClientUpdateClearHistory),gt.a.on("updateChatDraftMessage",this.onUpdate),gt.a.on("updateChatIsMarkedAsUnread",this.onUpdate),gt.a.on("updateChatIsPinned",this.onUpdate),gt.a.on("updateChatNotificationSettings",this.onUpdate),gt.a.on("updateChatReadInbox",this.onUpdate),gt.a.on("updateChatLastMessage",this.onUpdate),gt.a.on("updateChatReadOutbox",this.onUpdate),gt.a.on("updateChatUnreadMentionCount",this.onUpdate),gt.a.on("updateMessageMentionRead",this.onUpdate),St.a.on("updateScopeNotificationSettings",this.onUpdateScopeNotificationSettings)}componentWillUnmount(){gt.a.off("clientUpdateFastUpdatingComplete",this.onFastUpdatingComplete),gt.a.off("clientUpdateClearHistory",this.onClientUpdateClearHistory),gt.a.off("updateChatDraftMessage",this.onUpdate),gt.a.off("updateChatIsMarkedAsUnread",this.onUpdate),gt.a.off("updateChatIsPinned",this.onUpdate),gt.a.off("updateChatNotificationSettings",this.onUpdate),gt.a.off("updateChatReadInbox",this.onUpdate),gt.a.off("updateChatLastMessage",this.onUpdate),gt.a.off("updateChatReadOutbox",this.onUpdate),gt.a.off("updateChatUnreadMentionCount",this.onUpdate),gt.a.off("updateMessageMentionRead",this.onUpdate),St.a.off("updateScopeNotificationSettings",this.onUpdateScopeNotificationSettings)}render(){if(this.clearHistory)return null;const e=this.props.chatId,t=gt.a.get(e);if(!t)return null;const a=t.is_pinned,n=t.unread_count,i=Object(Ze.ab)(e),o=Object(Ze.Z)(e),r=Object(Ze.P)(e);return s.a.createElement(s.a.Fragment,null,!1,i&&s.a.createElement("div",{className:"dialog-badge"},s.a.createElement("div",{className:"dialog-badge-mention"},"@")),o&&s.a.createElement("div",{className:q()({"dialog-badge-muted":r},"dialog-badge")},s.a.createElement("span",{className:"dialog-badge-text"},n>0?n:"")),a&&!o&&!i&&s.a.createElement("div",{className:"dialog-badge-pinned"},s.a.createElement(Et,{className:"dialog-badge-pinned-icon"})))}}var kt=Ut,wt=Object(Je.a)(s.a.createElement("path",{d:"M23,12L20.56,9.22L20.9,5.54L17.29,4.72L15.4,1.54L12,3L8.6,1.54L6.71,4.72L3.1,5.53L3.44,9.21L1,12L3.44,14.78L3.1,18.47L6.71,19.29L8.6,22.47L12,21L15.4,22.46L17.29,19.28L20.9,18.46L20.56,14.78L23,12M10,17L6,13L7.41,11.59L10,14.17L16.59,7.58L18,9L10,17Z"}),"Verified");a(378);class Mt extends s.a.Component{constructor(...e){super(...e),this.onFastUpdatingComplete=e=>{this.forceUpdate()},this.onUpdateChatTitle=e=>{const t=this.props.chatId;e.chat_id===t&&this.forceUpdate()}}shouldComponentUpdate(e,t){const a=this.props,n=a.chatId,s=a.t;return e.chatId!==n||e.t!==s}componentDidMount(){gt.a.on("clientUpdateFastUpdatingComplete",this.onFastUpdatingComplete),gt.a.on("updateChatTitle",this.onUpdateChatTitle)}componentWillUnmount(){gt.a.off("clientUpdateFastUpdatingComplete",this.onFastUpdatingComplete),gt.a.off("updateChatTitle",this.onUpdateChatTitle)}render(){const e=this.props,t=e.t,a=e.chatId,n=e.showSavedMessages,i=Object(Ze.S)(a),o=Object(Ze.u)(a,n,t);return s.a.createElement("div",{className:"dialog-title"},s.a.createElement("span",{className:"dialog-title-span"},o),i&&s.a.createElement(wt,{className:"dialog-title-icon"}))}}Mt.defaultProps={showSavedMessages:!0};var It=Object(p.c)()(Mt),_t=Object(Je.a)(s.a.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},s.a.createElement("g",{transform:"translate(-3.000000, 0.000000)",fill:"#E53935",fillRule:"nonzero"},s.a.createElement("path",{d:"M10,0.4 C13.6450793,0.4 16.6,3.35492065 16.6,7 C16.6,10.6450793 13.6450793,13.6 10,13.6 C6.35492065,13.6 3.4,10.6450793 3.4,7 C3.4,3.35492065 6.35492065,0.4 10,0.4 Z M10,9.25 C9.58578644,9.25 9.25,9.58578644 9.25,10 C9.25,10.4142136 9.58578644,10.75 10,10.75 C10.4142136,10.75 10.75,10.4142136 10.75,10 C10.75,9.58578644 10.4142136,9.25 10,9.25 Z M10,2.85 C9.64101491,2.85 9.35,3.14101491 9.35,3.5 L9.35,7.5 C9.35,7.85898509 9.64101491,8.15 10,8.15 C10.3589851,8.15 10.65,7.85898509 10.65,7.5 L10.65,3.5 C10.65,3.14101491 10.3589851,2.85 10,2.85 Z"}))),"Error"),xt=Object(Je.a)(s.a.createElement("g",{strokeWidth:"1",fill:"none",fillRule:"evenodd",strokeLinecap:"round",strokeLinejoin:"round"},s.a.createElement("g",{transform:"translate(-3.000000, 0.000000)"},s.a.createElement("circle",{strokeWidth:"1.2",cx:"10",cy:"7",r:"6"}),s.a.createElement("line",{x1:"10",y1:"3.5",x2:"10",y2:"7",strokeWidth:"1.3"}),s.a.createElement("line",{x1:"12",y1:"9",x2:"10",y2:"7",strokeWidth:"1.3"}))),"Pending"),Ot=Object(Je.a)(s.a.createElement("path",{transform:"translate(-4.000000, -2.000000)",d:"M7.96833846,10.0490996 L14.5108251,2.571972 C14.7472185,2.30180819 15.1578642,2.27443181 15.428028,2.51082515 C15.6711754,2.72357915 15.717665,3.07747757 15.5522007,3.34307913 L15.4891749,3.428028 L8.48917485,11.428028 C8.2663359,11.6827011 7.89144111,11.7199091 7.62486888,11.5309823 L7.54038059,11.4596194 L4.54038059,8.45961941 C4.2865398,8.20577862 4.2865398,7.79422138 4.54038059,7.54038059 C4.7688373,7.31192388 5.12504434,7.28907821 5.37905111,7.47184358 L5.45961941,7.54038059 L7.96833846,10.0490996 L14.5108251,2.571972 L7.96833846,10.0490996 Z"}),"Sent"),Pt=Object(Je.a)(s.a.createElement("path",{transform:"translate(-1.000000, -2.000000)",d:"M4.96833846,10.0490996 L11.5108251,2.571972 C11.7472185,2.30180819 12.1578642,2.27443181 12.428028,2.51082515 C12.6711754,2.72357915 12.717665,3.07747757 12.5522007,3.34307913 L12.4891749,3.428028 L5.48917485,11.428028 C5.2663359,11.6827011 4.89144111,11.7199091 4.62486888,11.5309823 L4.54038059,11.4596194 L1.54038059,8.45961941 C1.2865398,8.20577862 1.2865398,7.79422138 1.54038059,7.54038059 C1.7688373,7.31192388 2.12504434,7.28907821 2.37905111,7.47184358 L2.45961941,7.54038059 L4.96833846,10.0490996 L11.5108251,2.571972 L4.96833846,10.0490996 Z M9.96833846,10.0490996 L16.5108251,2.571972 C16.7472185,2.30180819 17.1578642,2.27443181 17.428028,2.51082515 C17.6711754,2.72357915 17.717665,3.07747757 17.5522007,3.34307913 L17.4891749,3.428028 L10.4891749,11.428028 C10.2663359,11.6827011 9.89144111,11.7199091 9.62486888,11.5309823 L9.54038059,11.4596194 L8.54038059,10.4596194 C8.2865398,10.2057786 8.2865398,9.79422138 8.54038059,9.54038059 C8.7688373,9.31192388 9.12504434,9.28907821 9.37905111,9.47184358 L9.45961941,9.54038059 L9.96833846,10.0490996 L16.5108251,2.571972 L9.96833846,10.0490996 Z"}),"Succeeded"),Tt=a(17),Nt=a(8);a(379);class Dt extends s.a.Component{constructor(...e){super(...e),this.state={},this.onUpdateMessageSend=e=>{const t=this.props,a=t.chatId,n=t.messageId,s=e.old_message_id,i=e.message;if(n!==s)return;if(!i)return;const o=i.chat_id,r=i.id,c=i.sending_state;a===o&&(this.newMessageId=r,this.setState({sendingState:c}))},this.onUpdateChatReadOutbox=e=>{const t=this.props,a=t.chatId,n=t.messageId,s=e.chat_id,i=e.last_read_outbox_message_id,o=this.newMessageId;a===s&&(o&&o<=i||n<=i)&&this.setState({sendingState:null,unread:!1})}}static getDerivedStateFromProps(e,t){const a=e.chatId,n=e.messageId,s=Nt.a.get(a,n),i=s?s.sending_state:null;return a!==t.prevChatId||n!==t.prevMessageId?{prevChatId:a,prevMessageId:n,sendingState:i,unread:Object(Tt.H)(a,n)}:null}componentDidMount(){gt.a.on("updateChatReadOutbox",this.onUpdateChatReadOutbox),Nt.a.on("updateMessageSendFailed",this.onUpdateMessageSend),Nt.a.on("updateMessageSendSucceeded",this.onUpdateMessageSend)}componentWillUnmount(){gt.a.off("updateChatReadOutbox",this.onUpdateChatReadOutbox),Nt.a.off("updateMessageSendFailed",this.onUpdateMessageSend),Nt.a.off("updateMessageSendSucceeded",this.onUpdateMessageSend)}render(){const e=this.state,t=e.sendingState;return e.unread?t?"messageSendingStateFailed"===t["@type"]?s.a.createElement(_t,{className:"status",viewBox:"0 0 14 14",style:{width:16,height:12,transform:"translate(0, 1px)"}}):s.a.createElement(xt,{className:"status",viewBox:"0 0 14 14",style:{width:16,height:12,transform:"translate(0, 1px)",stroke:"currentColor"}}):s.a.createElement(Ot,{className:"status",viewBox:"0 0 12 10",style:{width:16,height:9}}):s.a.createElement(Pt,{className:"status",viewBox:"0 0 17 10",style:{width:16,height:9}})}}var Lt=Dt;a(380);class jt extends s.a.Component{constructor(...e){super(...e),this.onClientUpdateClearHistory=e=>{this.props.chatId===e.chatId&&(this.clearHistory=e.inProgress,this.forceUpdate())},this.onFastUpdatingComplete=e=>{this.forceUpdate()},this.onUpdate=e=>{this.props.chatId===e.chat_id&&this.forceUpdate()}}shouldComponentUpdate(e,t){const a=this.props.chatId;return e.chatId!==a}componentDidMount(){gt.a.on("clientUpdateFastUpdatingComplete",this.onFastUpdatingComplete),gt.a.on("clientUpdateClearHistory",this.onClientUpdateClearHistory),gt.a.on("updateChatDraftMessage",this.onUpdate),gt.a.on("updateChatLastMessage",this.onUpdate),gt.a.on("updateChatReadInbox",this.onUpdate),gt.a.on("updateChatUnreadMentionCount",this.onUpdate),gt.a.on("updateMessageMentionRead",this.onUpdate)}componentWillUnmount(){gt.a.off("clientUpdateFastUpdatingComplete",this.onFastUpdatingComplete),gt.a.off("clientUpdateClearHistory",this.onClientUpdateClearHistory),gt.a.off("updateChatDraftMessage",this.onUpdate),gt.a.off("updateChatLastMessage",this.onUpdate),gt.a.off("updateChatReadInbox",this.onUpdate),gt.a.off("updateChatUnreadMentionCount",this.onUpdate),gt.a.off("updateMessageMentionRead",this.onUpdate)}render(){if(this.clearHistory)return null;const e=this.props.chatId,t=gt.a.get(e);if(!t)return null;const a=t.last_message;if(!a)return null;const n=Object(Ze.B)(t);if(!n)return null;const i=a.id,o=a.is_outgoing;return s.a.createElement("div",{className:"dialog-meta"},o&&s.a.createElement(s.a.Fragment,null,s.a.createElement(Lt,{chatId:e,messageId:i}),s.a.createElement("span",null," ")),n)}}var Rt=jt;function At(e,t){V.a.send({"@type":"setChatChatList",chat_id:e,chat_list:t})}function Ft(e,t){V.a.send({"@type":"toggleChatIsPinned",chat_id:e,is_pinned:t})}function Bt(e,t){V.a.send({"@type":"toggleChatIsMarkedAsUnread",chat_id:e,is_marked_as_unread:t})}function Vt(e,t){const a=gt.a.get(e);if(!a)return;if(!a.notification_settings)return;if(Object(Ze.P)(e)===t)return;const n=t?B.v:B.w,s=Object(ae.a)({},a.notification_settings,{use_default_mute_for:!1,mute_for:n});V.a.send({"@type":"setChatNotificationSettings",chat_id:e,notification_settings:s})}function zt(e){return Ht.apply(this,arguments)}function Ht(){return(Ht=Object(h.a)(d.a.mark((function e(t){var a,n,s,i,o,r,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(gt.a.get(t)){e.next=3;break}return e.abrupt("return");case 3:return a=[],n=V.a.send({"@type":"getChatMessageCount",chat_id:t,filter:{"@type":"searchMessagesFilterPhoto"},return_local:!1}).then(e=>e?e.count:0).catch(()=>0),a.push(n),s=V.a.send({"@type":"getChatMessageCount",chat_id:t,filter:{"@type":"searchMessagesFilterVideo"},return_local:!1}).then(e=>e?e.count:0).catch(()=>0),a.push(s),i=V.a.send({"@type":"getChatMessageCount",chat_id:t,filter:{"@type":"searchMessagesFilterDocument"},return_local:!1}).then(e=>e?e.count:0).catch(()=>0),a.push(i),o=V.a.send({"@type":"getChatMessageCount",chat_id:t,filter:{"@type":"searchMessagesFilterAudio"},return_local:!1}).then(e=>e?e.count:0).catch(()=>0),a.push(o),r=V.a.send({"@type":"getChatMessageCount",chat_id:t,filter:{"@type":"searchMessagesFilterUrl"},return_local:!1}).then(e=>e?e.count:0).catch(()=>0),a.push(r),c=V.a.send({"@type":"getChatMessageCount",chat_id:t,filter:{"@type":"searchMessagesFilterVoiceNote"},return_local:!1}).then(e=>e?e.count:0).catch(()=>0),a.push(c),e.next=18,Promise.all(a);case 18:return e.abrupt("return",e.sent);case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}a(381);class Wt extends n.Component{constructor(e){var t;super(e),t=this,this.onClientUpdateChatId=e=>{const t=this.props.chatId;t!==e.previousChatId&&t!==e.nextChatId||this.forceUpdate()},this.handleSelect=e=>{0===e.button&&Object(nt.h)(this.props.chatId)},this.handleContextMenu=function(){var e=Object(h.a)(d.a.mark((function e(a){var n,s,i,o,r,c,l;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a&&(a.preventDefault(),a.stopPropagation()),n=t.props.chatId,!t.state.contextMenu){e.next=7;break}t.setState({contextMenu:!1}),e.next=19;break;case 7:return s=a.clientX,i=a.clientY,o=gt.a.get(n),r=o.is_pinned,e.next=13,t.canPinChats(n);case 13:if(e.t0=e.sent,e.t0){e.next=16;break}e.t0=r;case 16:c=e.t0,l=Object(Ze.g)(n),t.setState({contextMenu:!0,canTogglePin:c,canToggleArchive:l,left:s,top:i});case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleCloseContextMenu=e=>{e&&e.stopPropagation(),this.setState({contextMenu:!1})},this.handleMute=e=>{this.handleCloseContextMenu(e);const t=this.props.chatId;Vt(t,!Object(Ze.P)(t))},this.canPinChats=function(){var e=Object(h.a)(d.a.mark((function e(t){var a,n,s,i;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=Object(Ze.N)(t)?re.a.get("pinned_archived_chat_count_max"):re.a.get("pinned_chat_count_max")){e.next=3;break}return e.abrupt("return",!1);case 3:return n=Object(Ze.Q)(t),e.next=6,V.a.send({"@type":"getChats",chat_list:Object(Ze.N)(t)?{"@type":"chatListArchive"}:{"@type":"chatListMain"},offset_order:"9223372036854775807",offset_chat_id:0,limit:a.value+10});case 6:return s=e.sent,i=s.chat_ids.reduce((e,t)=>{if(Object(Ze.Q)(t)!==n)return e;const a=gt.a.get(t);return e+(a&&a.is_pinned?1:0)},0),e.abrupt("return",i<a.value);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handlePin=function(){var e=Object(h.a)(d.a.mark((function e(a){var n,s,i;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.handleCloseContextMenu(a),n=t.props.chatId,s=gt.a.get(n)){e.next=5;break}return e.abrupt("return");case 5:if((i=s.is_pinned)||t.canPinChats(n)){e.next=8;break}return e.abrupt("return");case 8:Ft(n,!i);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleArchive=function(){var e=Object(h.a)(d.a.mark((function e(a){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.handleCloseContextMenu(a),n=t.props.chatId,Object(Ze.g)(n)){e.next=4;break}return e.abrupt("return");case 4:At(n,{"@type":Object(Ze.N)(n)?"chatListMain":"chatListArchive"});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getViewInfoTitle=()=>{const e=this.props,t=e.chatId,a=e.t,n=gt.a.get(t);if(!n)return;const s=n.type;switch(s["@type"]){case"chatTypeBasicGroup":return a("ViewGroupInfo");case"chatTypePrivate":case"chatTypeSecret":return a("ViewProfile");case"chatTypeSupergroup":return s.is_channel?a("ViewChannelInfo"):a("ViewGroupInfo")}},this.handleViewInfo=e=>{this.handleCloseContextMenu(e);const t=this.props.chatId;Object(nt.h)(t,null,!0)},this.handleRead=e=>{this.handleCloseContextMenu(e);const t=this.props.chatId;if(Object(Ze.R)(t)){const e=gt.a.get(t);if(!e)return;const a=e.is_marked_as_unread,n=e.last_message;e.unread_count>0&&n?function(e,t,a){V.a.send({"@type":"viewMessages",chat_id:e,message_ids:t,force_read:a})}(t,[n.id],!0):a&&Bt(t,!1)}else Bt(t,!0)},this.dialog=s.a.createRef();const a=gt.a.get(this.props.chatId);this.state={chat:a,contextMenu:!1,left:0,top:0}}shouldComponentUpdate(e,t){const a=this.props,n=a.chatId,s=a.t,i=a.hidden,o=a.isLastPinned,r=a.style,c=this.state.contextMenu;return e.chatId!==n||(e.t!==s||(e.hidden!==i||(e.isLastPinned!==o||(t.contextMenu!==c||!(!e.style||!r||r.top===e.style.top)))))}componentDidMount(){v.a.on("clientUpdateChatId",this.onClientUpdateChatId)}componentWillUnmount(){v.a.off("clientUpdateChatId",this.onClientUpdateChatId)}render(){const e=this.props,t=e.chatId,a=e.showSavedMessages,n=e.hidden,i=e.t,o=(e.isLastPinned,e.style),r=this.state,c=r.contextMenu,l=r.left,d=r.top,h=r.canToggleArchive,u=r.canTogglePin;if(n)return null;const p=gt.a.get(t).is_pinned,m=v.a.getChatId()===t,g=Object(Ze.P)(t),f=Object(Ze.R)(t),b=Object(Ze.N)(t);return s.a.createElement("div",{ref:this.dialog,className:q()(m?"dialog-active":"dialog",{"item-selected":m}),onMouseDown:this.handleSelect,onContextMenu:this.handleContextMenu,style:o},s.a.createElement("div",{className:"dialog-wrapper"},s.a.createElement(Ct,{chatId:t,showSavedMessages:a,showOnline:!0}),s.a.createElement("div",{className:"dialog-inner-wrapper"},s.a.createElement("div",{className:"tile-first-row"},s.a.createElement(It,{chatId:t}),s.a.createElement(Rt,{chatId:t})),s.a.createElement("div",{className:"tile-second-row"},s.a.createElement(vt,{chatId:t}),s.a.createElement(kt,{chatId:t})))),s.a.createElement(rt.a,{open:c,onClose:this.handleCloseContextMenu,anchorReference:"anchorPosition",anchorPosition:{top:d,left:l},anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"},onMouseDown:e=>e.stopPropagation()},s.a.createElement(ot.a,{onClick:e=>e.stopPropagation()},h&&s.a.createElement(it.a,{onClick:this.handleArchive},i(b?"Unarchive":"Archive")),u&&s.a.createElement(it.a,{onClick:this.handlePin},i(p?"UnpinFromTop":"PinToTop")),s.a.createElement(it.a,{onClick:this.handleViewInfo},this.getViewInfoTitle()),s.a.createElement(it.a,{onClick:this.handleMute},i(g?"ChatsUnmute":"ChatsMute")),s.a.createElement(it.a,{onClick:this.handleRead},i(f?"MarkAsRead":"MarkAsUnread")))))}}Wt.defaultProps={hidden:!1,showSavedMessages:!0};var Gt=Object(p.c)()(Wt);const Kt=e=>({height:e,position:"relative"}),Zt=(e,t)=>({height:t,left:0,right:0,top:t*e,position:"absolute"});class qt extends s.a.Component{constructor(e){super(e),this.setViewportHeight=()=>{const e=this.props.source,t=this.state.scrollTop,a=this.listRef.current;if(!a)return;const n=parseFloat(window.getComputedStyle(a,null).getPropertyValue("height")),s=this.getRenderIds(e,n,t);this.setState(Object(ae.a)({viewportHeight:n},s))},this.setScrollPosition=e=>{const t=this.props,a=t.source,n=t.rowHeight,s=t.onScroll,i=this.state,o=i.viewportHeight,r=i.scrollTop;if(Math.abs(e.target.scrollTop-r)>=n){const t=this.getRenderIds(a,o,e.target.scrollTop);this.setState(Object(ae.a)({scrollTop:e.target.scrollTop},t))}s&&s(e)},this.isVisibleItem=(e,t,a)=>{const n=this.props,s=n.overScanCount,i=n.rowHeight;return e*i>a-s*i&&(e+1)*i<a+t+s*i},this.listRef=s.a.createRef(),this.state={scrollTop:0,renderIds:new Map,renderIdsList:[],viewportHeight:0}}componentDidUpdate(e,t,a){e.source!==this.props.source&&this.setViewportHeight()}shouldComponentUpdate(e,t,a){return!0}componentDidMount(){window.addEventListener("resize",this.setViewportHeight,!0);const e=this.listRef.current;e&&(e.addEventListener("scroll",this.setScrollPosition,!0),this.setViewportHeight())}getRenderIds(e,t,a){const n=new Map,s=[];return e.forEach((e,i)=>{this.isVisibleItem(i,t,a)&&(n.set(i,i),s.push(i))}),{renderIds:n,renderIdsList:s}}componentWillUnmount(){window.removeEventListener("resize",this.setViewportHeight);const e=this.listRef.current;e&&e.removeEventListener("scroll",this.setScrollPosition)}getListRenderIds(){return this.state.renderIds}getListRef(){return this.listRef}render(){const e=this.props,t=e.className,a=e.source,n=e.renderItem,i=e.rowHeight,o=this.state.renderIds,r=(a||[]).map((e,t)=>o.has(t)&&n({index:t,style:Zt(t,i)}));return s.a.createElement("div",{ref:this.listRef,className:t},s.a.createElement("div",{style:Kt((a||[]).length*i)},r))}}qt.defaultProps={source:[],rowHeight:72,overScanCount:5};var Yt=qt,Jt=a(43),Qt=a(30);a(382);function Xt(e){if(e.nodeType===Node.TEXT_NODE)return e;for(let t=e.childNodes.length-1;t>=0;t--){const a=Xt(e.childNodes[t]);if(a)return a}return null}function $t(e){if(!e)return;const t=Xt(e);if(t){const e=document.createRange();e.setStart(t,t.length),e.collapse(!0);const a=window.getSelection();a.removeAllRanges(),a.addRange(e)}e.focus()}function ea(e,t="smooth"){e&&(e.scrollTop=Math.min(e.scrollTop,100),setTimeout(()=>{e.scrollTo({top:0,behavior:t})},50))}class ta extends s.a.Component{shouldComponentUpdate(e,t,a){const n=this.props,s=n.chatId,i=n.style,o=n.hidden;return e.chatId!==s||(e.hidden!==o||e.style.top!==i.top)}render(){const e=this.props,t=e.chatId,a=e.hidden,n=e.style;return s.a.createElement("div",{className:"dialog-list-item",style:n},s.a.createElement(Gt,{chatId:t,hidden:a}))}}class aa extends s.a.Component{constructor(e){var t;super(e),t=this,this.onClientUpdateLeaveChat=e=>{const t=e.inProgress,a=e.chatId;t?this.hiddenChats.set(a,a):this.hiddenChats.delete(a),this.forceUpdate()},this.onUpdateAuthorizationState=e=>{const t=e.authorization_state;this.setState({authorizationState:t},()=>this.loadFirstSlice())},this.onFastUpdatingComplete=e=>{this.onLoadNext(!0)},this.loadFirstSlice=Object(h.a)(d.a.mark((function e(){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.state.authorizationState,!Object(ze.p)(a)){e.next=4;break}return e.next=4,ft.a.initDB(()=>t.onLoadNext(!0));case 4:case"end":return e.stop()}}),e)}))),this.saveCache=()=>{const e=this.props.onSaveCache;e&&e()},this.onUpdateChatOrder=e=>{const t=this.props.type,a=this.state.chats;if(this.loading)return;const n=e.chat_id,s=e.order,i=gt.a.get(n);if(!i||!i.chat_list||i.chat_list["@type"]!==t)return;const o=[],r=[];for(let c=0;c<a.length;c++){let e=gt.a.get(a[c]);if(e&&"0"!==e.order)switch(e.type["@type"]){case"chatTypeBasicGroup":"chatMemberStatusLeft"!==Jt.a.get(e.type.basic_group_id).status["@type"]&&r.push(e.id);break;case"chatTypePrivate":case"chatTypeSecret":r.push(e.id);break;case"chatTypeSupergroup":"chatMemberStatusLeft"!==Qt.a.get(e.type.supergroup_id).status["@type"]&&r.push(e.id);break}}if("0"===s)n===v.a.getChatId()&&(V.a.setChatId(0),v.a.changeChatDetailsVisibility(!1));else if(a.length>0){a.find(e=>e===n)||o.push(n)}else o.push(n);this.reorderChats(r,o,()=>{this.loadChatContents(o),this.saveCache()})},this.handleScroll=()=>{const e=this.listRef.current.getListRef().current;e&&(e.scrollTop<=B.fb?this.onLoadPrev():e.scrollTop+e.offsetHeight>=e.scrollHeight-e.offsetHeight&&this.onLoadNext())},this.renderItem=({index:e,style:t},a)=>{const n=a[e];return s.a.createElement(ta,{key:n,chatId:n,hidden:this.hiddenChats.has(n),style:t})},this.hiddenChats=new Map,this.listRef=s.a.createRef();const a=v.a.authorizationState;this.state={authorizationState:a,offset:0,chats:null,fistSliceLoaded:!1}}shouldComponentUpdate(e,t){const a=this.props,n=a.theme,s=a.open,i=a.showArchive,o=a.archiveTitle,r=a.items,c=a.cacheItems,l=this.state,d=l.chats,h=l.offset;return e.theme!==n||(e.open!==s||(e.items!==r||(e.cacheItems!==c||(e.showArchive!==i||(e.archiveTitle!==o||(t.offset!==h||t.chats!==d))))))}getSnapshotBeforeUpdate(e,t){const a=this.listRef.current;return a?{scrollTop:a.scrollTop}:{scrollTop:0}}componentDidUpdate(e,t,a){if(!this.listRef.current)return;a.scrollTop}componentDidMount(){this.loadFirstSlice(),v.a.on("updateAuthorizationState",this.onUpdateAuthorizationState),gt.a.on("updateChatDraftMessage",this.onUpdateChatOrder),gt.a.on("updateChatIsPinned",this.onUpdateChatOrder),gt.a.on("updateChatIsSponsored",this.onUpdateChatOrder),gt.a.on("updateChatLastMessage",this.onUpdateChatOrder),gt.a.on("updateChatOrder",this.onUpdateChatOrder),gt.a.on("clientUpdateFastUpdatingComplete",this.onFastUpdatingComplete),gt.a.on("clientUpdateLeaveChat",this.onClientUpdateLeaveChat)}componentWillUnmount(){v.a.off("updateAuthorizationState",this.onUpdateAuthorizationState),gt.a.off("updateChatDraftMessage",this.onUpdateChatOrder),gt.a.off("updateChatIsPinned",this.onUpdateChatOrder),gt.a.off("updateChatIsSponsored",this.onUpdateChatOrder),gt.a.off("updateChatLastMessage",this.onUpdateChatOrder),gt.a.off("updateChatOrder",this.onUpdateChatOrder),gt.a.off("clientUpdateFastUpdatingComplete",this.onFastUpdatingComplete),gt.a.off("clientUpdateLeaveChat",this.onClientUpdateLeaveChat)}reorderChats(e,t=[],a){const n=e.concat(t).sort((e,t)=>Object(ze.u)(gt.a.get(t).order,gt.a.get(e).order));aa.isDifferentOrder(this.state.chats,n)?this.setState({chats:n},a):a&&a()}static isDifferentOrder(e,t){if(e.length===t.length){for(let a=0;a<e.length;a++)if(e[a]!==t[a])return!0;return!1}return!0}onLoadPrev(){this.setState({offset:Math.max(this.state.offset-B.e,0)})}onLoadNext(e=!1){var t=this;return Object(h.a)(d.a.mark((function a(){var n,s,i,o,r,c,l,h;return d.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=t.props.type,s=t.state,i=s.offset,!((o=s.chats)&&i+2*B.e<o.length)){a.next=5;break}return t.setState({offset:i+B.e}),a.abrupt("return");case 5:if(!t.loading){a.next=7;break}return a.abrupt("return");case 7:return r="9223372036854775807",c=0,!e&&o&&o.length>0&&(l=gt.a.get(o[o.length-1]))&&(r=l.order,c=l.id),"chatListMain"===n&&console.log("[update] GETCHATS start"),t.loading=!0,a.next=14,V.a.send({"@type":"getChats",chat_list:{"@type":n},offset_chat_id:c,offset_order:r,limit:B.e}).finally(()=>{t.loading=!1,"chatListMain"===n&&console.log("[update] GETCHATS stop"),e&&V.a.clientUpdate({"@type":"clientUpdateDialogsReady"})});case 14:(h=a.sent).chat_ids.length>0&&h.chat_ids[0]===c&&h.chat_ids.shift(),e?t.replaceChats(h.chat_ids,()=>{t.loadChatContents(h.chat_ids),t.saveCache()}):t.appendChats(h.chat_ids,()=>{t.loadChatContents(h.chat_ids)});case 17:case"end":return a.stop()}}),a)})))()}loadChatContents(e){const t=ft.a.getStore();Object(mt.p)(t,e)}appendChats(e,t){if(0===e.length)return void(t&&t());const a=(this.state.chats||[]).concat(e);this.setState({chats:a,offset:a.length-2*B.e},t)}replaceChats(e,t){this.setState({chats:e,offset:0},t)}scrollToTop(){ea(this.listRef.current.getListRef().current)}render(){const e=this.props,t=e.type,a=e.open,n=e.cacheItems,i=(e.showArchive,e.archiveTitle,this.state),o=i.chats;i.offset;if(!a)return null;this.source=[];let r=null;if(o){let e=0;o.forEach(t=>{const a=gt.a.get(t);a&&a.is_pinned&&(e=t)}),this.source=o}else if(n){let e=0;n.forEach(t=>{const a=gt.a.get(t);a&&a.is_pinned&&(e=t)}),this.source=n.map(e=>e.id)}else"chatListMain"===t&&(r=Array.from(Array(10)).map((e,t)=>s.a.createElement(Ye,{key:t,index:t})));return s.a.createElement(Yt,{ref:this.listRef,className:"dialogs-list",source:this.source,rowHeight:76,overScanCount:20,renderItem:e=>this.renderItem(e,this.source),onScroll:this.handleScroll})}}var na=aa;class sa extends s.a.Component{render(){const e=this.props,t=e.title,a=e.t,n=Array.from(Array(10)).map((e,t)=>s.a.createElement(Ye,{key:t,index:t}));return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:q()("page",{"page-third-column":!1})},s.a.createElement("div",{className:q()("dialogs",{"dialogs-third-column":!1})},s.a.createElement("div",{className:"header-master"},s.a.createElement(J.a,{className:"header-left-button","aria-label":"Menu"},s.a.createElement(Qe,null)),s.a.createElement("div",{className:"header-status grow cursor-pointer"},s.a.createElement("span",{className:"header-status-content"},a("AppName"))),s.a.createElement(J.a,{className:"header-right-button","aria-label":a("Search")},s.a.createElement(et,null))),n),s.a.createElement("div",{className:q()("dialog-details",{"dialog-details-third-column":!1})},s.a.createElement("div",{className:"header-details"},s.a.createElement("div",{className:q()("header-status","grow","cursor-default")},s.a.createElement("span",{className:"header-status-content"},t),Boolean(t)&&s.a.createElement(te,null))),s.a.createElement("div",{className:"messages-list"},s.a.createElement($e,null)))),s.a.createElement(Fe,null))}}Object(p.c)()(sa);var ia=a(122),oa=a(104),ra=a(86);var ca=function(e){class t extends s.a.Component{render(){return s.a.createElement(ra.SnackbarProvider,{maxSnack:B.r},s.a.createElement(e,this.props))}}return t.displayName="WithSnackbarNotifications(".concat(Object(u.b)(e),")"),t},la=a(41);a(390);class da extends s.a.Component{render(){const e=this.props,t=e.chatId,a=e.selected,n=e.onSelect,i=e.t,o=Object(Ze.r)(t,!0,i);return s.a.createElement("div",{className:q()("forward-target-chat",{"forward-target-chat-selected":a}),onClick:n},s.a.createElement("div",{className:"forward-target-chat-tile"},s.a.createElement("div",{className:"forward-target-chat-tile-wrapper"},s.a.createElement(Ct,{chatId:t})),a&&s.a.createElement("div",{className:"forward-target-chat-selection"}),s.a.createElement("div",{className:q()("forward-target-chat-mark",a?"forward-target-chat-mark-selected":"forward-target-chat-mark-unselected")}),s.a.createElement("div",{className:"forward-target-chat-mark-icon"})),s.a.createElement("div",{className:"forward-target-chat-title"},o))}}var ha=Object(p.c)()(da);function ua(e){let t;try{t=document.createElement("textarea"),t.value=e,t.style.all="unset",t.style.position="fixed",t.style.top=0,t.style.clip="rect(0, 0, 0, 0)",t.style.whiteSpace="pre",t.style.webkitUserSelect="text",t.style.MozUserSelect="text",t.style.msUserSelect="text",t.style.userSelect="text",document.body.appendChild(t),t.select(),document.execCommand("copy")||console.error("unable to copy using execCommand")}catch(a){}finally{t&&document.body.removeChild(t)}}let pa=null;function ma(e){if(!e)return!1;const t=e.value;return!!t&&"ru"===t.value}function ga(e){if(!e)return null;if(!e.length)return null;const t=re.a.get("language_pack_id"),a=re.a.get("suggested_language_pack_id");if(!(ma(t)||ma(a)))return null;pa=pa||new Map([["q","\u0439"],["w","\u0446"],["e","\u0443"],["r","\u043a"],["t","\u0435"],["y","\u043d"],["u","\u0433"],["i","\u0448"],["o","\u0449"],["p","\u0437"],["[","\u0445"],["]","\u044a"],["a","\u0444"],["s","\u044b"],["d","\u0432"],["f","\u0430"],["g","\u043f"],["h","\u0440"],["j","\u043e"],["k","\u043b"],["l","\u0434"],[";","\u0436"],["'","\u044d"],["\\","\u0451"],["z","\u044f"],["x","\u0447"],["c","\u0441"],["v","\u043c"],["b","\u0438"],["n","\u0442"],["m","\u044c"],[",","\u0431"],[".","\u044e"]]);let n="";for(let s=0;s<e.length;s++){if(!pa.has(e[s]))return null;n+=pa.get(e[s])}return""===n?null:n}let fa=null;function ba(e){if(!e)return null;if(!e.length)return null;fa=fa||new Map([["\u0439","q"],["\u0446","w"],["\u0443","e"],["\u043a","r"],["\u0435","t"],["\u043d","y"],["\u0433","u"],["\u0448","i"],["\u0449","o"],["\u0437","p"],["\u0445","["],["\u044a","]"],["\u0444","a"],["\u044b","s"],["\u0432","d"],["\u0430","f"],["\u043f","g"],["\u0440","h"],["\u043e","j"],["\u043b","k"],["\u0434","l"],["\u0436",";"],["\u044d","'"],["\u0451","\\"],["\u044f","z"],["\u0447","x"],["\u0441","c"],["\u043c","v"],["\u0438","b"],["\u0442","n"],["\u044c","m"],["\u0431",","],["\u044e","."]]);let t="";for(let a=0;a<e.length;a++){if(!fa.has(e[a]))return null;t+=fa.get(e[a])}return""===t?null:t}a(391);class Ca extends s.a.Component{constructor(e){var t;super(e),t=this,this.loadContent=Object(h.a)(d.a.mark((function e(){var a,n,s,i,o,r,c,l;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.getPublicMessageLink(),a=[],n=V.a.send({"@type":"getChats",offset_order:"9223372036854775807",offset_chat_id:0,limit:100}),a.push(n),s=V.a.send({"@type":"createPrivateChat",user_id:ht.a.getMyId(),force:!0}),a.push(s),e.next=8,Promise.all(a.map(e=>e.catch(e=>null)));case 8:i=e.sent,o=Object(T.a)(i,2),r=o[0],c=o[1],t.setState({chatIds:r.chat_ids,savedMessages:c}),l=ft.a.getStore(),Object(mt.p)(l,r.chat_ids);case 15:case"end":return e.stop()}}),e)}))),this.getPublicMessageLink=Object(h.a)(d.a.mark((function e(){var a,n,s,i;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.props,n=a.chatId,s=a.messageIds,n){e.next=3;break}return e.abrupt("return");case 3:if(s){e.next=5;break}return e.abrupt("return");case 5:if(!(s.length>1)){e.next=7;break}return e.abrupt("return");case 7:if(Object(Ze.X)(n)){e.next=9;break}return e.abrupt("return");case 9:if(Object(Ze.x)(n)){e.next=11;break}return e.abrupt("return");case 11:return e.next=13,V.a.send({"@type":"getPublicMessageLink",chat_id:n,message_id:s[0],for_album:!1});case 13:i=e.sent,t.setState({publicMessageLink:i});case 15:case"end":return e.stop()}}),e)}))),this.handleClose=()=>{V.a.clientUpdate({"@type":"clientUpdateForward",info:null})},this.handleCopyLink=()=>{const e=this.props.t,t=this.state.publicMessageLink;if(!t)return;if(!t.link)return;const a="copy_link_".concat(t.link),n=e("LinkCopied");ua(t.link),this.handleScheduledAction(a,n,null)},this.handleScheduledAction=(e,t,a)=>{if(!e)return;const n=this.props.enqueueSnackbar;if(!n)return;v.a.addScheduledAction(e,B.y+300,a)&&n(t,{autoHideDuration:B.y,action:[s.a.createElement(J.a,{key:"close","aria-label":"Close",color:"inherit",className:"notification-close-button",onClick:()=>v.a.removeScheduledAction(e)},s.a.createElement(la.a,null))]})},this.getForwardPhotoSize=(e,t)=>{if(1!==t.length)return null;const a=Nt.a.get(e,t[0]);if(!a)return null;const n=a.can_be_forwarded,s=a.content;if(!n&&"messageChatChangePhoto"===s["@type"]){const e=s.photo;if(!e)return null;const t=e.sizes;if(t&&t.length)return t[t.length-1]}return null},this.handleSend=()=>{this.handleClose(),Object(nt.a)();const e=this.props,t=e.chatId,a=e.messageIds,n=e.inputMessageContent;if(!t&&!a&&!n)return;const s=this.getInnerText(this.messageRef.current);this.targetChats.forEach(e=>{if(n)return s&&("caption"in n?n.caption={"@type":"formattedText",text:s,entities:null}:V.a.send({"@type":"sendMessage",chat_id:e,reply_to_message_id:0,disable_notifications:!1,from_background:!1,reply_markup:null,input_message_content:{"@type":"inputMessageText",text:{"@type":"formattedText",text:s,entities:null},disable_web_page_preview:!1,clear_draft:!1}})),void V.a.send({"@type":"sendMessage",chat_id:e,reply_to_message_id:0,disable_notifications:!1,from_background:!1,reply_markup:null,input_message_content:n});const i=this.getForwardPhotoSize(t,a);if(i){const t=i.width,a=i.height,n=i.photo;V.a.send({"@type":"sendMessage",chat_id:e,reply_to_message_id:0,disable_notifications:!1,from_background:!1,reply_markup:null,input_message_content:{"@type":"inputMessagePhoto",photo:{"@type":"inputFileId",id:n.id},thumbnail:null,added_sticker_file_ids:[],width:t,height:a,caption:{"@type":"formattedText",text:s,entities:null},ttl:0}})}else s&&V.a.send({"@type":"sendMessage",chat_id:e,reply_to_message_id:0,disable_notifications:!1,from_background:!1,reply_markup:null,input_message_content:{"@type":"inputMessageText",text:{"@type":"formattedText",text:s,entities:null},disable_web_page_preview:!1,clear_draft:!1}}),V.a.send({"@type":"forwardMessages",chat_id:e,from_chat_id:t,message_ids:a,disable_notifications:!1,from_background:!1,as_album:!1})})},this.handleChangeSelection=e=>{this.targetChats.has(e)?this.targetChats.delete(e):this.targetChats.set(e,e),this.forceUpdate()},this.getInnerText=e=>{const t=e.innerHTML;return"<br>"!==t&&"<div><br></div>"!==t||(e.innerHTML=null),e.innerText},this.handleSearchKeyDown=e=>{13===e.keyCode&&e.preventDefault()},this.handleSearchKeyUp=Object(h.a)(d.a.mark((function e(){var a,n,s,i,o,r,c,l,h,u,p;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.state,n=a.chatIds,s=a.savedMessages,i=t.searchRef.current){e.next=4;break}return e.abrupt("return");case 4:if("<br>"!==(o=i.innerHTML)&&"<div><br></div>"!==o||(i.innerHTML=null),r=t.getInnerText(i).trim()){e.next=10;break}return t.setState({searchText:null,searchResults:[],globalSearchResults:[]}),e.abrupt("return");case 10:return c=ba(r),l=ga(r),h=s?[s.id].concat(n.filter(e=>e!==s.id&&Object(Ze.e)(e))):n,u=h.filter(e=>t.hasSearchText(e,r)||c&&t.hasSearchText(e,c)||l&&t.hasSearchText(e,l)),t.setState({searchText:r,searchResults:u}),e.next=17,V.a.send({"@type":"searchChatsOnServer",query:r,limit:100});case 17:if(p=e.sent,t.state.searchText===r){e.next=20;break}return e.abrupt("return");case 20:t.setState({globalSearchResults:p.chat_ids});case 21:case"end":return e.stop()}}),e)}))),this.handleSearchPaste=e=>{const t=e.clipboardData.getData("text/plain");t&&(e.preventDefault(),document.execCommand("insertText",!1,t))},this.handleMessageKeyUp=()=>{const e=this.messageRef.current;if(!e)return;const t=e.innerHTML;"<br>"!==t&&"<div><br></div>"!==t||(e.innerHTML=null)},this.handleMessagePaste=e=>{const t=e.clipboardData.getData("text/plain");t&&(e.preventDefault(),document.execCommand("insertText",!1,t))},this.hasSearchText=(e,t)=>{const a=this.props.t,n=this.state.savedMessages;if(n&&e===n.id){if(-1!==(Object(Ze.u)(e,!0,a)||"").toLocaleLowerCase().indexOf(t.toLowerCase()))return!0}return-1!==(Object(Ze.u)(e,!1,a)||"").toLocaleLowerCase().indexOf(t.toLowerCase())||-1!==(Object(Ze.x)(e)||"").toLocaleLowerCase().indexOf(t.toLowerCase())},this.setSearchFocus=()=>{setTimeout(()=>{if(this.searchRef.current){this.searchRef.current.focus()}},100)},this.state={chatIds:[],savedMessages:null},this.searchRef=s.a.createRef(),this.messageRef=s.a.createRef(),this.targetChats=new Map}componentDidMount(){this.loadContent(),this.setSearchFocus()}render(){const e=this.props.t,t=this.state,a=t.chatIds,n=t.searchText,i=t.searchResults,o=t.globalSearchResults,r=t.savedMessages,c=t.publicMessageLink,l=(r?[r.id].concat(a.filter(e=>e!==r.id&&Object(Ze.e)(e))):a).map(e=>s.a.createElement(ha,{key:e,chatId:e,selected:this.targetChats.has(e),onSelect:()=>this.handleChangeSelection(e)})),d=new Map((i||[]).map(e=>[e,e])),h=(o||[]).filter(e=>e!==r.id&&Object(Ze.e)(e)&&!d.has(e)),u=(i||[]).concat(h).map(e=>s.a.createElement(ha,{key:e,chatId:e,selected:this.targetChats.has(e),onSelect:()=>this.handleChangeSelection(e)}));return s.a.createElement(M.a,{open:!0,onClose:this.handleClose,"aria-labelledby":"forward-dialog-title","aria-describedby":"forward-dialog-description",className:"forward-dialog"},s.a.createElement(O.a,{id:"forward-dialog-title"},e("ShareSendTo")),s.a.createElement("div",{ref:this.searchRef,id:"forward-dialog-search",contentEditable:!0,suppressContentEditableWarning:!0,placeholder:e("Search"),onKeyDown:this.handleSearchKeyDown,onKeyUp:this.handleSearchKeyUp,onPaste:this.handleSearchPaste}),s.a.createElement("div",{className:"forward-dialog-content"},s.a.createElement("div",{className:"forward-dialog-list"},l),n&&s.a.createElement("div",{className:"forward-dialog-search-list"},u)),this.targetChats.size>0&&s.a.createElement("div",{ref:this.messageRef,id:"forward-dialog-message",contentEditable:!0,suppressContentEditableWarning:!0,placeholder:e("ShareComment"),onKeyUp:this.handleMessageKeyUp,onPaste:this.handleMessagePaste}),s.a.createElement(I.a,null,s.a.createElement(w.a,{onClick:this.handleClose,color:"primary"},e("Cancel")),this.targetChats.size>0&&s.a.createElement(w.a,{onClick:this.handleSend,color:"primary",autoFocus:!0},e("Send")),!this.targetChats.size&&c&&s.a.createElement(w.a,{onClick:this.handleCopyLink,color:"primary"},e("CopyLink"))))}}var ya=Object(u.a)(Object(p.c)(),ra.withSnackbar)(Ca),va=a(248),Ea=a.n(va),Sa=a(254),Ua=a.n(Sa),ka=a(172),wa=a.n(ka),Ma=a(541),Ia=a(249),_a=a.n(Ia),xa=a(251),Oa=a.n(xa),Pa=Object(Je.a)(s.a.createElement("path",{d:"M12.1715729,2 C12.9672223,2 13.7302841,2.31607052 14.2928932,2.87867966 L21.1213203,9.70710678 C21.6839295,10.2697159 22,11.0327777 22,11.8284271 L22,19 C22,20.6568542 20.6568542,22 19,22 L5,22 C3.34314575,22 2,20.6568542 2,19 L2,5 C2,3.34314575 3.34314575,2 5,2 L12.1715729,2 Z M11,4 L5,4 C4.44771525,4 4,4.44771525 4,5 L4,19 C4,19.5522847 4.44771525,20 5,20 L19,20 C19.5522847,20 20,19.5522847 20,19 L20,13 L14,13 C12.4023191,13 11.0963391,11.75108 11.0050927,10.1762728 L11,10 L11,4 Z M19.586,11 L13,4.414 L13,10 C13,10.5128358 13.3860402,10.9355072 13.8833789,10.9932723 L14,11 L19.586,11 Z"}),"Document2"),Ta=a(252),Na=a.n(Ta),Da=a(498),La=a(493),ja=a(536),Ra=a(537),Aa=a(253),Fa=a.n(Aa),Ba=Object(Je.a)(s.a.createElement("path",{d:"M19,2 C20.6568542,2 22,3.34314575 22,5 L22,19 C22,20.6568542 20.6568542,22 19,22 L5,22 C3.34314575,22 2,20.6568542 2,19 L2,5 C2,3.34314575 3.34314575,2 5,2 L19,2 Z M8.95903938,14.4653367 L8.89694708,14.4202095 C8.68789701,14.291568 8.42133316,14.3352159 8.26303498,14.5116789 L8.2090719,14.5840012 L4.88033327,19.9929138 L4.93969424,19.9982115 L4.93969424,19.9982115 L12.446,20 L9.05890452,14.5810435 C9.0316623,14.5374559 8.99794603,14.4984621 8.95903938,14.4653367 L8.89694708,14.4202095 L8.95903938,14.4653367 Z M15.6580762,12.1926572 C15.4476303,12.0663122 15.1815603,12.1128758 15.0252035,12.2910614 L14.9720355,12.3639701 L12.551,16.396 L14.803,20 L19,20 C19.5410622,20 19.9817615,19.5702952 19.9994483,19.0335352 L15.8247114,12.3563345 C15.7828678,12.2893847 15.7257647,12.2332952 15.6580762,12.1926572 Z M19,4 L5,4 C4.44771525,4 4,4.44771525 4,5 L4,17.606 L6.50573804,13.5358344 C7.19919591,12.4089238 8.64230264,12.0252274 9.79631538,12.6320827 L9.94511393,12.7168756 C10.2187146,12.885239 10.4567799,13.1044297 10.6467737,13.3619985 L10.7549011,13.5210456 L11.361,14.492 L13.2573282,11.3345145 C13.9384069,10.2000794 15.3772263,9.80060652 16.5378139,10.3947912 L16.6875318,10.4779499 C16.9695672,10.6472749 17.2148477,10.8702509 17.409849,11.1335934 L17.5207081,11.2963367 L20,15.264 L20,5 C20,4.44771525 19.5522847,4 19,4 Z"}),"SharedMedia"),Va=a(250),za=a.n(Va),Ha=a(140);a(392);class Wa extends s.a.Component{constructor(e){super(e),this.onUpdateUserStatus=e=>{const t=this.props.chatId,a=gt.a.get(t);if(!a)return;if(!a.type)return;let n=!1;switch(a.type["@type"]){case"chatTypeBasicGroup":{const t=Jt.a.getFullInfo(a.type.basic_group_id);if(t&&t.members){t.members.find(t=>t.user_id===e.user_id)&&(n=!0)}break}case"chatTypePrivate":case"chatTypeSecret":a.type.user_id===e.user_id&&(n=!0)}n&&this.updateSubtitle(a)},this.updateSubtitle=e=>{this.setState({subtitle:Object(Ze.t)(e.id),isAccent:Object(Ze.L)(e.id)})},this.onUpdateUserFullInfo=e=>{const t=this.props.chatId,a=gt.a.get(t);if(!a)return;const n=a.type;n&&(!n||"chatTypePrivate"!==n["@type"]&&"chatTypeSecret"!==n["@type"]||n.user_id!==e.user_id||this.updateSubtitle(a))},this.onUpdateBasicGroupFullInfo=e=>{const t=this.props.chatId,a=gt.a.get(t);if(!a)return;const n=a.type;n&&n&&"chatTypeBasicGroup"===n["@type"]&&n.basic_group_id===e.basic_group_id&&this.updateSubtitle(a)},this.onUpdateSupergroupFullInfo=e=>{const t=this.props.chatId,a=gt.a.get(t);if(!a)return;const n=a.type;n&&n&&"chatTypeSupergroup"===n["@type"]&&n.supergroup_id===e.supergroup_id&&this.updateSubtitle(a)},this.onUpdateBasicGroup=e=>{const t=this.props.chatId,a=gt.a.get(t);if(!a)return;const n=a.type;n&&n&&"chatTypeBasicGroup"===n["@type"]&&n.basic_group_id===e.basic_group.id&&this.updateSubtitle(a)},this.onUpdateSupergroup=e=>{const t=this.props.chatId,a=gt.a.get(t);if(!a)return;const n=a.type;n&&n&&"chatTypeSupergroup"===n["@type"]&&n.supergroup_id===e.supergroup.id&&this.updateSubtitle(a)};const t=this.props.chatId;this.state={prevChatId:t,subtitle:Object(Ze.t)(t),isAccent:Object(Ze.L)(t)}}static getDerivedStateFromProps(e,t){if(e.chatId!==t.prevChatId){const t=e.chatId;return{prevChatId:t,subtitle:Object(Ze.t)(t),isAccent:Object(Ze.L)(t)}}return null}shouldComponentUpdate(e,t){const a=this.props.chatId,n=this.state,s=n.subtitle,i=n.isAccent;return e.chatId!==a||(t.subtitle!==s||t.isAccent!==i)}componentDidMount(){ht.a.on("updateUserStatus",this.onUpdateUserStatus),Jt.a.on("updateBasicGroup",this.onUpdateBasicGroup),Qt.a.on("updateSupergroup",this.onUpdateSupergroup),ht.a.on("updateUserFullInfo",this.onUpdateUserFullInfo),Jt.a.on("updateBasicGroupFullInfo",this.onUpdateBasicGroupFullInfo),Qt.a.on("updateSupergroupFullInfo",this.onUpdateSupergroupFullInfo)}componentWillUnmount(){ht.a.off("updateUserStatus",this.onUpdateUserStatus),Jt.a.off("updateBasicGroup",this.onUpdateBasicGroup),Qt.a.off("updateSupergroup",this.onUpdateSupergroup),ht.a.off("updateUserFullInfo",this.onUpdateUserFullInfo),Jt.a.off("updateBasicGroupFullInfo",this.onUpdateBasicGroupFullInfo),Qt.a.off("updateSupergroupFullInfo",this.onUpdateSupergroupFullInfo)}render(){const e=this.state,t=e.subtitle,a=e.isAccent;return s.a.createElement("div",{className:q()("dialog-status",{"dialog-status-accent":a})},t)}}var Ga=Wa;a(393);class Ka extends s.a.Component{constructor(e){super(e),this.handleClick=()=>{const e=this.props,t=e.chatId,a=e.onSelect;a&&a(t)};const t=this.props.chatId;this.state={chat:gt.a.get(t)}}shouldComponentUpdate(e,t){return e.chatId!==this.props.chatId}render(){const e=this.props,t=e.chatId,a=e.onTileSelect,n=e.showStatus,i=e.showSavedMessages,o=e.big,r=e.showTitle,c=Object(Ze.V)(t);return s.a.createElement("div",{className:q()("chat",{"chat-big":o}),onClick:this.handleClick},s.a.createElement("div",{className:"chat-wrapper"},s.a.createElement(Ct,{big:o,chatId:t,onSelect:a,showSavedMessages:i}),r&&s.a.createElement("div",{className:"dialog-inner-wrapper"},s.a.createElement("div",{className:"tile-first-row"},s.a.createElement(It,{chatId:t,showSavedMessages:i})),n&&(!c||!i)&&s.a.createElement("div",{className:"tile-second-row"},s.a.createElement(Ga,{chatId:t})))))}}Ka.defaultProps={showSavedMessages:!0,showStatus:!0,showTitle:!0};var Za=Ka,qa=Object(Je.a)(s.a.createElement("path",{d:"M4.29289322,11.2928932 L11.2928932,4.29289322 C11.6834175,3.90236893 12.3165825,3.90236893 12.7071068,4.29289322 C13.0675907,4.65337718 13.0953203,5.22060824 12.7902954,5.61289944 L12.7071068,5.70710678 L7.414,11 L19,11 C19.5128358,11 19.9355072,11.3860402 19.9932723,11.8833789 L20,12 C20,12.5128358 19.6139598,12.9355072 19.1166211,12.9932723 L19,13 L7.414,13 L12.7071068,18.2928932 C13.0675907,18.6533772 13.0953203,19.2206082 12.7902954,19.6128994 L12.7071068,19.7071068 C12.3466228,20.0675907 11.7793918,20.0953203 11.3871006,19.7902954 L11.2928932,19.7071068 L4.29289322,12.7071068 C3.93240926,12.3466228 3.90467972,11.7793918 4.20970461,11.3871006 L4.29289322,11.2928932 L11.2928932,4.29289322 L4.29289322,11.2928932 Z"}),"Back");a(394);class Ya extends s.a.Component{constructor(e){super(e)}render(){const e=this.props,t=e.chatId,a=e.t,n=e.backButton,i=e.onClick,o=e.onClose;let r=a("ChatInfo");return Object(Ze.W)(t)?r=a("Info"):Object(Ze.M)(t)&&(r=a("ChannelInfo")),s.a.createElement("div",{className:"header-master"},n&&s.a.createElement(J.a,{className:"header-left-button",onClick:o},s.a.createElement(qa,null)),s.a.createElement("div",{className:"header-status grow cursor-pointer",onClick:i},s.a.createElement("span",{className:"header-status-content"},r)),!n&&s.a.createElement(J.a,{className:"header-right-button",onClick:o},s.a.createElement(la.a,null)))}}var Ja=Object(p.c)()(Ya),Qa=a(538),Xa=a(244),$a=a.n(Xa),en=a(243),tn=a.n(en),an=a(539);class nn extends s.a.Component{constructor(e){super(e),this.onUpdateChatNotificationSettings=e=>{const t=e.chat_id,a=this.props.chatId;t&&t===a&&this.setState({isMuted:Object(Ze.P)(a)})},this.onUpdateScopeNotificationSettings=e=>{const t=this.props.chatId,a=gt.a.get(t);switch(e.scope["@type"]){case"notificationSettingsScopeGroupChats":"chatTypeBasicGroup"!==a.type["@type"]&&"chatTypeSupergroup"!==a.type["@type"]||this.setState({isMuted:Object(Ze.P)(t)});break;case"notificationSettingsScopePrivateChats":"chatTypePrivate"!==a.type["@type"]&&"chatTypeSecret"!==a.type["@type"]||this.setState({isMuted:Object(Ze.P)(t)})}},this.handleSetChatNotifications=()=>{this.setState({isMuted:!this.state.isMuted}),this.debouncedSetChatNotificationSettings()},this.setChatNotificationSettings=()=>{Vt(this.props.chatId,this.state.isMuted)};const t=e.chatId;this.state={prevChatId:t,isMuted:Object(Ze.P)(t)},this.debouncedSetChatNotificationSettings=Object(ze.c)(this.setChatNotificationSettings,B.z)}static getDerivedStateFromProps(e,t){if(e.chatId!==t.prevChatId){const t=e.chatId;return{prevChatId:t,isMuted:Object(Ze.P)(t)}}return null}componentDidMount(){gt.a.on("updateChatNotificationSettings",this.onUpdateChatNotificationSettings),St.a.on("updateScopeNotificationSettings",this.onUpdateScopeNotificationSettings)}componentWillUnmount(){gt.a.off("updateChatNotificationSettings",this.onUpdateChatNotificationSettings),St.a.off("updateScopeNotificationSettings",this.onUpdateScopeNotificationSettings)}}var sn=nn;var on=Object(p.c)()(class extends sn{render(){const e=this.props.t,t=this.state.isMuted;return s.a.createElement(La.a,{button:!0,className:"list-item",onClick:this.handleSetChatNotifications},s.a.createElement(ja.a,null,t?s.a.createElement($a.a,null):s.a.createElement(tn.a,null)),s.a.createElement(Ra.a,{primary:s.a.createElement(Y.a,{variant:"inherit",noWrap:!0},e("Notifications"))}),s.a.createElement(Qa.a,null,s.a.createElement(an.a,{color:"primary",onChange:this.handleSetChatNotifications,checked:!t})))}}),rn=a(245),cn=a.n(rn),ln=a(246),dn=a.n(ln),hn=a(247),un=a.n(hn),pn=a(540);a(395);class mn extends s.a.Component{constructor(e){super(e),this.handleMoreClick=()=>{this.setState({openMore:!this.state.openMore})},this.handleSendMessage=()=>{const e=v.a.getChatId(),t=this.props.chatId;e===t||V.a.setChatId(t)},this.handleBlock=()=>{const e=this.state.chatId,t=gt.a.get(e);if(!t)return;if(!t.type)return;const a=t.type.user_id;a&&V.a.send({"@type":Object(dt.h)(a)?"unblockUser":"blockUser",user_id:a})};const t=this.props.chatId;this.state={prevChatId:t,openMore:!1}}static getDerivedStateFromProps(e,t){return e.chatId!==t.prevChatId?{prevChatId:e.chatId,openMore:!1}:null}render(){const e=this.props,t=e.t,a=e.chatId,n=this.state.openMore,i=gt.a.get(a);if(!i)return null;const o=Object(Ze.U)(a);let r=!1;!o&&i.type&&(r=Object(dt.h)(i.type.user_id));const c=Object(Ze.O)(a),l=Object(Ze.M)(a);return s.a.createElement(s.a.Fragment,null,s.a.createElement(La.a,{button:!0,className:"list-item",onClick:this.handleMoreClick},s.a.createElement(ja.a,null,s.a.createElement(cn.a,null)),s.a.createElement(Ra.a,{primary:s.a.createElement(Y.a,{variant:"inherit",noWrap:!0},t("More"))}),n?s.a.createElement(dn.a,null):s.a.createElement(un.a,null)),s.a.createElement(pn.a,{in:n,timeout:"auto",unmountOnExit:!0},s.a.createElement(Da.a,{component:"div",disablePadding:!0},!o&&s.a.createElement(s.a.Fragment,null,s.a.createElement(La.a,{button:!0,className:"list-item",onClick:this.handleSendMessage},s.a.createElement(Ra.a,{inset:!0,primary:s.a.createElement(Y.a,{variant:"inherit",noWrap:!0},t("SendMessage"))})),s.a.createElement(La.a,{button:!0,className:"list-item",onClick:this.handleBlock},s.a.createElement(Ra.a,{inset:!0,primary:s.a.createElement(Y.a,{color:"secondary",variant:"inherit",noWrap:!0},t(r?"Unblock":"BlockContact"))}))),o&&c&&s.a.createElement(La.a,{button:!0,className:"list-item"},s.a.createElement(Ra.a,{inset:!0,primary:s.a.createElement(Y.a,{color:"secondary",variant:"inherit",noWrap:!0},t(l?"LeaveChannel":"DeleteChat"))})),o&&!c&&s.a.createElement(La.a,{button:!0,className:"list-item"},s.a.createElement(Ra.a,{inset:!0,primary:s.a.createElement(Y.a,{color:"secondary",variant:"inherit",noWrap:!0},t("ReportChat"))})))))}}Object(p.c)()(mn),a(396);class gn extends s.a.Component{constructor(e){super(e),this.onUpdateBasicGroupFullInfo=e=>{const t=gt.a.get(this.props.chatId);t&&t.type&&"chatTypeBasicGroup"===t.type["@type"]&&t.type.basic_group_id===e.basic_group_id&&this.forceUpdate()},this.onUpdateSupergroupFullInfo=e=>{const t=gt.a.get(this.props.chatId);t&&t.type&&"chatTypeSupergroup"===t.type["@type"]&&t.type.supergroup_id===e.supergroup_id&&this.forceUpdate()},this.onUpdateUserFullInfo=e=>{const t=gt.a.get(this.props.chatId);t&&(!t.type||"chatTypePrivate"!==t.type["@type"]&&"chatTypeSecret"!==t.type["@type"]||t.type.user_id!==e.user_id||this.forceUpdate())},this.onUpdateUserStatus=e=>{this.members.has(e.user_id)&&this.forceUpdate()},this.loadContent=()=>{this.loadChatContents()},this.loadChatContents=()=>{const e=this.props,t=e.chatId,a=e.popup,n=ft.a.getStore();Object(mt.p)(n,[t]);const s=Object(Ze.y)(t).map(e=>e.user_id);Object(mt.A)(n,s),a&&Object(Ze.o)(t)},this.handleUsernameHint=()=>{const e=this.props,t=e.t,a=e.chatId,n=Object(Ze.x)(a);if(!n)return;const s=re.a.get("t_me_url");ua((s?s.value:"https://telegram.org/")+n);const i="".concat(a,"_copy_username"),o=t("TextCopied");this.handleScheduledAction(i,o,null)},this.handleScheduledAction=(e,t,a)=>{if(!e)return;const n=this.props.enqueueSnackbar;if(!n)return;v.a.addScheduledAction(e,B.y+300,a)&&n(t,{autoHideDuration:B.y,action:[s.a.createElement(J.a,{key:"close","aria-label":"Close",color:"inherit",className:"notification-close-button",onClick:()=>v.a.removeScheduledAction(e)},s.a.createElement(la.a,null))]})},this.handlePhoneHint=()=>{const e=this.props,t=e.t,a=e.chatId,n=Object(Ze.q)(a);if(!n)return;ua(Object(oa.a)(n));const s="".concat(a,"_copy_phone"),i=t("PhoneCopied");this.handleScheduledAction(s,i,null)},this.handleHeaderClick=()=>{this.chatDetailsListRef.current.scrollTop=0},this.handleOpenViewer=()=>{const e=this.props,t=e.chatId,a=e.popup,n=gt.a.get(t);n&&n.photo&&(Object(nt.q)({chatId:t}),a&&V.a.clientUpdate({"@type":"clientUpdateDialogChatId",chatId:0}))},this.handleOpenChat=()=>{const e=this.props,t=e.chatId,a=e.popup;Object(nt.h)(t,null,!1),a&&V.a.clientUpdate({"@type":"clientUpdateDialogChatId",chatId:0})},this.handleOpenUser=e=>{Object(nt.j)(e,!0)},this.getContentHeight=()=>this.chatDetailsListRef?this.chatDetailsListRef.current.clientHeight:0,this.chatDetailsListRef=s.a.createRef();const t=this.props.chatId;this.members=new Map,this.state={prevChatId:t}}static getDerivedStateFromProps(e,t){return e.chatId!==t.prevChatId?{prevChatId:e.chatId}:null}getSnapshotBeforeUpdate(e,t){this.props.chatId;const a=this.chatDetailsListRef.current;return{scrollTop:a.scrollTop,scrollHeight:a.scrollHeight,offsetHeight:a.offsetHeight}}shouldComponentUpdate(e,t){const a=this.props,n=a.chatId,s=a.theme,i=a.counters,o=a.migratedCounters;return e.chatId!==n||(e.counters!==i||(e.migratedCounters!==o||e.theme!==s))}componentDidUpdate(e,t,a){const n=this.props.chatId;e.chatId!==n&&this.loadContent();const s=this.chatDetailsListRef.current,i=a.scrollTop;a.scrollHeight,a.offsetHeight;e.chatId===n?s.scrollTop=i:s.scrollTop=0}componentDidMount(){this.loadContent(),ht.a.on("updateUserStatus",this.onUpdateUserStatus),ht.a.on("updateUserFullInfo",this.onUpdateUserFullInfo),Jt.a.on("updateBasicGroupFullInfo",this.onUpdateBasicGroupFullInfo),Qt.a.on("updateSupergroupFullInfo",this.onUpdateSupergroupFullInfo)}componentWillUnmount(){ht.a.off("updateUserStatus",this.onUpdateUserStatus),ht.a.off("updateUserFullInfo",this.onUpdateUserFullInfo),Jt.a.off("updateBasicGroupFullInfo",this.onUpdateBasicGroupFullInfo),Qt.a.off("updateSupergroupFullInfo",this.onUpdateSupergroupFullInfo)}render(){const e=this.props,t=e.backButton,a=e.className,n=e.chatId,i=e.onClose,o=e.onOpenGroupInCommon,r=e.onOpenSharedAudios,c=e.onOpenSharedDocuments,l=e.onOpenSharedLinks,d=(e.onOpenSharedMedia,e.onOpenSharedPhotos),h=e.onOpenSharedVideos,u=e.onOpenSharedVoiceNotes,p=e.popup,m=e.t;let g=this.props,f=g.counters,b=g.migratedCounters;f=f||[0,0,0,0,0,0],b=b||[0,0,0,0,0,0];const C=f.map((e,t)=>e+b[t]),y=Object(T.a)(C,6),v=y[0],E=y[1],S=y[2],U=y[3],k=y[4],w=y[5],M=gt.a.get(n);if(!M)return s.a.createElement("div",{className:"chat-details"},s.a.createElement(Ja,{onClose:i}),s.a.createElement("div",{ref:this.chatDetailsListRef,className:"chat-details-list"}));let I=0;if(Object(Ze.W)(n)){const e=ht.a.getFullInfo(M.type.user_id);I=e?e.group_in_common_count:I}const _=Object(Ze.x)(n),x=Object(Ze.q)(n),O=Object(Ze.j)(n),P=Object(Ze.U)(n),N=Object(Ze.V)(n),D=Object(Ze.y)(n),L=[];this.members=new Map,D.forEach(e=>{const t=ht.a.get(e.user_id);t&&(this.members.set(t.id,t.id),L.push(t))});const j=L.sort((e,t)=>Object(dt.g)(t)-Object(dt.g)(e)).map(e=>s.a.createElement(La.a,{button:!0,className:"list-item",key:e.id},s.a.createElement(Ha.a,{userId:e.id,onSelect:this.handleOpenUser}))),R=M.photo,A=s.a.createElement(s.a.Fragment,null,s.a.createElement(Ja,{chatId:n,backButton:t,onClose:i,onClick:this.handleHeaderClick}),s.a.createElement("div",{ref:this.chatDetailsListRef,className:"chat-details-list"},s.a.createElement("div",{className:"chat-details-info"},s.a.createElement(Za,{chatId:n,big:!0,showStatus:!0,showSavedMessages:!p,onTileSelect:R?this.handleOpenViewer:null})),(_||x||O)&&s.a.createElement(s.a.Fragment,null,s.a.createElement(Da.a,null,_&&s.a.createElement(La.a,{button:!0,className:"list-item",onClick:this.handleUsernameHint},s.a.createElement(ja.a,null,s.a.createElement(Ea.a,null)),s.a.createElement(Ra.a,{primary:s.a.createElement(Y.a,{variant:"inherit",noWrap:!0},_)})),x&&s.a.createElement(s.a.Fragment,null,s.a.createElement(La.a,{button:!0,className:"list-item",onClick:this.handlePhoneHint},s.a.createElement(ja.a,null,s.a.createElement(wa.a,null)),s.a.createElement(Ra.a,{primary:s.a.createElement(Y.a,{variant:"inherit",noWrap:!0},Object(oa.a)(x))}))),O&&s.a.createElement(La.a,{className:"list-item"},s.a.createElement(ja.a,null,s.a.createElement(_a.a,{className:"chat-details-info-icon"})),s.a.createElement(Ra.a,{primary:O,style:{whiteSpace:"pre-wrap",wordWrap:"break-word"}})))),(!N||P||p&&!P)&&s.a.createElement(s.a.Fragment,null,s.a.createElement(Ma.a,null),s.a.createElement(Da.a,null,!N&&s.a.createElement(on,{chatId:n}),p&&!P&&s.a.createElement(La.a,{button:!0,className:"list-item",onClick:this.handleOpenChat},s.a.createElement(Ra.a,{inset:!0,primary:s.a.createElement(Y.a,{color:"primary",variant:"inherit",noWrap:!0},m("SendMessage").toUpperCase())})))),(v>0||E>0||S>0||U>0||k>0||w>0||I>0)&&s.a.createElement(s.a.Fragment,null,s.a.createElement(Ma.a,null),s.a.createElement(Da.a,null,v>0&&s.a.createElement(La.a,{button:!0,className:"list-item",onClick:d},s.a.createElement(ja.a,null,s.a.createElement(Ba,null)),s.a.createElement(Ra.a,{primary:s.a.createElement(Y.a,{variant:"inherit",noWrap:!0},1===v?"1 photo":"".concat(v," photos"))})),E>0&&s.a.createElement(La.a,{button:!0,className:"list-item",onClick:h},s.a.createElement(ja.a,null,s.a.createElement(za.a,null)),s.a.createElement(Ra.a,{primary:s.a.createElement(Y.a,{variant:"inherit",noWrap:!0},1===E?"1 video":"".concat(E," videos"))})),S>0&&s.a.createElement(La.a,{button:!0,className:"list-item",onClick:c},s.a.createElement(ja.a,null,s.a.createElement(Pa,null)),s.a.createElement(Ra.a,{primary:s.a.createElement(Y.a,{variant:"inherit",noWrap:!0},1===S?"1 file":"".concat(S," files"))})),U>0&&s.a.createElement(La.a,{button:!0,className:"list-item",onClick:r},s.a.createElement(ja.a,null,s.a.createElement(Oa.a,null)),s.a.createElement(Ra.a,{primary:s.a.createElement(Y.a,{variant:"inherit",noWrap:!0},1===U?"1 audio file":"".concat(U," audio files"))})),k>0&&s.a.createElement(La.a,{button:!0,className:"list-item",onClick:l},s.a.createElement(ja.a,null,s.a.createElement(Na.a,null)),s.a.createElement(Ra.a,{primary:s.a.createElement(Y.a,{variant:"inherit",noWrap:!0},1===k?"1 shared link":"".concat(k," shared links"))})),w>0&&s.a.createElement(La.a,{button:!0,className:"list-item",onClick:u},s.a.createElement(ja.a,null,s.a.createElement(Fa.a,null)),s.a.createElement(Ra.a,{primary:s.a.createElement(Y.a,{variant:"inherit",noWrap:!0},1===w?"1 voice message":"".concat(w," voice messages"))})),I>0&&s.a.createElement(La.a,{button:!0,className:"list-item",onClick:o},s.a.createElement(ja.a,null,s.a.createElement(Ua.a,null)),s.a.createElement(Ra.a,{primary:s.a.createElement(Y.a,{variant:"inherit",noWrap:!0},1===I?"1 group in common":"".concat(I," groups in common"))})))),j.length>0&&s.a.createElement(s.a.Fragment,null,s.a.createElement(Ma.a,null),s.a.createElement(Da.a,null,j))));return p?s.a.createElement(s.a.Fragment,null,A):s.a.createElement("div",{className:q()("chat-details",a)},A)}}var fn=Object(u.a)(Object(u.d)(),Object(p.c)(),ra.withSnackbar,Object(u.c)())(gn);a(397);class bn extends s.a.Component{render(){const e=this.props.onClose;return s.a.createElement("div",{className:"header-master"},s.a.createElement(J.a,{className:"header-left-button",onClick:e},s.a.createElement(qa,null)),s.a.createElement("div",{className:"header-status grow cursor-pointer"},s.a.createElement("span",{className:"header-status-content"},"Groups in common")))}}var Cn=bn;a(398);class yn extends s.a.Component{constructor(e){super(e),this.handleSelect=e=>{const t=this.props.popup;Object(nt.h)(e),t&&V.a.clientUpdate({"@type":"clientUpdateDialogChatId",chatId:0})},this.state={chatIds:[]}}componentDidMount(){const e=this.props.chatId,t=Object(Ze.w)(e);t&&V.a.send({"@type":"getGroupsInCommon",user_id:t,offset_chat_id:0,limit:100}).then(e=>{const t=ft.a.getStore();Object(mt.p)(t,e.chat_ids),this.setState({chatIds:e.chat_ids})})}render(){const e=this.props,t=e.minHeight,a=e.onClose,n=e.popup,i=this.state.chatIds.map(e=>s.a.createElement(La.a,{button:!0,key:e},s.a.createElement(Za,{chatId:e,onSelect:this.handleSelect}))),o=s.a.createElement(s.a.Fragment,null,s.a.createElement(Cn,{onClose:a}),s.a.createElement("div",{className:"groups-in-common-list",style:{minHeight:t}},i));return n?s.a.createElement(s.a.Fragment,null,o):s.a.createElement("div",{className:"groups-in-common"},o)}}yn.defaultProps={popup:!1,minHeight:0};var vn=yn,En=a(11),Sn=a.n(En),Un=a(542);a(399);class kn extends s.a.Component{constructor(e){var t;super(e),t=this,this.handleOpenMessage=e=>{this.handleCloseContextMenu(e);const t=this.props,a=t.chatId,n=t.messageId;Object(nt.h)(a,n)},this.handleForward=e=>{this.handleCloseContextMenu(e);const t=this.props,a=t.chatId,n=t.messageId;Object(nt.e)(a,[n])},this.handleDelete=e=>{this.handleCloseContextMenu(e);const t=this.props,a=t.chatId,n=t.messageId,s=Nt.a.get(a,n);if(!s)return null;const i=s.can_be_deleted_for_all_users;this.setState({openDeleteDialog:!0,canBeDeletedForAllUsers:i,revoke:i})},this.handleContextMenu=function(){var e=Object(h.a)(d.a.mark((function e(a){var n,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a&&(a.preventDefault(),a.stopPropagation()),t.state.contextMenu?t.setState({contextMenu:!1}):(n=a.clientX,s=a.clientY,t.setState({contextMenu:!0,left:n,top:s}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleCloseContextMenu=e=>{e&&e.stopPropagation(),this.setState({contextMenu:!1})},this.handleRevokeChange=()=>{this.setState({revoke:!this.state.revoke})},this.handleCloseDelete=()=>{this.setState({openDeleteDialog:!1})},this.handleDeleteContinue=()=>{const e=this.props,t=e.chatId,a=e.messageId,n=this.state.revoke;this.handleCloseDelete(),V.a.send({"@type":"deleteMessages",chat_id:t,message_ids:[a],revoke:n})},this.state={contextMenu:!1,left:0,top:0,openDeleteDialog:!1,revoke:!1}}render(){const e=this.props,t=e.chatId,a=e.messageId,n=e.showOpenMessage,i=e.t,o=this.state,r=o.contextMenu,c=o.left,l=o.top,d=o.openDeleteDialog,h=o.revoke,u=Nt.a.get(t,a);if(!u)return null;const p=u.can_be_forwarded,m=u.can_be_deleted_only_for_self,g=u.can_be_deleted_for_all_users;return s.a.createElement("div",{className:"shared-document",onContextMenu:this.handleContextMenu},Object(Tt.n)(u,()=>Object(Tt.M)(t,a,!0)),s.a.createElement(rt.a,{open:r,onClose:this.handleCloseContextMenu,anchorReference:"anchorPosition",anchorPosition:{top:l,left:c},anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"},onMouseDown:e=>e.stopPropagation()},s.a.createElement(ot.a,{onClick:e=>e.stopPropagation()},n&&s.a.createElement(it.a,{onClick:this.handleOpenMessage},i("GoToMessage")),p&&s.a.createElement(it.a,{onClick:this.handleForward},i("Forward")),(m||g)&&s.a.createElement(it.a,{onClick:this.handleDelete},i("Delete")))),s.a.createElement(M.a,{transitionDuration:0,open:d,onClose:this.handleCloseDelete,"aria-labelledby":"delete-dialog-title"},s.a.createElement(O.a,{id:"delete-dialog-title"},"Confirm"),s.a.createElement(_.a,null,s.a.createElement(x.a,null,"Are you sure you want to delete 1 message?"),g&&s.a.createElement(Un.a,{control:s.a.createElement(se.a,{checked:h,onChange:this.handleRevokeChange,color:"primary"}),label:Object(Ze.W)(t)?"Delete for ".concat(Object(Ze.r)(t,!1,i)):"Delete for all"})),s.a.createElement(I.a,null,s.a.createElement(w.a,{onClick:this.handleCloseDelete,color:"primary"},"Cancel"),s.a.createElement(w.a,{onClick:this.handleDeleteContinue,color:"primary"},"Ok"))))}}var wn=Object(p.c)()(kn),Mn=a(554);a(400);class In extends s.a.Component{constructor(e){super(e),this.handleSearch=()=>{if(this.searchInputRef.current){if(this.searchInputRef.current.innerText){this.searchInputRef.current.innerText="";const e=this.props.onSearch;if(!e)return;return void e("")}}const e=this.props.onCloseSearch,t=this.state.openSearch;this.setState({openSearch:!t}),e&&e()},this.handleKeyDown=e=>{13===e.keyCode&&e.preventDefault()},this.handleKeyUp=()=>{const e=this.searchInputRef.current;if(!e)return;const t=e.innerHTML;"<br>"!==t&&"<div><br></div>"!==t||(e.innerHTML=null);const a=e.innerText,n=this.props.onSearch;n&&n(a)},this.handlePaste=e=>{const t=e.clipboardData.getData("text/plain");t&&(e.preventDefault(),document.execCommand("insertText",!1,t))},this.searchInputRef=s.a.createRef(),this.state={openSearch:!1}}componentDidUpdate(e,t,a){const n=this.state.openSearch;n&&n!==e.openSearch&&setTimeout(()=>{this.searchInputRef.current&&this.searchInputRef.current.focus()},B.b)}render(){const e=this.props,t=e.t,a=e.title,n=e.onClick,i=e.onClose,o=e.onSearch,r=this.state.openSearch;return s.a.createElement("div",{className:"header-master"},r?s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"header-search-input grow"},s.a.createElement("div",{id:"header-search-inputbox",ref:this.searchInputRef,placeholder:t("Search"),contentEditable:!0,suppressContentEditableWarning:!0,onKeyDown:this.handleKeyDown,onKeyUp:this.handleKeyUp,onPaste:this.handlePaste}))):s.a.createElement(s.a.Fragment,null,s.a.createElement(J.a,{className:"header-left-button",onClick:i},s.a.createElement(qa,null)),s.a.createElement("div",{className:"header-status grow cursor-pointer",onClick:n},s.a.createElement("span",{className:"header-status-content"},a))),Boolean(o)&&s.a.createElement(J.a,{className:"header-right-button",onMouseDown:this.handleSearch},s.a.createElement(Mn.a,{open:r,icon:s.a.createElement(et,null),openIcon:s.a.createElement(la.a,null)})))}}var _n=Object(p.c)()(In);a(401);class xn extends s.a.Component{getListClassName(){return null}getSearchListClassName(){return null}constructor(e){var t;if(new.target===xn)throw new TypeError("Cannot construct SharedMediaBase instances directly");super(e),t=this,this.onUpdateMessageContent=e=>{const t=this.props,a=t.chatId,n=t.migratedChatId,s=this.state,i=s.items,o=s.migratedItems,r=e.chat_id,c=e.message_id,l=(e.old_content,e.new_content),d=Nt.a.get(r,c);if(r===a){if(!i.length)return;if(!Object(ze.b)(c,i[0].id,i[i.length-1].id,!0))return;const e=i.findIndex(e=>e.id===c);this.isValidContent(l)?-1===e?this.setState({items:Object(ze.n)(i,d,Tt.L)}):this.setState({items:[...i.slice(0,e),d,...i.slice(e+1)]}):-1===e||this.setState({items:i.filter(e=>e.id!==c)})}else if(r===n){if(!o.length)return;if(!Object(ze.b)(c,o[0].id,o[o.length-1].id,!0))return;const e=o.findIndex(e=>e.id===c);this.isValidContent(l)?-1===e?this.setState({migratedItems:Object(ze.n)(o,d,Tt.L)}):this.setState({migratedItems:[...o.slice(0,e),d,...o.slice(e+1)]}):-1===e||this.setState({migratedItems:o.filter(e=>e.id!==c)})}},this.onUpdateNewMessage=e=>{const t=this.props,a=t.chatId,n=t.migratedChatId,s=this.state,i=s.items,o=s.migratedItems,r=e.message,c=r.chat_id;if(c!==a)return;if(!this.isValidMessage(r))return;const l=ft.a.getStore();Object(mt.t)(l,[r]),c===a?this.setState({items:[r].concat(i)}):c===n&&this.setState({migratedItems:[r].concat(o)})},this.onUpdateDeleteMessages=e=>{const t=this.props,a=t.chatId,n=t.migratedChatId,s=this.state,i=s.items,o=s.migratedItems,r=e.chat_id,c=e.message_ids,l=new Map(c.map(e=>[e,e])),d=()=>{this.state.items.length+this.state.migratedItems.length<B.ib&&this.onLoadNext(this.params)};r===a?this.setState({items:i.filter(e=>!l.has(e.id))},d):r===n&&this.setState({migratedItems:o.filter(e=>!l.has(e.id))},d)},this.loadContent=()=>{this.params={loading:!1,completed:!1,migrateCompleted:!1,items:[],migratedItems:[],filter:this.getSearchFilter()},this.onLoadNext(this.params)},this.onLoadNext=function(){var e=Object(h.a)(d.a.mark((function e(a,n=!0){var s,i,o,r,c,l,h,u,p;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=t.props.chatId,i=a.completed,o=a.filter,r=a.items,!a.loading){e.next=4;break}return e.abrupt("return");case 4:if(!i){e.next=6;break}return e.abrupt("return");case 6:return c=r.length>0?r[r.length-1].id:0,a.loading=!0,e.next=10,V.a.send({"@type":"searchChatMessages",chat_id:s,query:"",sender_user_id:0,from_message_id:c,offset:0,limit:B.ib,filter:o}).finally(()=>{a.loading=!1});case 10:l=e.sent,V.a.send({"@type":"searchChatMessages",chat_id:s,query:"",sender_user_id:0,from_message_id:c,offset:0,limit:2*B.ib,filter:o}),h=l.messages,a.completed=0===h.length||0===h.total_count,a.items=r.concat(h.filter(t.isValidMessage)),u=n&&h.length>0&&h.length<B.ib,Nt.a.setItems(l.messages),p=ft.a.getStore(),Object(mt.t)(p,l.messages),t.setState({items:a.items}),a.completed?t.onLoadMigratedNext(a,!0):u&&t.onLoadNext(a,!1);case 21:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.onLoadMigratedNext=function(){var e=Object(h.a)(d.a.mark((function e(a,n=!0){var s,i,o,r,c,l,h,u,p,m;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=t.props.migratedChatId,i=a.filter,o=a.loading,r=a.migrateCompleted,c=a.migratedItems,s){e.next=4;break}return e.abrupt("return");case 4:if(!o){e.next=6;break}return e.abrupt("return");case 6:if(!r){e.next=8;break}return e.abrupt("return");case 8:return l=c.length>0?c[c.length-1].id:0,a.loading=!0,e.next=12,V.a.send({"@type":"searchChatMessages",chat_id:s,query:"",sender_user_id:0,from_message_id:l,offset:0,limit:B.ib,filter:i}).finally(()=>{a.loading=!1});case 12:if(h=e.sent,u=h.messages,a.migratedItems=c.concat(u.filter(t.isValidMessage)),a.migrateCompleted=0===u.length||0===u.total_count,p=n&&u.length>0&&u.length<B.ib,!a.migrateCompleted){e.next=19;break}return e.abrupt("return");case 19:Nt.a.setItems(u),m=ft.a.getStore(),Object(mt.t)(m,u),t.setState({migratedItems:a.migratedItems}),p&&t.onLoadMigratedNext(a,!1);case 24:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleScroll=()=>{if(!this.listRef)return;const e=this.listRef.current;if(!e)return;const t=this.params;e.scrollTop+e.offsetHeight>=e.scrollHeight-B.gb&&(t&&!t.completed?this.onLoadNext(t):this.onLoadMigratedNext(t))},this.handleHeaderClick=()=>{const e=this.listRef.current;e&&(e.scrollTop=0)},this.handleSearchScroll=()=>{if(!this.searchListRef)return;const e=this.searchListRef.current;if(!e)return;const t=this.searchParams;t&&e.scrollTop+e.offsetHeight>=e.scrollHeight-B.gb&&(t.completed?this.onSearchMigratedNext(t):this.onSearchNext(t))},this.onSearchNext=function(){var e=Object(h.a)(d.a.mark((function e(a,n=!0){var s,i,o,r,c,l,h,u,p,m,g;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=t.props.chatId,i=a.completed,o=a.filter,r=a.items,c=a.loading,l=a.query,!i){e.next=4;break}return e.abrupt("return");case 4:if(!c){e.next=6;break}return e.abrupt("return");case 6:return h=r.length>0?r[r.length-1].id:0,a.loading=!0,e.next=10,V.a.send({"@type":"searchChatMessages",chat_id:s,query:l,sender_user_id:0,from_message_id:h,offset:0,limit:B.ib,filter:o}).finally(()=>{a.loading=!1});case 10:if(u=e.sent,p=u.messages,a.items=r.concat(p.filter(t.isValidMessage)),a.completed=0===p.length||0===p.total_count,m=n&&p.length>0&&p.length<B.ib,t.searchParams===a){e.next=17;break}return e.abrupt("return");case 17:Nt.a.setItems(p),g=ft.a.getStore(),Object(mt.t)(g,p),t.setState({searchItems:a.items,searchMigratedItems:a.migratedItems}),a.completed?t.onSearchMigratedNext(a,!0):m&&t.onSearchNext(a,!1);case 22:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.onSearchMigratedNext=function(){var e=Object(h.a)(d.a.mark((function e(a,n=!0){var s,i,o,r,c,l,h,u,p,m,g;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=t.props.migratedChatId,i=a.filter,o=a.loading,r=a.migratedItems,c=a.migrateCompleted,l=a.query,s){e.next=4;break}return e.abrupt("return");case 4:if(!o){e.next=6;break}return e.abrupt("return");case 6:if(!c){e.next=8;break}return e.abrupt("return");case 8:return h=r.length>0?r[r.length-1].id:0,a.loading=!0,e.next=12,V.a.send({"@type":"searchChatMessages",chat_id:s,query:l,sender_user_id:0,from_message_id:h,offset:0,limit:B.ib,filter:i}).finally(()=>{a.loading=!1});case 12:if(u=e.sent,p=u.messages,a.migratedItems=r.concat(p.filter(t.isValidMessage)),a.migrateCompleted=0===p.length||0===p.total_count,m=n&&p.length>0&&p.length<B.ib,t.searchParams===a){e.next=19;break}return e.abrupt("return");case 19:Nt.a.setItems(p),g=ft.a.getStore(),Object(mt.t)(g,p),t.setState({searchItems:a.items,searchMigratedItems:a.migratedItems}),m&&t.onSearchMigratedNext(a,!1);case 24:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleSearch=function(){var e=Object(h.a)(d.a.mark((function e(a){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a?a.trim():""){e.next=4;break}return t.handleCloseSearch(),e.abrupt("return");case 4:t.searchParams={query:n,completed:!1,migrateCompleted:!1,items:[],migratedItems:[],filter:t.getSearchFilter()},t.onSearchNext(t.searchParams,!0);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleCloseSearch=()=>{this.searchParams=null,this.setState({searchItems:[],searchMigratedItems:[]})},this.isValidMessage=e=>!!e&&this.isValidContent(e.content),this.listRef=s.a.createRef(),this.searchListRef=s.a.createRef(),this.state={items:[],migratedItems:[],searchItems:[],searchMigratedItems:[]}}hasSearch(){return!0}isValidContent(e){throw new Error("Virtual method isValidContent is not implemented")}getItemTemplate(e){const t=this.props.migratedChatId,a=e.chat_id,n=e.id;return s.a.createElement(wn,{key:"chat_id=".concat(a,"_message_id=").concat(n),chatId:a,messageId:n,showOpenMessage:a!==t})}getSearchFilter(){throw new Error("Virtual method getSearchFilter is not implemented")}getHeader(){throw new Error("Virtual method getHeader is not implemented")}componentDidMount(){this.loadContent(),Nt.a.on("updateDeleteMessages",this.onUpdateDeleteMessages),Nt.a.on("updateMessageContent",this.onUpdateMessageContent),Nt.a.on("updateNewMessage",this.onUpdateNewMessage)}componentWillUnmount(){Nt.a.off("updateDeleteMessages",this.onUpdateDeleteMessages),Nt.a.off("updateMessageContent",this.onUpdateMessageContent),Nt.a.off("updateNewMessage",this.onUpdateNewMessage)}render(){const e=this.props,t=e.minHeight,a=e.onClose,n=e.popup,i=this.state,o=i.items,r=i.migratedItems,c=i.searchItems,l=i.searchMigratedItems,d=this.searchParams,h=o.concat(r).map(e=>this.getItemTemplate(e)),u=c.concat(l).map(e=>this.getItemTemplate(e));return s.a.createElement(s.a.Fragment,null,s.a.createElement(_n,{title:this.getHeader(),onClick:this.handleHeaderClick,onClose:a,onSearch:this.hasSearch()?this.handleSearch:null,onCloseSearch:this.handleCloseSearch}),s.a.createElement("div",{ref:this.listRef,className:q()("shared-media-list",this.getListClassName()),onScroll:this.handleScroll,style:{minHeight:n?t:null}},h),Boolean(d)&&s.a.createElement("div",{ref:this.searchListRef,className:q()("shared-media-search-list",this.getSearchListClassName()),onScroll:this.handleSearchScroll},u))}}var On=xn;a(402);class Pn extends On{isValidContent(e){return e&&"messageAudio"===e["@type"]}getSearchFilter(){return{"@type":"searchMessagesFilterAudio"}}getHeader(){return(0,this.props.t)("AudioTitle")}}Pn.propTypes={chatId:Sn.a.number.isRequired,migratedChatId:Sn.a.number,onClose:Sn.a.func.isRequired,popup:Sn.a.bool,minHeight:Sn.a.number},Pn.defaultProps={popup:!1,minHeight:0};var Tn=Object(p.c)()(Pn);a(403);class Nn extends On{isValidContent(e){return e&&"messageDocument"===e["@type"]}getSearchFilter(){return{"@type":"searchMessagesFilterDocument"}}getHeader(){return(0,this.props.t)("DocumentsTitle")}}Nn.propTypes={chatId:Sn.a.number.isRequired,migratedChatId:Sn.a.number,onClose:Sn.a.func.isRequired,popup:Sn.a.bool,minHeight:Sn.a.number},Nn.defaultProps={popup:!1,minHeight:0};var Dn=Object(p.c)()(Nn),Ln=a(79),jn=a(88),Rn=a(168);a(404);class An extends s.a.Component{constructor(e){var t;super(e),t=this,this.handleOpenMessage=e=>{this.handleCloseContextMenu(e);const t=this.props,a=t.chatId,n=t.messageId;Object(nt.h)(a,n)},this.handleForward=e=>{this.handleCloseContextMenu(e);const t=this.props,a=t.chatId,n=t.messageId;Object(nt.e)(a,[n])},this.handleDelete=e=>{this.handleCloseContextMenu(e);const t=this.props,a=t.chatId,n=t.messageId,s=Nt.a.get(a,n);if(!s)return null;const i=s.can_be_deleted_for_all_users;this.setState({openDeleteDialog:!0,canBeDeletedForAllUsers:i,revoke:i})},this.handleContextMenu=function(){var e=Object(h.a)(d.a.mark((function e(a){var n,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a&&(a.preventDefault(),a.stopPropagation()),t.state.contextMenu?t.setState({contextMenu:!1}):(n=a.clientX,s=a.clientY,t.setState({contextMenu:!0,left:n,top:s}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleCloseContextMenu=e=>{e&&e.stopPropagation(),this.setState({contextMenu:!1})},this.handleRevokeChange=()=>{this.setState({revoke:!this.state.revoke})},this.handleCloseDelete=()=>{this.setState({openDeleteDialog:!1})},this.handleDeleteContinue=()=>{const e=this.props,t=e.chatId,a=e.messageId,n=this.state.revoke;this.handleCloseDelete(),V.a.send({"@type":"deleteMessages",chat_id:t,message_ids:[a],revoke:n})},this.state={contextMenu:!1,left:0,top:0,openDeleteDialog:!1,revoke:!1}}shouldComponentUpdate(e,t,a){const n=this.state,s=n.contextMenu,i=n.left,o=n.top,r=n.openDeleteDialog,c=n.revoke;return t.contextMenu!==s||(t.left!==i||(t.top!==o||(t.openDeleteDialog!==r||t.revoke!==c)))}isValidEntityType(e){return!!e&&("textEntityTypeUrl"===e.type["@type"]||"textEntityTypeTextUrl"===e.type["@type"]||"textEntityTypeEmailAddress"===e.type["@type"])}getTitleFromUrl(e){try{e=e.startsWith("http")?e:"http://"+e;const t=decodeURI(e),a=new URL(t).hostname.split("."),n=a.length>=2?a[a.length-2]:new URL(t).hostname;return Rn.a.ToUnicode(n)}catch(t){console.error("url: "+e+"\n"+t)}return null}render(){const e=this.props,t=e.chatId,a=e.messageId,n=e.webPage,i=e.showOpenMessage,o=e.t,r=this.state,c=r.contextMenu,l=r.left,d=r.top,h=r.openDeleteDialog,u=r.revoke,p=Nt.a.get(t,a);if(!p)return null;const m=p.can_be_forwarded,g=p.can_be_deleted_only_for_self,f=p.can_be_deleted_for_all_users;let b=null,C=n||{title:"",description:"",photo:null,url:""},y=C.display_url,v=C.description,E=C.photo,S=C.title,U=C.url;if(n)S=S||this.getTitleFromUrl(U),b=s.a.createElement(jn.a,{className:"shared-link-url",url:U},y);else{const e=p.content.text;if(e){const t=e.entities;t&&t.length>0&&(b=t.filter(this.isValidEntityType).map(t=>{const a=Object(Tt.O)(e.text,t.offset,t.offset+t.length);let n=a,i=!1;switch(t.type["@type"]){case"textEntityTypeTextUrl":{const e=t.type.url;e&&(n=e);break}case"textEntityTypeUrl":break;case"textEntityTypeEmailAddress":i=!0}return S=S||this.getTitleFromUrl(n)||" ",s.a.createElement(jn.a,{className:"shared-link-url",url:n,mail:i},a)}))}}const k="tile_color_".concat(Math.abs(S.charCodeAt(0))%8+1);return s.a.createElement("div",{className:"shared-link",onContextMenu:this.handleContextMenu},s.a.createElement("div",{className:q()("shared-link-photo",k)},S.charAt(0),E&&s.a.createElement(Ln.a,{displaySize:90,chatId:t,messageId:a,photo:E,openMedia:Tt.M,showProgress:!1,style:{width:48,height:48,position:"absolute",top:0,left:0}})),s.a.createElement("div",{className:"shared-link-content"},S&&s.a.createElement("div",{className:"web-page-title"},S),v&&s.a.createElement("div",{className:"web-page-description"},v),b),s.a.createElement(rt.a,{open:c,onClose:this.handleCloseContextMenu,anchorReference:"anchorPosition",anchorPosition:{top:d,left:l},anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"},onMouseDown:e=>e.stopPropagation()},s.a.createElement(ot.a,{onClick:e=>e.stopPropagation()},i&&s.a.createElement(it.a,{onClick:this.handleOpenMessage},o("GoToMessage")),m&&s.a.createElement(it.a,{onClick:this.handleForward},o("Forward")),(g||f)&&s.a.createElement(it.a,{onClick:this.handleDelete},o("Delete")))),s.a.createElement(M.a,{transitionDuration:0,open:h,onClose:this.handleCloseDelete,"aria-labelledby":"delete-dialog-title"},s.a.createElement(O.a,{id:"delete-dialog-title"},"Confirm"),s.a.createElement(_.a,null,s.a.createElement(x.a,null,"Are you sure you want to delete 1 message?"),f&&s.a.createElement(Un.a,{control:s.a.createElement(se.a,{checked:u,onChange:this.handleRevokeChange,color:"primary"}),label:Object(Ze.W)(t)?"Delete for ".concat(Object(Ze.r)(t,!1,o)):"Delete for all"})),s.a.createElement(I.a,null,s.a.createElement(w.a,{onClick:this.handleCloseDelete,color:"primary"},"Cancel"),s.a.createElement(w.a,{onClick:this.handleDeleteContinue,color:"primary"},"Ok"))))}}var Fn=Object(p.c)()(An);a(405);class Bn extends On{isValidContent(e){if(!e)return!1;const t=e.web_page,a=e.text;if(t)return!0;if(!a)return!1;const n=a.entities;return!!n&&n.find(e=>"textEntityTypeUrl"===e.type["@type"]||"textEntityTypeTextUrl"===e.type["@type"]||"textEntityTypeEmailAddress"===e.type["@type"])}getSearchFilter(){return{"@type":"searchMessagesFilterUrl"}}getHeader(){return(0,this.props.t)("LinksTitle")}getItemTemplate(e){const t=this.props.migratedChatId,a=e.chat_id,n=e.content,i=e.id;return s.a.createElement(Fn,{key:"chat_id=".concat(a,"_message_id=").concat(i),chatId:a,messageId:i,webPage:n.web_page,openMedia:()=>Object(Tt.M)(a,i,!1),showOpenMessage:a!==t})}}Bn.propTypes={chatId:Sn.a.number.isRequired,migratedChatId:Sn.a.number,onClose:Sn.a.func.isRequired,popup:Sn.a.bool,minHeight:Sn.a.number},Bn.defaultProps={popup:!1,minHeight:0};var Vn=Object(p.c)()(Bn),zn=a(547),Hn=a(543);a(406);class Wn extends s.a.Component{constructor(e){super(e)}render(){const e=this.props.close;return s.a.createElement("div",{className:"header-master"},s.a.createElement(J.a,{className:"header-left-button",onClick:e},s.a.createElement(qa,null)),s.a.createElement("div",{className:"header-status grow cursor-pointer"},s.a.createElement("span",{className:"header-status-content"},"Shared Media")))}}var Gn=Wn;a(407);class Kn extends s.a.Component{constructor(...e){super(...e),this.state={value:0},this.handleChange=(e,t)=>{this.setState({value:t})}}render(){const e=this.props,t=e.onClose,a=e.popup,n=this.state.value,i=s.a.createElement(s.a.Fragment,null,s.a.createElement(Gn,{close:t}),s.a.createElement(zn.a,{value:n,onChange:this.handleChange,indicatorColor:"primary",textColor:"primary",scrollable:!0,scrollButtons:"off",fullWidth:!0},s.a.createElement(Hn.a,{label:"Media",style:{minWidth:"40px"}}),s.a.createElement(Hn.a,{label:"Docs",style:{minWidth:"40px"}}),s.a.createElement(Hn.a,{label:"Links",style:{minWidth:"40px"}}),s.a.createElement(Hn.a,{label:"Audio",style:{minWidth:"40px"}})));return a?s.a.createElement(s.a.Fragment,null,i):s.a.createElement("div",{className:"shared-media"},i)}}Kn.defaultProps={popup:!1,minHeight:0};var Zn=Kn,qn=a(37);a(408);class Yn extends s.a.Component{constructor(e){var t;super(e),t=this,this.onClientUpdatePhotoBlob=e=>{const t=this.state,a=t.photoSize,n=t.thumbSize,s=e.fileId;(a&&a.photo&&a.photo.id===s||n&&n.photo&&n.photo.id===s)&&this.forceUpdate()},this.handleOpenMessage=e=>{this.handleCloseContextMenu(e);const t=this.props,a=t.chatId,n=t.messageId;Object(nt.h)(a,n)},this.handleForward=e=>{this.handleCloseContextMenu(e);const t=this.props,a=t.chatId,n=t.messageId;Object(nt.e)(a,[n])},this.handleDelete=e=>{this.handleCloseContextMenu(e);const t=this.props,a=t.chatId,n=t.messageId,s=Nt.a.get(a,n);if(!s)return null;const i=s.can_be_deleted_for_all_users;this.setState({openDeleteDialog:!0,canBeDeletedForAllUsers:i,revoke:i})},this.handleContextMenu=function(){var e=Object(h.a)(d.a.mark((function e(a){var n,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a&&(a.preventDefault(),a.stopPropagation()),t.state.contextMenu?t.setState({contextMenu:!1}):(n=a.clientX,s=a.clientY,t.setState({contextMenu:!0,left:n,top:s}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleCloseContextMenu=e=>{e&&e.stopPropagation(),this.setState({contextMenu:!1})},this.handleRevokeChange=()=>{this.setState({revoke:!this.state.revoke})},this.handleCloseDelete=()=>{this.setState({openDeleteDialog:!1})},this.handleDeleteContinue=()=>{const e=this.props,t=e.chatId,a=e.messageId,n=this.state.revoke;this.handleCloseDelete(),V.a.send({"@type":"deleteMessages",chat_id:t,message_ids:[a],revoke:n})};const a=e.photo,n=e.size,s=e.thumbnailSize;this.state={contextMenu:!1,left:0,top:0,openDeleteDialog:!1,revoke:!1,photoSize:Object(ze.l)(a.sizes,n),thumbSize:Object(ze.l)(a.sizes,s),minithumbnail:a.minithumbnail}}componentDidMount(){ft.a.on("clientUpdatePhotoBlob",this.onClientUpdatePhotoBlob)}componentWillUnmount(){ft.a.off("clientUpdatePhotoBlob",this.onClientUpdatePhotoBlob)}render(){const e=this.props,t=e.chatId,a=e.messageId,n=e.openMedia,i=e.style,o=e.showOpenMessage,r=e.t,c=this.state,l=c.minithumbnail,d=c.thumbSize,h=c.photoSize,u=c.contextMenu,p=c.left,m=c.top,g=c.openDeleteDialog,f=c.revoke,b=Nt.a.get(t,a);if(!b)return null;const C=b.can_be_forwarded,y=b.can_be_deleted_only_for_self,v=b.can_be_deleted_for_all_users;if(!h)return null;const E=l?"data:image/jpeg;base64, "+l.data:null,S=Object(mt.j)(d?d.photo:null),U=Object(mt.j)(h.photo);E||Object(qn.h)(d);return s.a.createElement("div",{className:"shared-photo",style:i,onClick:n,onContextMenu:this.handleContextMenu},s.a.createElement("div",{className:"shared-photo-content",style:{backgroundImage:"url(".concat(S||E,")")}},U!==S&&s.a.createElement("div",{className:"shared-photo-main-content",style:{backgroundImage:"url(".concat(U,")")}})),s.a.createElement(rt.a,{open:u,onClose:this.handleCloseContextMenu,anchorReference:"anchorPosition",anchorPosition:{top:m,left:p},anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"},onMouseDown:e=>e.stopPropagation(),onClick:e=>e.stopPropagation()},s.a.createElement(ot.a,null,o&&s.a.createElement(it.a,{onClick:this.handleOpenMessage},r("GoToMessage")),C&&s.a.createElement(it.a,{onClick:this.handleForward},r("Forward")),(y||v)&&s.a.createElement(it.a,{onClick:this.handleDelete},r("Delete")))),s.a.createElement(M.a,{transitionDuration:0,open:g,onClose:this.handleCloseDelete,"aria-labelledby":"delete-dialog-title",onClick:e=>e.stopPropagation()},s.a.createElement(O.a,{id:"delete-dialog-title"},"Confirm"),s.a.createElement(_.a,null,s.a.createElement(x.a,null,"Are you sure you want to delete 1 message?"),v&&s.a.createElement(Un.a,{control:s.a.createElement(se.a,{checked:f,onChange:this.handleRevokeChange,color:"primary"}),label:Object(Ze.W)(t)?"Delete for ".concat(Object(Ze.r)(t,!1,r)):"Delete for all"})),s.a.createElement(I.a,null,s.a.createElement(w.a,{onClick:this.handleCloseDelete,color:"primary"},"Cancel"),s.a.createElement(w.a,{onClick:this.handleDeleteContinue,color:"primary"},"Ok"))))}}Yn.defaultProps={size:B.F,thumbnailSize:B.G};var Jn=Object(p.c)()(Yn);a(409);class Qn extends On{getListClassName(){return"shared-photos-list"}getSearchListClassName(){return"shared-photos-search-list"}isValidContent(e){return e&&"messagePhoto"===e["@type"]}getSearchFilter(){return{"@type":"searchMessagesFilterPhoto"}}getHeader(){return(0,this.props.t)("PhotosTitle")}getItemTemplate(e){const t=this.props.migratedChatId,a=e.chat_id,n=e.content,i=e.id;return s.a.createElement(Jn,{key:"chat_id=".concat(a,"_message_id=").concat(i),chatId:a,messageId:i,photo:n.photo,openMedia:()=>Object(Tt.M)(a,i,!1),showOpenMessage:a!==t})}}Qn.propTypes={chatId:Sn.a.number.isRequired,migratedChatId:Sn.a.number,onClose:Sn.a.func.isRequired,popup:Sn.a.bool,minHeight:Sn.a.number},Qn.defaultProps={popup:!1,minHeight:0};var Xn=Object(p.c)()(Qn);a(410);class $n extends s.a.Component{constructor(e){var t;super(e),t=this,this.onClientUpdateVideoThumbnailBlob=e=>{const t=this.props.video.thumbnail,a=e.fileId;t&&t.photo&&t.photo.id===a&&this.forceUpdate()},this.handleOpenMessage=e=>{this.handleCloseContextMenu(e);const t=this.props,a=t.chatId,n=t.messageId;Object(nt.h)(a,n)},this.handleForward=e=>{this.handleCloseContextMenu(e);const t=this.props,a=t.chatId,n=t.messageId;Object(nt.e)(a,[n])},this.handleDelete=e=>{this.handleCloseContextMenu(e);const t=this.props,a=t.chatId,n=t.messageId,s=Nt.a.get(a,n);if(!s)return null;const i=s.can_be_deleted_for_all_users;this.setState({openDeleteDialog:!0,canBeDeletedForAllUsers:i,revoke:i})},this.handleContextMenu=function(){var e=Object(h.a)(d.a.mark((function e(a){var n,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a&&(a.preventDefault(),a.stopPropagation()),t.state.contextMenu?t.setState({contextMenu:!1}):(n=a.clientX,s=a.clientY,t.setState({contextMenu:!0,left:n,top:s}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleCloseContextMenu=e=>{e&&e.stopPropagation(),this.setState({contextMenu:!1})},this.handleRevokeChange=()=>{this.setState({revoke:!this.state.revoke})},this.handleCloseDelete=()=>{this.setState({openDeleteDialog:!1})},this.handleDeleteContinue=()=>{const e=this.props,t=e.chatId,a=e.messageId,n=this.state.revoke;this.handleCloseDelete(),V.a.send({"@type":"deleteMessages",chat_id:t,message_ids:[a],revoke:n})},this.state={contextMenu:!1,left:0,top:0,openDeleteDialog:!1,revoke:!1}}componentDidMount(){ft.a.on("clientUpdateVideoThumbnailBlob",this.onClientUpdateVideoThumbnailBlob)}componentWillUnmount(){ft.a.off("clientUpdateVideoThumbnailBlob",this.onClientUpdateVideoThumbnailBlob)}render(){const e=this.props,t=e.chatId,a=e.messageId,n=e.openMedia,i=e.style,o=e.showOpenMessage,r=e.t,c=this.props.video,l=c.minithumbnail,d=c.thumbnail,h=(c.video,c.width,c.height,c.duration),u=this.state,p=u.contextMenu,m=u.left,g=u.top,f=u.openDeleteDialog,b=u.revoke,C=Nt.a.get(t,a);if(!C)return null;const y=C.can_be_forwarded,v=C.can_be_deleted_only_for_self,E=C.can_be_deleted_for_all_users,S=l?"data:image/jpeg;base64, "+l.data:null,U=Object(mt.j)(d?d.photo:null),k=U?Object(qn.h)(d,B.nb):Boolean(S);return s.a.createElement("div",{className:"shared-photo",style:i,onClick:n,onContextMenu:this.handleContextMenu},s.a.createElement("div",{className:"shared-video-wrapper"},s.a.createElement("div",{className:q()("shared-video-content",{"media-blurred":k,"media-mini-blurred":!U&&k}),style:{backgroundImage:"url(".concat(U||S,")")}}),s.a.createElement("div",{className:"shared-video-meta"},Object(ze.e)(h))),s.a.createElement(rt.a,{open:p,onClose:this.handleCloseContextMenu,anchorReference:"anchorPosition",anchorPosition:{top:g,left:m},anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"},onMouseDown:e=>e.stopPropagation(),onClick:e=>e.stopPropagation()},s.a.createElement(ot.a,null,o&&s.a.createElement(it.a,{onClick:this.handleOpenMessage},r("GoToMessage")),y&&s.a.createElement(it.a,{onClick:this.handleForward},r("Forward")),(v||E)&&s.a.createElement(it.a,{onClick:this.handleDelete},r("Delete")))),s.a.createElement(M.a,{transitionDuration:0,open:f,onClose:this.handleCloseDelete,"aria-labelledby":"delete-dialog-title",onClick:e=>e.stopPropagation()},s.a.createElement(O.a,{id:"delete-dialog-title"},"Confirm"),s.a.createElement(_.a,null,s.a.createElement(x.a,null,"Are you sure you want to delete 1 message?"),E&&s.a.createElement(Un.a,{control:s.a.createElement(se.a,{checked:b,onChange:this.handleRevokeChange,color:"primary"}),label:Object(Ze.W)(t)?"Delete for ".concat(Object(Ze.r)(t,!1,r)):"Delete for all"})),s.a.createElement(I.a,null,s.a.createElement(w.a,{onClick:this.handleCloseDelete,color:"primary"},"Cancel"),s.a.createElement(w.a,{onClick:this.handleDeleteContinue,color:"primary"},"Ok"))))}}$n.defaultProps={size:B.F,thumbnailSize:B.G};var es=Object(p.c)()($n);a(411);class ts extends On{getListClassName(){return"shared-photos-list"}getSearchListClassName(){return"shared-photos-search-list"}isValidContent(e){return e&&"messageVideo"===e["@type"]}getSearchFilter(){return{"@type":"searchMessagesFilterVideo"}}getHeader(){return(0,this.props.t)("VideosTitle")}getItemTemplate(e){const t=this.props.migratedChatId,a=e.chat_id,n=e.content,i=e.id;return s.a.createElement(es,{key:"chat_id=".concat(a,"_message_id=").concat(i),chatId:a,messageId:i,video:n.video,openMedia:()=>Object(Tt.M)(a,i,!1),showOpenMessage:a!==t})}}ts.propTypes={chatId:Sn.a.number.isRequired,migratedChatId:Sn.a.number,onClose:Sn.a.func.isRequired,popup:Sn.a.bool,minHeight:Sn.a.number},ts.defaultProps={popup:!1,minHeight:0};var as=Object(p.c)()(ts),ns=a(136),ss=a(123),is=a(38),os=a(171);a(412);class rs extends s.a.Component{constructor(e){var t;super(e),t=this,this.handleOpenMessage=e=>{this.handleCloseContextMenu(e);const t=this.props,a=t.chatId,n=t.messageId;Object(nt.h)(a,n)},this.handleForward=e=>{this.handleCloseContextMenu(e);const t=this.props,a=t.chatId,n=t.messageId;Object(nt.e)(a,[n])},this.handleDelete=e=>{this.handleCloseContextMenu(e);const t=this.props,a=t.chatId,n=t.messageId,s=Nt.a.get(a,n);if(!s)return null;const i=s.can_be_deleted_for_all_users;this.setState({openDeleteDialog:!0,canBeDeletedForAllUsers:i,revoke:i})},this.handleContextMenu=function(){var e=Object(h.a)(d.a.mark((function e(a){var n,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a&&(a.preventDefault(),a.stopPropagation()),t.state.contextMenu?t.setState({contextMenu:!1}):(n=a.clientX,s=a.clientY,t.setState({contextMenu:!0,left:n,top:s}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleCloseContextMenu=e=>{e&&e.stopPropagation(),this.setState({contextMenu:!1})},this.handleRevokeChange=()=>{this.setState({revoke:!this.state.revoke})},this.handleCloseDelete=()=>{this.setState({openDeleteDialog:!1})},this.handleDeleteContinue=()=>{const e=this.props,t=e.chatId,a=e.messageId,n=this.state.revoke;this.handleCloseDelete(),V.a.send({"@type":"deleteMessages",chat_id:t,message_ids:[a],revoke:n})},this.state={contextMenu:!1,left:0,top:0,openDeleteDialog:!1,revoke:!1}}render(){const e=this.props,t=e.chatId,a=e.i18n,n=e.messageId,i=e.voiceNote,o=e.openMedia,r=e.showOpenMessage,c=e.t,l=this.state,d=l.contextMenu,h=l.left,u=l.top,p=l.openDeleteDialog,m=l.revoke;if(!i)return null;const g=Nt.a.get(t,n);if(!g)return null;const f=g.can_be_forwarded,b=g.can_be_deleted_only_for_self,C=g.can_be_deleted_for_all_users,y=g.date,v=g.sender_user_id,E=new Date(1e3*y).toLocaleDateString([a.language],{day:"numeric",month:"short",year:"numeric",hour:"numeric",minute:"numeric",hour12:!1}),S=i.duration,U=i.voice;return s.a.createElement("div",{className:"shared-voice-note",onContextMenu:this.handleContextMenu},s.a.createElement(os.a,{chatId:t,messageId:n,file:U,openMedia:o}),s.a.createElement("div",{className:"voice-note-content"},s.a.createElement(is.a,{chatId:t,messageId:n,userId:v}),s.a.createElement("div",{className:"voice-note-meta"},s.a.createElement(ns.a,{chatId:t,messageId:n,duration:S,file:U,title:"".concat(E,", ")}),s.a.createElement(ss.a,{chatId:t,messageId:n,icon:"\xa0\u2022"}))),s.a.createElement(rt.a,{open:d,onClose:this.handleCloseContextMenu,anchorReference:"anchorPosition",anchorPosition:{top:u,left:h},anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"},onMouseDown:e=>e.stopPropagation()},s.a.createElement(ot.a,{onClick:e=>e.stopPropagation()},r&&s.a.createElement(it.a,{onClick:this.handleOpenMessage},c("GoToMessage")),f&&s.a.createElement(it.a,{onClick:this.handleForward},c("Forward")),(b||C)&&s.a.createElement(it.a,{onClick:this.handleDelete},c("Delete")))),s.a.createElement(M.a,{transitionDuration:0,open:p,onClose:this.handleCloseDelete,"aria-labelledby":"delete-dialog-title"},s.a.createElement(O.a,{id:"delete-dialog-title"},"Confirm"),s.a.createElement(_.a,null,s.a.createElement(x.a,null,"Are you sure you want to delete 1 message?"),C&&s.a.createElement(Un.a,{control:s.a.createElement(se.a,{checked:m,onChange:this.handleRevokeChange,color:"primary"}),label:Object(Ze.W)(t)?"Delete for ".concat(Object(Ze.r)(t,!1,c)):"Delete for all"})),s.a.createElement(I.a,null,s.a.createElement(w.a,{onClick:this.handleCloseDelete,color:"primary"},"Cancel"),s.a.createElement(w.a,{onClick:this.handleDeleteContinue,color:"primary"},"Ok"))))}}var cs=Object(p.c)()(rs);a(413);class ls extends On{isValidContent(e){return e&&"messageVoiceNote"===e["@type"]}getSearchFilter(){return{"@type":"searchMessagesFilterVoiceNote"}}getHeader(){return(0,this.props.t)("VoiceTitle")}hasSearch(){return!1}getItemTemplate(e){const t=this.props.migratedChatId,a=e.chat_id,n=e.content,i=e.id;return s.a.createElement(cs,{key:"chat_id=".concat(a,"_message_id=").concat(i),chatId:a,messageId:i,voiceNote:n.voice_note,openMedia:()=>Object(Tt.M)(a,i,!1),showOpenMessage:a!==t})}}ls.propTypes={chatId:Sn.a.number.isRequired,migratedChatId:Sn.a.number,onClose:Sn.a.func.isRequired,popup:Sn.a.bool,minHeight:Sn.a.number},ls.defaultProps={popup:!1,minHeight:0};var ds=Object(p.c)()(ls);a(414);class hs extends s.a.Component{constructor(e){var t;super(e),t=this,this.onClientUpdateChatId=e=>{const t=this.props.popup,a=this.state.chatId;t||a!==e.nextChatId&&(this.sharedAudios=null,this.sharedDocuments=null,this.sharedLinks=null,this.sharedPhotos=null,this.sharedVideos=null,this.sharedVoiceNotes=null,this.setState({chatId:e.nextChatId,migratedChatId:0,userChatId:null,openGroupInCommon:!1,openSharedAudios:!1,openSharedDocuments:!1,openSharedLinks:!1,openSharedMedia:!1,openSharedPhotos:!1,openSharedVideos:!1,openSharedVoiceNotes:!1,counters:gt.a.getCounters(e.nextChatId),migratedCounters:null}))},this.loadContent=e=>{this.loadChatCounters(e),this.loadMigratedCounters(e);const t=Object(Ze.G)(e);t&&Object(mt.u)(e,[t])},this.loadChatCounters=function(){var e=Object(h.a)(d.a.mark((function e(a){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,zt(a);case 2:if(n=e.sent,gt.a.setCounters(a,n),a===t.state.chatId){e.next=6;break}return e.abrupt("return");case 6:t.setState({counters:n});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.loadMigratedCounters=function(){var e=Object(h.a)(d.a.mark((function e(a){var n,s,i,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(Ze.X)(a)){e.next=2;break}return e.abrupt("return");case 2:if(n=Qt.a.getFullInfo(Object(Ze.H)(a))){e.next=5;break}return e.abrupt("return");case 5:if(s=n.upgraded_from_basic_group_id){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,V.a.send({"@type":"createBasicGroupChat",basic_group_id:s,force:!0});case 10:if(i=e.sent){e.next=13;break}return e.abrupt("return");case 13:return e.next=15,zt(i.id);case 15:if(o=e.sent,gt.a.setCounters(i.id,o),t.state.chatId===a){e.next=19;break}return e.abrupt("return");case 19:t.setState({migratedChatId:i.id,migratedCounters:gt.a.getCounters(i.id)});case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleOpenSharedMedia=()=>{this.setState({openSharedMedia:!0})},this.handleCloseSharedMedia=()=>{this.setState({openSharedMedia:!1})},this.handleOpenGroupInCommon=()=>{this.setState({openGroupInCommon:!0})},this.handleCloseGroupsInCommon=()=>{this.setState({openGroupInCommon:!1})},this.handleCloseChatDetails=()=>{const e=this.props.popup;this.state.userChatId?this.setState({userChatId:null}):e?V.a.clientUpdate({"@type":"clientUpdateDialogChatId",chatId:0}):v.a.changeChatDetailsVisibility(!1)},this.handleOpenSharedDocuments=()=>{this.setState({openSharedDocuments:!0})},this.handleCloseSharedDocuments=()=>{this.setState({openSharedDocuments:!1})},this.handleOpenSharedAudios=()=>{this.setState({openSharedAudios:!0})},this.handleCloseSharedAudios=()=>{this.setState({openSharedAudios:!1})},this.handleOpenSharedVoiceNotes=()=>{this.setState({openSharedVoiceNotes:!0})},this.handleCloseSharedVoiceNotes=()=>{this.setState({openSharedVoiceNotes:!1})},this.handleOpenSharedLinks=()=>{this.setState({openSharedLinks:!0})},this.handleCloseSharedLinks=()=>{this.setState({openSharedLinks:!1})},this.handleOpenSharedPhotos=()=>{this.setState({openSharedPhotos:!0})},this.handleCloseSharedPhotos=()=>{this.setState({openSharedPhotos:!1})},this.handleOpenSharedVideos=()=>{this.setState({openSharedVideos:!0})},this.handleCloseSharedVideos=()=>{this.setState({openSharedVideos:!1})},this.detailsRef=s.a.createRef();const a=e.popup,n=v.a.chatId,i=v.a.dialogChatId;this.state={chatId:a?i:n,migratedChatId:0,userChatId:null,openGroupInCommon:!1,openSharedAudios:!1,openSharedDocuments:!1,openSharedLinks:!1,openSharedMedia:!1,openSharedPhotos:!1,openSharedVideos:!1,openSharedVoiceNotes:!1,counters:null,migratedCounters:null}}componentDidMount(){this.loadContent(this.state.chatId),v.a.on("clientUpdateChatId",this.onClientUpdateChatId)}componentWillUnmount(){v.a.off("clientUpdateChatId",this.onClientUpdateChatId)}componentDidUpdate(e,t,a){const n=this.state.chatId;n!==t.chatId&&this.loadContent(n)}render(){const e=this.props,t=(e.classes,e.className),a=e.popup,n=this.state,i=n.chatId,o=n.counters,r=n.migratedChatId,c=n.migratedCounters,l=n.userChatId,d=n.openSharedAudios,h=n.openSharedDocuments,u=n.openSharedLinks,p=n.openSharedMedia,m=n.openSharedPhotos,g=n.openSharedVideos,f=n.openSharedVoiceNotes,b=n.openGroupInCommon,C=i||l,y=this.detailsRef&&this.detailsRef.current?this.detailsRef.current.getContentHeight():0;let v=null;return p?v=s.a.createElement(Zn,{chatId:C,popup:a,minHeight:y,onClose:this.handleCloseSharedMedia}):d?(this.sharedAudios=this.sharedAudios||s.a.createElement(Tn,{chatId:C,migratedChatId:r,popup:a,minHeight:y,onClose:this.handleCloseSharedAudios}),v=this.sharedAudios):h?(this.sharedDocuments=this.sharedDocuments||s.a.createElement(Dn,{chatId:C,migratedChatId:r,popup:a,minHeight:y,onClose:this.handleCloseSharedDocuments}),v=this.sharedDocuments):u?(this.sharedLinks=this.sharedLinks||s.a.createElement(Vn,{chatId:C,migratedChatId:r,popup:a,minHeight:y,onClose:this.handleCloseSharedLinks}),v=this.sharedLinks):m?(this.sharedPhotos=this.sharedPhotos||s.a.createElement(Xn,{chatId:C,migratedChatId:r,popup:a,minHeight:y,onClose:this.handleCloseSharedPhotos}),v=this.sharedPhotos):g?(this.sharedVideos=this.sharedVideos||s.a.createElement(as,{chatId:C,migratedChatId:r,popup:a,minHeight:y,onClose:this.handleCloseSharedVideos}),v=this.sharedVideos):f?(this.sharedVoiceNotes=this.sharedVoiceNotes||s.a.createElement(ds,{chatId:C,migratedChatId:r,popup:a,minHeight:y,onClose:this.handleCloseSharedVoiceNotes}),v=this.sharedVoiceNotes):v=b?s.a.createElement(vn,{chatId:C,popup:a,minHeight:y,onClose:this.handleCloseGroupsInCommon}):s.a.createElement(fn,{ref:this.detailsRef,chatId:C,popup:a,backButton:l===i,counters:o,migratedCounters:c,onOpenGroupInCommon:this.handleOpenGroupInCommon,onOpenSharedAudios:this.handleOpenSharedAudios,onOpenSharedDocuments:this.handleOpenSharedDocuments,onOpenSharedMedia:this.handleOpenSharedMedia,onOpenSharedLinks:this.handleOpenSharedLinks,onOpenSharedPhotos:this.handleOpenSharedPhotos,onOpenSharedVideos:this.handleOpenSharedVideos,onOpenSharedVoiceNotes:this.handleOpenSharedVoiceNotes,onClose:this.handleCloseChatDetails}),a?s.a.createElement(s.a.Fragment,null,v):s.a.createElement("div",{className:q()("chat-info",{"right-column":!a},t)},v)}}hs.defaultProps={className:null,classes:null,popup:!1};var us=hs;a(415);class ps extends s.a.PureComponent{render(){const e=this.props,t=e.chatId,a=e.onSelect,n=e.showSavedMessages,i=e.t,o=Object(Ze.r)(t,n,i);return s.a.createElement("div",{className:"top-chat"},s.a.createElement(Ct,{chatId:t,onSelect:a,showSavedMessages:n,showOnline:!0}),s.a.createElement("div",{className:"top-chat-title"},o))}}ps.defaultProps={showSavedMessages:!0};var ms=Object(p.c)()(ps);a(416);class gs extends s.a.PureComponent{render(){const e=this.props,t=e.chatId,a=e.onClick;return s.a.createElement(La.a,{button:!0,className:"recently-found-chat",onClick:a},s.a.createElement("div",{className:"recently-found-chat-content"},s.a.createElement("div",{className:"chat-wrapper"},s.a.createElement(Ct,{chatId:t}),s.a.createElement("div",{className:"dialog-inner-wrapper"},s.a.createElement("div",{className:"tile-first-row"},s.a.createElement(It,{chatId:t}))))))}}var fs=gs;a(417);class bs extends s.a.Component{constructor(e){super(e),this.onClientUpdateChatId=e=>{const t=e.nextChatId,a=e.previousChatId;this.setState({nextChatId:t,previousChatId:a})},this.state={nextChatId:v.a.getChatId(),previousChatId:null}}shouldComponentUpdate(e,t){const a=this.props,n=a.chatId,s=a.theme;return t.nextChatId===n||(t.previousChatId===n||e.theme!==s)}componentDidMount(){v.a.on("clientUpdateChatId",this.onClientUpdateChatId)}componentWillUnmount(){v.a.off("clientUpdateChatId",this.onClientUpdateChatId)}render(){const e=this.props,t=e.chatId,a=e.onClick,n=this.state.nextChatId,i=Object(Ze.x)(t),o=Object(Ze.z)(t);let r="";return o>0&&(r=1===o?", 1 subscriber":", ".concat(o," subscribers")),s.a.createElement(La.a,{button:!0,classes:q()("found-public-chat",{"item-selected":t===n}),onClick:a},s.a.createElement("div",{className:"dialog-wrapper"},s.a.createElement(Ct,{chatId:t}),s.a.createElement("div",{className:"dialog-inner-wrapper"},s.a.createElement("div",{className:"tile-first-row"},s.a.createElement(It,{chatId:t})),s.a.createElement("div",{className:"tile-second-row"},s.a.createElement("div",{className:"dialog-content"},"@",i,r)))))}}var Cs=bs,ys=a(84);a(418);class vs extends s.a.Component{constructor(e){super(e),this.onClientUpdateChatId=e=>{this.setState(Object(ae.a)({},e))},this.state={nextChatId:v.a.getChatId(),nextMessageId:v.a.getMessageId()}}shouldComponentUpdate(e,t){const a=this.props,n=a.chatId,s=a.messageId,i=a.theme;return t.nextChatId===n&&t.nextMessageId===s||(t.previousChatId===n&&t.previousMessageId===s||e.theme!==i)}componentDidMount(){v.a.on("clientUpdateChatId",this.onClientUpdateChatId)}componentWillUnmount(){v.a.off("clientUpdateChatId",this.onClientUpdateChatId)}render(){const e=this.props,t=e.chatId,a=e.messageId,n=e.chatSearch,i=e.onClick,o=e.t,r=this.state.nextChatId,c=this.state.nextMessageId,l=Nt.a.get(t,a),d=l.sender_user_id,h=Object(Ze.D)(l),u=Object(Ze.F)(l,o),p=Object(Ze.E)(l,o),m=Object(Tt.f)(l,o)||"\xa0",g=t===r&&a===c,f=d&&n?s.a.createElement(ys.a,{userId:d}):s.a.createElement(Ct,{chatId:t});return s.a.createElement(La.a,{button:!0,className:q()("found-message",{"item-selected":g}),onClick:i},s.a.createElement("div",{className:"dialog-wrapper"},f,s.a.createElement("div",{className:"dialog-inner-wrapper"},s.a.createElement("div",{className:"tile-first-row"},n&&p?s.a.createElement("div",{className:"dialog-title"},p):s.a.createElement(It,{chatId:t}),s.a.createElement("div",{className:"dialog-meta"},h)),s.a.createElement("div",{className:"tile-second-row"},s.a.createElement("div",{className:"dialog-content"},s.a.createElement(s.a.Fragment,null,!n&&u&&s.a.createElement("span",{className:"dialog-content-accent"},u,": "),m))))))}}var Es=Object(p.c)()(vs);a(419);var Ss=function(e){const t=e.caption,a=e.command,n=e.onClick;return s.a.createElement("div",{className:"search-caption"},s.a.createElement("div",{className:"search-caption-title"},t),Boolean(a)&&s.a.createElement("a",{onClick:n},a))};a(420);class Us extends s.a.Component{constructor(e){var t;super(e),t=this,this.concatSearchResults=e=>{const t=[],a=new Map;for(let n=0;n<e.length;n++){let s=e[n]&&e[n].chat_ids;if(s)for(let e=0;e<s.length;e++)a.has(s[e])||(a.set(s[e],s[e]),t.push(s[e]))}return t.sort((e,t)=>Object(ze.u)(gt.a.get(t).order,gt.a.get(e).order)),t},this.searchText=function(){var e=Object(h.a)(d.a.mark((function e(a){var n,s,i,o,r,c,l,h,u,p,m,g,f,b,C,y,v,E,S,U,k,w,M,I,_,x,O,P,T,N,D;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.sessionId=new Date,t.text=a,n=t.sessionId,s=null,i=t.props.chatId,o=t.state.savedMessages,i){e.next=43;break}return r=[],c=V.a.send({"@type":"searchChats",query:a,limit:100}),r.push(c),(l=ba(a))&&l!==a&&(h=V.a.send({"@type":"searchChats",query:l,limit:100}),r.push(h)),(u=ga(a))&&u!==a&&(p=V.a.send({"@type":"searchChats",query:u,limit:100}),r.push(p)),e.next=16,Promise.all(r.map(e=>e.catch(e=>null)));case 16:if(m=e.sent,g=t.concatSearchResults(m),n===t.sessionId){e.next=20;break}return e.abrupt("return");case 20:if(o&&(f=t.props.t,b=a.toUpperCase(),((C=["SAVED MESSAGES",f("SavedMessages").toUpperCase()]).some(e=>e.includes(b))||l&&C.some(e=>e.includes(l.toUpperCase())))&&g.splice(0,0,o.id)),t.setState({top:null,recentlyFound:null,local:g}),s=ft.a.getStore(),Object(mt.p)(s,g),!((y=(y=a.trim()).startsWith("@")?y.substr(1):y).length>=B.rb)){e.next=42;break}return v=[],E=V.a.send({"@type":"searchPublicChats",query:y}),v.push(E),l&&(S=(S=l.trim()).startsWith("@")?S.substr(1):S).length>=B.rb&&S!==y&&(U=V.a.send({"@type":"searchPublicChats",query:S}),v.push(U)),e.next=33,Promise.all(v.map(e=>e.catch(e=>null)));case 33:if(k=e.sent,w=t.concatSearchResults(k),n===t.sessionId){e.next=37;break}return e.abrupt("return");case 37:t.setState({global:w}),s=ft.a.getStore(),Object(mt.p)(s,w),e.next=43;break;case 42:t.setState({global:null});case 43:if(M=[],!i){e.next=50;break}return e.next=47,V.a.send({"@type":"searchChatMessages",chat_id:i,query:a,sender_user_id:0,from_message_id:0,offset:0,limit:50,filter:null});case 47:M=e.sent,e.next=53;break;case 50:return e.next=52,V.a.send({"@type":"searchMessages",query:a,offset_date:0,offset_chat_id:0,offset_message_id:0,limit:50});case 52:M=e.sent;case 53:if(Nt.a.setItems(M.messages),I=null,i){e.next=67;break}return e.prev=56,e.next=59,V.a.send({"@type":"getMessageLinkInfo",url:a});case 59:_=e.sent,Nt.a.setItems([_.message]),I=_,e.next=67;break;case 64:e.prev=64,e.t0=e.catch(56),console.log("[se] searchText="+a+" messageLinkInfo error",e.t0);case 67:if(n===t.sessionId){e.next=69;break}return e.abrupt("return");case 69:for(t.setState({messages:M,linkMessage:I}),x=new Map,O=new Map,P=0;P<M.messages.length;P++)x.set(M.messages[P].chat_id,M.messages[P].chat_id),M.messages[P].sender_user_id&&O.set(M.messages[P].sender_user_id,M.messages[P].sender_user_id);I&&(N=(T=I).chat_id,D=T.sender_user_id,x.set(N,N),D&&O.set(D,D)),s=ft.a.getStore(),Object(mt.p)(s,[...x.keys()]),Object(mt.A)(s,[...O.keys()]);case 77:case"end":return e.stop()}}),e,null,[[56,64]])})));return function(t){return e.apply(this,arguments)}}(),this.loadContent=Object(h.a)(d.a.mark((function e(){var a,n,s,i,o,r,c,l,h;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.props.chatId){e.next=4;break}return t.setState({top:null,recentlyFound:null,local:null,global:null,messages:null,linkMessage:null}),e.abrupt("return");case 4:return a=V.a.send({"@type":"getTopChats",category:{"@type":"topChatCategoryUsers"},limit:30}).catch(()=>({"@type":"chats",chat_ids:[]})),n=V.a.send({"@type":"searchChats",query:"",limit:100}).catch(()=>({"@type":"chats",chat_ids:[]})),s=V.a.send({"@type":"createPrivateChat",user_id:ht.a.getMyId(),force:!0}).catch(e=>{}),e.next=9,Promise.all([a,n,s]);case 9:i=e.sent,o=Object(T.a)(i,3),r=o[0],c=o[1],l=o[2],t.setState({top:r,recentlyFound:c,savedMessages:l,local:null,global:null,messages:null,linkMessage:null}),h=ft.a.getStore(),Object(mt.p)(h,r.chat_ids),Object(mt.p)(h,c.chat_ids);case 18:case"end":return e.stop()}}),e)}))),this.handleRecentlyFound=Object(h.a)(d.a.mark((function e(){var t,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.a.send({"@type":"getChats",offset_order:"9223372036854775807",offset_chat_id:0,limit:20});case 2:for(t=e.sent,a=t.chat_ids.length-1;a>=0;a--)V.a.send({"@type":"addRecentlyFoundChat",chat_id:t.chat_ids[a]});case 4:case"end":return e.stop()}}),e)}))),this.handleClearRecentlyFound=e=>{e.stopPropagation(),V.a.send({"@type":"clearRecentlyFoundChats"}),this.setState({recentlyFound:null})},this.handleSelectMessage=(e,t,a,n)=>{const s=this.props.onSelectMessage;a&&V.a.send({"@type":"addRecentlyFoundChat",chat_id:e}),s(e,t,n)},this.handleScroll=()=>{const e=this.listRef.current;e.scrollTop+e.offsetHeight>=e.scrollHeight-B.gb&&this.onLoadPrevious()},this.getOffset=e=>{const t=e?e.messages.length:0;return{offset_date:t>0?e.messages[t-1].date:0,offset_chat_id:t>0?e.messages[t-1].chat_id:0,offset_message_id:t>0?e.messages[t-1].id:0}},this.concatMessages=(e,t)=>t&&t.messages.length?e&&e.messages.length?{total_count:t.total_count,messages:e.messages.concat(t.messages)}:t:e,this.onLoadPrevious=Object(h.a)(d.a.mark((function e(){var a,n,s,i,o,r,c,l,h;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.loading){e.next=2;break}return e.abrupt("return");case 2:if(a=t.props.chatId,n=t.sessionId,s=t.state.messages,i=t.getOffset(s),t.loading=!0,o=[],!a){e.next=14;break}return e.next=11,V.a.send({"@type":"searchChatMessages",chat_id:a,query:t.text,sender_user_id:0,from_message_id:i.offset_message_id,limit:50,filter:null});case 11:o=e.sent,e.next=17;break;case 14:return e.next=16,V.a.send(Object(ae.a)({"@type":"searchMessages",query:t.text},i,{limit:50}));case 16:o=e.sent;case 17:if(t.loading=!1,Object(Tt.d)(o,s?s.messages:[]),Nt.a.setItems(o.messages),n===t.sessionId){e.next=22;break}return e.abrupt("return");case 22:for(t.setState({messages:t.concatMessages(s,o)}),r=new Map,c=new Map,l=0;l<o.messages.length;l++)r.set(o.messages[l].chat_id,o.messages[l].chat_id),o.messages[l].sender_user_id&&c.set(o.messages[l].sender_user_id,o.messages[l].sender_user_id);h=ft.a.getStore(),Object(mt.p)(h,[...r.keys()]),Object(mt.A)(h,[...c.keys()]);case 29:case"end":return e.stop()}}),e)}))),this.handleTopChatsScroll=e=>{e.stopPropagation()},this.handleClose=()=>{(0,this.props.onClose)()},this.listRef=s.a.createRef(),this.state={}}componentDidMount(){const e=this.props.text;this.searchOrLoadContent(e)}componentDidUpdate(e,t,a){const n=this.props,s=n.chatId,i=n.text;(e.text!==i||e.chatId!==s)&&this.searchOrLoadContent(i)}searchOrLoadContent(e){const t=e?e.trim():"";t?this.searchText(t):this.loadContent()}render(){const e=this.props,t=(e.classes,e.chatId),a=this.state,n=a.top,i=a.recentlyFound,o=a.local,r=a.global,c=a.messages,l=a.linkMessage,d=gt.a.get(t),h=n&&n.chat_ids?n.chat_ids.map(e=>s.a.createElement(ms,{key:e,chatId:e,onSelect:()=>this.handleSelectMessage(e,null,!1,!1)})):[],u=i&&i.chat_ids?i.chat_ids.map(e=>s.a.createElement(fs,{key:e,chatId:e,onClick:()=>this.handleSelectMessage(e,null,!0,!1)})):[],p=o?o.map(e=>s.a.createElement(fs,{key:e,chatId:e,onClick:()=>this.handleSelectMessage(e,null,!0,!1)})):[],m=new Map,g=r?r.map(e=>(m.set(e,e),s.a.createElement(Cs,{key:e,chatId:e,onClick:()=>this.handleSelectMessage(e,null,!0,!0)}))):[],f=l&&l.chat_id&&!l.message&&!m.has(l.chat_id)?s.a.createElement(Cs,{key:l.chat_id,chatId:l.chat_id,onClick:()=>this.handleSelectMessage(l.chat_id,null,!0,!0)}):null,b=new Map,C=c&&c.messages?c.messages.map(e=>{const a="".concat(e.chat_id,"_").concat(e.id);return b.set(a,a),s.a.createElement(Es,{key:a,chatId:e.chat_id,messageId:e.id,chatSearch:Boolean(t),onClick:()=>this.handleSelectMessage(e.chat_id,e.id,!1,!0)})}):[],y=l&&l.message&&!b.has("".concat(l.message.chat_id,"_").concat(l.message.id))?s.a.createElement(Es,{key:"".concat(l.message.chat_id,"_").concat(l.message.id),chatId:l.message.chat_id,messageId:l.message.id,chatSearch:!1,onClick:()=>this.handleSelectMessage(l.message.chat_id,l.message.id,!1,!0)}):null;let v=c?c.total_count:0;l&&l.message&&!b.has("".concat(l.message.chat_id,"_").concat(l.message.id))&&v++;let E="No messages found";return v&&(E=1===v?"Found 1 message":"Found ".concat(v," messages")),s.a.createElement("div",{ref:this.listRef,className:"search",onScroll:this.handleScroll},d&&s.a.createElement("div",{className:"search-chat"},s.a.createElement(Ss,{caption:"Search messages in"}),s.a.createElement("div",{className:"search-chat-wrapper"},s.a.createElement("div",{className:"search-chat-control"},s.a.createElement(Za,{chatId:t,showStatus:!1})),s.a.createElement(J.a,{className:"header-right-button","aria-label":"Search",onMouseDown:this.handleClose},s.a.createElement(la.a,null)))),h.length>0&&s.a.createElement("div",{className:"search-top-chats"},s.a.createElement(Ss,{caption:"People"}),s.a.createElement("div",{className:"search-top-chats-list",onScroll:this.handleTopChatsScroll},s.a.createElement("div",{className:"search-top-chats-placeholder"}),h,s.a.createElement("div",{className:"search-top-chats-placeholder"}))),u.length>0&&s.a.createElement("div",{className:"search-recently-found-chats"},s.a.createElement(Ss,{caption:"Recent",command:"Clear",onClick:this.handleClearRecentlyFound}),u),p.length>0&&s.a.createElement("div",{className:"search-local-chats"},s.a.createElement(Ss,{caption:"Chats and contacts"}),p),g.length>0&&s.a.createElement("div",{className:"search-global-chats"},s.a.createElement(Ss,{caption:"Global search"}),f,g),(c||l&&l.message)&&s.a.createElement("div",{className:"search-global-chats"},s.a.createElement(Ss,{caption:E}),y,C))}}var ks=Object(p.c)()(Us),ws=a(239),Ms=Object(Je.a)(s.a.createElement("path",{d:"M16.5,1 C17.7590292,1 18.9445825,1.59277663 19.7,2.6 L19.7,2.6 L21.2,4.6 C21.7192885,5.29238468 22,6.13451915 22,7 L22,7 L22,8 C22,8.11615513 21.980196,8.22768478 21.9437804,8.33139667 C21.9809544,8.54881122 22,8.77218145 22,9 L22,18 C22,20.209139 20.209139,22 18,22 L6,22 C3.790861,22 2,20.209139 2,18 L2,9 C2,8.77218145 2.01904557,8.54881122 2.05563136,8.33139468 C2.01980398,8.22768478 2,8.11615513 2,8 L2,8 L2,7 C2,6.13451915 2.28071149,5.29238468 2.8,4.6 L2.8,4.6 L4.3,2.6 C5.05541753,1.59277663 6.24097079,1 7.5,1 L7.5,1 Z M18,7 L6,7 C4.8954305,7 4,7.8954305 4,9 L4,18 C4,19.1045695 4.8954305,20 6,20 L18,20 C19.1045695,20 20,19.1045695 20,18 L20,9 C20,7.8954305 19.1045695,7 18,7 Z M8.29289322,11.2928932 C8.68341751,10.9023689 9.31658249,10.9023689 9.70710678,11.2928932 L9.70710678,11.2928932 L12,13.5857864 L14.2928932,11.2928932 C14.6834175,10.9023689 15.3165825,10.9023689 15.7071068,11.2928932 C16.0976311,11.6834175 16.0976311,12.3165825 15.7071068,12.7071068 L15.7071068,12.7071068 L12.7071068,15.7071068 C12.3165825,16.0976311 11.6834175,16.0976311 11.2928932,15.7071068 L11.2928932,15.7071068 L8.29289322,12.7071068 C7.90236893,12.3165825 7.90236893,11.6834175 8.29289322,11.2928932 Z M16.5,3 L7.5,3 C6.87048539,3 6.27770876,3.29638831 5.9,3.8 L5.9,3.8 L4.88040369,5.15879948 C5.23567546,5.05542416 5.61136523,5 6,5 L18,5 C18.3882729,5 18.7636249,5.055321 19.1186039,5.15851085 L18.1,3.8 C17.7222912,3.29638831 17.1295146,3 16.5,3 L16.5,3 Z"}),"Archive"),Is=Object(Je.a)(s.a.createElement("path",{d:"M8,13 C11.3229116,13 13.7530244,13.8337117 15.2223821,15.5699359 C15.724477,16.1632234 16,16.915291 16,17.6925226 L16,18.5 C16,19.8807119 14.8807119,21 13.5,21 L2.5,21 C1.11928813,21 0,19.8807119 0,18.5 L0,17.6925204 C0,16.9152876 0.275524605,16.1632192 0.777621166,15.569932 C2.24697824,13.8337108 4.67709024,13 8,13 Z M17.9515112,14.0335753 L18.0683205,14.0347288 C20.2213596,14.1802785 21.8813904,14.7876525 23.0130897,15.8958397 C23.5916808,16.4623828 23.9388003,17.2206225 23.9926356,18.0235027 L24,18.2434663 L24,18.75 C24,19.940864 23.0748384,20.9156449 21.9040488,20.9948092 L21.75,21 L19,21 C18.4477153,21 18,20.5522847 18,20 C18,19.4871642 18.3860402,19.0644928 18.8833789,19.0067277 L19,19 L21.75,19 C21.8683467,19 21.9674868,18.9177666 21.9933973,18.8073227 L22,18.75 L22,18.2434663 C22,17.8977921 21.8608093,17.5666871 21.6138154,17.3248364 C20.8641159,16.5907126 19.6490875,16.1461566 17.9334244,16.0301743 C17.3823973,15.9929238 16.9658991,15.5160306 17.0031496,14.9650035 C17.0377394,14.4533355 17.4514089,14.0576643 17.9515112,14.0335753 L17.9515112,14.0335753 Z M8,15 C5.21130036,15 3.33538166,15.6435809 2.30428673,16.861943 C2.10781409,17.0940989 2,17.3883868 2,17.6925212 L2,18.5 C2,18.7761424 2.22385763,19 2.5,19 L13.5,19 C13.7761424,19 14,18.7761424 14,18.5 L14,17.6925226 C14,17.3883883 13.8921864,17.0941004 13.6957148,16.8619448 C12.6646202,15.6435815 10.788701,15 8,15 Z M17,5 C18.9329966,5 20.5,6.56700338 20.5,8.5 C20.5,10.4329966 18.9329966,12 17,12 C15.0670034,12 13.5,10.4329966 13.5,8.5 C13.5,6.56700338 15.0670034,5 17,5 Z M8,3 C10.209139,3 12,4.790861 12,7 C12,9.209139 10.209139,11 8,11 C5.790861,11 4,9.209139 4,7 C4,4.790861 5.790861,3 8,3 Z M17,7 C16.1715729,7 15.5,7.67157288 15.5,8.5 C15.5,9.32842712 16.1715729,10 17,10 C17.8284271,10 18.5,9.32842712 18.5,8.5 C18.5,7.67157288 17.8284271,7 17,7 Z M8,5 C6.8954305,5 6,5.8954305 6,7 C6,8.1045695 6.8954305,9 8,9 C9.1045695,9 10,8.1045695 10,7 C10,5.8954305 9.1045695,5 8,5 Z"}),"Group"),_s=Object(Je.a)(s.a.createElement("path",{d:"M12,1 C18.0751322,1 23,5.92486775 23,12 C23,18.0751322 18.0751322,23 12,23 C5.92486775,23 1,18.0751322 1,12 C1,5.92486775 5.92486775,1 12,1 Z M12,3 C7.02943725,3 3,7.02943725 3,12 C3,16.9705627 7.02943725,21 12,21 C16.9705627,21 21,16.9705627 21,12 C21,7.02943725 16.9705627,3 12,3 Z M11.9779053,15.294165 C12.6523978,15.294165 13.1985107,15.8124506 13.1985107,16.4732666 C13.1985107,17.1238794 12.6418359,17.6523682 11.9779053,17.6523682 C11.3175981,17.6523682 10.7572998,17.1168932 10.7572998,16.4732666 C10.7572998,15.8194152 11.3070616,15.294165 11.9779053,15.294165 Z M12.3306885,6.9 C14.2795758,6.9 15.719873,7.96860761 15.719873,9.65625 C15.719873,10.6709643 15.2884676,11.3128276 14.2962576,12.0165438 L13.7962596,12.3573922 C13.1714716,12.7953495 12.9391113,13.1198405 12.9391113,13.5887451 L12.9391113,13.7132568 C12.9391113,14.2033083 12.5618823,14.5499512 11.9986572,14.5499512 C11.4068652,14.5499512 11.0789551,14.2281702 11.0789551,13.630249 L11.0789551,13.4953613 C11.0789551,12.5573197 11.487326,11.9745882 12.4189711,11.3276124 L12.7619755,11.0871498 C13.5110635,10.5470305 13.7248291,10.2540011 13.7248291,9.73925781 C13.7248291,8.99900037 13.149745,8.51113281 12.2580566,8.51113281 C11.6278214,8.51113281 11.1498312,8.8062186 10.7980484,9.38963394 L10.5277106,9.73161327 L10.5277106,9.73161327 L10.4428973,9.8298462 C10.2452762,10.0412654 10.0433297,10.1297852 9.70556641,10.1297852 C9.27040611,10.1297852 8.9,9.79174463 8.9,9.31384277 C8.9,9.13743147 8.92867764,8.96536563 8.98734042,8.76592778 C9.31829759,7.6784971 10.623966,6.9 12.3306885,6.9 Z"}),"Help"),xs=Object(Je.a)(s.a.createElement("path",{d:"M13.4542714,1 C14.5034049,1 15.447759,1.80035641 15.6254934,2.83409123 L15.8863908,4.35151652 C16.4016786,4.58533298 16.8892685,4.86975342 17.3418997,5.20083722 L18.729489,4.68523838 C19.7215225,4.31661974 20.8874905,4.74674629 21.4093705,5.66596818 L22.3631385,7.34590292 C22.8807104,8.25753682 22.6641696,9.47960173 21.8668015,10.158283 L20.7203437,11.1340925 C20.7523279,11.4263818 20.768775,11.713662 20.768775,12 C20.768775,12.2863013 20.7523321,12.5735444 20.7203561,12.8657949 L21.8666717,13.8411466 C22.6665193,14.5217032 22.8803536,15.7423983 22.3631806,16.6535107 L21.4094127,18.3337799 C20.8871999,19.2537711 19.7186485,19.6823124 18.729489,19.3147616 L17.3418997,18.7991628 C16.8892685,19.1302466 16.4016786,19.414667 15.8863908,19.6484835 L15.6254934,21.1659088 C15.4482371,22.1968626 14.500959,23 13.4542714,23 L11.5464067,23 C10.4973482,23 9.55294448,22.1997516 9.37499917,21.1661206 L9.11371177,19.6483803 C8.59870239,19.4145642 8.11116816,19.1301583 7.65836517,18.7991106 L6.27103566,19.3147347 C5.27906015,19.683419 4.11313098,19.25315 3.59116388,18.3339086 L2.63706709,16.6536394 C2.11936149,15.741903 2.33579039,14.5197379 3.13332831,13.8411466 L4.27990265,12.8655748 C4.24777315,12.5724368 4.23122501,12.2856623 4.23122501,12 C4.23122501,11.7143012 4.24777739,11.4274899 4.27991498,11.1343127 L3.1331985,10.158283 C2.33341387,9.47754488 2.11971252,8.25678535 2.6371093,7.34577419 L3.59120609,5.66583945 C4.11357343,4.74607633 5.28204594,4.31769072 6.27103566,4.68526527 L7.65836517,5.20088944 C8.02060756,4.93605128 8.40507795,4.70106385 8.80806121,4.49794854 L9.11371177,4.35161967 L9.37499917,2.83387942 C9.55246572,1.80302941 10.4997942,1 11.5464067,1 L13.4542714,1 Z M13.4542714,3 L11.5464067,3 C11.4759721,3 11.3587093,3.09940116 11.3460046,3.17319893 L10.9911423,5.23448734 C10.9307198,5.5854636 10.6881938,5.87781899 10.3544182,6.00203275 C9.66471384,6.25870451 9.03276419,6.62813555 8.48454956,7.09507573 C8.20871593,7.3300162 7.82737524,7.39737412 7.48774669,7.2711455 L5.57427032,6.55997006 C5.50662795,6.53482964 5.36908018,6.58525743 5.33030218,6.65353615 L4.37620539,8.3334709 C4.33235155,8.41068695 4.36153792,8.57741281 4.42951339,8.63527025 L5.99467372,9.96745916 C6.26327177,10.1960769 6.39156502,10.5492878 6.3322987,10.8969923 C6.26535074,11.2897637 6.23122501,11.6509097 6.23122501,12 C6.23122501,12.3490903 6.26535074,12.7102363 6.3322987,13.1030077 C6.39157523,13.4507721 6.26322722,13.80404 5.99454391,14.0326513 L4.42938358,15.3643802 C4.36263141,15.4211768 4.33280785,15.5895892 4.3762476,15.6660914 L5.33034439,17.3463606 C5.36962791,17.4155432 5.5053715,17.4656373 5.57427032,17.4400299 L7.48774669,16.7288545 C7.82737524,16.6026259 8.20871593,16.6699838 8.48454956,16.9049243 C9.03276419,17.3718644 9.66471384,17.7412955 10.3544182,17.9979673 C10.6881938,18.122181 10.9307198,18.4145364 10.9911423,18.7655127 L11.3460046,20.8268011 C11.3591616,20.9032262 11.473368,21 11.5464067,21 L13.4542714,21 C13.5246311,21 13.6417446,20.9007069 13.6544151,20.8270129 L14.0088212,18.7657245 C14.0691981,18.4145617 14.3118672,18.1220527 14.6458423,17.9978703 C15.3359969,17.7412494 15.9677081,17.3719578 16.5150513,16.9052644 C16.7908836,16.6700754 17.1723926,16.6025695 17.512181,16.7288276 L19.4261097,17.4400031 C19.4938321,17.4651673 19.631347,17.4147366 19.6700861,17.3464893 L20.623854,15.6662201 C20.6677382,15.5889085 20.6385289,15.422164 20.5706164,15.3643802 L19.0054561,14.0326513 C18.7363402,13.803672 18.6080436,13.4496677 18.6679701,13.1014383 C18.7347206,12.7135552 18.768775,12.3516302 18.768775,12 C18.768775,11.6483698 18.7347206,11.2864448 18.6679701,10.8985617 C18.6080539,10.5503923 18.7362957,10.196445 19.0053263,9.96745916 L20.5704866,8.63527025 C20.6374086,8.57830946 20.6672761,8.40975011 20.6238962,8.33334216 L19.6701283,6.65340742 C19.6309511,6.58440211 19.4952014,6.53432393 19.4261097,6.55999695 L17.512181,7.27117239 C17.1723926,7.39743055 16.7908836,7.32992456 16.5150513,7.09473562 C15.9677081,6.62804223 15.3359969,6.25875055 14.6458423,6.00212967 C14.3118672,5.87794735 14.0691981,5.58543825 14.0088212,5.23427554 L13.6544151,3.17298713 C13.6412929,3.0966658 13.5272352,3 13.4542714,3 Z M12.5,10 C13.6045695,10 14.5,10.8954305 14.5,12 C14.5,13.1045695 13.6045695,14 12.5,14 C11.3954305,14 10.5,13.1045695 10.5,12 C10.5,10.8954305 11.3954305,10 12.5,10 Z"}),"Settings"),Os=Object(Je.a)(s.a.createElement("path",{d:"M12,12 C15.9072418,12 18.715318,13.0364023 20.3351717,15.1788288 C20.7665758,15.7493929 21,16.4451545 21,17.1604559 L21,18.2857143 C21,19.7847729 19.7847729,21 18.2857143,21 L5.71428571,21 C4.21522711,21 3,19.7847729 3,18.2857143 L3,17.160494 C3,16.445199 3.23340019,15.7494497 3.66478123,15.178891 C5.28463457,13.0364199 8.09272555,12 12,12 Z M12,14 C8.66170181,14 6.44476079,14.8182362 5.26012276,16.3850773 C5.09133017,16.6083279 5,16.8805766 5,17.160494 L5,18.2857143 C5,18.6802034 5.31979661,19 5.71428571,19 L18.2857143,19 C18.6802034,19 19,18.6802034 19,18.2857143 L19,17.1604559 C19,16.8805572 18.9086617,16.6083073 18.7398491,16.38504 C17.5552048,14.8182236 15.3382718,14 12,14 Z M12,2 C14.209139,2 16,3.790861 16,6 C16,8.209139 14.209139,10 12,10 C9.790861,10 8,8.209139 8,6 C8,3.790861 9.790861,2 12,2 Z M12,4 C10.8954305,4 10,4.8954305 10,6 C10,7.1045695 10.8954305,8 12,8 C13.1045695,8 14,7.1045695 14,6 C14,4.8954305 13.1045695,4 12,4 Z"}),"User");class Ps extends s.a.Component{constructor(e){var t;super(e),t=this,this.onUpdateAuthorizationState=e=>{this.setState({authorizationState:e.authorization_state})},this.handleMenuOpen=e=>{const t=this.state.authorizationState;Object(ze.p)(t)&&this.setState({anchorEl:e.currentTarget})},this.handleMenuClose=()=>{this.setState({anchorEl:null})},this.handleCheckUpdates=Object(h.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.handleMenuClose();case 1:case"end":return e.stop()}}),e)}))),this.handleNewGroup=e=>{this.handleMenuClose()},this.handleContacts=e=>{this.handleMenuClose(),V.a.clientUpdate({"@type":"clientUpdateOpenContacts"})},this.handleArchived=e=>{this.handleMenuClose(),Object(nt.g)()},this.handleSaved=function(){var e=Object(h.a)(d.a.mark((function e(a){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.handleMenuClose(),e.next=3,V.a.send({"@type":"createPrivateChat",user_id:ht.a.getMyId(),force:!0});case 3:if(n=e.sent){e.next=6;break}return e.abrupt("return");case 6:Object(nt.h)(n.id);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleSettings=function(){var e=Object(h.a)(d.a.mark((function e(a){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.handleMenuClose(),e.next=3,V.a.send({"@type":"createPrivateChat",user_id:ht.a.getMyId(),force:!0});case 3:if(n=e.sent){e.next=6;break}return e.abrupt("return");case 6:V.a.clientUpdate({"@type":"clientUpdateOpenSettings",chatId:n.id});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleHelp=e=>{this.handleMenuClose()},this.state={authorizationState:v.a.getAuthorizationState(),anchorEl:null}}componentDidMount(){v.a.on("updateAuthorizationState",this.onUpdateAuthorizationState)}componentWillUnmount(){v.a.off("updateAuthorizationState",this.onUpdateAuthorizationState)}render(){const e=this.props,t=e.t,a=e.showClose,n=e.onClose,i=this.state,o=i.anchorEl,r=i.authorizationState,c=!a&&Object(ze.p)(r)?s.a.createElement(ws.a,{id:"main-menu",anchorEl:o,open:Boolean(o),onClose:this.handleMenuClose,getContentAnchorEl:null,disableAutoFocusItem:!0,disableRestoreFocus:!0,anchorOrigin:{vertical:"bottom",horizontal:"left"}},s.a.createElement(it.a,{onClick:this.handleNewGroup},s.a.createElement(ja.a,null,s.a.createElement(Is,null)),s.a.createElement(Ra.a,{primary:t("NewGroup")})),s.a.createElement(it.a,{onClick:this.handleContacts},s.a.createElement(ja.a,null,s.a.createElement(Os,null)),s.a.createElement(Ra.a,{primary:t("Contacts")})),s.a.createElement(it.a,{onClick:this.handleArchived},s.a.createElement(ja.a,null,s.a.createElement(Ms,null)),s.a.createElement(Ra.a,{primary:t("Archived")})),s.a.createElement(it.a,{onClick:this.handleSaved},s.a.createElement(ja.a,null,s.a.createElement(ct,null)),s.a.createElement(Ra.a,{primary:t("Saved")})),s.a.createElement(it.a,{onClick:this.handleSettings},s.a.createElement(ja.a,null,s.a.createElement(xs,null)),s.a.createElement(Ra.a,{primary:t("Settings")})),s.a.createElement(it.a,{onClick:this.handleHelp},s.a.createElement(ja.a,null,s.a.createElement(_s,null)),s.a.createElement(Ra.a,{primary:t("SettingsHelp")}))):null;return s.a.createElement(s.a.Fragment,null,s.a.createElement(J.a,{"aria-owns":o?"simple-menu":null,"aria-haspopup":"true",className:"header-left-button","aria-label":"Menu",onClick:a?n:this.handleMenuOpen},s.a.createElement(Mn.a,{open:a,openIcon:s.a.createElement(qa,null),icon:s.a.createElement(Qe,null)})),c)}}var Ts=Object(p.c)()(Ps);a(421);class Ns extends s.a.Component{constructor(...e){super(...e),this.handleKeyDown=e=>{if(13===e.keyCode)e.preventDefault();else if(27===e.keyCode){const t=this.props,a=t.onChange,n=t.onClose,s=e.target;if(!s)return;if(s.innerText)return e.stopPropagation(),s.innerText=null,void a(s.innerText);n&&(e.stopPropagation(),e.target.blur(),n())}},this.handleKeyUp=e=>{const t=e.target;if(!t)return;const a=t.innerHTML;"<br>"!==a&&"<div><br></div>"!==a||(t.innerHTML=null)},this.handlePaste=e=>{const t=e.clipboardData.getData("text/plain");t&&(e.preventDefault(),document.execCommand("insertText",!1,t))},this.handleInput=e=>{const t=this.props.onChange,a=e.target;a&&t&&t(a.innerText)}}render(){const e=this.props,t=e.inputRef,a=e.t,n=e.onFocus;return s.a.createElement("div",{className:"search-input"},s.a.createElement("div",{id:"search-inputbox",ref:t,placeholder:a("Search"),contentEditable:!0,suppressContentEditableWarning:!0,onKeyDown:this.handleKeyDown,onKeyUp:this.handleKeyUp,onPaste:this.handlePaste,onInput:this.handleInput,onFocus:n}))}}var Ds=Object(p.c)()(Ns);class Ls extends s.a.Component{constructor(e){super(e),this.onUpdateAuthorizationState=e=>{this.setState({authorizationState:e.authorization_state})},this.handleSearch=()=>{const e=this.props,t=e.onSearch,a=e.openSearch,n=this.state.authorizationState;Object(ze.p)(n)&&t(!a)},this.handleSearchTextChange=()=>{const e=this.props.onSearchTextChange,t=this.searchInputRef.current;if(!t)return;const a=t.innerHTML;"<br>"!==a&&"<div><br></div>"!==a||(t.innerHTML=null),e(t.innerText)},this.handleCloseArchive=()=>{V.a.clientUpdate({"@type":"clientUpdateCloseArchive"})},this.handleCloseSearch=()=>{this.handleSearch()},this.handleFocus=()=>{this.handleSearch()},this.handleClose=()=>{const e=this.props,t=e.openArchive,a=e.openSearch;t?this.handleCloseArchive():a&&this.handleCloseSearch()},this.searchInputRef=s.a.createRef(),this.state={authorizationState:v.a.getAuthorizationState(),open:!1}}setInitQuery(e){const t=this.props.onSearchTextChange,a=this.searchInputRef.current;if(a){if(a.innerText=e,a.childNodes.length>0){const e=document.createRange();e.setStart(a.childNodes[0],a.childNodes[0].length),e.collapse(!0);const t=window.getSelection();t.removeAllRanges(),t.addRange(e)}a.focus(),t(e)}}componentDidUpdate(e,t,a){const n=this.props,s=n.openSearch;n.text;if(s!==e.openSearch){const e=this.searchInputRef.current;s?setTimeout(()=>{e&&e.focus()},B.a):e.innerText=null}}componentDidMount(){v.a.on("updateAuthorizationState",this.onUpdateAuthorizationState)}componentWillUnmount(){v.a.off("updateAuthorizationState",this.onUpdateAuthorizationState)}render(){const e=this.props,t=e.onClick,a=e.openArchive,n=e.openSearch,i=e.t;let o=null,r=!1;return n?(r=!0,o=s.a.createElement(Ds,{inputRef:this.searchInputRef,onChange:this.handleSearchTextChange,onClose:this.handleCloseSearch})):a?(r=!0,o=s.a.createElement("div",{className:"header-status grow cursor-pointer",onClick:t},s.a.createElement("span",{className:"header-status-content"},i("ArchivedChats")))):o=s.a.createElement(Ds,{inputRef:this.searchInputRef,onFocus:this.handleFocus}),s.a.createElement("div",{className:"header-master"},s.a.createElement(Ts,{showClose:r,onClose:this.handleClose}),o)}}var js=Object(u.a)(Object(u.d)(),Object(p.c)(),Object(u.c)())(Ls);a(422);class Rs extends s.a.Component{constructor(e){var t;super(e),t=this,this.handleUsernameChange=Object(h.a)(d.a.mark((function e(){var a,n,s,i,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.props.chatId,n=t.state.username,(s=t.usernameRef.current.value).startsWith("@")&&s.length>1&&(s=s.substr(1)),n!==s&&""!==s){e.next=8;break}t.setState({usernameCheck:null}),e.next=14;break;case 8:return e.next=10,V.a.send({"@type":"checkChatUsername",chat_id:a,username:s});case 10:i=e.sent,(o=t.usernameRef.current.value).startsWith("@")&&o.length>1&&(o=o.substr(1)),o===s&&t.setState({usernameCheck:i});case 14:case"end":return e.stop()}}),e)}))),this.firstNameRef=s.a.createRef(),this.lastNameRef=s.a.createRef(),this.bioRef=s.a.createRef(),this.usernameRef=s.a.createRef();const a=ht.a.get(ht.a.getMyId()),n=ht.a.getFullInfo(ht.a.getMyId());this.state={firstName:a?a.first_name:"",lastName:a?a.last_name:"",bio:n?n.bio:"",username:a?a.username:"",usernameCheck:null}}componentWillUnmount(){this.setName(),this.setBio(),this.setUsername()}setUsername(){const e=this.state,t=e.username,a=e.usernameCheck;let n=this.usernameRef.current.value;n.startsWith("@")&&n.length>1&&(n=n.substr(1)),t!==n&&a&&"checkChatUsernameResultOk"===a["@type"]&&V.a.send({"@type":"setUsername",username:n})}setName(){const e=this.state,t=e.firstName,a=e.lastName,n=this.firstNameRef.current.value,s=this.lastNameRef.current.value;n===t&&s===a||V.a.send({"@type":"setName",first_name:n,last_name:s})}setBio(){const e=this.state.bio,t=this.bioRef.current.value;t!==e&&V.a.send({"@type":"setBio",bio:t})}render(){let e=this.props,t=e.chatId,a=e.t,n=e.onClose;const i=this.state,o=i.firstName,r=i.lastName,c=i.bio,l=i.username,d=i.usernameCheck;let h=!1,u=a("Username");if(d)switch(d["@type"]){case"checkChatUsernameResultOk":h=!1,u="Username is available";break;case"checkChatUsernameResultPublicChatsTooMuch":case"checkChatUsernameResultPublicGroupsUnavailable":case"checkChatUsernameResultUsernameInvalid":h=!0,u="Invalid username";break;case"checkChatUsernameResultUsernameOccupied":h=!0,u="Username is already taken"}return s.a.createElement("div",{className:"settings-page"},s.a.createElement("div",{className:"header-master"},s.a.createElement(J.a,{className:"header-left-button",onClick:n},s.a.createElement(qa,null)),s.a.createElement("div",{className:"header-status grow cursor-pointer"},s.a.createElement("span",{className:"header-status-content"},a("EditProfile")))),s.a.createElement("div",{className:"settings-page-content"},s.a.createElement("div",{className:"chat-details-info"},s.a.createElement(Za,{chatId:t,showTitle:!1,big:!0,showStatus:!0,showSavedMessages:!1,onTileSelect:null})),s.a.createElement("div",{className:"edit-profile-name"},s.a.createElement($.a,{inputRef:this.firstNameRef,className:"edit-profile-input",variant:"outlined",fullWidth:!0,label:a("FirstName"),defaultValue:o}),s.a.createElement($.a,{inputRef:this.lastNameRef,className:"edit-profile-input",variant:"outlined",fullWidth:!0,label:a("LastName"),defaultValue:r}),s.a.createElement($.a,{inputRef:this.bioRef,className:"edit-profile-input",variant:"outlined",fullWidth:!0,label:a("Bio"),defaultValue:c}),s.a.createElement("div",{className:"edit-profile-hint"},a("BioAbout"))),s.a.createElement("div",{className:"settings-border"}),s.a.createElement("div",{className:"edit-profile-username"},s.a.createElement($.a,{inputRef:this.usernameRef,error:h,className:"edit-profile-input",variant:"outlined",fullWidth:!0,label:u,defaultValue:l,onChange:this.handleUsernameChange}),s.a.createElement("div",{className:"edit-profile-hint"},"You can choose a username on Telegram. If you do, other people will be able to find you by this username and contact you without knowing your phone number. You can use a-z, 0-9 and underscores. Minimum length is 5 characters."))))}}var As=Object(u.a)(Object(u.d)(),Object(p.c)(),Object(u.c)())(Rs);a(423);class Fs extends s.a.Component{constructor(e){super(e),this.handleMuteFor=e=>{const t=this.state[e];if(!t)return;const a=t.mute_for,n=Object(ae.a)({},t,{mute_for:0===a?31536e3:0});this.setState({[e]:n})},this.handleShowPreview=e=>{const t=this.state[e];if(!t)return;const a=t.show_preview,n=Object(ae.a)({},t,{show_preview:!a});this.setState({[e]:n})},this.handleContactJoined=()=>{this.setState({contactJoined:!this.state.contactJoined})};const t=re.a.get("disable_contact_registered_notifications");this.state={privateChatsSettings:St.a.settings.get("notificationSettingsScopePrivateChats"),groupChatsSettings:St.a.settings.get("notificationSettingsScopeGroupChats"),channelChatsSettings:St.a.settings.get("notificationSettingsScopeChannelChats"),contactJoined:!t||!t.value}}componentWillUnmount(){const e=this.state,t=e.privateChatsSettings,a=e.groupChatsSettings,n=e.channelChatsSettings,s=e.contactJoined;this.setScopeNotificationSettings("notificationSettingsScopePrivateChats",t),this.setScopeNotificationSettings("notificationSettingsScopeGroupChats",a),this.setScopeNotificationSettings("notificationSettingsScopeChannelChats",n),this.setContactJoinedOption(s)}setContactJoinedOption(){const e=this.state.contactJoined,t=re.a.get("disable_contact_registered_notifications");(!t||!t.value)!==e&&V.a.send({"@type":"setOption",name:"disable_contact_registered_notifications",value:{"@type":"optionValueBoolean",value:!e}})}setScopeNotificationSettings(e,t){if(!e)return;if(!t)return;const a=St.a.settings.get(e);if(!a)return;const n=t.mute_for,s=t.show_preview,i=a.mute_for,o=a.show_preview;n===i&&s===o||V.a.send({"@type":"setScopeNotificationSettings",scope:{"@type":e},notification_settings:t})}isEnabled(e){if(!e)return!1;return 0===e.mute_for}showPreview(e){if(!e)return!1;return e.show_preview}render(){const e=this.props,t=e.t,a=e.onClose,n=this.state,i=n.privateChatsSettings,o=n.groupChatsSettings,r=n.channelChatsSettings,c=n.contactJoined;return s.a.createElement("div",{className:"settings-page"},s.a.createElement("div",{className:"header-master"},s.a.createElement(J.a,{className:"header-left-button",onClick:a},s.a.createElement(qa,null)),s.a.createElement("div",{className:"header-status grow cursor-pointer"},s.a.createElement("span",{className:"header-status-content"},t("Notifications")))),s.a.createElement("div",{className:"settings-page-content"},s.a.createElement("div",{className:"settings-section"},s.a.createElement("div",{className:"settings-section-header"},t("NotificationsPrivateChats")),s.a.createElement("div",{className:"settings-item",onClick:()=>this.handleMuteFor("privateChatsSettings")},s.a.createElement(se.a,{color:"primary",className:"settings-item-control",checked:this.isEnabled(i),tabIndex:-1,inputProps:{"aria-labelledby":"label-1"}}),s.a.createElement(Ra.a,{id:"label-1",primary:t("NotificationsForPrivateChats"),secondary:this.isEnabled(i)?t("NotificationsEnabled"):t("NotificationsDisabled")})),s.a.createElement("div",{className:"settings-item",onClick:()=>this.handleShowPreview("privateChatsSettings")},s.a.createElement(se.a,{color:"primary",className:"settings-item-control",checked:this.showPreview(i),tabIndex:-1,inputProps:{"aria-labelledby":"label-2"}}),s.a.createElement(Ra.a,{id:"label-2",primary:t("MessagePreview"),secondary:this.showPreview(i)?t("PreviewEnabled"):t("PreviewDisabled")}))),s.a.createElement("div",{className:"settings-border"}),s.a.createElement("div",{className:"settings-section"},s.a.createElement("div",{className:"settings-section-header"},t("NotificationsGroups")),s.a.createElement("div",{className:"settings-item",onClick:()=>this.handleMuteFor("groupChatsSettings")},s.a.createElement(se.a,{color:"primary",className:"settings-item-control",checked:this.isEnabled(o),tabIndex:-1,inputProps:{"aria-labelledby":"label-1"}}),s.a.createElement(Ra.a,{id:"label-1",primary:t("NotificationsForGroups"),secondary:this.isEnabled(o)?t("NotificationsEnabled"):t("NotificationsDisabled")})),s.a.createElement("div",{className:"settings-item",onClick:()=>this.handleShowPreview("groupChatsSettings")},s.a.createElement(se.a,{color:"primary",className:"settings-item-control",checked:this.showPreview(o),tabIndex:-1,inputProps:{"aria-labelledby":"label-2"}}),s.a.createElement(Ra.a,{id:"label-2",primary:t("MessagePreview"),secondary:this.showPreview(o)?t("PreviewEnabled"):t("PreviewDisabled")}))),s.a.createElement("div",{className:"settings-border"}),s.a.createElement("div",{className:"settings-section"},s.a.createElement("div",{className:"settings-section-header"},t("NotificationsChannels")),s.a.createElement("div",{className:"settings-item",onClick:()=>this.handleMuteFor("channelChatsSettings")},s.a.createElement(se.a,{color:"primary",className:"settings-item-control",checked:this.isEnabled(r),tabIndex:-1,inputProps:{"aria-labelledby":"label-1"}}),s.a.createElement(Ra.a,{id:"label-1",primary:t("NotificationsForChannels"),secondary:this.isEnabled(r)?t("NotificationsEnabled"):t("NotificationsDisabled")})),s.a.createElement("div",{className:"settings-item",onClick:()=>this.handleShowPreview("channelChatsSettings")},s.a.createElement(se.a,{color:"primary",className:"settings-item-control",checked:this.showPreview(r),tabIndex:-1,inputProps:{"aria-labelledby":"label-2"}}),s.a.createElement(Ra.a,{id:"label-2",primary:t("MessagePreview"),secondary:this.showPreview(r)?t("PreviewEnabled"):t("PreviewDisabled")}))),s.a.createElement("div",{className:"settings-border"}),s.a.createElement("div",{className:"settings-section"},s.a.createElement("div",{className:"settings-section-header"},t("NotificationsOther")),s.a.createElement("div",{className:"settings-item",onClick:this.handleContactJoined},s.a.createElement(se.a,{color:"primary",className:"settings-item-control",checked:c,tabIndex:-1,inputProps:{"aria-labelledby":"label-1"}}),s.a.createElement(Ra.a,{id:"label-1",primary:t("ContactJoined"),secondary:t(c?"ContactJoinedEnabled":"ContactJoinedDisabled")})))))}}var Bs=Object(u.a)(Object(u.d)(),Object(p.c)(),Object(u.c)())(Fs),Vs=a(223),zs=Object(Je.a)(s.a.createElement("path",{d:"M7.70710678,20.7071068 C7.5195704,20.8946432 7.26521649,21 7,21 L4,21 C3.44771525,21 3,20.5522847 3,20 L3,17 C3,16.7347835 3.10535684,16.4804296 3.29289322,16.2928932 L16.5857864,3 C17.3257272,2.26005924 18.5012114,2.22111499 19.2869988,2.88316725 L19.4142136,3 L21,4.58578644 C21.7399408,5.3257272 21.778885,6.50121136 21.1168328,7.28699879 L21,7.41421356 L7.70710678,20.7071068 Z M5,17.4142136 L5,19 L6.58578644,19 L16.5857864,9 L15,7.41421356 L5,17.4142136 Z M18,4.41421356 L16.414,5.99921356 L18,7.58521356 L19.5857864,6 L18,4.41421356 Z"}),"Edit"),Hs=Object(Je.a)(s.a.createElement("path",{d:"M11,2 C13.209139,2 15,3.790861 15,6 C15,6.55228475 14.5522847,7 14,7 C13.4477153,7 13,6.55228475 13,6 L13,6 L12.9945143,5.85073766 C12.9181651,4.81587779 12.0543618,4 11,4 L11,4 L6,4 C4.8954305,4 4,4.8954305 4,6 L4,6 L4,18 C4,19.1045695 4.8954305,20 6,20 L6,20 L11,20 C12.1045695,20 13,19.1045695 13,18 L13,18 L13.0067277,17.8833789 C13.0644928,17.3860402 13.4871642,17 14,17 C14.5522847,17 15,17.4477153 15,18 C15,20.209139 13.209139,22 11,22 L11,22 L6,22 C3.790861,22 2,20.209139 2,18 L2,18 L2,6 C2,3.790861 3.790861,2 6,2 L6,2 Z M18.7071068,7.29289322 L22.7071068,11.2928932 C22.7355731,11.3213595 22.7623312,11.3515341 22.787214,11.3832499 L22.7071068,11.2928932 C22.7425008,11.3282873 22.774687,11.3656744 22.8036654,11.4046934 C22.8215099,11.4288693 22.8382813,11.453725 22.8539326,11.4793398 C22.8613931,11.4913869 22.8685012,11.5036056 22.8753288,11.5159379 C22.8862061,11.5357061 22.8966234,11.5561086 22.9063462,11.5769009 C22.914321,11.5939015 22.9218036,11.6112044 22.9287745,11.628664 C22.9366843,11.6484208 22.9438775,11.6682023 22.9504533,11.6882636 C22.9552713,11.7031487 22.9599023,11.7185367 22.9641549,11.734007 C22.9701664,11.7555635 22.9753602,11.7772539 22.9798348,11.7992059 C22.9832978,11.8166247 22.9863719,11.834051 22.9889822,11.8515331 C22.9962388,11.8996379 23,11.9493797 23,12 L22.9962979,11.9137692 C22.9978436,11.9317345 22.9989053,11.9497336 22.9994829,11.9677454 L23,12 C23,12.0112225 22.9998151,12.0224019 22.9994483,12.0335352 C22.9988772,12.050591 22.997855,12.0679231 22.996384,12.0852242 C22.994564,12.1070574 22.9920941,12.1281144 22.9889807,12.1489612 C22.9863719,12.165949 22.9832978,12.1833753 22.9797599,12.2007258 C22.9753602,12.2227461 22.9701664,12.2444365 22.964279,12.2658396 C22.9599023,12.2814633 22.9552713,12.2968513 22.9502619,12.3121425 C22.9438775,12.3317977 22.9366843,12.3515792 22.928896,12.3710585 C22.9218036,12.3887956 22.914321,12.4060985 22.9063266,12.4232215 C22.8966234,12.4438914 22.8862061,12.4642939 22.8751242,12.484277 C22.8685012,12.4963944 22.8613931,12.5086131 22.8540045,12.5207088 C22.8382813,12.546275 22.8215099,12.5711307 22.8036865,12.5951593 C22.7982466,12.602603 22.7927155,12.6098424 22.7870723,12.6170223 C22.7849289,12.6196628 22.7826279,12.6225624 22.7803112,12.625449 L22.7071068,12.7071068 L22.7071068,12.7071068 L18.7071068,16.7071068 C18.3165825,17.0976311 17.6834175,17.0976311 17.2928932,16.7071068 C16.9023689,16.3165825 16.9023689,15.6834175 17.2928932,15.2928932 L19.585,13 L13,13 C12.4871642,13 12.0644928,12.6139598 12.0067277,12.1166211 L12,12 C12,11.4477153 12.4477153,11 13,11 L13,11 L19.585,11 L17.2928932,8.70710678 C16.9023689,8.31658249 16.9023689,7.68341751 17.2928932,7.29289322 C17.6834175,6.90236893 18.3165825,6.90236893 18.7071068,7.29289322 Z"}),"LogOut"),Ws=Object(Je.a)(s.a.createElement("path",{d:"M12,16 C13.1045695,16 14,16.8954305 14,18 C14,19.1045695 13.1045695,20 12,20 C10.8954305,20 10,19.1045695 10,18 C10,16.8954305 10.8954305,16 12,16 Z M12,10 C13.1045695,10 14,10.8954305 14,12 C14,13.1045695 13.1045695,14 12,14 C10.8954305,14 10,13.1045695 10,12 C10,10.8954305 10.8954305,10 12,10 Z M12,4 C13.1045695,4 14,4.8954305 14,6 C14,7.1045695 13.1045695,8 12,8 C10.8954305,8 10,7.1045695 10,6 C10,4.8954305 10.8954305,4 12,4 Z"}),"More");class Gs extends s.a.Component{constructor(...e){super(...e),this.state={anchorEl:null,open:!1},this.handleMenuOpen=e=>{this.setState({anchorEl:e.currentTarget})},this.handleMenuClose=()=>{this.setState({anchorEl:null})},this.handleLogOut=()=>{this.handleMenuClose(),this.setState({open:!0})},this.handleDone=()=>{this.handleClose(),V.a.logOut()},this.handleClose=()=>{this.setState({open:!1})}}render(){const e=this.props.t,t=this.state,a=t.anchorEl,n=t.open;return s.a.createElement(s.a.Fragment,null,s.a.createElement(J.a,{"aria-owns":a?"simple-menu":null,"aria-haspopup":"true",className:"header-right-button","aria-label":"Menu",onClick:this.handleMenuOpen},s.a.createElement(Ws,null)),s.a.createElement(ws.a,{id:"main-menu",anchorEl:a,open:Boolean(a),onClose:this.handleMenuClose,getContentAnchorEl:null,disableAutoFocusItem:!0,disableRestoreFocus:!0,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"}},s.a.createElement(it.a,{onClick:this.handleLogOut},s.a.createElement(ja.a,null,s.a.createElement(Hs,null)),s.a.createElement(Ra.a,{primary:e("LogOut")}))),s.a.createElement(M.a,{transitionDuration:0,open:n,onClose:this.handleClose,"aria-labelledby":"form-dialog-title"},s.a.createElement(O.a,{id:"form-dialog-title"},e("Confirm")),s.a.createElement(_.a,null,s.a.createElement(x.a,{style:{whiteSpace:"pre-wrap"}},e("AreYouSureLogout"))),s.a.createElement(I.a,null,s.a.createElement(w.a,{onClick:this.handleClose,color:"primary"},e("Cancel")),s.a.createElement(w.a,{onClick:this.handleDone,color:"primary"},e("Ok")))))}}var Ks=Object(p.c)()(Gs),Zs=Object(Je.a)(s.a.createElement("path",{d:"M13,20 C13.5522847,20 14,20.4477153 14,21 C14,21.5522847 13.5522847,22 13,22 L13,22 L11,22 C10.4477153,22 10,21.5522847 10,21 C10,20.4477153 10.4477153,20 11,20 L11,20 Z M12,2 C15.8659932,2 19,5.13400675 19,9 L19,14.6972244 L20.8320503,17.4452998 C21.2750868,18.1098545 20.7986954,19 20,19 L4,19 C3.20130462,19 2.72491322,18.1098545 3.16794971,17.4452998 L5,14.6972244 L5,9 C5,5.13400675 8.13400675,2 12,2 Z M12,4 C9.23857625,4 7,6.23857625 7,9 L7,14.6972244 C7,15.0920743 6.88312395,15.4780897 6.66410059,15.8066248 L5.86851709,17 L18.1314829,17 L17.3358994,15.8066248 C17.1168761,15.4780897 17,15.0920743 17,14.6972244 L17,9 C17,6.23857625 14.7614237,4 12,4 Z"}),"Unmute"),qs=Object(Je.a)(s.a.createElement("path",{d:"M12,1 C14.6887547,1 16.8818181,3.12230671 16.9953805,5.78311038 L17,6 L17,8 C18.6568542,8 20,9.34314575 20,11 L20,19 C20,20.6568542 18.6568542,22 17,22 L7,22 C5.34314575,22 4,20.6568542 4,19 L4,11 C4,9.34314575 5.34314575,8 7,8 L7,6 C7,3.23857625 9.23857625,1 12,1 Z M17,10 L7,10 C6.44771525,10 6,10.4477153 6,11 L6,19 C6,19.5522847 6.44771525,20 7,20 L17,20 C17.5522847,20 18,19.5522847 18,19 L18,11 C18,10.4477153 17.5522847,10 17,10 Z M12,13.5 C12.8284271,13.5 13.5,14.1715729 13.5,15 C13.5,15.8284271 12.8284271,16.5 12,16.5 C11.1715729,16.5 10.5,15.8284271 10.5,15 C10.5,14.1715729 11.1715729,13.5 12,13.5 Z M12.1762728,3.00509269 L12,3 C10.4023191,3 9.09633912,4.24891996 9.00509269,5.82372721 L9,6 L9,8 L15,8 L15,6 C15,4.40231912 13.75108,3.09633912 12.1762728,3.00509269 L12,3 L12.1762728,3.00509269 Z"}),"Data"),Ys=Object(Je.a)(s.a.createElement("path",{d:"M12.4100787,14.6155108 L10.33,12.56 L10.33,12.56 L10.36,12.53 C12.1,10.59 13.34,8.36 14.07,6 L16,6 C16.5522847,6 17,5.55228475 17,5 C17,4.44771525 16.5522847,4 16,4 L10,4 L10,4 L10,3 C10,2.44771525 9.55228475,2 9,2 C8.44771525,2 8,2.44771525 8,3 L8,4 L8,4 L1.995,4 C1.44547667,4 1,4.44547667 1,4.995 C1,5.54452333 1.44547667,5.99 1.995,5.99 L12.17,5.99 L12.17,5.99 C11.5,7.92 10.44,9.75 9,11.35 C8.29025814,10.5639418 7.67370319,9.7196418 7.15033516,8.83487918 C7.09974701,8.74935905 7.03930045,8.64304956 6.96899548,8.51595071 C6.79288115,8.1975972 6.45776707,8 6.09394677,8 L5.69,8 C5.34408921,8 5.06367311,8.2804161 5.06367311,8.62632689 C5.06367311,8.72554854 5.08724633,8.82335055 5.13246346,8.91167013 C5.1653189,8.97586688 5.19575217,9.03408878 5.22376326,9.08633583 C5.88285067,10.3156835 6.70136504,11.4828779 7.67,12.56 L3.29489879,16.8749328 C2.90279535,17.2616439 2.89842396,17.8929978 3.28513501,18.2851012 C3.28675102,18.2867397 3.28837269,18.2883727 3.29,18.29 L3.29289322,18.2928932 C3.68341751,18.6834175 4.31658249,18.6834175 4.70710678,18.2928932 L9,14 L9,14 L11.3403247,16.3403247 C11.6133932,16.6133932 12.0561246,16.6133932 12.3291931,16.3403247 C12.4001325,16.2693853 12.4549762,16.1840114 12.49,16.09 L12.6442671,15.6759147 C12.7816472,15.3071575 12.6899849,14.8921111 12.4100787,14.6155108 Z M17.8069995,10 L17.1930005,10 C16.7761559,10 16.4030352,10.2585728 16.2566713,10.6488766 L12.3511234,21.0636708 C12.2167367,21.4220355 12.3983067,21.8214894 12.7566713,21.9558761 C12.8344793,21.9850541 12.916901,22 13,22 L13.3059169,22 C13.7232965,22 14.0967782,21.7407727 14.2427584,21.3497542 L15.12,19 L15.12,19 L19.87,19 L20.7561047,21.3524905 C20.9028501,21.74208 21.2756099,22 21.6919201,22 L22,22 C22.3827336,22 22.6930005,21.6897331 22.6930005,21.3069995 C22.6930005,21.2239005 22.6780546,21.1414789 22.6488766,21.0636708 L18.7433287,10.6488766 C18.5969648,10.2585728 18.2238441,10 17.8069995,10 Z M17.5,12.67 L19.12,17 L15.88,17 L17.5,12.67 Z"}),"Language"),Js=a(549),Qs=a(544),Xs=a(495),$s=a(174),ei=a.n($s),ti=a(175),ai=a.n(ti),ni=a(178),si=a.n(ni),ii=a(151),oi=a.n(ii),ri=a(173),ci=a.n(ri),li=a(199),di=a.n(li);a(424);class hi extends s.a.Component{constructor(e){super(e),this.handleChange=e=>{this.setState({type:e.target.value}),v.a.emit("clientUpdateThemeChanging",{type:e.target.value,primary:this.getColor(this.state.color)})},this.handleAccentChange=e=>{this.setState({color:e.target.value}),v.a.emit("clientUpdateThemeChanging",{type:this.state.type,primary:this.getColor(e.target.value)})},this.getColorString=e=>{switch(e){case ei.a[500]:return"red";case ai.a[500]:return"orange";case si.a[500]:return"amber";case oi.a[500]:return"green";case"#50A2E9":return"blue";case ci.a[500]:return"indigo";case di.a[500]:return"deepPurple"}return null},this.getColor=e=>{switch(e){case"red":return ei.a;case"orange":return ai.a;case"amber":return si.a;case"green":return oi.a;case"blue":return{main:"#50A2E9"};case"indigo":return ci.a;case"deepPurple":return di.a}return null},this.handleClose=()=>{this.setState({open:!1})},this.open=()=>{this.setState({open:!0})},this.state={open:!1,type:this.props.theme.palette.type,color:this.getColorString(this.props.theme.palette.primary.main)}}render(){const e=this.props.t,t=this.state,a=t.type,n=t.color,i=t.open;return s.a.createElement(M.a,{transitionDuration:0,open:i,onClose:this.handleClose,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},s.a.createElement(O.a,{id:"alert-dialog-title"},e("Appearance")),s.a.createElement(_.a,null,s.a.createElement(Se.a,{component:"fieldset",className:"theme-picker-form"},s.a.createElement(Xs.a,{focused:!0,component:"legend"},e("Theme")),s.a.createElement(Qs.a,{"aria-label":"theme",name:"theme1",className:"theme-picker-group",value:a,onChange:this.handleChange},s.a.createElement(Un.a,{value:"light",control:s.a.createElement(Js.a,{color:"primary"}),label:"Light"}),s.a.createElement(Un.a,{value:"dark",control:s.a.createElement(Js.a,{color:"primary"}),label:"Dark"}))),s.a.createElement(Se.a,{component:"fieldset",className:"theme-picker-form"},s.a.createElement(Xs.a,{focused:!0,component:"legend"},e("Accent")),s.a.createElement(Qs.a,{"aria-label":"accent",name:"accent1",className:"theme-picker-group",value:n,onChange:this.handleAccentChange},s.a.createElement(Un.a,{value:"red",control:s.a.createElement(Js.a,{color:"primary",classes:{root:"theme-picker-red"}}),label:"Red"}),s.a.createElement(Un.a,{value:"orange",control:s.a.createElement(Js.a,{color:"primary",classes:{root:"theme-picker-orange"}}),label:"Orange"}),s.a.createElement(Un.a,{value:"amber",control:s.a.createElement(Js.a,{color:"primary",classes:{root:"theme-picker-amber"}}),label:"Amber"}),s.a.createElement(Un.a,{value:"green",control:s.a.createElement(Js.a,{color:"primary",classes:{root:"theme-picker-green"}}),label:"Green"}),s.a.createElement(Un.a,{value:"blue",control:s.a.createElement(Js.a,{color:"primary",classes:{root:"theme-picker-blue"}}),label:"Blue"}),s.a.createElement(Un.a,{value:"indigo",control:s.a.createElement(Js.a,{color:"primary",classes:{root:"theme-picker-indigo"}}),label:"Indigo"}),s.a.createElement(Un.a,{value:"deepPurple",control:s.a.createElement(Js.a,{color:"primary",classes:{root:"theme-picker-deep-purple"}}),label:"Deep Purple"})))))}}var ui=Object(u.a)(Object(u.d)(),k.a,Object(p.c)(),Object(u.c)())(hi);a(425);class pi extends s.a.Component{constructor(e){super(e),this.handleAppearance=()=>{this.themePickerRef.current.open()},this.handleOpenViewer=()=>{const e=this.props.chatId,t=gt.a.get(e);t&&t.photo&&Object(nt.q)({chatId:e})},this.themePickerRef=s.a.createRef()}render(){const e=this.props,t=e.chatId,a=e.t,n=e.onClose,i=e.onEditProfile,o=e.onGeneral,r=e.onNotifications,c=e.onPrivacySecurity,l=e.onLanguage,d=gt.a.get(t);if(!d)return null;const h=d.photo;return s.a.createElement("div",{className:"settings-page"},s.a.createElement("div",{className:"header-master"},s.a.createElement(J.a,{className:"header-left-button",onClick:n},s.a.createElement(qa,null)),s.a.createElement("div",{className:"header-status grow cursor-pointer"},s.a.createElement("span",{className:"header-status-content"},a("Settings"))),s.a.createElement(Ks,null)),s.a.createElement("div",{className:"settings-page-content"},s.a.createElement("div",{className:"chat-details-info"},s.a.createElement(Za,{chatId:t,big:!0,showStatus:!0,showSavedMessages:!1,onTileSelect:h?this.handleOpenViewer:null})),s.a.createElement(La.a,{className:"settings-list-item",button:!0,onClick:i},s.a.createElement(ja.a,null,s.a.createElement(zs,null)),s.a.createElement(Ra.a,{primary:a("EditProfile")})),s.a.createElement(La.a,{className:"settings-list-item",button:!0,onClick:o},s.a.createElement(ja.a,null,s.a.createElement(xs,null)),s.a.createElement(Ra.a,{primary:a("GeneralSettings")})),s.a.createElement(La.a,{className:"settings-list-item",button:!0,onClick:r},s.a.createElement(ja.a,null,s.a.createElement(Zs,null)),s.a.createElement(Ra.a,{primary:a("Notifications")})),s.a.createElement(La.a,{className:"settings-list-item",button:!0,onClick:c},s.a.createElement(ja.a,null,s.a.createElement(qs,null)),s.a.createElement(Ra.a,{primary:a("PrivacySettings")})),s.a.createElement(La.a,{autoFocus:!1,className:"settings-list-item",button:!0,onClick:l},s.a.createElement(ja.a,null,s.a.createElement(Ys,null)),s.a.createElement(Ra.a,{primary:a("Language")})),s.a.createElement(La.a,{autoFocus:!1,className:"settings-list-item",button:!0,onClick:this.handleAppearance},s.a.createElement(ja.a,null,s.a.createElement(Ba,null)),s.a.createElement(Ra.a,{primary:a("Appearance")})),s.a.createElement(ui,{ref:this.themePickerRef})))}}var mi=Object(p.c)()(pi);a(426);class gi extends s.a.Component{render(){const e=this.props,t=e.t,a=e.onClose;return s.a.createElement("div",{className:"settings-page"},s.a.createElement("div",{className:"header-master"},s.a.createElement(J.a,{className:"header-left-button",onClick:a},s.a.createElement(qa,null)),s.a.createElement("div",{className:"header-status grow cursor-pointer"},s.a.createElement("span",{className:"header-status-content"},t("GeneralSettings")))),s.a.createElement("div",{className:"settings-page-content"}))}}var fi=Object(u.a)(Object(u.d)(),Object(p.c)(),Object(u.c)())(gi),bi=Object(Je.a)(s.a.createElement("g",{transform:"translate(-1.000000, -1.000000)",fillRule:"nonzero"},s.a.createElement("path",{d:"M12,1 C18.0751322,1 23,5.92486775 23,12 C23,18.0751322 18.0751322,23 12,23 C5.92486775,23 1,18.0751322 1,12 C1,5.92486775 5.92486775,1 12,1 Z M12,3 C7.02943725,3 3,7.02943725 3,12 C3,16.9705627 7.02943725,21 12,21 C16.9705627,21 21,16.9705627 21,12 C21,7.02943725 16.9705627,3 12,3 Z M8,11 L16,11 C16.5522847,11 17,11.4477153 17,12 C17,12.5128358 16.6139598,12.9355072 16.1166211,12.9932723 L16,13 L8,13 C7.44771525,13 7,12.5522847 7,12 C7,11.4871642 7.38604019,11.0644928 7.88337887,11.0067277 L8,11 L16,11 L8,11 Z"})),"Stop");a(427);class Ci extends s.a.Component{constructor(...e){super(...e),this.state={contextMenu:!1,left:0,top:0},this.handleContextMenu=e=>{e&&(e.preventDefault(),e.stopPropagation());const t=this.props.session;if(t&&!t.is_current)if(this.state.contextMenu)this.setState({contextMenu:!1});else{const t=e.clientX,a=e.clientY;this.setState({contextMenu:!0,left:t,top:a})}},this.handleCloseContextMenu=e=>{this.setState({contextMenu:!1,left:0,top:0})},this.handleTerminate=e=>{this.handleCloseContextMenu(e);const t=this.props;(0,t.onTerminate)(t.session)}}render(){const e=this.props,t=e.session,a=e.t;if(!t)return null;const n=this.state,i=n.left,o=n.top,r=n.contextMenu,c=t.is_current,l=t.application_name,d=t.application_version,h=t.device_model,u=t.platform,p=t.system_version,m=t.ip,g=t.region,f=t.country,b=t.last_active_date,C=!c;return s.a.createElement(s.a.Fragment,null,s.a.createElement(La.a,{className:"settings-list-item",button:!0,onContextMenu:this.handleContextMenu},s.a.createElement("div",{className:"session"},s.a.createElement("div",{className:"session-title"},s.a.createElement("div",{className:"session-app"},"".concat(l," ").concat(d)),C&&s.a.createElement("div",{className:"session-date"},Object(Ze.D)({date:b}))),s.a.createElement("div",{className:"session-subtitle1"},"".concat(h,", ").concat(u," ").concat(p)),s.a.createElement("div",{className:"session-subtitle2"},"".concat(m," - "),g&&"".concat(g,", "),f&&"".concat(f)))),s.a.createElement(rt.a,{open:r,onClose:this.handleCloseContextMenu,anchorReference:"anchorPosition",anchorPosition:{top:o,left:i},anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"},onMouseDown:e=>e.stopPropagation()},s.a.createElement(ot.a,{onClick:e=>e.stopPropagation()},s.a.createElement(it.a,{onClick:this.handleTerminate},s.a.createElement(ja.a,null,s.a.createElement(bi,null)),s.a.createElement(Ra.a,{primary:a("Terminate")})))))}}var yi=Object(p.c)()(Ci);a(428);class vi extends s.a.Component{constructor(...e){var t;super(...e),t=this,this.state={open:!1,openAll:!1,session:null},this.handleTerminate=e=>{this.setState({open:!0,session:e})},this.handleTerminateAllOther=()=>{this.setState({openAll:!0})},this.handleCloseConfirmation=()=>{this.setState({open:!1,session:null})},this.handleDoneConfirmation=Object(h.a)(d.a.mark((function e(){var a,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.props.sessions,n=t.state.session){e.next=4;break}return e.abrupt("return");case 4:return t.setState({open:!1,session:null}),e.next=7,V.a.send({"@type":"terminateSession",session_id:n.id});case 7:a.sessions=a.sessions.filter(e=>e.id!==n.id),t.forceUpdate();case 9:case"end":return e.stop()}}),e)}))),this.handleCloseAllConfirmation=()=>{this.setState({openAll:!1})},this.handleDoneAllConfirmation=Object(h.a)(d.a.mark((function e(){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.props.sessions,t.setState({openAll:!1}),e.next=4,V.a.send({"@type":"terminateAllOtherSessions"});case 4:a.sessions=a.sessions.filter(e=>!e.is_current),t.forceUpdate();case 6:case"end":return e.stop()}}),e)})))}render(){const e=this.props,t=e.t,a=e.sessions,n=e.onClose,i=this.state,o=i.open,r=i.openAll,c=a.sessions.find(e=>e.is_current),l=a.sessions.filter(e=>!e.is_current);return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"settings-page"},s.a.createElement("div",{className:"header-master"},s.a.createElement(J.a,{className:"header-left-button",onClick:n},s.a.createElement(qa,null)),s.a.createElement("div",{className:"header-status grow cursor-pointer"},s.a.createElement("span",{className:"header-status-content"},t("SessionsTitle")))),s.a.createElement("div",{className:"settings-page-content"},Boolean(c)&&s.a.createElement("div",{className:"settings-section"},s.a.createElement("div",{className:"settings-section-header"},t("CurrentSession")),s.a.createElement(yi,{session:c,onTerminate:this.handleTerminate}),l.length>0&&s.a.createElement(La.a,{className:"settings-list-item",button:!0,disableRipple:!0,onClick:this.handleTerminateAllOther},s.a.createElement(ja.a,null,s.a.createElement(bi,{color:"secondary"})),s.a.createElement(Ra.a,{primaryTypographyProps:{color:"secondary"},primary:t("TerminateAllSessions")}))),l.length>0&&s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"settings-border"}),s.a.createElement("div",{className:"settings-section"},s.a.createElement("div",{className:"settings-section-header"},t("OtherSessions")),l.map(e=>s.a.createElement(yi,{key:e.id,session:e,onTerminate:this.handleTerminate})))))),s.a.createElement(M.a,{transitionDuration:0,open:o,onClose:this.handleCloseConfirmation,"aria-labelledby":"form-dialog-title"},s.a.createElement(O.a,{id:"form-dialog-title"},t("Confirm")),s.a.createElement(_.a,null,s.a.createElement(x.a,{style:{whiteSpace:"pre-wrap"}},t("TerminateSessionText"))),s.a.createElement(I.a,null,s.a.createElement(w.a,{onClick:this.handleCloseConfirmation,color:"primary"},t("Cancel")),s.a.createElement(w.a,{onClick:this.handleDoneConfirmation,color:"primary"},t("Ok")))),s.a.createElement(M.a,{transitionDuration:0,open:r,onClose:this.handleCloseAllConfirmation,"aria-labelledby":"form-dialog-title"},s.a.createElement(O.a,{id:"form-dialog-title"},t("Confirm")),s.a.createElement(_.a,null,s.a.createElement(x.a,{style:{whiteSpace:"pre-wrap"}},t("AreYouSureSessions"))),s.a.createElement(I.a,null,s.a.createElement(w.a,{onClick:this.handleCloseAllConfirmation,color:"primary"},t("Cancel")),s.a.createElement(w.a,{onClick:this.handleDoneAllConfirmation,color:"primary"},t("Ok")))))}}var Ei=Object(u.a)(Object(u.d)(),Object(p.c)(),Object(u.c)())(vi),Si=Object(Je.a)(s.a.createElement("g",{transform:"translate(0.000000, -2.000000)",fillRule:"nonzero"},s.a.createElement("path",{d:"M18,2 C20.209139,2 22,3.790861 22,6 L22,6 L22,8 C22,8.55228475 21.5522847,9 21,9 C20.4477153,9 20,8.55228475 20,8 L20,8 L20,6 C20,4.8954305 19.1045695,4 18,4 L18,4 L4,4 C2.8954305,4 2,4.8954305 2,6 L2,6 L2,14 C2,15.1045695 2.8954305,16 4,16 L4,16 L14,16 C14.5522847,16 15,16.4477153 15,17 C15,17.5522847 14.5522847,18 14,18 L14,18 L12,18 L12,20 L14,20 C14.5128358,20 14.9355072,20.3860402 14.9932723,20.8833789 L15,21 C15,21.5522847 14.5522847,22 14,22 L14,22 L8,22 C7.44771525,22 7,21.5522847 7,21 C7,20.4477153 7.44771525,20 8,20 L8,20 L10,20 L10,18 L4,18 C1.85780461,18 0.108921124,16.3160315 0.00489530723,14.1996403 L0,14 L0,6 C0,3.790861 1.790861,2 4,2 L4,2 Z M22,11 C23.1045695,11 24,11.8954305 24,13 L24,20 C24,21.1045695 23.1045695,22 22,22 L19,22 C17.8954305,22 17,21.1045695 17,20 L17,13 C17,11.8954305 17.8954305,11 19,11 L22,11 Z M22,13 L19,13 L19,20 L22,20 L22,13 Z"})),"Device"),Ui=Object(Je.a)(s.a.createElement("g",{transform:"translate(-1.000000, -3.000000)",fillRule:"nonzero"},s.a.createElement("path",{d:"M9,13 C12.3229116,13 14.7530244,13.8337117 16.2223821,15.5699359 C16.724477,16.1632234 17,16.915291 17,17.6925226 L17,18.5 C17,19.8807119 15.8807119,21 14.5,21 L3.5,21 C2.11928813,21 1,19.8807119 1,18.5 L1,17.6925204 C1,16.9152876 1.2755246,16.1632192 1.77762117,15.569932 C3.24697824,13.8337108 5.67709024,13 9,13 Z M9,15 C6.21130036,15 4.33538166,15.6435809 3.30428673,16.861943 C3.10781409,17.0940989 3,17.3883868 3,17.6925212 L3,18.5 C3,18.7761424 3.22385763,19 3.5,19 L14.5,19 C14.7761424,19 15,18.7761424 15,18.5 L15,17.6925226 C15,17.3883883 14.8921864,17.0941004 14.6957148,16.8619448 C13.6646202,15.6435815 11.788701,15 9,15 Z M16,10 L22,10 C22.5522847,10 23,10.4477153 23,11 C23,11.5128358 22.6139598,11.9355072 22.1166211,11.9932723 L22,12 L16,12 C15.4477153,12 15,11.5522847 15,11 C15,10.4871642 15.3860402,10.0644928 15.8833789,10.0067277 L16,10 L22,10 L16,10 Z M9,3 C11.209139,3 13,4.790861 13,7 C13,9.209139 11.209139,11 9,11 C6.790861,11 5,9.209139 5,7 C5,4.790861 6.790861,3 9,3 Z M9,5 C7.8954305,5 7,5.8954305 7,7 C7,8.1045695 7.8954305,9 9,9 C10.1045695,9 11,8.1045695 11,7 C11,5.8954305 10.1045695,5 9,5 Z"})),"RemoveMember");a(429);class ki extends s.a.Component{constructor(...e){super(...e),this.state={sessions:null,users:null},this.handleBlockedUsers=()=>{const e=this.state.users;e&&V.a.clientUpdate({"@type":"clientUpdateBlockedUsersPage",opened:!0,users:e})},this.openActiveSessions=()=>{this.state.sessions&&this.setState({openActiveSessions:!0})},this.closeActiveSessions=()=>{this.setState({openActiveSessions:!1})}}componentDidMount(){this.loadContent()}loadContent(){var e=this;return Object(h.a)(d.a.mark((function t(){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:V.a.send({"@type":"getActiveSessions"}).then(t=>e.setState({sessions:t})),V.a.send({"@type":"getBlockedUsers",offset:0,limit:100}).then(t=>e.setState({users:t}));case 2:case"end":return t.stop()}}),t)})))()}render(){const e=this.props,t=e.t,a=e.onClose,n=this.state,i=n.users,o=n.openActiveSessions,r=n.sessions,c=r&&r.sessions.length>0?1===r.sessions.length?"1 session":"".concat(r.sessions.length," sessions"):"1 session",l=i&&i.total_count>0?1===i.total_count?"1 user":"".concat(i.total_count," users"):"no users";return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"settings-page"},s.a.createElement("div",{className:"header-master"},s.a.createElement(J.a,{className:"header-left-button",onClick:a},s.a.createElement(qa,null)),s.a.createElement("div",{className:"header-status grow cursor-pointer"},s.a.createElement("span",{className:"header-status-content"},t("PrivacySettings")))),s.a.createElement("div",{className:"settings-page-content"},s.a.createElement("div",{className:"settings-section"},s.a.createElement(La.a,{className:"settings-list-item2",role:void 0,button:!0,onClick:this.handleBlockedUsers},s.a.createElement(ja.a,{className:"settings-list-item-icon"},s.a.createElement(Ui,null)),s.a.createElement(Ra.a,{id:"label-2",className:"settings-list-item-text",primary:t("BlockedUsers"),secondary:l})),s.a.createElement(La.a,{className:"settings-list-item2",role:void 0,button:!0,onClick:this.openActiveSessions},s.a.createElement(ja.a,{className:"settings-list-item-icon"},s.a.createElement(Si,null)),s.a.createElement(Ra.a,{id:"label-2",className:"settings-list-item-text",primary:t("SessionsTitle"),secondary:c}))),s.a.createElement("div",{className:"settings-border"}),s.a.createElement("div",{className:"settings-section"},s.a.createElement("div",{className:"settings-section-header"},t("PrivacyTitle")),s.a.createElement(La.a,{className:"settings-list-item2",role:void 0,button:!0},s.a.createElement(Ra.a,{className:"settings-list-item-text2",primary:t("PrivacyPhoneTitle"),secondary:t("LastSeenContacts")})),s.a.createElement(La.a,{className:"settings-list-item2",role:void 0,button:!0},s.a.createElement(Ra.a,{className:"settings-list-item-text2",primary:t("LastSeenTitle"),secondary:t("LastSeenEverybody")})),s.a.createElement(La.a,{className:"settings-list-item2",role:void 0,button:!0},s.a.createElement(Ra.a,{className:"settings-list-item-text2",primary:t("PrivacyProfilePhotoTitle"),secondary:t("LastSeenEverybody")})),s.a.createElement(La.a,{className:"settings-list-item2",role:void 0,button:!0},s.a.createElement(Ra.a,{className:"settings-list-item-text2",primary:t("PrivacyForwardsTitle"),secondary:t("LastSeenEverybody")})),s.a.createElement(La.a,{className:"settings-list-item2",role:void 0,button:!0},s.a.createElement(Ra.a,{className:"settings-list-item-text2",primary:t("WhoCanAddMe"),secondary:t("LastSeenEverybody")}))))),s.a.createElement(Vs.a,{direction:"right",in:o,mountOnEnter:!0,unmountOnExit:!0},s.a.createElement(Ei,{sessions:r,onClose:this.closeActiveSessions})))}}var wi=Object(u.a)(Object(u.d)(),Object(p.c)(),Object(u.c)())(ki);a(430);class Mi extends s.a.Component{constructor(e){super(e),this.handleChange=e=>{this.setState({language:e}),V.a.clientUpdate({"@type":"clientUpdateLanguageChange",language:e})};const t=e.i18n,a=t?t.language:null;this.state={language:a||"en"}}render(){const e=this.props,t=e.t,a=e.onClose,n=this.state.language,i=(m.a.info||{language_packs:[]}).language_packs.map(e=>s.a.createElement("div",{className:"settings-item",onClick:()=>this.handleChange(e.id)},s.a.createElement(Js.a,{color:"primary",className:"settings-item-control",checked:n===e.id,tabIndex:-1,inputProps:{"aria-labelledby":"label-2"}}),s.a.createElement(Ra.a,{id:"label-2",primary:e.name,secondary:e.native_name})));return s.a.createElement("div",{className:"settings-page"},s.a.createElement("div",{className:"header-master"},s.a.createElement(J.a,{className:"header-left-button",onClick:a},s.a.createElement(qa,null)),s.a.createElement("div",{className:"header-status grow cursor-pointer"},s.a.createElement("span",{className:"header-status-content"},t("Language")))),s.a.createElement("div",{className:"settings-page-content"},i))}}var Ii=Object(u.a)(Object(u.d)(),Object(p.c)(),Object(u.c)())(Mi);a(431);class _i extends s.a.Component{constructor(e){super(e),this.openEditProfile=()=>{this.setState({openEditProfile:!0})},this.closeEditProfile=()=>{this.setState({openEditProfile:!1})},this.openGeneral=()=>{this.setState({openGeneral:!0})},this.closeGeneral=()=>{this.setState({openGeneral:!1})},this.openNotifications=()=>{this.setState({openNotifications:!0})},this.closeNotifications=()=>{this.setState({openNotifications:!1})},this.openPrivacySecurity=()=>{this.setState({openPrivacySecurity:!0})},this.closePrivacySecurity=()=>{this.setState({openPrivacySecurity:!1})},this.openLanguage=()=>{this.setState({openLanguage:!0})},this.closeLanguage=()=>{this.setState({openLanguage:!1})},this.handleCloseSettings=()=>{V.a.clientUpdate({"@type":"clientUpdateCloseSettings"})},this.state={openEditProfile:!1,openGeneral:!1,openNotifications:!1,openPrivacy:!1,openLanguage:!1}}componentDidMount(){this.loadContent()}loadContent(){var e=this;return Object(h.a)(d.a.mark((function t(){var a,n,s;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.props.chatId,n=ft.a.getStore(),Object(mt.p)(n,[a]),t.next=5,V.a.send({"@type":"getUserFullInfo",user_id:ht.a.getMyId()});case 5:s=t.sent,ht.a.setFullInfo(ht.a.getMyId(),s);case 7:case"end":return t.stop()}}),t)})))()}render(){const e=this.props.chatId,t=this.state,a=t.openEditProfile,n=t.openGeneral,i=t.openNotifications,o=t.openPrivacySecurity,r=t.openLanguage;return s.a.createElement("div",{className:"settings"},s.a.createElement("div",{className:"settings-content"},s.a.createElement(mi,{chatId:e,onClose:this.handleCloseSettings,onEditProfile:this.openEditProfile,onGeneral:this.openGeneral,onNotifications:this.openNotifications,onPrivacySecurity:this.openPrivacySecurity,onLanguage:this.openLanguage}),s.a.createElement(Vs.a,{direction:"right",in:a,mountOnEnter:!0,unmountOnExit:!0},s.a.createElement(As,{chatId:e,onClose:this.closeEditProfile})),s.a.createElement(Vs.a,{direction:"right",in:n,mountOnEnter:!0,unmountOnExit:!0},s.a.createElement(fi,{chatId:e,onClose:this.closeGeneral})),s.a.createElement(Vs.a,{direction:"right",in:i,mountOnEnter:!0,unmountOnExit:!0},s.a.createElement(Bs,{chatId:e,onClose:this.closeNotifications})),s.a.createElement(Vs.a,{direction:"right",in:o,mountOnEnter:!0,unmountOnExit:!0},s.a.createElement(wi,{onClose:this.closePrivacySecurity})),s.a.createElement(Vs.a,{direction:"right",in:r,mountOnEnter:!0,unmountOnExit:!0},s.a.createElement(Ii,{onClose:this.closeLanguage}))))}}var xi=Object(u.a)(Object(u.d)(),Object(p.c)(),Object(u.c)())(_i);var Oi=new class{load(e){return Object(h.a)(d.a.mark((function t(){var a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=localStorage.getItem(e)){t.next=3;break}return t.abrupt("return",null);case 3:return t.prev=3,t.abrupt("return",JSON.parse(a));case 7:return t.prev=7,t.t0=t.catch(3),t.abrupt("return",null);case 10:case"end":return t.stop()}}),t,null,[[3,7]])})))()}save(e,t){return Object(h.a)(d.a.mark((function a(){return d.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:localStorage.setItem(e,JSON.stringify(t));case 1:case"end":return a.stop()}}),a)})))()}remove(e){return Object(h.a)(d.a.mark((function t(){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:localStorage.removeItem(e);case 1:case"end":return t.stop()}}),t)})))()}clear(){return Object(h.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:localStorage.clear();case 1:case"end":return e.stop()}}),e)})))()}};class Pi extends F.a{constructor(){super(),this.reset=()=>{this.chatIds=[],this.cache=null,this.contacts=null},this.onUpdate=e=>{switch(e["@type"]){case"updateAuthorizationState":{const t=e.authorization_state;if(!t)break;switch(t["@type"]){case"authorizationStateClosed":this.reset();break;case"authorizationStateLoggingOut":case"authorizationStateWaitCode":case"authorizationStateWaitPhoneNumber":case"authorizationStateWaitPassword":case"authorizationStateWaitRegistration":Oi.remove("cache"),Oi.remove("files"),Oi.remove("contacts")}break}}},this.onClientUpdate=e=>{switch(e["@type"]){case"clientUpdateDialogsReady":this.clear()}},this.addTdLibListener=()=>{V.a.on("update",this.onUpdate),V.a.on("clientUpdate",this.onClientUpdate)},this.removeTdLibListener=()=>{V.a.off("update",this.onUpdate),V.a.off("clientUpdate",this.onClientUpdate)},this.reset(),this.addTdLibListener(),this.saveChatsInternal=Object(ze.c)(this.saveChatsInternal,2e3)}loadCache(){var e=this;return Object(h.a)(d.a.mark((function t(){var a,n,s,i,o;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(a=[]).push(Oi.load("cache").catch(e=>null)),a.push(Oi.load("files").catch(e=>null)),t.next=5,Promise.all(a);case 5:if(n=t.sent,s=Object(T.a)(n,2),i=s[0],o=s[1],e.cache=i,e.cache&&(e.cache.files=o||[]),e.cache){t.next=13;break}return t.abrupt("return",null);case 13:return e.parseCache(e.cache),t.abrupt("return",e.cache);case 15:case"end":return t.stop()}}),t)})))()}parseCache(e){if(!e)return;const t=e.chats,a=e.archiveChats,n=e.users,s=e.basicGroups,i=e.supergroups,o=e.files,r=e.options;(o||[]).forEach(({id:e,url:t})=>{ft.a.setDataUrl(e,t)}),(n||[]).forEach(e=>{ht.a.set(e)}),(s||[]).forEach(e=>{Jt.a.set(e)}),(i||[]).forEach(e=>{Qt.a.set(e)}),(t||[]).concat(a||[]).forEach(e=>{delete e.OutputTypingManager,gt.a.set(e),e.photo&&(e.photo.small&&ft.a.set(e.photo.small),e.photo.big&&ft.a.set(e.photo.big)),e.chat_list&&gt.a.updateChatChatList(e.id,e.chat_list),e.last_message&&Nt.a.set(e.last_message)}),(r||[]).forEach(([e,t])=>{re.a.set(e,t)})}getCache(e,t){const a=new Map,n=new Map,s=new Map,i=new Map,o=e.map(e=>gt.a.get(e)),r=t.map(e=>gt.a.get(e));return o.concat(r).forEach(e=>{const t=e.photo,o=e.type,r=e.last_message;if(t&&t.small){const e=t.small.id;if(e){const t=ft.a.getBlob(e);t&&a.set(e,t)}}switch(o["@type"]){case"chatTypeBasicGroup":{const e=Jt.a.get(o.basic_group_id);e&&s.set(e.id,e)}case"chatTypePrivate":case"chatTypeSecret":{const e=ht.a.get(o.user_id);e&&n.set(e.id,e)}case"chatTypeSupergroup":{const e=Qt.a.get(o.supergroup_id);e&&i.set(e.id,e)}}if(r){const e=r.sender_user_id;if(e){const t=ht.a.get(e);t&&n.set(t.id,t)}}}),{chats:o,archiveChats:r,users:[...n.values()],basicGroups:[...s.values()],supergroups:[...i.values()],files:[...a.entries()],options:[...re.a.items.entries()]}}saveChats(e,t){this.chatIds=e,this.archiveChatIds=t,this.saveChatsInternal()}saveChatsInternal(){var e=this;return Object(h.a)(d.a.mark((function t(){var a,n,s,i;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.getCache(e.chatIds,e.archiveChatIds),n=a.files,a.files=[],t.next=5,Oi.save("cache",a);case 5:return s=[],n.forEach(e=>{const t=Object(T.a)(e,2),a=t[0],n=t[1];s.push(new Promise((e,t)=>{const s=new FileReader;s.readAsDataURL(n),s.onload=t=>{e({id:a,url:t.target.result})},s.onerror=t=>{e(null)}}))}),t.next=9,Promise.all(s);case 9:return i=t.sent,t.next=12,Oi.save("files",i);case 12:case"end":return t.stop()}}),t)})))()}clear(){if(this.cache){this.cache.files.forEach(({id:e,url:t})=>{ft.a.deleteDataUrl(e)})}}}const Ti=new Pi;window.cache=Ti;var Ni=Ti;a(432);class Di extends s.a.Component{shouldComponentUpdate(e,t,a){const n=this.props,s=n.userId,i=n.style;return e.userId!==s||e.style.top!==i.top}render(){const e=this.props,t=e.userId,a=e.onClick,n=e.style;return s.a.createElement(La.a,{className:"user-list-item",onClick:()=>a(t),button:!0,style:n},s.a.createElement(Ha.a,{userId:t}))}}class Li extends s.a.Component{constructor(e){var t;super(e),t=this,this.handleScroll=e=>{this.handleDebounceScroll(),this.handleThrottleScroll()},this.loadRenderIdsContent=()=>{const e=this.state,t=e.items,a=e.searchItems,n=a||t,s=(n===a?this.searchListRef:this.listRef).current;if(!s)return;const i=s.getListRenderIds();if(i.size>0){const e=[];[...i.keys()].forEach(t=>{e.push(n.user_ids[t])});const t=ft.a.getStore();Object(mt.A)(t,e)}},this.handleClose=()=>{V.a.clientUpdate({"@type":"clientUpdateCloseContacts"})},this.handleOpenUser=e=>{Object(nt.j)(e,!1),this.handleClose()},this.renderItem=({index:e,style:t},a)=>{const n=a.user_ids[e];return s.a.createElement(Di,{key:n,userId:n,onClick:()=>this.handleOpenUser(n),style:t})},this.handleSearch=function(){var e=Object(h.a)(d.a.mark((function e(a){var n,s,i;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.trim()){e.next=4;break}return t.setState({searchItems:null}),e.abrupt("return");case 4:return e.next=6,V.a.send({"@type":"searchContacts",query:n,limit:1e3});case 6:(s=e.sent).user_ids=s.user_ids.sort((e,t)=>Object(dt.c)(e).localeCompare(Object(dt.c)(t))),i=ft.a.getStore(),Object(mt.A)(i,s.user_ids.slice(0,20)),t.setState({searchItems:s});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.searchInputRef=s.a.createRef(),this.listRef=s.a.createRef(),this.searchListRef=s.a.createRef(),this.state={items:null,searchItems:null},this.handleDebounceScroll=Object(ze.c)(this.handleDebounceScroll,100,!1),this.handleThrottleScroll=Object(ze.x)(this.handleThrottleScroll,200,!1)}handleDebounceScroll(){this.loadRenderIdsContent()}handleThrottleScroll(){this.loadRenderIdsContent()}componentDidMount(){const e=this.searchInputRef.current;e&&setTimeout(()=>e.focus(),50),this.loadContent()}loadContent(){var e=this;return Object(h.a)(d.a.mark((function t(){var a,n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=Ni.contacts){t.next=7;break}return t.next=4,V.a.send({"@type":"getContacts"});case 4:(a=t.sent).user_ids=a.user_ids.sort((e,t)=>Object(dt.c)(e).localeCompare(Object(dt.c)(t))),Ni.contacts=a;case 7:n=ft.a.getStore(),Object(mt.A)(n,a.user_ids.slice(0,20)),e.setState({items:a});case 10:case"end":return t.stop()}}),t)})))()}render(){const e=this.state,t=e.items,a=e.searchItems;return s.a.createElement("div",{className:"contacts"},s.a.createElement("div",{className:"header-master"},s.a.createElement(J.a,{className:"header-left-button",onClick:this.handleClose},s.a.createElement(qa,null)),s.a.createElement(Ds,{inputRef:this.searchInputRef,onChange:this.handleSearch,onClose:this.handleClose})),s.a.createElement("div",{className:"contacts-content"},t&&s.a.createElement(Yt,{ref:this.listRef,className:"contacts-list",source:t.user_ids,rowHeight:72,overScanCount:20,renderItem:e=>this.renderItem(e,t),onScroll:this.handleScroll}),a&&s.a.createElement(Yt,{ref:this.searchListRef,className:"contacts-list contacts-search-list",source:a.user_ids,rowHeight:72,overScanCount:20,renderItem:e=>this.renderItem(e,a),onScroll:this.handleScroll})))}}var ji=Li;a(433);class Ri extends s.a.Component{constructor(e){super(e),this.onClientUpdateNewContentAvailable=()=>{this.setState({newContentAvailable:!0})},this.handleUpdate=()=>{this.handled||(this.handled=!0,setTimeout(()=>{window.location.reload()},250))},this.state={newContentAvailable:!1}}componentDidMount(){v.a.on("clientUpdateNewContentAvailable",this.onClientUpdateNewContentAvailable)}componentWillUnmount(){v.a.off("clientUpdateNewContentAvailable",this.onClientUpdateNewContentAvailable)}render(){const e=this.state.newContentAvailable,t=this.props.t;return e?s.a.createElement(w.a,{className:"update-button",variant:"contained",color:"primary",onClick:this.handleUpdate},t("Update")):null}}var Ai=Object(p.c)()(Ri);function Fi(){const e=gt.a.chatList.get("chatListArchive"),t=[],a=[];if(e){var n=!0,s=!1,i=void 0;try{for(var o,r=e.keys()[Symbol.iterator]();!(n=(o=r.next()).done);n=!0){const e=o.value,n=gt.a.get(e);n&&("0"!==n.order&&t.push(n),a.push({order:n.order,id:n.id,title:n.title}))}}catch(c){s=!0,i=c}finally{try{n||null==r.return||r.return()}finally{if(s)throw i}}}return t.sort((e,t)=>Object(ze.u)(t.order,e.order)).map(e=>e.title).join(", ")}class Bi extends n.Component{constructor(e){var t;super(e),t=this,this.onUpdateChatOrder=e=>{const t=e.chat_id,a=this.dialogListRef.current;if(a&&a.loading)return;const n=this.archiveListRef.current;if(n&&n.loading)return;const s=gt.a.chatList.get("chatListArchive");s&&s.has(t)&&this.setState({archiveTitle:Fi()})},this.onUpdateChatChatList=e=>{const t=this.state.showArchive,a=this.dialogListRef.current;if(a&&a.loading)return;const n=this.archiveListRef.current;if(n&&n.loading)return;const s=gt.a.chatList.get("chatListArchive"),i=s&&s.size>0;this.setState({showArchive:i,archiveTitle:Fi()},()=>{if(!t&&i){const e=this.dialogListRef.current;if(e.listRef){const t=e.listRef.current;t&&t.scrollTop>0&&(e.scrollTop+=68)}}}),t&&!i&&V.a.clientUpdate({"@type":"clientUpdateCloseArchive"})},this.onClientUpdateOpenContacts=function(){var e=Object(h.a)(d.a.mark((function e(a){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.setState({openContacts:!0});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.onClientUpdateCloseContacts=e=>{this.setState({openContacts:!1})},this.onClientUpdateOpenSettings=e=>{this.setState({openSettings:!0,meChatId:e.chatId})},this.onClientUpdateCloseSettings=e=>{this.setState({openSettings:!1})},this.onClientUpdateOpenArchive=e=>{this.setState({openArchive:!0})},this.onClientUpdateCloseArchive=e=>{this.setState({openArchive:!1})},this.onClientUpdateThemeChange=e=>{this.forceUpdate()},this.onClientUpdateChatDetailsVisibility=e=>{const t=v.a.isChatDetailsVisible;this.setState({isChatDetailsVisible:t})},this.onClientUpdateSearchChat=e=>{const t=e.chatId,a=e.query,n=this.state,s=n.openSearch,i=n.searchChatId,o=n.searchText;if(s&&t===i&&a===o)return;const r=this.dialogsHeaderRef.current;this.setState({openSearch:!0,searchChatId:t,searchText:null,openSettings:!1,openActiveSessions:!1,openContacts:!1},()=>{r&&r.setInitQuery(a)})},this.handleHeaderClick=()=>{this.state.openArchive?V.a.clientUpdate({"@type":"clientUpdateCloseArchive"}):this.dialogListRef.current.scrollToTop()},this.handleSearch=e=>{this.setState({openSearch:e,searchChatId:0,searchText:null})},this.handleSelectMessage=(e,t,a)=>{Object(nt.h)(e,t);const n=a?this.state.searchChatId:0,s=a?this.state.searchText:null;this.setState({openSearch:a,searchChatId:n,searchText:s})},this.handleClose=()=>{this.setState({openSearch:!1,searchChatId:0,searchText:null})},this.handleSearchTextChange=e=>{this.setState({searchText:e,query:null})},this.handleSaveCache=()=>{this.saveCache()},this.dialogListRef=s.a.createRef(),this.archiveListRef=s.a.createRef(),this.dialogsHeaderRef=s.a.createRef();const a=v.a.isChatDetailsVisible;this.state={cache:null,showArchive:!1,archiveTitle:null,mainItems:[],archiveItems:[],isChatDetailsVisible:a,openSearch:!1,openArchive:!1,searchChatId:0,searchText:null,query:null}}shouldComponentUpdate(e,t){const a=this.state,n=a.cache,s=a.showArchive,i=a.archiveTitle,o=a.mainItems,r=a.archiveItems,c=a.isChatDetailsVisible,l=a.openSearch,d=a.openArchive,h=a.openSettings,u=a.openContacts,p=a.searchChatId,m=a.searchText;return t.cache!==n||(t.showArchive!==s||(t.archiveTitle!==i||(t.archiveItems!==r||(t.mainItems!==o||(t.isChatDetailsVisible!==c||(t.openSearch!==l||(t.openArchive!==d||(t.openSettings!==h||(t.openContacts!==u||(t.searchChatId!==p||t.searchText!==m))))))))))}componentDidMount(){this.loadCache(),v.a.on("clientUpdateChatDetailsVisibility",this.onClientUpdateChatDetailsVisibility),v.a.on("clientUpdateSearchChat",this.onClientUpdateSearchChat),v.a.on("clientUpdateThemeChange",this.onClientUpdateThemeChange),gt.a.on("updateChatChatList",this.onUpdateChatChatList),gt.a.on("updateChatDraftMessage",this.onUpdateChatOrder),gt.a.on("updateChatIsPinned",this.onUpdateChatOrder),gt.a.on("updateChatIsSponsored",this.onUpdateChatOrder),gt.a.on("updateChatLastMessage",this.onUpdateChatOrder),gt.a.on("updateChatOrder",this.onUpdateChatOrder),gt.a.on("clientUpdateOpenSettings",this.onClientUpdateOpenSettings),gt.a.on("clientUpdateCloseSettings",this.onClientUpdateCloseSettings),gt.a.on("clientUpdateOpenArchive",this.onClientUpdateOpenArchive),gt.a.on("clientUpdateCloseArchive",this.onClientUpdateCloseArchive),gt.a.on("clientUpdateOpenContacts",this.onClientUpdateOpenContacts),gt.a.on("clientUpdateCloseContacts",this.onClientUpdateCloseContacts)}componentWillUnmount(){v.a.off("clientUpdateChatDetailsVisibility",this.onClientUpdateChatDetailsVisibility),v.a.off("clientUpdateSearchChat",this.onClientUpdateSearchChat),v.a.off("clientUpdateThemeChange",this.onClientUpdateThemeChange),gt.a.off("updateChatChatList",this.onUpdateChatChatList),gt.a.off("updateChatDraftMessage",this.onUpdateChatOrder),gt.a.off("updateChatIsPinned",this.onUpdateChatOrder),gt.a.off("updateChatIsSponsored",this.onUpdateChatOrder),gt.a.off("updateChatLastMessage",this.onUpdateChatOrder),gt.a.off("updateChatOrder",this.onUpdateChatOrder),gt.a.off("clientUpdateOpenSettings",this.onClientUpdateOpenSettings),gt.a.off("clientUpdateCloseSettings",this.onClientUpdateCloseSettings),gt.a.off("clientUpdateOpenArchive",this.onClientUpdateOpenArchive),gt.a.off("clientUpdateCloseArchive",this.onClientUpdateCloseArchive),gt.a.off("clientUpdateOpenContacts",this.onClientUpdateOpenContacts),gt.a.off("clientUpdateCloseContacts",this.onClientUpdateCloseContacts)}loadCache(){var e=this;return Object(h.a)(d.a.mark((function t(){var a,n,s;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Ni.loadCache();case 2:if(t.t0=t.sent,t.t0){t.next=5;break}t.t0={};case 5:a=t.t0,n=a.chats,s=a.archiveChats,e.setState({cache:a,showArchive:s&&s.length>0,archiveTitle:Fi()}),e.loadChatContents((n||[]).map(e=>e.id)),V.a.clientUpdate({"@type":"clientUpdateCacheLoaded"});case 10:case"end":return t.stop()}}),t)})))()}saveCache(){const e=this.archiveListRef.current,t=e&&e.state.chats?e.state.chats.slice(0,25):[],a=this.dialogListRef.current,n=a&&a.state.chats?a.state.chats.slice(0,25):[];Ni.saveChats(n,t)}loadChatContents(e){const t=ft.a.getStore();Object(mt.p)(t,e)}render(){const e=this.state,t=e.cache,a=e.showArchive,n=e.archiveTitle,i=e.mainItems,o=e.archiveItems,r=e.isChatDetailsVisible,c=e.meChatId,l=e.openSettings,d=e.openContacts,h=e.openArchive,u=e.openSearch,p=e.searchChatId,m=e.searchText,g=t?t.chats||[]:null,f=t?t.archiveChats||[]:null;return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:q()("dialogs",{"dialogs-third-column":r})},s.a.createElement("div",{className:"sidebar-page"},s.a.createElement(js,{ref:this.dialogsHeaderRef,openArchive:h,openSearch:u,onClick:this.handleHeaderClick,onSearch:this.handleSearch,onSearchTextChange:this.handleSearchTextChange}),s.a.createElement("div",{className:"dialogs-content"},s.a.createElement(na,{type:"chatListMain",ref:this.dialogListRef,cacheItems:g,items:i,showArchive:a,archiveTitle:n,open:!0,onSaveCache:this.handleSaveCache}),s.a.createElement(na,{type:"chatListArchive",ref:this.archiveListRef,cacheItems:f,items:o,open:h,onSaveCache:this.handleSaveCache}),u&&s.a.createElement(ks,{chatId:p,text:m,onSelectMessage:this.handleSelectMessage,onClose:this.handleClose})),s.a.createElement(Ai,null)),s.a.createElement(Vs.a,{direction:"right",in:d,mountOnEnter:!0,unmountOnExit:!0},s.a.createElement(ji,null)),s.a.createElement(Vs.a,{direction:"right",in:l,mountOnEnter:!0,unmountOnExit:!0},s.a.createElement(xi,{chatId:c}))))}}var Vi=Bi;a(434);class zi extends s.a.Component{constructor(...e){super(...e),this.state={chatId:v.a.dialogChatId},this.onClientUpdateMediaViewerContent=e=>{v.a.mediaViewerContent&&this.handleClose()},this.onClientUpdateDialogChatId=e=>{const t=e.chatId;this.setState({chatId:t})},this.handleClose=()=>{V.a.clientUpdate({"@type":"clientUpdateDialogChatId",chatId:0})}}shouldComponentUpdate(e,t,a){const n=this.state.chatId;return t.chatId!==n}componentDidMount(){v.a.on("clientUpdateDialogChatId",this.onClientUpdateDialogChatId),v.a.on("clientUpdateMediaViewerContent",this.onClientUpdateMediaViewerContent)}componentWillUnmount(){v.a.off("clientUpdateDialogChatId",this.onClientUpdateDialogChatId),v.a.off("clientUpdateMediaViewerContent",this.onClientUpdateMediaViewerContent)}render(){const e=this.state.chatId;return e?s.a.createElement(M.a,{open:!0,transitionDuration:0,onClose:this.handleClose,classes:{root:"chat-info-dialog-root",container:"chat-info-dialog-container",paper:"chat-info-dialog-paper"}},s.a.createElement(us,{className:"chat-info-dialog-content",chatId:e,popup:!0})):null}}var Hi=zi,Wi=a(162),Gi=a.n(Wi),Ki=Object(Je.a)(s.a.createElement("path",{d:"M4.70710678,12.2928932 C4.31658249,11.9023689 3.68341751,11.9023689 3.29289322,12.2928932 C2.90236893,12.6834175 2.90236893,13.3165825 3.29289322,13.7071068 L8.29289322,18.7071068 C8.68341751,19.0976311 9.31658249,19.0976311 9.70710678,18.7071068 L20.7071068,7.70710678 C21.0976311,7.31658249 21.0976311,6.68341751 20.7071068,6.29289322 C20.3165825,5.90236893 19.6834175,5.90236893 19.2928932,6.29289322 L9,16.5857864 L4.70710678,12.2928932 Z"}),"Done"),Zi=a(224),qi=Object(Je.a)(s.a.createElement("path",{d:"M2.65383364,2.92607697 L4.145798,9.778632 C4.26700994,10.3353554 4.73555061,10.7489799 5.30300879,10.8002098 L16.196355,11.7836569 C16.3159306,11.7944521 16.4041145,11.9001385 16.3933192,12.0197141 C16.3838746,12.1243302 16.3009783,12.2072294 16.1963626,12.2166777 L5.30295988,13.2005138 C4.73552551,13.2517615 4.26701089,13.6653731 4.14579755,14.2220735 L2.65385781,21.074154 C2.55168485,21.543407 2.84926209,22.0066394 3.31851517,22.1088123 C3.50628037,22.1496954 3.70229947,22.1272304 3.87594675,22.0449272 L23.4110848,12.7858981 C23.8450551,12.5802101 24.0301144,12.0616646 23.8244264,11.6276943 C23.7384721,11.4463438 23.5924353,11.300307 23.4110848,11.2143527 L3.87592461,1.95531307 C3.44195432,1.74962507 2.92340882,1.93468443 2.71772082,2.36865471 C2.63541897,2.54229904 2.61295329,2.73831451 2.65383364,2.92607697 Z"}),"Send"),Yi=Object(Je.a)(s.a.createElement("path",{d:"M11.657825,8.68730116 L7.89384699,12.5266719 C6.53977525,13.9078658 6.53979565,16.118605 7.89389288,17.4997739 C9.18119565,18.812813 11.2598788,18.8798255 12.6276396,17.6859428 L12.8071445,17.5177786 L19.3928802,10.8005213 C21.4766204,8.67512215 21.4766204,5.27313659 19.3928802,3.14773741 C17.4051081,1.12022499 14.1862843,1.0310006 12.0906645,2.90336495 L11.834659,3.14773741 L5.26671543,9.84699003 C2.45333216,12.7166196 2.45333216,17.3098454 5.26671543,20.179475 C7.96150749,22.9281424 12.3352577,23.0332941 15.1578204,20.4629606 L15.452067,20.1794113 L19.2160679,16.340063 C19.6027032,15.945688 19.596429,15.3125541 19.202054,14.9259188 C18.8076791,14.5392835 18.1745452,14.5455577 17.7879099,14.9399327 L13.9520378,18.8511531 C11.9281881,20.8353343 8.67903707,20.8031766 6.6948559,18.7793268 C4.64395201,16.6874204 4.64395201,13.3390446 6.6948559,11.2471382 L13.3088798,4.50180526 C14.6072848,3.22884976 16.6917843,3.24948061 17.9647398,4.54788555 C19.2860006,5.89556155 19.2860006,8.05269718 17.9647398,9.40037319 L11.3764629,16.119959 C10.803533,16.6816592 9.88373353,16.6725557 9.32203335,16.0996258 C8.73040544,15.4961698 8.73039653,14.5302606 9.3220133,13.9267937 L13.0859914,10.0874229 C13.4726243,9.6930457 13.4663463,9.05991185 13.0719691,8.67327889 C12.6775919,8.28664594 12.044458,8.29292392 11.657825,8.68730116 Z"}),"Attach"),Ji=a(255),Qi=a.n(Ji);class Xi extends s.a.Component{constructor(...e){super(...e),this.state={anchorEl:null},this.handleMenuClick=e=>{this.setState({anchorEl:e.currentTarget})},this.handleMenuClose=()=>{this.setState({anchorEl:null})},this.handleAttachPhoto=()=>{this.handleMenuClose();const e=this.props.onAttachPhoto;e&&setTimeout(()=>e(),B.c)},this.handleAttachDocument=()=>{this.handleMenuClose();const e=this.props.onAttachDocument;e&&setTimeout(()=>e(),B.c)},this.handleAttachPoll=()=>{this.handleMenuClose();const e=this.props.onAttachPoll;e&&e()}}render(){const e=this.props,t=(e.classes,e.t),a=e.chatId,n=this.state.anchorEl;return s.a.createElement(s.a.Fragment,null,s.a.createElement(J.a,{className:"inputbox-icon-button","aria-label":"Attach",open:Boolean(n),onClick:this.handleMenuClick},s.a.createElement(Yi,null)),s.a.createElement(ws.a,{id:"attach-menu",anchorEl:n,open:Boolean(n),getContentAnchorEl:null,disableAutoFocusItem:!0,disableRestoreFocus:!0,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"bottom",horizontal:"right"},onClose:this.handleMenuClose},s.a.createElement(it.a,{onClick:this.handleAttachPhoto,disabled:!Object(Ze.d)(a)},s.a.createElement(ja.a,null,s.a.createElement(Ba,null)),s.a.createElement(Ra.a,{primary:t("AttachPhoto")})),s.a.createElement(it.a,{onClick:this.handleAttachDocument,disabled:!Object(Ze.d)(a)},s.a.createElement(ja.a,null,s.a.createElement(Pa,null)),s.a.createElement(Ra.a,{primary:t("AttachDocument")})),!Object(Ze.W)(a)&&s.a.createElement(it.a,{onClick:this.handleAttachPoll,disabled:!Object(Ze.f)(a)},s.a.createElement(ja.a,null,s.a.createElement(Qi.a,null)),s.a.createElement(Ra.a,{primary:t("Poll")}))))}}var $i=Object(p.c)()(Xi),eo=a(499),to=a(179);function ao(e,t=!1){if(e){if(t&&e.childNodes&&e.childNodes.length>0){const t=e.childNodes[e.childNodes.length-1],a=document.createRange();a.setStart(t,t.length),a.collapse(!0);const n=window.getSelection();n.removeAllRanges(),n.addRange(a),e.scrollTop=e.scrollHeight}e.focus()}}const no=8,so=16,io=17,oo=18,ro=46,co=37,lo=38,ho=39,uo=40,po={special:{},navigational:{},isSpecial(e){return"undefined"!==typeof this.special[e.keyCode]},isNavigational(e){return"undefined"!==typeof this.navigational[e.keyCode]}};po.special[no]=!0,po.special[so]=!0,po.special[io]=!0,po.special[oo]=!0,po.special[ro]=!0,po.navigational[lo]=!0,po.navigational[uo]=!0,po.navigational[co]=!0,po.navigational[ho]=!0;a(435);class mo extends s.a.Component{constructor(e){super(e),this.getText=()=>this.optionTextRef.current.innerText,this.focus=(e=!1)=>{ao(this.optionTextRef.current,e)},this.handleDelete=()=>{const e=this.props,t=e.option,a=e.onDelete;t&&a&&a(t.id)},this.handleInput=e=>{const t=this.props.option;e.preventDefault();const a=this.optionTextRef.current,n=a.dataset.length,s=(a.dataset.maxLength,this.getText());this.setState({remainLength:n-s.length}),V.a.clientUpdate({"@type":"clientUpdatePollOption",id:t.id,text:s})},this.handleKeyDown=e=>{const t=this.optionTextRef.current,a=t.dataset.maxLength,n=this.getText().length;let s=!1;const i=window.getSelection(),o=po.isSpecial(e),r=po.isNavigational(e);switch(i&&(s=!!i.toString()),e.key){case"Backspace":if(!this.getText()){const t=this.props,a=t.option,n=t.onDelete;return n&&n(a.id,!0),e.preventDefault(),!1}break;case"Enter":{const t=this.props,a=t.option,n=t.onFocusNext;return a&&n&&n(a.id),e.preventDefault(),!1}case"ArrowUp":{const a=window.getSelection();if(!a)break;if(!a.isCollapsed)break;const n=t.childNodes&&t.childNodes.length>0?t.childNodes[0]:null;if(!n||a.anchorNode===n&&!a.anchorOffset){const t=this.props,a=t.option,n=t.onFocusPrev;return n&&n(a.id),e.preventDefault(),!1}break}case"ArrowDown":{const a=window.getSelection();if(!a)break;if(!a.isCollapsed)break;const n=t.childNodes&&t.childNodes.length>0?t.childNodes[t.childNodes.length-1]:null;if(!n||a.anchorNode===n&&a.anchorOffset===n.length){const t=this.props,a=t.option,n=t.onFocusNext;return n&&n(a.id),e.preventDefault(),!1}break}}return!(!o&&!r)||(!(n>=a&&!s)||(e.preventDefault(),!1))},this.handlePaste=e=>{e.preventDefault();const t=this.optionTextRef.current.dataset.maxLength,a=window.getSelection(),n=a?a.toString():"",s=this.getText();if(s.length-a.length>=t)return;let i=e.clipboardData.getData("text/plain");i&&(i=i.replace("\r\n","\n").replace("\n"," "),s.length-n.length+i.length>t&&(i=i.substr(0,t-s.length+n.length)),document.execCommand("insertText",!1,i))},this.handleChange=()=>{const e=this.props.option;e&&V.a.clientUpdate({"@type":"clientUpdatePollChooseOption",id:e.id})},this.optionTextRef=s.a.createRef(),this.state={remainLength:B.P}}render(){const e=this.props,t=e.t,a=e.option,n=this.state.remainLength,i=a.is_chosen;return s.a.createElement("div",{className:"create-poll-option"},s.a.createElement("div",{className:"create-poll-option-wrapper"},s.a.createElement(Js.a,{key:Date.now(),classes:{root:"create-poll-radio-root"},color:"primary",checked:i,onChange:this.handleChange}),s.a.createElement("div",{ref:this.optionTextRef,className:"create-poll-option-text",contentEditable:!0,suppressContentEditableWarning:!0,placeholder:t("Option"),"data-length":B.O,"data-max-length":B.P,onInput:this.handleInput,onKeyDown:this.handleKeyDown,onPaste:this.handlePaste})),s.a.createElement("div",{className:"create-poll-option-delete-button"},s.a.createElement(J.a,{className:"create-poll-option-button",onClick:this.handleDelete},s.a.createElement(la.a,{fontSize:"small"}))),s.a.createElement("div",{className:"create-poll-option-bottom-border"}),n<=B.O-B.N&&s.a.createElement(to.a,{align:"center",className:"create-poll-option-subtitle",color:n>=0?"textSecondary":"error",variant:"subtitle1"},n))}}var go=Object(u.a)(Object(u.d)(),Object(p.c)(),Object(u.c)())(mo),fo=a(152),bo=a(47);a(436);class Co extends s.a.Component{constructor(e){super(e),this.handleClientUpdateNewPoll=e=>{const t=bo.a.poll;this.setState({confirm:!1,remainLength:B.S,poll:t})},this.handleClientUpdatePollQuestion=e=>{const t=bo.a.poll,a=this.questionRef.current,n=a.dataset.length,s=a.innerText;this.setState({remainLength:n-s.length,poll:t})},this.handleClientUpdatePoll=e=>{const t=bo.a.poll;this.setState({poll:t})},this.handleClientUpdateNewPollOption=e=>{const t=bo.a.poll;this.setState({poll:t},()=>{setTimeout(()=>{this.optionsRefMap.get(t.options.length-1).focus(!0)})})},this.handleKeyDown=e=>{const t=this.questionRef.current,a=t.dataset.maxLength,n=t.innerText.length;let s=!1;const i=window.getSelection(),o=po.isSpecial(e),r=po.isNavigational(e);switch(i&&(s=!!i.toString()),e.key){case"Enter":if(!e.shiftKey)return this.handleFocusNextOption(0),e.preventDefault(),!1;break;case"ArrowDown":{const a=window.getSelection();if(!a)break;if(!a.isCollapsed)break;const n=t.childNodes&&t.childNodes.length>0?t.childNodes[t.childNodes.length-1]:null;if(!n||a.anchorNode===n&&a.anchorOffset===n.length)return this.handleFocusNextOption(0),e.preventDefault(),!1;break}}return!(!o&&!r)||(!(n>=a&&!s)||(e.preventDefault(),!1))},this.handlePaste=e=>{e.preventDefault();const t=this.questionRef.current,a=t.dataset.maxLength,n=window.getSelection(),s=n?n.toString():"",i=t.innerText;if(i.length-n.length>=a)return;let o=e.clipboardData.getData("text/plain");o&&(i.length-s.length+o.length>a&&(o=o.substr(0,a-i.length+s.length)),document.execCommand("insertText",!1,o))},this.handleInput=e=>{e.preventDefault();const t=this.questionRef.current,a=t.innerText;"<br>"===t.innerHTML&&(t.innerText=""),V.a.clientUpdate({"@type":"clientUpdatePollQuestion",question:a})},this.handleAddOption=()=>{const e=this.state.poll;if(!e)return;if(e.options.length>=B.M)return;const t={id:Date.now(),text:""};V.a.clientUpdate({"@type":"clientUpdateNewPollOption",option:t})},this.handleDeleteOption=(e,t=!1)=>{t?this.handleDeleteByBackspace(e):this.handleDelete(e)},this.handleDelete=e=>{V.a.clientUpdate({"@type":"clientUpdateDeletePollOption",id:e})},this.handleDeleteByBackspace=e=>{const t=this.state.poll;if(!t)return;const a=t.options,n=a.findIndex(t=>t.id===e),s=n-1;let i=!0;for(let r=n;r<a.length;r++){if(a[r].text){i=!1;break}}i&&this.handleDeleteOption(e);const o=this.optionsRefMap.get(s);if(o)o.focus(!0);else{ao(this.questionRef.current,!0)}},this.handleFocusPrevOption=e=>{const t=this.state.poll;if(!t)return;const a=t.options.findIndex(t=>t.id===e)-1,n=this.optionsRefMap.get(a);if(n)n.focus(!1);else{ao(this.questionRef.current,!1)}},this.handleFocusNextOption=e=>{const t=this.state.poll;if(!t)return;const a=t.options,n=a.findIndex(t=>t.id===e),s=n+1,i=this.optionsRefMap.get(s);if(i)i.focus(i,!0);else{const e=n>=0&&n<a.length?a[n].text:"";if(a.length&&!e)return;this.handleAddOption()}},this.getHint=()=>{const e=this.state.poll;if(!e)return;const t=e.options,a=B.M-t.length;return a<=0?"You have added the maximum number of options.":1===a?"You can add 1 more option.":"You can add ".concat(B.M-t.length," more options.")},this.handleClose=()=>{const e=this.state.poll;Object(fo.a)(e)?this.setState({confirm:!0}):this.handleConfirmationDone()},this.handleSend=()=>{const e=this.props.onSend,t=bo.a.getInputMessagePoll();t&&(e(t),this.handleConfirmationDone())},this.handleConfirmationClose=()=>{this.setState({confirm:!1})},this.handleConfirmationDone=()=>{this.handleConfirmationClose(),V.a.clientUpdate({"@type":"clientUpdateDeletePoll"})},this.handleChangeAnonymous=()=>{V.a.clientUpdate({"@type":"clientUpdatePollChangeAnonymous"})},this.handleChangeAllowMultipleAnswers=()=>{V.a.clientUpdate({"@type":"clientUpdatePollChangeAllowMultipleAnswers"})},this.handleChangeType=()=>{V.a.clientUpdate({"@type":"clientUpdatePollChangeType"})},this.handleScheduledAction=(e,t,a)=>{if(!e)return;const n=this.props.enqueueSnackbar;if(!n)return;v.a.addScheduledAction(e,B.y+300,a)&&n(t,{autoHideDuration:B.y,action:[s.a.createElement(J.a,{key:"close","aria-label":"Close",color:"inherit",className:"notification-close-button",onClick:()=>v.a.removeScheduledAction(e)},s.a.createElement(la.a,null))]})},this.handleAllowMultipleAnswersClick=e=>{const t=this.props.t,a=this.state.poll;if(a&&"pollTypeQuiz"===a.type["@type"]){e.stopPropagation();const a="disallow_multiple_answers",n=t("PollQuizOneRightAnswer"),s=null;this.handleScheduledAction(a,n,s)}},this.questionRef=s.a.createRef(),this.optionsRefMap=new Map,this.state={poll:null,confirm:!1,remainLength:B.S}}componentDidMount(){bo.a.on("clientUpdatePollChooseOption",this.handleClientUpdatePoll),bo.a.on("clientUpdatePollChangeAnonymous",this.handleClientUpdatePoll),bo.a.on("clientUpdatePollChangeAllowMultipleAnswers",this.handleClientUpdatePoll),bo.a.on("clientUpdatePollChangeType",this.handleClientUpdatePoll),bo.a.on("clientUpdateDeletePoll",this.handleClientUpdatePoll),bo.a.on("clientUpdateDeletePollOption",this.handleClientUpdatePoll),bo.a.on("clientUpdateNewPoll",this.handleClientUpdateNewPoll),bo.a.on("clientUpdateNewPollOption",this.handleClientUpdateNewPollOption),bo.a.on("clientUpdatePollOption",this.handleClientUpdatePoll),bo.a.on("clientUpdatePollQuestion",this.handleClientUpdatePollQuestion)}componentWillUnmount(){bo.a.off("clientUpdatePollChooseOption",this.handleClientUpdatePoll),bo.a.off("clientUpdatePollChangeAnonymous",this.handleClientUpdatePoll),bo.a.off("clientUpdatePollChangeAllowMultipleAnswers",this.handleClientUpdatePoll),bo.a.off("clientUpdatePollChangeType",this.handleClientUpdatePoll),bo.a.off("clientUpdateDeletePoll",this.handleClientUpdatePoll),bo.a.off("clientUpdateDeletePollOption",this.handleClientUpdatePoll),bo.a.off("clientUpdateNewPoll",this.handleClientUpdateNewPoll),bo.a.off("clientUpdateNewPollOption",this.handleClientUpdateNewPollOption),bo.a.off("clientUpdatePollOption",this.handleClientUpdatePoll),bo.a.off("clientUpdatePollQuestion",this.handleClientUpdatePollQuestion)}componentDidUpdate(e,t,a){this.state.poll&&!t.poll&&setTimeout(()=>{ao(this.questionRef.current,!0)},0)}render(){const e=this.props.t,t=this.state,a=t.remainLength,n=t.confirm,i=t.poll;if(!i)return null;const o=i.is_anonymous,r=i?i.options:[],c=i.type.allow_multiple_answers,l="pollTypeRegular"!==i.type["@type"],d="pollTypeQuiz"===i.type["@type"];this.optionsRefMap.clear();const h=r.map((e,t)=>s.a.createElement(go,{ref:e=>this.optionsRefMap.set(t,e),key:e.id,option:e,onDelete:this.handleDeleteOption,onFocusPrev:this.handleFocusPrevOption,onFocusNext:this.handleFocusNextOption})),u=B.M-r.length>0,p=this.getHint();return s.a.createElement(s.a.Fragment,null,s.a.createElement(M.a,{className:q()("create-poll-dialog",{"create-quiz-dialog":d}),open:!0,transitionDuration:0,onClose:this.handleClose,"aria-labelledby":"dialog-title"},s.a.createElement(O.a,{id:"dialog-title"},e("NewPoll")),s.a.createElement(_.a,{classes:{root:"create-poll-dialog-root"}},s.a.createElement("div",{className:"create-poll-dialog-question-title"},s.a.createElement(Y.a,{color:"primary",variant:"subtitle1",style:{flexGrow:1}},e("Question")),a<=B.R-B.Q&&s.a.createElement(Y.a,{color:a>=0?"textSecondary":"error",variant:"subtitle1"},a)),s.a.createElement("div",{ref:this.questionRef,id:"create-poll-dialog-question",contentEditable:!0,suppressContentEditableWarning:!0,placeholder:e("QuestionHint"),"data-length":B.R,"data-max-length":B.S,onPaste:this.handlePaste,onKeyDown:this.handleKeyDown,onInput:this.handleInput}),s.a.createElement(Ma.a,{className:"divider"}),s.a.createElement(Y.a,{color:"primary",variant:"subtitle1"},e("PollOptions")),s.a.createElement(Da.a,{classes:{root:"create-poll-dialog-list"}},h,u&&s.a.createElement(La.a,{selected:!1,className:"create-poll-add-option",button:!0,onClick:this.handleAddOption},s.a.createElement(Ra.a,{disableTypography:!0,primary:e("AddAnOption")}))),s.a.createElement(Y.a,null,p),s.a.createElement(Ma.a,{className:"divider"}),s.a.createElement(Y.a,{color:"primary",variant:"subtitle1"},e("Settings")),s.a.createElement(eo.a,null,s.a.createElement(Un.a,{control:s.a.createElement(se.a,{color:"primary",checked:o,onChange:this.handleChangeAnonymous}),label:e("PollAnonymous")}),s.a.createElement("div",{onClick:this.handleAllowMultipleAnswersClick,style:{background:"transparent"}},s.a.createElement(Un.a,{control:s.a.createElement(se.a,{color:"primary",disabled:l,checked:c,onChange:this.handleChangeAllowMultipleAnswers}),label:e("PollMultiple")})),s.a.createElement(Un.a,{control:s.a.createElement(se.a,{color:"primary",checked:d,onChange:this.handleChangeType}),label:e("PollQuiz")})),s.a.createElement(Y.a,null,e("QuizInfo"))),s.a.createElement(I.a,null,s.a.createElement(w.a,{color:"primary",onClick:this.handleClose},e("Cancel")),Object(fo.b)(i)&&s.a.createElement(w.a,{color:"primary",onClick:this.handleSend},e("Create")))),s.a.createElement(M.a,{className:"create-poll-dialog-root",open:n,transitionDuration:0,onClose:this.handleConfirmationClose,"aria-labelledby":"dialog-title"},s.a.createElement(O.a,{id:"dialog-title"},e("CancelPollAlertTitle")),s.a.createElement(_.a,{classes:{root:"create-poll-dialog-root"}},e("CancelPollAlertText")),s.a.createElement(I.a,null,s.a.createElement(w.a,{color:"primary",onClick:this.handleConfirmationClose},e("Cancel")),s.a.createElement(w.a,{color:"primary",onClick:this.handleConfirmationDone},e("Ok")))))}}var yo=Object(u.a)(Object(u.d)(),Object(p.c)(),ra.withSnackbar,Object(u.c)())(Co),vo=a(105);a(437);class Eo extends s.a.Component{constructor(e){super(e),this.handleTextKeyDown=e=>{"Enter"===e.key&&(this.urlInputRef.current.focus(),e.preventDefault(),e.stopPropagation())},this.handleUrlKeyDown=e=>{"Enter"===e.key&&(this.handleDone(),e.preventDefault(),e.stopPropagation())},this.handleTextChange=e=>{this.setState({text:e.target.value})},this.handleUrlChange=e=>{this.setState({url:e.target.value})},this.handleDone=()=>{const e=this.props,t=e.defaultText,a=e.defaultUrl;let n=this.state,s=n.text,i=n.url;if(s=null!==s?s:t,i=null!==i?i:a,!s&&!i)return void this.textInputRef.current.focus();if(!s)return this.setState({textError:!0}),void this.textInputRef.current.focus();if(i=Object(vo.d)(i),!i)return this.setState({urlError:!0}),void this.urlInputRef.current.focus();(0,this.props.onDone)(s,i)},this.handleCancel=()=>{(0,this.props.onCancel)()},this.textRef=s.a.createRef(),this.textInputRef=s.a.createRef(),this.urlRef=s.a.createRef(),this.urlInputRef=s.a.createRef(),this.state={}}componentDidUpdate(e,t,a){const n=this.props,s=n.defaultText,i=n.defaultUrl,o=n.open;o&&e.open!==o&&setTimeout(()=>{const e=this.textInputRef.current,t=this.urlInputRef.current;e&&t&&(s?i?(e.focus(),e.select()):t.focus():e.focus())},0)}componentDidMount(){}shouldComponentUpdate(e,t,a){const n=this.props,s=n.defaultText,i=n.defaultUrl,o=n.onDone,r=n.onCancel,c=n.open,l=this.state,d=l.textError,h=l.urlError;return e.defaultText!==s||(e.defaultUrl!==i||(t.textError!==d||(t.urlError!==h||(e.onDone!==o||(e.onCancel!==r||e.open!==c)))))}static getDerivedStateFromProps(e,t){return t.prevOpen!==e.open?{prevOpen:!0,textError:!1,urlError:!1,text:null,url:null}:null}render(){const e=this.props,t=e.open,a=e.defaultUrl,n=e.defaultText,i=e.t,o=this.state,r=o.textError,c=o.urlError;return t?s.a.createElement(M.a,{transitionDuration:0,open:!0,onClose:this.handleCancel,"aria-labelledby":"edit-url-dialog-title"},s.a.createElement(O.a,{id:"edit-url-dialog-title"},i("CreateLink")),s.a.createElement(_.a,null,s.a.createElement("div",{style:{display:"flex",flexDirection:"column",width:260}},s.a.createElement($.a,{ref:this.textRef,inputRef:this.textInputRef,label:i("Text"),margin:"normal",autoComplete:"off",defaultValue:n,error:r,onChange:this.handleTextChange,onKeyDown:this.handleTextKeyDown}),s.a.createElement($.a,{ref:this.urlRef,inputRef:this.urlInputRef,label:i("URL"),margin:"normal",autoComplete:"off",defaultValue:a,error:c,onChange:this.handleUrlChange,onKeyDown:this.handleUrlKeyDown}))),s.a.createElement(I.a,null,s.a.createElement(w.a,{onClick:this.handleCancel,color:"primary"},i("Cancel")),s.a.createElement(w.a,{onClick:this.handleDone,color:"primary"},i("Create")))):null}}var So=Object(p.c)()(Eo);a(438);class Uo extends s.a.Component{constructor(...e){super(...e),this.onClientUpdatePhotoBlob=e=>{const t=this.props,a=t.chatId,n=t.messageId,s=t.photoSize;if(!s)return;const i=s.photo;i&&e.chatId===a&&e.messageId===n&&e.fileId===i.id&&this.forceUpdate()}}componentDidMount(){ft.a.on("clientUpdateAnimationThumbnailBlob",this.onClientUpdatePhotoBlob),ft.a.on("clientUpdateAudioThumbnailBlob",this.onClientUpdatePhotoBlob),ft.a.on("clientUpdateDocumentThumbnailBlob",this.onClientUpdatePhotoBlob),ft.a.on("clientUpdatePhotoBlob",this.onClientUpdatePhotoBlob),ft.a.on("clientUpdateStickerThumbnailBlob",this.onClientUpdatePhotoBlob),ft.a.on("clientUpdateVideoThumbnailBlob",this.onClientUpdatePhotoBlob),ft.a.on("clientUpdateVideoNoteThumbnailBlob",this.onClientUpdatePhotoBlob)}componentWillUnmount(){ft.a.off("clientUpdateAnimationThumbnailBlob",this.onClientUpdatePhotoBlob),ft.a.off("clientUpdateAudioThumbnailBlob",this.onClientUpdatePhotoBlob),ft.a.off("clientUpdateDocumentThumbnailBlob",this.onClientUpdatePhotoBlob),ft.a.off("clientUpdatePhotoBlob",this.onClientUpdatePhotoBlob),ft.a.off("clientUpdateStickerThumbnailBlob",this.onClientUpdatePhotoBlob),ft.a.off("clientUpdateVideoThumbnailBlob",this.onClientUpdatePhotoBlob),ft.a.off("clientUpdateVideoNoteThumbnailBlob",this.onClientUpdatePhotoBlob)}render(){const e=this.props,t=e.chatId,a=e.messageId,n=e.photoSize,i=e.minithumbnail;if(!n)return null;const o=n.photo;if(!o)return null;const r=i?"data:image/jpeg;base64, "+i.data:null,c=Object(mt.j)(o),l=!c&&r||Object(qn.h)(n),d=Object(Tt.y)(t,a),h=Boolean(c||r);return s.a.createElement("div",{className:"reply-tile"},h&&s.a.createElement("img",{className:q()("reply-tile-photo",{"reply-tile-photo-round":d},{"reply-tile-photo-loading":!c},{"media-blurred":c&&l},{"media-mini-blurred":!c&&r&&l}),draggable:!1,src:c||r,alt:""}))}}var ko=Uo;a(439);class wo extends s.a.Component{constructor(...e){super(...e),this.onGetMessageResult=e=>{const t=this.props,a=t.chatId,n=t.messageId;a===e.chat_id&&n===e.id&&this.forceUpdate()},this.handleClick=e=>{e.stopPropagation()},this.handleOpen=e=>{if(0!==e.button)return;e.stopPropagation();const t=this.props,a=t.chatId,n=t.messageId,s=t.onClick,i=Nt.a.get(a,n);return i?Object(Tt.B)(i)?null:(Object(nt.h)(a,n,!1),void(s&&s())):null}}componentDidMount(){Nt.a.on("getMessageResult",this.onGetMessageResult)}componentWillUnmount(){Nt.a.off("getMessageResult",this.onGetMessageResult)}render(){const e=this.props,t=e.t,a=e.chatId,n=e.messageId;let i=this.props.title;const o=Nt.a.get(a,n);i=i||Object(Tt.v)(o,t);let r=o?Object(Tt.f)(o,t):t("Loading");const c=Object(Tt.r)(a,n),l=Object(Tt.q)(a,n);return Object(Tt.B)(o)&&(i=null,r=t("DeletedMessage")),s.a.createElement("div",{className:"reply",onMouseDown:this.handleOpen,onClick:this.handleClick},s.a.createElement("div",{className:"reply-wrapper"},s.a.createElement("div",{className:"border reply-border"}),c&&s.a.createElement(ko,{chatId:a,messageId:n,photoSize:c,minithumbnail:l}),s.a.createElement("div",{className:"reply-content"},i&&s.a.createElement("div",{className:"reply-content-title"},i),s.a.createElement("div",{className:q()("reply-content-subtitle")},r))))}}var Mo=Object(p.c)()(wo);a(440);class Io extends s.a.Component{constructor(...e){super(...e),this.onUpdateMessageContent=e=>{const t=this.props,a=t.chatId,n=t.messageId,s=t.editMessageId,i=e.chat_id,o=e.message_id;a===i&&(n!==o&&s!==o||this.forceUpdate())},this.handleClose=()=>{const e=this.props,t=e.chatId;e.editMessageId?V.a.clientUpdate({"@type":"clientUpdateEditMessage",chatId:t,messageId:0}):V.a.clientUpdate({"@type":"clientUpdateReply",chatId:t,messageId:0})}}componentDidMount(){Nt.a.on("updateMessageContent",this.onUpdateMessageContent)}componentWillUnmount(){Nt.a.off("updateMessageContent",this.onUpdateMessageContent)}render(){const e=this.props,t=e.chatId,a=e.messageId,n=e.editMessageId,i=e.t,o=e.onClick;return t&&(a||n)?s.a.createElement("div",{className:"inputbox-header"},s.a.createElement("div",{className:"inputbox-header-left-column"},s.a.createElement(J.a,{className:"inputbox-icon-button","aria-label":"Close",onClick:this.handleClose},s.a.createElement(la.a,null))),s.a.createElement("div",{className:"inputbox-header-middle-column"},s.a.createElement(Mo,{chatId:t,messageId:a||n,title:n?i("EditMessage"):null,onClick:o})),s.a.createElement("div",{className:"inputbox-header-right-column"})):null}}var _o=Object(p.c)()(Io);a(441);class xo extends s.a.Component{constructor(...e){super(...e),this.handleDone=()=>{(0,this.props.onConfirm)()},this.handleCancel=()=>{(0,this.props.onCancel)()}}render(){const e=this.props,t=e.files,a=e.t;return t?s.a.createElement(M.a,{transitionDuration:0,open:!0,onClose:this.handleCancel,"aria-labelledby":"delete-dialog-title"},s.a.createElement(O.a,{id:"delete-dialog-title"},a("Confirm")),s.a.createElement(_.a,null,s.a.createElement(x.a,null,t.length>1?a("SendFilesConfirmation"):a("SendFileConfirmation"))),s.a.createElement(I.a,null,s.a.createElement(w.a,{onClick:this.handleCancel,color:"primary"},a("Cancel")),s.a.createElement(w.a,{onClick:this.handleDone,color:"primary"},a("Ok")))):null}}var Oo=Object(u.a)(Object(p.c)())(xo),Po=a(256),To=a.n(Po);a(442);class No extends s.a.Component{constructor(e){super(e),this.handleSelectionChange=()=>{document.activeElement===this.captionRef.current&&this.saveSelection()},this.handleDone=()=>{const e=this.props,t=e.chatId,a=e.onDone,n=this.captionRef.current;if(!n)return;const s=n.innerHTML;n.innerText=null;const i=Object(Tt.j)(s),o={"@type":"formattedText",text:i.text,entities:i.entities};let r=null;this.file?(Object(ze.v)(this.file,e=>{r={"@type":"inputMessagePhoto",photo:{"@type":"inputFileBlob",name:e.name,data:e},width:e.photoWidth,height:e.photoHeight,caption:o},a(null,r),V.a.clientUpdate({"@type":"clientUpdateEditMessage",chatId:t,messageId:0})}),this.file=null):(a(o,null),V.a.clientUpdate({"@type":"clientUpdateEditMessage",chatId:t,messageId:0}))},this.handleCancel=()=>{const e=this.props,t=e.chatId,a=e.onCancel;V.a.clientUpdate({"@type":"clientUpdateEditMessage",chatId:t,messageId:0}),a()},this.handleKeyDown=e=>{const t=e.altKey,a=e.ctrlKey,n=e.keyCode,s=e.metaKey,i=e.repeat,o=e.shiftKey;switch(n){case 13:t||a||s||o||(i||this.handleDone(),e.preventDefault(),e.stopPropagation());break;case 66:t||!a&&!s||o||(i||this.handleBold(),e.preventDefault(),e.stopPropagation());break;case 73:t||!a&&!s||o||(i||this.handleItalic(),e.preventDefault(),e.stopPropagation());break;case 75:t||!a&&!s||o?t&&(a||s)&&!o&&(i||this.handleMono(),e.preventDefault(),e.stopPropagation()):(i||this.handleUrl(),e.preventDefault(),e.stopPropagation());break;case 192:t&&(a||s)&&!o&&(i||this.handleClear(),e.preventDefault(),e.stopPropagation())}},this.handleClear=()=>{document.execCommand("removeFormat",!1,null),document.execCommand("unlink",!1,null)},this.handleBold=()=>{document.execCommand("removeFormat",!1,null),document.execCommand("unlink",!1,null),document.execCommand("bold",!1,null)},this.handleItalic=()=>{document.execCommand("removeFormat",!1,null),document.execCommand("unlink",!1,null),document.execCommand("italic",!1,null)},this.handleMono=()=>{document.execCommand("removeFormat",!1,null),document.execCommand("unlink",!1,null);let e="";const t=this.selection;t&&!t.isCollapsed&&(e=t.toString()),e&&(e="<code>".concat(e,"</code>"),document.execCommand("removeFormat",!1,null),document.execCommand("insertHTML",!1,e))},this.handleUnderline=()=>{document.execCommand("removeFormat",!1,null),document.execCommand("unlink",!1,null),document.execCommand("underline",!1,null)},this.handleStrikeThrough=()=>{document.execCommand("removeFormat",!1,null),document.execCommand("unlink",!1,null),document.execCommand("strikeThrough",!1,null)},this.handleUrl=()=>{this.openEditUrlDialog()},this.openEditUrlDialog=()=>{let e="",t="";const a=this.selection,n=this.range;if(n){let a=n.startContainer;if(a===n.endContainer){const n=a.parentElement;n&&"A"===n.nodeName&&(e=n.innerText,t=n.href)}}e||!a||a.isCollapsed||(e=a.toString()),this.setState({openEditUrl:!0,defaultUrl:t,defaultText:e})},this.closeEditUrlDialog=()=>{this.setState({openEditUrl:!1},()=>{this.restoreSelection()})},this.handlePaste=e=>{const t=e.clipboardData.getData("text/plain");t&&(e.preventDefault(),document.execCommand("insertText",!1,t))},this.handleInput=()=>{this.clearInnerHtml()},this.handleCancelEditUrl=()=>{this.closeEditUrlDialog()},this.handleDoneEditUrl=(e,t)=>{this.closeEditUrlDialog(),setTimeout(()=>{const a=this.range;if(a){const n=a.startContainer,s=a.endContainer;if(n&&n===s){const a=n.parentNode;if(a&&"A"===a.nodeName){a.href=t,a.title=t,a.innerText=e;const n=a.lastChild;if(n){const e=document.createRange();e.setStart(n,n.textContent.length),e.setEnd(n,n.textContent.length);const t=document.getSelection();t.removeAllRanges(),t.addRange(e)}return}}}const n="<a href=".concat(t," title=").concat(t," rel='noopener noreferrer' target='_blank'>").concat(e,"</a>");document.execCommand("removeFormat",!1,null),document.execCommand("insertHTML",!1,n)},0)},this.handleEditMedia=e=>{const t=this.editMediaRef.current;t&&t.click()},this.handleEditMediaComplete=e=>{const t=this.editMediaRef.current;if(!t)return;const a=t.files;0!==a.length&&(Array.from(a).forEach(e=>{this.file=e,this.getMediaFromFile(e,e=>{this.media=e,this.forceUpdate()})}),t.value="")},this.captionRef=s.a.createRef(),this.editMediaRef=s.a.createRef(),this.state={}}componentDidMount(){document.addEventListener("selectionchange",this.handleSelectionChange,!0)}componentWillUnmount(){document.removeEventListener("selectionchange",this.handleSelectionChange,!0)}componentDidUpdate(e,t,a){const n=this.props,s=n.chatId,i=n.messageId,o=n.open;if(o&&o!==e.open){this.file=null,this.media=null;const e=Nt.a.get(s,i);if(!e)return;const t=e.content;if(!t)return;const a=t.text,n=t.caption;if(!a&&!n)return;setTimeout(()=>{const e=this.captionRef.current;e&&(a?this.setFormattedText(a):n?this.setFormattedText(n):e.innerText=null,$t(e))},0)}}setFormattedText(e){const t=this.props.t,a=this.captionRef.current;if(!e)return void(a.innerText=null);const n=e.text,s=e.entities;try{const e=Object(Tt.p)(n,s,t);a.innerHTML=null,e.forEach(e=>{a.appendChild(e)})}catch(i){a.innerText=n}}saveSelection(){this.selection=document.getSelection(),this.range=this.selection.getRangeAt(0)}restoreSelection(){const e=this.range;if(!e)return void $t();const t=document.getSelection();t.removeAllRanges(),t.addRange(e),this.captionRef.current.focus()}clearInnerHtml(){const e=this.captionRef.current;if(!e)return;const t=e.innerHTML;"<br>"!==t&&"<div><br></div>"!==t||(e.innerHTML=null)}getRandomInt(e,t){return Math.floor(Math.random()*(t-e+1))+e}getMediaFromFile(e,t){e||t(null),e.type.startsWith("image")?Object(ze.v)(e,e=>{const a=-this.getRandomInt(1,1e6);ft.a.setBlob(a,e),t({"@type":"messagePhoto",photo:{"@type":"photo",has_stickers:!1,minithumbnail:null,sizes:[{"@type":"photoSize",photo:{"@type":"file",id:a},width:e.photoWidth,height:e.photoHeight}]}})}):t(null)}render(){const e=this.props,t=(e.classes,e.chatId),a=e.messageId,n=e.open,i=e.t;if(!n)return null;const o=this.state,r=o.defaultText,c=o.defaultUrl,l=o.openEditUrl,d=Nt.a.get(t,a);if(!d)return;const h=Object(Tt.n)({content:this.media})||Object(Tt.n)(d,null);return s.a.createElement(M.a,{transitionDuration:0,open:!0,onClose:this.handleCancel,"aria-labelledby":"edit-media-dialog-title"},s.a.createElement("div",{className:"edit-media-dialog-content"},s.a.createElement("div",{style:{margin:24}},h),s.a.createElement(J.a,{disableRipple:!0,"aria-label":i("Edit"),className:"edit-media-dialog-edit-button",size:"small",onClick:this.handleEditMedia},s.a.createElement(To.a,{fontSize:"inherit"})),s.a.createElement("input",{ref:this.editMediaRef,className:"inputbox-attach-button",type:"file",accept:"image/*",onChange:this.handleEditMediaComplete})),s.a.createElement("div",{ref:this.captionRef,id:"edit-media-dialog-caption",contentEditable:!0,suppressContentEditableWarning:!0,placeholder:i("Caption"),onKeyDown:this.handleKeyDown,onPaste:this.handlePaste,onInput:this.handleInput}),s.a.createElement(I.a,null,s.a.createElement(w.a,{onClick:this.handleCancel,color:"primary"},i("Cancel")),s.a.createElement(w.a,{onClick:this.handleDone,color:"primary"},i("Edit"))),s.a.createElement(So,{open:l,defaultText:r,defaultUrl:c,onDone:this.handleDoneEditUrl,onCancel:this.handleCancelEditUrl}))}}var Do=Object(p.c)()(No);var Lo=class{constructor(e){this.chatId=e,this.lastAction=null}setTyping(e){if(this.chatId){if(this.lastAction&&this.lastAction["@type"]===e["@type"]){let e=new Date;if(e.setSeconds(e.getSeconds()-B.qb),this.lastTypingDate&&this.lastTypingDate>e)return}this.lastAction=e,this.lastTypingDate=new Date,V.a.send({"@type":"sendChatAction",chat_id:this.chatId,action:e})}}},jo=a(48);a(443);const Ro=s.a.lazy(()=>Promise.all([a.e(3),a.e(4)]).then(a.bind(null,624)));class Ao extends n.Component{constructor(e){var t;super(e),t=this,this.selectionChangeListener=()=>{document.activeElement===this.newMessageRef.current&&this.saveSelection()},this.onUpdateDeleteMessages=e=>{const t=this.state,a=t.chatId,n=t.editMessageId,s=e.chat_id,i=e.message_ids,o=e.is_permanent;n&&o&&a===s&&-1!==i.indexOf(n)&&this.handleCancel()},this.onClientUpdateEditMessage=e=>{const t=e.chatId,a=e.messageId;this.state.chatId===t&&(a?this.saveDraftAndSelection():this.restoreDraftAndSelection(),this.setState({editMessageId:a,openEditMedia:0!==a&&Object(qn.i)(t,a)},()=>{this.state.openEditMedia||(this.setEditMessage(),this.handleInput(),this.focusInput())}))},this.onClientUpdateFocusWindow=e=>{e.focused||this.saveDraft()},this.onUpdateChatDraftMessage=e=>{const t=e.chat_id;this.state.chatId===t&&this.loadDraft()},this.onClientUpdateStickerSend=e=>{const t=e.sticker;if(!t)return;const a=t.sticker,n=t.thumbnail,s=t.width,i=t.height;if(!a)return;const o=this.newMessageRef.current;if(!o)return;o.innerText=null,this.restoreSelection();const r={"@type":"inputMessageSticker",sticker:{"@type":"inputFileId",id:a.id},width:s,height:i};if(n){const e=n.width,t=n.height,a=n.photo;r.thumbnail={thumbnail:{"@type":"inputFileId",id:a.id},width:e,height:t}}this.sendMessage(r,!1,e=>{}),V.a.clientUpdate({"@type":"clientUpdateLocalStickersHint",hint:null})},this.onClientUpdateReply=e=>{const t=this.state.chatId,a=e.chatId,n=e.messageId;t===a&&(this.setState({replyToMessageId:n}),n&&this.setInputFocus())},this.onClientUpdateChatId=e=>{this.state.chatId!==e.nextChatId&&(this.saveDraft(),this.beforeEditText=null,this.setState({chatId:e.nextChatId,replyToMessageId:Object(Ze.n)(e.nextChatId),editMessageId:0,openEditUrl:!1},()=>{this.loadDraft()}))},this.setDraft=()=>{const e=this.state.chatId,t=this.newMessageRef.current,a=Object(Ze.m)(e);a?(this.setFormattedText(a),this.setState({replyToMessageId:Object(Ze.n)(e)})):t.innerText=null},this.setInputFocus=()=>{setTimeout(()=>{$t(this.newMessageRef.current)},100)},this.setChatDraftMessage=e=>{if(!e)return;const t=e.chatId,a=e.draftMessage;t&&V.a.send({"@type":"setChatDraftMessage",chat_id:t,draft_message:a})},this.getDraftMessage=(e,t,a)=>{const n=gt.a.get(e);if(!n)return;const s=n.draft_message,i=Object(Tt.j)(a),o=i.text,r=i.entities,c=o&&o.length>0||r.length>0?{"@type":"draftMessage",reply_to_message_id:t,input_message_text:{"@type":"inputMessageText",text:{"@type":"formattedText",text:o,entities:r},disable_web_page_preview:!1,clear_draft:!1}}:null;return Object(Ze.i)(s,c)?null:{chatId:e,draftMessage:c}},this.handleSubmit=()=>{const e=this.state,t=e.chatId,a=e.editMessageId,n=this.newMessageRef.current;if(!n)return;let s=n.innerHTML;if(n.innerText=null,this.handleInput(),V.a.clientUpdate({"@type":"clientUpdateEditMessage",chatId:t,messageId:0}),!s)return;if(!s.trim())return;s=s.replace(/<div><br><\/div>/gi,"<br>"),s=s.replace(/<div>/gi,"<br>"),s=s.replace(/<\/div>/gi,"");const i=Object(Tt.j)(s),o={"@type":"formattedText",text:i.text,entities:i.entities},r={"@type":"inputMessageText",text:o,disable_web_page_preview:!1,clear_draft:!0};if(a){const e=Nt.a.get(t,a);if(!e)return;const n=e.content;if(!n)return;const s=n.text,i=n.caption;s?this.editMessageText(r,e=>{}):i&&this.editMessageCaption(o,e=>{})}else this.sendMessage(r,!1,e=>{})},this.handleAttachPoll=()=>{V.a.clientUpdate({"@type":"clientUpdateNewPoll"})},this.handleAttachPhoto=()=>{this.attachPhotoRef&&this.attachPhotoRef.current.click()},this.handleAttachPhotoComplete=()=>{const e=this.attachPhotoRef.current.files;0!==e.length&&(Array.from(e).forEach(e=>{Object(ze.v)(e,e=>{this.handleSendPhoto(e)})}),this.attachPhotoRef.current.value="")},this.handleAttachDocument=()=>{this.attachDocumentRef&&this.attachDocumentRef.current.click()},this.handleAttachDocumentComplete=()=>{const e=this.attachDocumentRef.current.files;0!==e.length&&(Array.from(e).forEach(e=>{this.handleSendDocument(e)}),this.attachDocumentRef.current.value="")},this.handleClear=()=>{document.execCommand("removeFormat",!1,null),document.execCommand("unlink",!1,null)},this.handleBold=()=>{document.execCommand("removeFormat",!1,null),document.execCommand("unlink",!1,null),document.execCommand("bold",!1,null)},this.handleItalic=()=>{document.execCommand("removeFormat",!1,null),document.execCommand("unlink",!1,null),document.execCommand("italic",!1,null)},this.handleMono=()=>{document.execCommand("removeFormat",!1,null),document.execCommand("unlink",!1,null);let e="";const t=this.selection;t&&!t.isCollapsed&&(e=t.toString()),e&&(e="<code>".concat(e,"</code>"),document.execCommand("removeFormat",!1,null),document.execCommand("insertHTML",!1,e))},this.handleUnderline=()=>{document.execCommand("removeFormat",!1,null),document.execCommand("unlink",!1,null),document.execCommand("underline",!1,null)},this.handleStrikeThrough=()=>{document.execCommand("removeFormat",!1,null),document.execCommand("unlink",!1,null),document.execCommand("strikeThrough",!1,null)},this.handleUrl=()=>{this.openEditUrlDialog()},this.handleCancel=()=>{const e=this.state,t=e.chatId,a=e.editMessageId,n=e.replyToMessageId;a?V.a.clientUpdate({"@type":"clientUpdateEditMessage",chatId:t,messageId:0}):n&&V.a.clientUpdate({"@type":"clientUpdateReply",chatId:t,messageId:0})},this.handleKeyDown=e=>{const t=e.altKey,a=e.ctrlKey,n=e.keyCode,s=e.metaKey,i=e.repeat,o=e.shiftKey;switch(n){case 13:t||a||s||o||(i||this.handleSubmit(),e.preventDefault(),e.stopPropagation());break;case 27:t||a||s||o||(i||this.handleCancel(),e.preventDefault(),e.stopPropagation());break;case 38:if(!i&&!t&&!a&&!s&&!o){const t=this.newMessageRef.current;if(t&&!t.innerText){if(this.state.editMessageId)return;V.a.clientUpdate({"@type":"clientUpdateTryEditMessage"}),e.preventDefault(),e.stopPropagation()}}break;case 66:t||!a&&!s||o||(i||this.handleBold(),e.preventDefault(),e.stopPropagation());break;case 73:t||!a&&!s||o||(i||this.handleItalic(),e.preventDefault(),e.stopPropagation());break;case 75:t||!a&&!s||o?t&&(a||s)&&!o&&(i||this.handleMono(),e.preventDefault(),e.stopPropagation()):(i||this.handleUrl(),e.preventDefault(),e.stopPropagation());break;case 192:t&&(a||s)&&!o&&(i||this.handleClear(),e.preventDefault(),e.stopPropagation())}},this.handleSendPhoto=e=>{if(!e)return;const t={"@type":"inputMessagePhoto",photo:{"@type":"inputFileBlob",name:e.name,data:e},width:e.photoWidth,height:e.photoHeight};this.sendMessage(t,!0,t=>{const a=Nt.a.get(t.chat_id,t.id);null!=a&&this.handleSendingMessage(a,e),ft.a.uploadFile(t.content.photo.sizes[0].photo.id,t)})},this.handleSendPoll=e=>{this.sendMessage(e,!0,()=>{})},this.handleSendDocument=e=>{if(!e)return;const t={"@type":"inputMessageDocument",document:{"@type":"inputFileBlob",name:e.name,data:e}};this.sendMessage(t,!0,e=>ft.a.uploadFile(e.content.document.document.id,e))},this.handlePaste=e=>{const t=(e.clipboardData||e.originalEvent.clipboardData).items,a=[];for(let s=0;s<t.length;s++)0===t[s].kind.indexOf("file")&&a.push(t[s].getAsFile());if(a.length>0)return e.preventDefault(),void this.setState({files:a});const n=e.clipboardData.getData("text/plain");return n?(e.preventDefault(),void document.execCommand("insertText",!1,n)):void 0},this.handlePasteConfirm=()=>{const e=this.state.files;e&&e.length&&(e.forEach(e=>{this.handleSendDocument(e)}),this.handlePasteCancel())},this.handlePasteCancel=()=>{this.setState({files:null})},this.handleUpdateDraftConfirm=()=>{this.state.newDraft&&(this.loadDraft(),this.handleUpdateDraftCancel())},this.handleUpdateDraftCancel=()=>{this.setState({newDraft:null})},this.handleSendingMessage=(e,t)=>{if(e&&e.sending_state&&"messageSendingStatePending"===e.sending_state["@type"]&&e.content&&"messagePhoto"===e.content["@type"]&&e.content.photo){let a=Object(ze.l)(e.content.photo.sizes,B.F);if(!a)return;let n=a.photo;n&&n.local&&n.local.is_downloading_completed&&!n.blob&&(n.blob=t,ft.a.updatePhotoBlob(e.chat_id,e.id,n.id))}},this.sendMessage=function(){var e=Object(h.a)(d.a.mark((function e(a,n,s){var i,o,r,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.state,o=i.chatId,r=i.replyToMessageId,o){e.next=3;break}return e.abrupt("return");case 3:if(a){e.next=5;break}return e.abrupt("return");case 5:return e.prev=5,e.next=8,v.a.invokeScheduledAction("clientUpdateClearHistory chatId=".concat(o));case 8:return e.next=10,V.a.send({"@type":"sendMessage",chat_id:o,reply_to_message_id:r,input_message_content:a});case 10:c=e.sent,t.setState({replyToMessageId:0},()=>{n&&t.saveDraft()}),V.a.send({"@type":"viewMessages",chat_id:o,message_ids:[c.id]}),s(c),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(5),alert("sendMessage error "+JSON.stringify(e.t0));case 19:case"end":return e.stop()}}),e,null,[[5,16]])})));return function(t,a,n){return e.apply(this,arguments)}}(),this.handleEmojiSelect=e=>{e&&(this.restoreSelection(),document.execCommand("insertText",!1,e.native),this.handleInput())},this.handleInput=function(){var e=Object(h.a)(d.a.mark((function e(a){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.setTyping(),t.setHints();case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.openEditUrlDialog=()=>{let e="",t="";const a=this.selection,n=this.range;if(n){let a=n.startContainer;if(a===n.endContainer){const n=a.parentElement;n&&"A"===n.nodeName&&(e=n.innerText,t=n.href)}}e||!a||a.isCollapsed||(e=a.toString()),this.setState({openEditUrl:!0,defaultUrl:t,defaultText:e})},this.closeEditUrlDialog=()=>{this.setState({openEditUrl:!1},()=>{this.restoreSelection()})},this.focusInput=()=>{const e=this.newMessageRef.current;if(!e)return;if(!e.childNodes.length)return void e.focus();const t=Xt(e);if(!t)return;const a=document.createRange();a.setStart(t,t.length),a.collapse(!0);const n=window.getSelection();n.removeAllRanges(),n.addRange(a),e.focus()},this.handleCancelEditUrl=()=>{this.closeEditUrlDialog()},this.handleDoneEditUrl=(e,t)=>{this.closeEditUrlDialog(),setTimeout(()=>{const a=this.range;if(a){const n=a.startContainer,s=a.endContainer;if(n&&n===s){const a=n.parentNode;if(a&&"A"===a.nodeName){a.href=t,a.title=t,a.innerText=e;const n=a.lastChild;if(n){const e=document.createRange();e.setStart(n,n.textContent.length),e.setEnd(n,n.textContent.length);const t=document.getSelection();t.removeAllRanges(),t.addRange(e)}return}}}const n="<a href=".concat(t," title=").concat(t," rel='noopener noreferrer' target='_blank'>").concat(e,"</a>");document.execCommand("removeFormat",!1,null),document.execCommand("insertHTML",!1,n)},0)},this.handleCancelEditMedia=()=>{this.closeEditMediaDialog()},this.handleDoneEditMedia=(e,t)=>{t?this.editMessageMedia(t,()=>{}):this.editMessageCaption(e,()=>{})},this.handleHeaderClick=()=>{setTimeout(()=>this.restoreSelection(),0)},this.attachDocumentRef=s.a.createRef(),this.attachPhotoRef=s.a.createRef(),this.newMessageRef=s.a.createRef();const a=v.a.getChatId();this.state={chatId:a,replyToMessageId:Object(Ze.n)(a),editMessageId:0},document.execCommand("defaultParagraphSeparator",!1,"br")}shouldComponentUpdate(e,t){const a=this.props,n=a.theme,s=a.t,i=this.state,o=i.chatId,r=i.newDraft,c=i.files,l=i.replyToMessageId,d=i.editMessageId,h=i.openEditMedia,u=i.openEditUrl;return e.theme!==n||(e.t!==s||(t.chatId!==o||(t.newDraft!==r||(t.files!==c||(t.replyToMessageId!==l||(t.editMessageId!==d||(t.openEditUrl!==u||t.openEditMedia!==h)))))))}loadDraft(){this.setDraft(),this.setInputFocus(),this.handleInput()}saveDraft(){const e=this.state,t=e.chatId,a=e.editMessageId,n=e.replyToMessageId,s=this.newMessageRef.current;if(!s)return;let i=null;i=a?this.beforeEditText?this.beforeEditText.innerHTML:null:s.innerHTML;const o=this.getDraftMessage(t,n,i);this.setChatDraftMessage(o)}componentDidMount(){document.addEventListener("selectionchange",this.selectionChangeListener,!0),v.a.on("clientUpdateChatId",this.onClientUpdateChatId),v.a.on("clientUpdateEditMessage",this.onClientUpdateEditMessage),v.a.on("clientUpdateFocusWindow",this.onClientUpdateFocusWindow),gt.a.on("updateChatDraftMessage",this.onUpdateChatDraftMessage),Nt.a.on("clientUpdateReply",this.onClientUpdateReply),Nt.a.on("updateDeleteMessages",this.onUpdateDeleteMessages),jo.a.on("clientUpdateStickerSend",this.onClientUpdateStickerSend),this.loadDraft()}componentWillUnmount(){this.saveDraft(),v.a.off("clientUpdateChatId",this.onClientUpdateChatId),v.a.off("clientUpdateEditMessage",this.onClientUpdateEditMessage),v.a.off("clientUpdateFocusWindow",this.onClientUpdateFocusWindow),gt.a.off("updateChatDraftMessage",this.onUpdateChatDraftMessage),Nt.a.off("clientUpdateReply",this.onClientUpdateReply),Nt.a.off("updateDeleteMessages",this.onUpdateDeleteMessages),jo.a.off("clientUpdateStickerSend",this.onClientUpdateStickerSend),document.removeEventListener("selectionchange",this.selectionChangeListener,!0)}restoreDraftAndSelection(){const e=this.newMessageRef.current;if(!e)return;const t=this.beforeEditText;if(t){if(e.innerHTML=t.innerHTML,!t.range)return void this.focusInput();const a=document.getSelection();a.removeAllRanges(),a.addRange(t.range),e.focus()}else e.innerHTML=null,this.focusInput();this.handleInput()}saveDraftAndSelection(){const e=this.newMessageRef.current;e&&(this.beforeEditText={innerHTML:e.innerHTML,range:this.range})}setEditMessage(){const e=this.state,t=e.chatId,a=e.editMessageId,n=Nt.a.get(t,a);if(!n)return;const s=n.content;if(!s)return;const i=s.text,o=s.caption;if(!i&&!o)return;const r=this.newMessageRef.current;i?this.setFormattedText(i):o?this.setFormattedText(o):r.innerText=null}setFormattedText(e){const t=this.props.t,a=this.newMessageRef.current;if(!e)return void(a.innerText=null);const n=e.text,s=e.entities;try{const e=Object(Tt.p)(n,s,t);a.innerHTML=null,e.forEach(e=>{a.appendChild(e)})}catch(i){a.innerText=n}}setTyping(){const e=this.state,t=e.chatId,a=e.editMessageId,n=gt.a.get(t);if(!n)return;const s=this.newMessageRef.current;if(!s)return;const i=s.innerHTML;"<br>"!==i&&"<div><br></div>"!==i||(s.innerHTML=null),s.innerText&&(Object(Ze.V)(t)||a||(n.OutputTypingManager||(n.OutputTypingManager=new Lo(n.id))).setTyping({"@type":"chatActionTyping"}))}setHints(){const e=this.state.editMessageId,t=this.newMessageRef.current.innerText;if(!t||t.length>11||e){return void(jo.a.hint&&V.a.clientUpdate({"@type":"clientUpdateLocalStickersHint",hint:null}))}performance.now();let a=Gi()().exec(t);performance.now();if(!a||t!==a[0]){return void(jo.a.hint&&V.a.clientUpdate({"@type":"clientUpdateLocalStickersHint",hint:null}))}const n=Date.now();V.a.send({"@type":"getStickers",emoji:a[0],limit:100}).then(e=>{V.a.clientUpdate({"@type":"clientUpdateLocalStickersHint",hint:{timestamp:n,emoji:a[0],stickers:e}})}),V.a.send({"@type":"searchStickers",emoji:a[0],limit:100}).then(e=>{V.a.clientUpdate({"@type":"clientUpdateRemoteStickersHint",hint:{timestamp:n,emoji:a[0],stickers:e}})})}editMessageMedia(e,t){var a=this;return Object(h.a)(d.a.mark((function n(){var s,i,o,r;return d.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(s=a.state,i=s.chatId,o=s.editMessageId,i){n.next=3;break}return n.abrupt("return");case 3:if(o){n.next=5;break}return n.abrupt("return");case 5:if(e){n.next=7;break}return n.abrupt("return");case 7:return n.next=9,V.a.send({"@type":"editMessageMedia",chat_id:i,message_id:o,input_message_content:e});case 9:r=n.sent,t(r);case 11:case"end":return n.stop()}}),n)})))()}editMessageCaption(e,t){var a=this;return Object(h.a)(d.a.mark((function n(){var s,i,o,r;return d.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(s=a.state,i=s.chatId,o=s.editMessageId,i){n.next=3;break}return n.abrupt("return");case 3:if(o){n.next=5;break}return n.abrupt("return");case 5:if(e){n.next=7;break}return n.abrupt("return");case 7:return n.next=9,V.a.send({"@type":"editMessageCaption",chat_id:i,message_id:o,caption:e});case 9:r=n.sent,t(r);case 11:case"end":return n.stop()}}),n)})))()}editMessageText(e,t){var a=this;return Object(h.a)(d.a.mark((function n(){var s,i,o,r;return d.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(s=a.state,i=s.chatId,o=s.editMessageId,i){n.next=3;break}return n.abrupt("return");case 3:if(o){n.next=5;break}return n.abrupt("return");case 5:if(e){n.next=7;break}return n.abrupt("return");case 7:return n.prev=7,n.next=10,V.a.send({"@type":"editMessageText",chat_id:i,message_id:o,input_message_content:e});case 10:r=n.sent,t(r);case 12:return n.prev=12,n.finish(12);case 14:case"end":return n.stop()}}),n,null,[[7,,12,14]])})))()}saveSelection(){this.selection=document.getSelection(),this.range=this.selection.getRangeAt(0)}restoreSelection(){const e=this.range;if(!e)return void this.focusInput();const t=document.getSelection();t.removeAllRanges(),t.addRange(e),this.newMessageRef.current.focus()}closeEditMediaDialog(){this.setState({openEditMedia:!1},()=>{this.restoreSelection()})}render(){const e=this.props.t,t=this.state,a=t.chatId,n=t.editMessageId,i=t.replyToMessageId,o=t.files,r=(t.newDraft,t.defaultText),c=t.defaultUrl,l=t.openEditUrl,d=t.openEditMedia,h=n>0&&!Object(Tt.J)(a,n);return s.a.createElement("div",{className:"inputbox-background"},s.a.createElement("div",{className:"inputbox"},s.a.createElement("div",{className:"inputbox-bubble"},s.a.createElement(_o,{chatId:a,messageId:i,editMessageId:d?0:n,onClick:this.handleHeaderClick}),s.a.createElement("div",{className:"inputbox-wrapper"},s.a.createElement("div",{className:"inputbox-left-column"},s.a.createElement(s.a.Suspense,{fallback:s.a.createElement(J.a,{className:"inputbox-icon-button","aria-label":"Emoticon"},s.a.createElement(Zi.a,null))},s.a.createElement(Ro,{onSelect:this.handleEmojiSelect}))),s.a.createElement("div",{className:"inputbox-middle-column"},s.a.createElement("div",{id:"inputbox-message",ref:this.newMessageRef,placeholder:e(h?"Caption":"Message"),contentEditable:!0,suppressContentEditableWarning:!0,onKeyDown:this.handleKeyDown,onPaste:this.handlePaste,onInput:this.handleInput})),s.a.createElement("div",{className:"inputbox-right-column"},s.a.createElement("input",{ref:this.attachDocumentRef,className:"inputbox-attach-button",type:"file",multiple:"multiple",onChange:this.handleAttachDocumentComplete}),s.a.createElement("input",{ref:this.attachPhotoRef,className:"inputbox-attach-button",type:"file",multiple:"multiple",accept:"image/*",onChange:this.handleAttachPhotoComplete}),!Boolean(n)&&s.a.createElement($i,{chatId:a,onAttachPhoto:this.handleAttachPhoto,onAttachDocument:this.handleAttachDocument,onAttachPoll:this.handleAttachPoll})))),s.a.createElement("div",{className:"inputbox-send-button-background"},s.a.createElement(J.a,{className:"inputbox-send-button","aria-label":"Send",size:"small",onClick:this.handleSubmit},n?s.a.createElement(Ki,null):s.a.createElement(qi,null)))),!Object(Ze.W)(a)&&s.a.createElement(yo,{onSend:this.handleSendPoll}),s.a.createElement(Oo,{files:o,onConfirm:this.handlePasteConfirm,onCancel:this.handlePasteCancel}),s.a.createElement(So,{open:l,defaultText:r,defaultUrl:c,onDone:this.handleDoneEditUrl,onCancel:this.handleCancelEditUrl}),s.a.createElement(Do,{open:d,chatId:a,messageId:n,onDone:this.handleDoneEditMedia,onCancel:this.handleCancelEditMedia}))}}var Fo=Object(p.c)()(Ao);a(444);class Bo extends s.a.Component{render(){const e=this.props,t=e.command,a=e.onCommand;return s.a.createElement("div",{className:"footer-command-wrapper"},s.a.createElement("div",{className:"footer-command-actions"},s.a.createElement(Le.a,{color:"primary",className:"footer-command-button",onClick:a},t)))}}var Vo=Bo;var zo=Object(p.c)()(class extends sn{render(){const e=this.props.t,t=e(this.state.isMuted?"ChatsUnmute":"ChatsMute");return s.a.createElement(Vo,{command:t,onCommand:this.handleSetChatNotifications})}});a(445);class Ho extends s.a.Component{constructor(...e){super(...e),this.onUpdateBasicGroup=e=>{const t=this.props.chatId;Object(Ze.I)(t,e.basic_group.id)&&this.forceUpdate()},this.onUpdateSupergroup=e=>{const t=this.props.chatId;Object(Ze.J)(t,e.supergroup.id)&&this.forceUpdate()},this.handleJoin=()=>{const e=this.props.chatId;e&&V.a.send({"@type":"joinChat",chat_id:e})},this.handleDeleteAndExit=()=>{const e=this.props.chatId;e&&V.a.send({"@type":"deleteChatHistory",chat_id:e,remove_from_chat_list:!0})}}shouldComponentUpdate(e,t){const a=this.props,n=a.t,s=a.chatId;return e.chatId!==s||e.t!==n}componentDidMount(){Jt.a.on("updateBasicGroup",this.onUpdateBasicGroup),Qt.a.on("updateSupergroup",this.onUpdateSupergroup)}componentWillUnmount(){Jt.a.off("updateBasicGroup",this.onUpdateBasicGroup),Qt.a.off("updateSupergroup",this.onUpdateSupergroup)}render(){const e=this.props,t=e.chatId,a=e.t,n=gt.a.get(t);if(!n)return null;const i=n.type;if(!i)return null;switch(i["@type"]){case"chatTypeBasicGroup":{const e=Jt.a.get(i.basic_group_id);if(!e)return null;const t=e.status;if(!t)return null;const n=t.is_member,o=t.permissions;switch(t["@type"]){case"chatMemberStatusAdministrator":return s.a.createElement(Fo,null);case"chatMemberStatusBanned":return s.a.createElement(Vo,{command:a("DeleteChat"),onCommand:this.handleDeleteAndExit});case"chatMemberStatusCreator":return n?s.a.createElement(Fo,null):null;case"chatMemberStatusLeft":return null;case"chatMemberStatusMember":return s.a.createElement(Fo,null);case"chatMemberStatusRestricted":return n?o&&o.can_send_messages?s.a.createElement(Fo,null):null:s.a.createElement(Vo,{command:a("JoinGroup"),onCommand:this.handleJoin})}break}case"chatTypePrivate":case"chatTypeSecret":return s.a.createElement(Fo,null);case"chatTypeSupergroup":{const e=Qt.a.get(i.supergroup_id);if(!e)return null;const n=e.is_channel,o=e.status;if(!o)return null;const r=o.is_member,c=o.permissions;switch(o["@type"]){case"chatMemberStatusAdministrator":return s.a.createElement(Fo,null);case"chatMemberStatusBanned":return s.a.createElement(Vo,{command:a("DeleteChat"),onCommand:this.handleDeleteAndExit});case"chatMemberStatusCreator":return r?s.a.createElement(Fo,null):null;case"chatMemberStatusLeft":return s.a.createElement(Vo,{command:a(n?"ChannelJoin":"JoinGroup"),onCommand:this.handleJoin});case"chatMemberStatusMember":return n?s.a.createElement(zo,{chatId:t}):s.a.createElement(Fo,null);case"chatMemberStatusRestricted":return r?c&&c.can_send_messages?s.a.createElement(Fo,null):null:s.a.createElement(Vo,{command:a(n?"ChannelJoin":"JoinGroup"),onCommand:this.handleJoin})}}}return null}}var Wo=Object(p.c)()(Ho),Go=a(125),Ko=a(272);a(446);class Zo extends s.a.Component{constructor(e){super(e),this.handleTimer=()=>{const e=new Date,t=this.expire-e,a=100-t/this.props.timeout*100;this.setState({seconds:t>0?t:0,value:a>100?100:a}),e>=this.expire&&this.timerId&&(clearInterval(this.timerId),this.timerId=null)},this.state={seconds:this.props.timeout/1e3,value:0}}componentDidMount(){this.startTime=new Date,this.expire=this.startTime,this.expire.setMilliseconds(this.expire.getMilliseconds()+this.props.timeout),this.timerId=setInterval(this.handleTimer,100)}componentWillUnmount(){this.timerId&&(clearInterval(this.timerId),this.timerId=null)}render(){const e=this.state,t=e.value,a=e.seconds;return s.a.createElement("div",{className:"notification-timer"},s.a.createElement("div",{className:"notification-timer-text"},s.a.createElement(to.a,{color:"inherit"},(a/1e3).toFixed())),s.a.createElement("div",{className:"notification-timer-progress"},s.a.createElement(Ko.a,{size:32,value:100-t,variant:"static"})))}}var qo=Zo;a(447);class Yo extends s.a.Component{constructor(...e){super(...e),this.getDeleteDialogText=(e,t)=>{const a=gt.a.get(e);if(!a)return null;if(!a.type)return null;switch(a.type["@type"]){case"chatTypeBasicGroup":return"Are you sure you want to leave group ".concat(a.title,"?");case"chatTypeSupergroup":{const e=Qt.a.get(a.type.supergroup_id);return e?e.is_channel?"Are you sure you want to leave channel ".concat(a.title,"?"):"Are you sure you want to leave group ".concat(a.title,"?"):null}case"chatTypePrivate":case"chatTypeSecret":return"Are you sure you want to delete chat with ".concat(Object(Ze.r)(e,!1,t),"?")}return null}}render(){const e=this.props,t=e.onClose,a=e.chatId,n=e.t,i=Object(Go.a)(e,["onClose","chatId","t"]);return s.a.createElement(M.a,Object.assign({transitionDuration:0,onClose:()=>t(!1),"aria-labelledby":"delete-dialog-title"},i),s.a.createElement(O.a,{id:"delete-dialog-title"},Object(Ze.r)(a,!1,n)),s.a.createElement(_.a,null,s.a.createElement("div",{className:"delete-dialog-content"},s.a.createElement(Ct,{chatId:a}),s.a.createElement(x.a,{id:"delete-dialog-description"},this.getDeleteDialogText(a,n)))),s.a.createElement(I.a,null,s.a.createElement(w.a,{onClick:()=>t(!1),color:"primary"},"Cancel"),s.a.createElement(w.a,{onClick:()=>t(!0),color:"primary",autoFocus:!0},"Ok")))}}const Jo=Object(p.c)()(Yo);class Qo extends s.a.Component{render(){const e=this.props,t=e.onClose,a=e.chatId,n=e.t,i=Object(Go.a)(e,["onClose","chatId","t"]);return s.a.createElement(M.a,Object.assign({transitionDuration:0,onClose:()=>t(!1),"aria-labelledby":"delete-dialog-title"},i),s.a.createElement(O.a,{id:"delete-dialog-title"},Object(Ze.r)(a,!1,n)),s.a.createElement(_.a,null,s.a.createElement("div",{className:"delete-dialog-content"},s.a.createElement(Ct,{chatId:a}),s.a.createElement(x.a,{id:"delete-dialog-description"},"Are you sure you want clear history?"))),s.a.createElement(I.a,null,s.a.createElement(w.a,{onClick:()=>t(!1),color:"primary"},"Cancel"),s.a.createElement(w.a,{onClick:()=>t(!0),color:"primary",autoFocus:!0},"Ok")))}}const Xo=Object(p.c)()(Qo);class $o extends s.a.Component{constructor(e){super(e),this.handleButtonClick=e=>{this.setState({anchorEl:e.currentTarget})},this.handleMenuClose=()=>{this.setState({anchorEl:null})},this.handleChatInfo=()=>{this.handleMenuClose(),setTimeout(()=>this.props.openChatDetails(),150)},this.handleClearHistory=()=>{this.handleMenuClose(),this.setState({openClearHistory:!0})},this.handleClearHistoryContinue=e=>{if(this.setState({openClearHistory:!1}),!e)return;const t=v.a.getChatId(),a={"@type":"deleteChatHistory",chat_id:t,remove_from_chat_list:!1};this.handleScheduledAction(t,"clientUpdateClearHistory","Messages deleted",a)},this.handleLeave=()=>{this.handleMenuClose(),this.setState({openDelete:!0})},this.handleLeaveContinue=e=>{if(this.setState({openDelete:!1}),!e)return;const t=v.a.getChatId(),a=this.getLeaveChatNotification(t),n=Object(Ze.W)(t)?{"@type":"deleteChatHistory",chat_id:t,remove_from_chat_list:!0}:{"@type":"leaveChat",chat_id:t};this.handleScheduledAction(t,"clientUpdateLeaveChat",a,n)},this.handleScheduledAction=(e,t,a,n)=>{const i=this.props.t;if(!t)return;const o="".concat(t," chatId=").concat(e),r=function(){var a=Object(h.a)(d.a.mark((function a(){return d.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,V.a.send(n);case 3:return a.prev=3,V.a.clientUpdate({"@type":t,chatId:e,inProgress:!1}),a.finish(3);case 6:case"end":return a.stop()}}),a,null,[[0,,3,6]])})));return function(){return a.apply(this,arguments)}}(),c=this.props.enqueueSnackbar;if(!c)return;v.a.addScheduledAction(o,B.y,r,()=>{V.a.clientUpdate({"@type":t,chatId:e,inProgress:!1})})&&(V.a.clientUpdate({"@type":t,chatId:e,inProgress:!0}),c(a,{autoHideDuration:B.y-300,action:[s.a.createElement(J.a,{key:"progress",color:"inherit",className:"progress-button"},s.a.createElement(qo,{timeout:B.y})),s.a.createElement(w.a,{key:"undo",color:"primary",size:"small",onClick:()=>v.a.removeScheduledAction(o)},i("Undo"))]}))},this.getLeaveChatTitle=(e,t)=>{const a=gt.a.get(e);if(!a)return null;if(!a.type)return null;switch(a.type["@type"]){case"chatTypeBasicGroup":return t("DeleteChat");case"chatTypeSupergroup":{const e=Qt.a.get(a.type.supergroup_id);return e?e.is_channel?t("LeaveChannel"):t("LeaveMegaMenu"):null}case"chatTypePrivate":case"chatTypeSecret":return t("DeleteChatUser")}return null},this.getLeaveChatNotification=e=>{const t=this.props.t,a=gt.a.get(e);if(!a)return t("ChatDeletedUndo");if(!a.type)return t("ChatDeletedUndo");switch(a.type["@type"]){case"chatTypeBasicGroup":return t("ChatDeletedUndo");case"chatTypeSupergroup":{const e=Qt.a.get(a.type.supergroup_id);return e?e.is_channel?"Left channel":"Left group":t("ChatDeletedUndo")}case"chatTypePrivate":case"chatTypeSecret":return t("ChatDeletedUndo")}return t("ChatDeletedUndo")},this.handleUnpin=()=>{this.handleMenuClose();const e=v.a.getChatId();V.a.clientUpdate({"@type":"clientUpdateUnpin",chatId:e})},this.state={anchorEl:null,openDelete:!1,openClearHistory:!1}}render(){const e=this.props.t,t=this.state,a=t.anchorEl,n=t.openDelete,i=t.openClearHistory,o=v.a.getChatId(),r=Object(Ze.a)(o),c=Object(Ze.b)(o),l=this.getLeaveChatTitle(o,e),d=Object(Ze.h)(o);return s.a.createElement(s.a.Fragment,null,s.a.createElement(J.a,{"aria-owns":a?"simple-menu":null,"aria-haspopup":"true",className:"main-menu-button","aria-label":"Menu",onClick:this.handleButtonClick},s.a.createElement(Ws,null)),s.a.createElement(ws.a,{id:"main-menu",anchorEl:a,open:Boolean(a),onClose:this.handleMenuClose,getContentAnchorEl:null,disableAutoFocusItem:!0,disableRestoreFocus:!0,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"}},s.a.createElement(it.a,{onClick:this.handleChatInfo},e("ChatInfo")),r&&s.a.createElement(it.a,{onClick:this.handleClearHistory},e("ClearHistory")),c&&l&&s.a.createElement(it.a,{onClick:this.handleLeave},l),d&&s.a.createElement(it.a,{onClick:this.handleUnpin},e("Unpin"))),s.a.createElement(Jo,{chatId:o,open:n,onClose:this.handleLeaveContinue}),s.a.createElement(Xo,{chatId:o,open:i,onClose:this.handleClearHistoryContinue}))}}var er=Object(u.a)(ra.withSnackbar,Object(p.c)())($o);a(448);class tr extends s.a.Component{constructor(...e){super(...e),this.onUpdateChatOnlineMemberCount=e=>{this.props.chatId===e.chat_id&&this.forceUpdate()},this.onUpdateChatTitle=e=>{this.props.chatId===e.chat_id&&this.forceUpdate()},this.onUpdateUserChatAction=e=>{this.props.chatId===e.chat_id&&this.forceUpdate()},this.onUpdateUserStatus=e=>{const t=this.props.chatId,a=gt.a.get(t);if(a&&a.type)switch(a.type["@type"]){case"chatTypeBasicGroup":{const t=Jt.a.getFullInfo(a.type.basic_group_id);if(t&&t.members){t.members.find(t=>t.user_id===e.user_id)&&this.forceUpdate()}break}case"chatTypePrivate":case"chatTypeSecret":a.type.user_id===e.user_id&&this.forceUpdate()}},this.onUpdateUserFullInfo=e=>{const t=this.props.chatId,a=gt.a.get(t);a&&a.type&&("chatTypePrivate"!==a.type["@type"]&&"chatTypeSecret"!==a.type["@type"]||a.type.user_id!==e.user_id||this.forceUpdate())},this.onUpdateBasicGroupFullInfo=e=>{const t=this.props.chatId,a=gt.a.get(t);a&&a.type&&"chatTypeBasicGroup"===a.type["@type"]&&a.type.basic_group_id===e.basic_group_id&&this.forceUpdate()},this.onUpdateSupergroupFullInfo=e=>{const t=this.props.chatId,a=gt.a.get(t);a&&a.type&&"chatTypeSupergroup"===a.type["@type"]&&a.type.supergroup_id===e.supergroup_id&&this.forceUpdate()},this.onUpdateBasicGroup=e=>{const t=this.props.chatId,a=gt.a.get(t);a&&a.type&&"chatTypeBasicGroup"===a.type["@type"]&&a.type.basic_group_id===e.basic_group.id&&this.forceUpdate()},this.onUpdateSupergroup=e=>{const t=this.props.chatId,a=gt.a.get(t);a&&a.type&&"chatTypeSupergroup"===a.type["@type"]&&a.type.supergroup_id===e.supergroup.id&&this.forceUpdate()}}componentDidMount(){gt.a.on("updateChatOnlineMemberCount",this.onUpdateChatOnlineMemberCount),gt.a.on("updateChatTitle",this.onUpdateChatTitle),ht.a.on("updateUserStatus",this.onUpdateUserStatus),gt.a.on("updateUserChatAction",this.onUpdateUserChatAction),ht.a.on("updateUserFullInfo",this.onUpdateUserFullInfo),Jt.a.on("updateBasicGroupFullInfo",this.onUpdateBasicGroupFullInfo),Qt.a.on("updateSupergroupFullInfo",this.onUpdateSupergroupFullInfo),Jt.a.on("updateBasicGroup",this.onUpdateBasicGroup),Qt.a.on("updateSupergroup",this.onUpdateSupergroup)}componentWillUnmount(){gt.a.off("updateChatOnlineMemberCount",this.onUpdateChatOnlineMemberCount),gt.a.off("updateChatTitle",this.onUpdateChatTitle),ht.a.off("updateUserStatus",this.onUpdateUserStatus),gt.a.off("updateUserChatAction",this.onUpdateUserChatAction),ht.a.off("updateUserFullInfo",this.onUpdateUserFullInfo),Jt.a.off("updateBasicGroupFullInfo",this.onUpdateBasicGroupFullInfo),Qt.a.off("updateSupergroupFullInfo",this.onUpdateSupergroupFullInfo),Jt.a.off("updateBasicGroup",this.onUpdateBasicGroup),Qt.a.off("updateSupergroup",this.onUpdateSupergroup)}render(){const e=this.props.chatId,t=Object(Ze.s)(e,!0),a=Object(Ze.K)(e);return s.a.createElement("div",{className:q()("header-chat-subtitle",{"header-chat-subtitle-accent":a})},t)}}var ar=tr;a(449);class nr extends s.a.Component{render(){const e=this.props,t=e.className,a=e.chatId,n=e.onClick;return s.a.createElement("div",{className:q()("header-chat",t),onClick:n},s.a.createElement(Ct,{chatId:a,size:44}),s.a.createElement("div",{className:"header-chat-content"},s.a.createElement(It,{chatId:a}),s.a.createElement(ar,{chatId:a})))}}var sr=nr;a(450);class ir extends s.a.Component{constructor(...e){super(...e),this.handleCancel=()=>{Object(nt.a)()},this.handleDelete=()=>{let e=0,t=[];var a=!0,n=!1,s=void 0;try{for(var i,o=Nt.a.selectedItems.values()[Symbol.iterator]();!(a=(i=o.next()).done);a=!0){let a=i.value,n=a.chatId,s=a.messageId;e=n,t.push(s)}}catch(r){n=!0,s=r}finally{try{a||null==o.return||o.return()}finally{if(n)throw s}}Object(nt.c)(e,t)},this.handleForward=()=>{let e;const t=[];var a=!0,n=!1,s=void 0;try{for(var i,o=Nt.a.selectedItems.values()[Symbol.iterator]();!(a=(i=o.next()).done);a=!0){let a=i.value,n=a.chatId,s=a.messageId;e=n,t.push(s)}}catch(r){n=!0,s=r}finally{try{a||null==o.return||o.return()}finally{if(n)throw s}}Object(nt.e)(e,t)}}render(){const e=this.props,t=e.t,a=e.count;let n=!0;var i=!0,o=!1,r=void 0;try{for(var c,l=Nt.a.selectedItems.values()[Symbol.iterator]();!(i=(c=l.next()).done);i=!0){let e=c.value,t=e.chatId,a=e.messageId;const s=Nt.a.get(t,a);if(!s){n=!1;break}if(!s.can_be_deleted_only_for_self&&!s.can_be_deleted_for_all_users){n=!1;break}}}catch(f){o=!0,r=f}finally{try{i||null==l.return||l.return()}finally{if(o)throw r}}let d=!0;var h=!0,u=!1,p=void 0;try{for(var m,g=Nt.a.selectedItems.values()[Symbol.iterator]();!(h=(m=g.next()).done);h=!0){let e=m.value,t=e.chatId,a=e.messageId;const n=Nt.a.get(t,a);if(!n){d=!1;break}if(!n.can_be_forwarded){d=!1;break}}}catch(f){u=!0,p=f}finally{try{h||null==g.return||g.return()}finally{if(u)throw p}}return s.a.createElement("div",{className:"header-command"},d&&s.a.createElement(w.a,{color:"primary",className:"header-command-button",onClick:this.handleForward},a<=1?t("Forward"):"".concat(t("Forward")," ").concat(a)),n&&s.a.createElement(w.a,{color:"primary",className:"header-command-button",onClick:this.handleDelete},a<=1?t("Delete"):"".concat(t("Delete")," ").concat(a)),s.a.createElement("div",{className:"header-command-space"}),s.a.createElement(w.a,{color:"primary",className:"header-command-button",onClick:this.handleCancel},t("Cancel")))}}var or=Object(p.c)()(ir);a(451);class rr extends s.a.Component{constructor(e){var t;super(e),t=this,this.onClientUpdateUnpin=e=>{const t=e.chatId;this.props.chatId===t&&this.handleDelete()},this.onClientUpdateDialogsReady=e=>{this.state.messageId&&this.loadContent()},this.onClientUpdateSetChatClientData=e=>{const t=e.chatId,a=e.clientData;this.props.chatId===t&&this.setState({clientData:a})},this.onUpdateChatPinnedMessage=e=>{const t=e.chat_id,a=e.pinned_message_id;this.props.chatId===t&&this.setState({messageId:a})},this.loadContent=()=>{const e=this.props.chatId,t=this.state.messageId;e&&t&&(Nt.a.get(e,t)||V.a.send({"@type":"getMessage",chat_id:e,message_id:t}).then(e=>{Nt.a.set(e);const t=ft.a.getStore();Object(mt.t)(t,[e]),this.forceUpdate()}).catch(a=>{a.code;if("Chat not found"!==a.message){const a={"@type":"deletedMessage",chat_id:e,id:t,content:null};Nt.a.set(a),this.forceUpdate()}}))},this.handleClick=e=>{const t=this.props.chatId,a=this.state.messageId;a&&Object(nt.h)(t,a)},this.handleDelete=function(){var e=Object(h.a)(d.a.mark((function e(a){var n,s,i;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a&&(a.preventDefault(),a.stopPropagation()),n=t.props.chatId,s=t.state.messageId,!Object(Ze.c)(n)){e.next=8;break}t.setState({confirm:!0}),e.next=11;break;case 8:return i=gt.a.getClientData(n),e.next=11,V.a.clientUpdate({"@type":"clientUpdateSetChatClientData",chatId:n,clientData:Object.assign({},i,{unpinned_message_id:s})});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleUnpin=Object(h.a)(d.a.mark((function e(){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.props.chatId,t.handleClose(),V.a.send({"@type":"unpinChatMessage",chat_id:a});case 3:case"end":return e.stop()}}),e)}))),this.handleClose=()=>{this.setState({confirm:!1})},this.state={}}static getDerivedStateFromProps(e,t){const a=t.prevPropsChatId,n=e.chatId;if(a!==n){const e=gt.a.get(n);return{prevPropsChatId:n,clientData:gt.a.getClientData(n),messageId:e&&e.pinned_message_id?e.pinned_message_id:0,confirm:!1}}return null}componentDidUpdate(e,t,a){const n=this.state.messageId;n&&t.messageId!==n&&this.loadContent()}componentDidMount(){this.loadContent(),v.a.on("clientUpdateDialogsReady",this.onClientUpdateDialogsReady),gt.a.on("clientUpdateSetChatClientData",this.onClientUpdateSetChatClientData),gt.a.on("clientUpdateUnpin",this.onClientUpdateUnpin),gt.a.on("updateChatPinnedMessage",this.onUpdateChatPinnedMessage)}componentWillUnmount(){v.a.off("clientUpdateDialogsReady",this.onClientUpdateDialogsReady),gt.a.off("clientUpdateSetChatClientData",this.onClientUpdateSetChatClientData),gt.a.off("clientUpdateUnpin",this.onClientUpdateUnpin),gt.a.off("updateChatPinnedMessage",this.onUpdateChatPinnedMessage)}shouldComponentUpdate(e,t,a){const n=this.props,s=n.chatId,i=n.t,o=n.theme,r=this.state,c=r.clientData,l=r.confirm,d=r.messageId;return e.t!==i||(e.theme!==o||(e.chatId!==s||(t.clientData!==c||(t.confirm!==l||t.messageId!==d))))}render(){const e=this.props,t=e.chatId,a=e.t,n=this.state,i=n.messageId,o=n.confirm;if(!t)return null;if(gt.a.getClientData(t).unpinned_message_id===i)return null;const r=Nt.a.get(t,i);if(!r)return null;let c=r?Object(Tt.f)(r,a):a("Loading");const l=Object(Tt.r)(t,i),d=Object(Tt.q)(t,i);return Object(Tt.B)(r)&&(c=a("DeletedMessage")),s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"pinned-message",onMouseDown:this.handleClick},s.a.createElement("div",{className:"border reply-border"}),l&&s.a.createElement(ko,{chatId:t,messageId:i,photoSize:l,minithumbnail:d}),s.a.createElement("div",{className:"pinned-message-content"},s.a.createElement("div",{className:"pinned-message-title"},a("PinnedMessage")),s.a.createElement("div",{className:"pinned-message-subtitle"},c))),o&&s.a.createElement(M.a,{transitionDuration:0,open:!0,onClose:this.handleClose,"aria-labelledby":"unpin-message-confirmation"},s.a.createElement(O.a,{id:"unpin-message-confirmation"},a("Confirm")),s.a.createElement(_.a,null,s.a.createElement(x.a,null,a("UnpinMessageAlert"))),s.a.createElement(I.a,null,s.a.createElement(w.a,{onClick:this.handleClose,color:"primary"},a("Cancel")),s.a.createElement(w.a,{onClick:this.handleUnpin,color:"primary"},a("Ok")))))}}var cr=Object(p.c)()(rr);class lr extends n.Component{constructor(e){super(e),this.onClientUpdateDeleteMessages=e=>{const t=e.chatId,a=e.messageIds;let n=!0;var s=!0,i=!1,o=void 0;try{for(var r,c=a[Symbol.iterator]();!(s=(r=c.next()).done);s=!0){let e=r.value;const a=Nt.a.get(t,e);if(!a){n=!1;break}if(!a.can_be_deleted_for_all_users){n=!1;break}}}catch(l){i=!0,o=l}finally{try{s||null==c.return||c.return()}finally{if(i)throw o}}this.setState({openDeleteDialog:!0,chatId:t,messageIds:a,canBeDeletedForAllUsers:n,revoke:n})},this.handleRevokeChange=()=>{this.setState({revoke:!this.state.revoke})},this.handleCloseDelete=()=>{this.setState({openDeleteDialog:!1})},this.handleDeleteContinue=()=>{const e=this.state,t=e.revoke,a=e.chatId,n=e.messageIds;Object(nt.a)(),this.handleCloseDelete(),V.a.send({"@type":"deleteMessages",chat_id:a,message_ids:n,revoke:t})},this.onClientUpdateMessageSelected=e=>{this.setState({selectionCount:Nt.a.selectedItems.size})},this.onClientUpdateChatId=e=>{this.forceUpdate()},this.onUpdateConnectionState=e=>{this.setState({connectionState:e.state})},this.onUpdateAuthorizationState=e=>{this.setState({authorizationState:e.authorization_state})},this.openChatDetails=()=>{const e=v.a.getChatId();gt.a.get(e)&&v.a.changeChatDetailsVisibility(!0)},this.handleSearchChat=()=>{const e=v.a.getChatId();gt.a.get(e)&&Object(nt.l)(e)},this.localize=e=>(0,this.props.t)(e).replace("...","").replace("\u2026",""),this.state={authorizationState:v.a.getAuthorizationState(),connectionState:v.a.getConnectionState(),openDeleteDialog:!1}}shouldComponentUpdate(e,t){return t!==this.state||(e.theme!==this.props.theme||e.t!==this.props.t)}componentDidMount(){v.a.on("clientUpdateChatId",this.onClientUpdateChatId),v.a.on("clientUpdateDeleteMessages",this.onClientUpdateDeleteMessages),v.a.on("updateAuthorizationState",this.onUpdateAuthorizationState),v.a.on("updateConnectionState",this.onUpdateConnectionState),Nt.a.on("clientUpdateClearSelection",this.onClientUpdateMessageSelected),Nt.a.on("clientUpdateMessageSelected",this.onClientUpdateMessageSelected)}componentWillUnmount(){v.a.off("clientUpdateChatId",this.onClientUpdateChatId),v.a.off("clientUpdateDeleteMessages",this.onClientUpdateDeleteMessages),v.a.off("updateAuthorizationState",this.onUpdateAuthorizationState),v.a.off("updateConnectionState",this.onUpdateConnectionState),Nt.a.off("clientUpdateClearSelection",this.onClientUpdateMessageSelected),Nt.a.off("clientUpdateMessageSelected",this.onClientUpdateMessageSelected)}render(){const e=this.props.t,t=this.state,a=t.authorizationState,n=t.connectionState,i=t.selectionCount,o=t.openDeleteDialog,r=t.canBeDeletedForAllUsers,c=t.revoke,l=t.messageIds,d=l?l.length:0;let h=null;i&&(h=s.a.createElement(or,{count:i}));const u=v.a.getChatId(),p=gt.a.get(u),m=Object(Ze.K)(u);let g=Object(Ze.u)(u,!0,e),f=Object(Ze.s)(u,!0),b=!1;if(n)switch(n["@type"]){case"connectionStateConnecting":g=this.localize("Connecting"),f="",b=!0;break;case"connectionStateConnectingToProxy":g=this.localize("Connecting to proxy"),f="",b=!0;break;case"connectionStateReady":break;case"connectionStateUpdating":g=this.localize("Updating"),f="",b=!0;break;case"connectionStateWaitingForNetwork":g=this.localize("Waiting for network"),f="",b=!0}else if(a)switch(a["@type"]){case"authorizationStateClosed":case" authorizationStateClosing":break;case"authorizationStateLoggingOut":g=this.localize("Logging out"),f="",b=!0;break;case"authorizationStateReady":case"authorizationStateWaitCode":break;case"authorizationStateWaitEncryptionKey":g=this.localize("Loading"),f="",b=!0;break;case"authorizationStateWaitPassword":case"authorizationStateWaitPhoneNumber":break;case"authorizationStateWaitTdlibParameters":g=this.localize("Loading"),f="",b=!0}else g=this.localize("Loading"),f="",b=!0;return h=h||s.a.createElement("div",{className:"header-details"},b?s.a.createElement("div",{className:q()("header-status","grow",p?"cursor-pointer":"cursor-default"),onClick:this.openChatDetails},s.a.createElement("span",{className:"header-status-content"},g),s.a.createElement(te,null),s.a.createElement("span",{className:q()("header-status-title",{"header-status-accent":m})},f),s.a.createElement("span",{className:"header-status-tail"})):s.a.createElement(sr,{className:q()("grow","cursor-pointer"),chatId:u,onClick:this.openChatDetails}),s.a.createElement(cr,{chatId:u}),p&&s.a.createElement(s.a.Fragment,null,s.a.createElement(J.a,{className:"header-right-second-button","aria-label":"Search",onClick:this.handleSearchChat},s.a.createElement(et,null)),s.a.createElement(er,{openChatDetails:this.openChatDetails}))),s.a.createElement(s.a.Fragment,null,h,s.a.createElement(M.a,{transitionDuration:0,open:o,onClose:this.handleCloseDelete,"aria-labelledby":"delete-dialog-title"},s.a.createElement(O.a,{id:"delete-dialog-title"},"Confirm"),s.a.createElement(_.a,null,s.a.createElement(x.a,null,1===d?"Are you sure you want to delete 1 message?":"Are you sure you want to delete ".concat(d," messages?")),r&&s.a.createElement(Un.a,{control:s.a.createElement(se.a,{checked:c,onChange:this.handleRevokeChange,color:"primary"}),label:Object(Ze.W)(u)?"Delete for ".concat(Object(Ze.r)(u,!1,e)):"Delete for all"})),s.a.createElement(I.a,null,s.a.createElement(w.a,{onClick:this.handleCloseDelete,color:"primary"},e("Cancel")),s.a.createElement(w.a,{onClick:this.handleDeleteContinue,color:"primary"},e("Ok")))))}}var dr=Object(p.c)()(lr),hr=a(115),ur=a(134),pr=a(263),mr=a.n(pr),gr=a(262),fr=a.n(gr),br=a(257),Cr=a.n(br),yr=a(258),vr=a.n(yr),Er=a(259),Sr=a.n(Er),Ur=a(153),kr=a.n(Ur),wr=a(552),Mr=a(18);a(452);class Ir extends s.a.Component{constructor(...e){super(...e),this.state={anchorEl:null,value:Mr.b.volume,prevValue:Mr.b.volume,dragging:!1,buttonOver:!1,popupOver:!1},this.onClientUpdateMediaVolume=e=>{const t=e.volume,a=e.prevVolume;void 0===a?this.setState({value:t}):this.setState({value:t,prevValue:a})},this.handlePopoverOpen=e=>{this.setState({anchorEl:e})},this.handlePopoverClose=()=>{const e=this.state,t=e.dragging,a=e.buttonOver,n=e.popupOver;t||a||n||this.setState({anchorEl:null})},this.handleMouseEnter=(e,t)=>{this.setState({buttonOver:!0}),t&&this.handlePopoverOpen(e.currentTarget)},this.handleMouseLeave=()=>{this.setState({buttonOver:!1},()=>{this.handlePopoverClose()})},this.handlePopupMouseLeave=()=>{this.setState({popupOver:!1},()=>{this.handlePopoverClose()})},this.handleVoiceClick=()=>{const e=this.state,t=e.value,a=e.prevValue,n=t>0?0:a||B.L;V.a.clientUpdate({"@type":"clientUpdateMediaVolume",volume:n})},this.handleChange=(e,t)=>{const a=this.state,n=a.dragging,s=a.prevValue;n?V.a.clientUpdate({"@type":"clientUpdateMediaVolume",volume:t}):V.a.clientUpdate({"@type":"clientUpdateMediaVolume",prevVolume:t>0?t:s,volume:t})},this.handleDragStart=()=>{const e=this.state.value;this.setState({dragging:!0,prevValue:e})},this.handleDragEnd=()=>{const e=this.state,t=e.value,a=e.prevValue;this.setState({dragging:!1,prevValue:t>0?t:a},()=>{this.handlePopoverClose()})},this.getVolumeIcon=e=>0===e?s.a.createElement(kr.a,{fontSize:"small"}):e<.25?s.a.createElement(Cr.a,{fontSize:"small"}):e<.5?s.a.createElement(vr.a,{fontSize:"small"}):s.a.createElement(Sr.a,{fontSize:"small"})}componentDidMount(){Mr.b.on("clientUpdateMediaVolume",this.onClientUpdateMediaVolume)}componentWillUnmount(){Mr.b.off("clientUpdateMediaVolume",this.onClientUpdateMediaVolume)}render(){const e=this.state,t=e.anchorEl,a=e.value,n=Boolean(t);return s.a.createElement("div",{onMouseEnter:e=>this.handleMouseEnter(e,!0),onMouseLeave:this.handleMouseLeave,style:{position:"relative",background:"transparent"}},s.a.createElement(J.a,{className:"header-player-button",color:"primary",onClick:this.handleVoiceClick},this.getVolumeIcon(a)),s.a.createElement("div",{style:{position:"absolute",background:"transparent",visibility:n?"visible":"hidden",zIndex:1},onMouseEnter:e=>this.handleMouseEnter(e,!1),onMouseLeave:this.handlePopupMouseLeave},s.a.createElement("div",{className:"volume-button-panel"},s.a.createElement(wr.a,{min:0,max:1,step:.01,value:a,onChange:this.handleChange,onDragStart:this.handleDragStart,onDragEnd:this.handleDragEnd,orientation:"vertical"}))))}}var _r=Ir,xr=a(182),Or=a.n(xr),Pr=a(260),Tr=a.n(Pr);class Nr extends s.a.Component{constructor(e){super(e),this.onClientUpdateMediaRepeat=e=>{const t=e.repeat;this.setState({repeat:t})},this.handleRepeat=()=>{const e=this.state.repeat;let t=e;switch(e){case Mr.a.NONE:t=Mr.a.REPEAT;break;case Mr.a.REPEAT:t=Mr.a.REPEAT_ONE;break;case Mr.a.REPEAT_ONE:t=Mr.a.NONE}V.a.clientUpdate({"@type":"clientUpdateMediaRepeat",repeat:t})},this.getIcon=e=>{switch(e){case Mr.a.NONE:case Mr.a.REPEAT:return s.a.createElement(Or.a,{fontSize:"small"});case Mr.a.REPEAT_ONE:return s.a.createElement(Tr.a,{fontSize:"small"});default:return s.a.createElement(Or.a,{fontSize:"small"})}};const t=Mr.b.repeat;this.state={repeat:t}}componentDidMount(){Mr.b.on("clientUpdateMediaRepeat",this.onClientUpdateMediaRepeat)}componentWillUnmount(){Mr.b.off("clientUpdateMediaRepeat",this.onClientUpdateMediaRepeat)}render(){const e=this.state.repeat;return s.a.createElement(J.a,{className:"header-player-button",color:e===Mr.a.NONE?"default":"primary",onClick:this.handleRepeat},this.getIcon(e))}}var Dr=Nr,Lr=a(261),jr=a.n(Lr);class Rr extends s.a.Component{constructor(e){super(e),this.onClientUpdateMediaShuffle=e=>{const t=e.shuffle;this.setState({shuffle:t})},this.handleShuffle=()=>{const e=this.state.shuffle;V.a.clientUpdate({"@type":"clientUpdateMediaShuffle",shuffle:!e})};const t=Mr.b.shuffle;this.state={shuffle:t}}componentDidMount(){Mr.b.on("clientUpdateMediaShuffle",this.onClientUpdateMediaShuffle)}componentWillUnmount(){Mr.b.off("clientUpdateMediaShuffle",this.onClientUpdateMediaShuffle)}render(){const e=this.state.shuffle;return s.a.createElement(J.a,{className:"header-player-button",color:e?"primary":"default",onClick:this.handleShuffle},s.a.createElement(jr.a,{fontSize:"small"}))}}var Ar=Rr;class Fr extends s.a.Component{constructor(e){super(e),this.onClientUpdateMediaPlaybackRate=e=>{const t=e.playbackRate;this.setState({playbackRate:t})},this.handlePlaybackRate=()=>{const e=this.state.playbackRate===B.I?B.H:B.I;V.a.clientUpdate({"@type":"clientUpdateMediaPlaybackRate",playbackRate:e})};const t=Mr.b.playbackRate;this.state={playbackRate:t}}componentDidMount(){Mr.b.on("clientUpdateMediaPlaybackRate",this.onClientUpdateMediaPlaybackRate)}componentWillUnmount(){Mr.b.off("clientUpdateMediaPlaybackRate",this.onClientUpdateMediaPlaybackRate)}render(){const e=this.state.playbackRate;return s.a.createElement(J.a,{className:"header-player-button",color:e>B.I?"primary":"default",onClick:this.handlePlaybackRate},s.a.createElement("div",{className:"header-player-playback-icon"},"2X"))}}var Br=Fr;class Vr extends s.a.Component{constructor(e){super(e),this.onClientUpdateMediaTime=e=>{const t=e.currentTime;this.setState({currentTime:t,currentTimeString:Object(ze.e)(Math.floor(t||0))})},this.getTimeString=(e,t)=>{Object(ze.e)(Math.floor(t||0));return Object(ze.e)(Math.floor(e||0))},this.state={currentTime:0,duration:0,timeString:this.getTimeString(0,0)}}componentDidMount(){Mr.b.on("clientUpdateMediaTime",this.onClientUpdateMediaTime)}componentWillUnmount(){Mr.b.off("clientUpdateMediaTime",this.onClientUpdateMediaTime)}render(){const e=this.state.currentTimeString;return s.a.createElement(s.a.Fragment,null,e)}}var zr=Vr;a(453);class Hr extends s.a.Component{constructor(e){super(e),this.scrollToActive=()=>{const e=this.listRef.current;if(!e)return;const t=this.messageId;if(!t)return;const a=this.itemRefMap.get(t);if(!a)return;const n=i.findDOMNode(a);n&&(e.scrollTop=n.offsetTop-15)},this.onClientUpdateMediaTitleMouseOver=e=>{const t=e.over;t?this.setState({playlistMouseOver:t},()=>{this.tryOpen()}):this.setState({playlistMouseOver:t},()=>{this.tryClose()})},this.onClientUpdateMediaActive=e=>{const t=e.chatId,a=e.messageId;this.chatId=t,this.messageId=a},this.onClientUpdateMediaPlaylistLoading=e=>{const t=this.chatId,a=this.messageId;e.chatId===t&&e.messageId===a&&this.setState({playlist:null})},this.onClientUpdateMediaPlaylist=e=>{const t=this.chatId,a=this.messageId,n=e.playlist;t===n.chatId&&a===n.messageId&&this.setState({playlist:n})},this.tryOpen=()=>{clearTimeout(this.openTimeout),this.openTimeout=setTimeout(()=>{const e=this.state,t=e.titleMouseOver,a=e.playlistMouseOver;this.setState({open:t||a})},250)},this.tryClose=()=>{clearTimeout(this.timeout),this.timeout=setTimeout(()=>{const e=this.state,t=e.titleMouseOver,a=e.playlistMouseOver;this.setState({open:t||a})},250)},this.handleMouseEnter=()=>{this.setState({playlistMouseOver:!0,open:!0})},this.handleMouseLeave=()=>{this.setState({playlistMouseOver:!1},()=>{this.tryClose()})},this.handleScroll=()=>{const e=this.listRef.current;e&&(e.scrollTop<=B.gb?V.a.clientUpdate({"@type":"clientUpdateMediaPlaylistNext"}):e.scrollTop+e.offsetHeight>=e.scrollHeight-B.gb&&V.a.clientUpdate({"@type":"clientUpdateMediaPlaylistPrev"}))},this.listRef=s.a.createRef(),this.itemRefMap=new Map;const t=Mr.b.message,a=Mr.b.playlist;this.chatId=t?t.chat_id:0,this.messageId=t?t.id:0,this.state={open:!1,titleMouseOver:!1,playlistMouseOver:!1,playlist:a}}componentDidUpdate(e,t,a){const n=this.state.open;!t.open&&n&&this.scrollToActive()}componentDidMount(){Mr.b.on("clientUpdateMediaActive",this.onClientUpdateMediaActive),Mr.b.on("clientUpdateMediaPlaylist",this.onClientUpdateMediaPlaylist),Mr.b.on("clientUpdateMediaPlaylistLoading",this.onClientUpdateMediaPlaylistLoading),Mr.b.on("clientUpdateMediaTitleMouseOver",this.onClientUpdateMediaTitleMouseOver)}componentWillUnmount(){Mr.b.off("clientUpdateMediaActive",this.onClientUpdateMediaActive),Mr.b.off("clientUpdateMediaPlaylist",this.onClientUpdateMediaPlaylist),Mr.b.off("clientUpdateMediaPlaylistLoading",this.onClientUpdateMediaPlaylistLoading),Mr.b.off("clientUpdateMediaTitleMouseOver",this.onClientUpdateMediaTitleMouseOver)}render(){this.props.classes;const e=this.state,t=e.open,a=e.playlist;if(!t)return null;if(!a)return null;const n=a.messages;return n?n.length<=1?null:(this.itemRefMap.clear(),s.a.createElement("div",{className:"playlist"},s.a.createElement("div",{className:"playlist-wrapper"},s.a.createElement("div",{ref:this.listRef,className:"playlist-items",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onScroll:this.handleScroll},a.messages.slice(0).reverse().map(e=>s.a.createElement("div",{key:e.id,ref:t=>this.itemRefMap.set(e.id,t),className:"playlist-item"},Object(Tt.n)(e,()=>Object(Tt.M)(e.chat_id,e.id)))))))):null}}var Wr=Hr;a(454);class Gr extends s.a.Component{constructor(e){super(e),this.onClientUpdateMediaPlaybackRate=e=>{const t=e.playbackRate,a=this.videoRef.current;a&&(a.playbackRate=t)},this.onClientUpdateMediaVolume=e=>{const t=e.volume,a=this.videoRef.current;a&&(a.volume=t)},this.onClientUpdateMediaViewerContent=e=>{this.playingMediaViewer=Boolean(v.a.mediaViewerContent)},this.onClientUpdateMediaViewerEnded=e=>{this.playingMediaViewer=!1},this.onClientUpdateMediaViewerPause=e=>{this.playingMediaViewer=!1},this.onClientUpdateMediaViewerPlay=e=>{this.playingMediaViewer=!0;const t=this.videoRef.current;t&&t.pause()},this.startPlayingFile=(e,t)=>{const a=t.chat_id,n=t.id;this.setState({src:this.getMediaSrc(t)},()=>{const e=this.videoRef.current;e&&this.playingMediaViewer&&(e.pause(),V.a.clientUpdate({"@type":"clientUpdateMediaPause",chatId:a,messageId:n}))})},this.onClientUpdateMediaBlob=e=>{const t=e.chatId,a=e.messageId,n=this.state.message;if(!n)return;const s=n.chat_id,i=n.id,o=n.content;if(o&&t===s&&a===i)switch(o["@type"]){case"messageText":{const e=o.web_page;if(e){const t=e.audio,a=e.voice_note,s=e.video_note;if(t){const e=t.audio;e&&this.startPlayingFile(e,n)}if(a){const e=a.voice;e&&this.startPlayingFile(e,n)}if(s){const e=s.video;e&&this.startPlayingFile(e,n)}}break}case"messageAudio":{const e=o.audio;if(e){const t=e.audio;t&&this.startPlayingFile(t,n)}break}case"messageVoiceNote":{const e=o.voice_note;if(e){const t=e.voice;t&&this.startPlayingFile(t,n)}break}case"messageVideoNote":{const e=o.video_note;if(e){const t=e.video;t&&this.startPlayingFile(t,n)}break}}},this.onClientUpdateMediaPlaylist=e=>{const t=e.playlist,a=t.chatId,n=t.messageId,s=this.state.message;s&&s.chat_id===a&&s.id===n&&this.setState({playlist:t})},this.onClientUpdateMediaClose=e=>{this.setState({message:null,playlist:null,playing:!1,src:null})},this.onClientUpdateMediaActive=e=>{const t=e.chatId,a=e.messageId,n=this.state,s=n.message,i=n.src;if(s&&s.chat_id===t&&s.id===a){if(i){const e=this.videoRef.current;e&&(e.paused?e.play():e.pause())}}else{const e=this.getMediaSrc(Mr.b.message),t=Boolean(e);Mr.b.playlist;this.setState({message:Mr.b.message,playlist:Mr.b.playlist,playing:t,src:e},()=>{const e=this.videoRef.current;e&&(e.currentTime=this.startTime,this.playingMediaViewer?e.pause():e.paused&&e.play())})}},this.handlePrev=()=>{V.a.clientUpdate({"@type":"clientUpdateMediaPrev"})},this.handlePlay=()=>{const e=this.state.message;e&&V.a.clientUpdate({"@type":"clientUpdateMediaActive",chatId:e.chat_id,messageId:e.id})},this.handleNext=()=>{V.a.clientUpdate({"@type":"clientUpdateMediaNext"})},this.getMediaSrc=e=>{if(e){const t=e.content;if(t){const e=t.audio,a=t.voice_note,n=t.video_note,s=t.web_page;if(e){const t=e.audio;if(t)return Object(mt.j)(t)}if(a){const e=a.voice;if(e)return Object(mt.j)(e)}if(n){const e=n.video;if(e)return Object(mt.j)(e)}if(s){if(s.audio){const e=s.audio.audio;if(e)return Object(mt.j)(e)}if(s.voice_note){const e=s.voice_note.voice;if(e)return Object(mt.j)(e)}if(s.video_note){const e=s.video_note.video;if(e)return Object(mt.j)(e)}}}}return""},this.handleEnded=(e=!0)=>{const t=this.state.message;t&&(V.a.clientUpdate({"@type":"clientUpdateMediaEnding",chatId:t.chat_id,messageId:t.id,moveNext:e}),this.setState({},()=>{V.a.clientUpdate({"@type":"clientUpdateMediaEnd",chatId:t.chat_id,messageId:t.id,moveNext:e})}))},this.handleVideoEnded=()=>{this.handleEnded(!0)},this.handleClose=()=>{const e=this.videoRef.current;e&&e.pause(),this.handleEnded(!1)},this.handleTimeUpdate=()=>{const e=this.state.message;if(!e)return;const t=this.videoRef.current;t&&(this.setState({currentTime:t.currentTime,currentTimeString:Object(ze.e)(Math.floor(t.currentTime||0))}),V.a.clientUpdate({"@type":"clientUpdateMediaTime",chatId:e.chat_id,messageId:e.id,duration:t.duration,currentTime:t.currentTime,timestamp:Date.now()}))},this.handleCanPlay=()=>{const e=this.state.message;if(!e)return;const t=this.videoRef.current;if(!t)return;const a=Mr.b.playbackRate,n=Mr.b.volume,s=e.chat_id,i=e.id,o=Object(Tt.x)(s,i);if(t.playbackRate=o?B.I:a,t.volume=n,t.muted=!1,o)return;let r=null;"captureStream"in t?r=t.captureStream():"mozCaptureStream"in t&&(r=t.mozCaptureStream()),r&&V.a.clientUpdate({"@type":"clientUpdateMediaCaptureStream",chatId:e.chat_id,messageId:e.id,stream:r})},this.handleVideoPlay=()=>{const e=this.state.message;if(!e)return;this.setState({playing:!0});const t=this.videoRef.current;t&&V.a.clientUpdate({"@type":"clientUpdateMediaPlay",chatId:e.chat_id,messageId:e.id,currentTime:t.currentTime,duration:t.duration,timestamp:Date.now()})},this.handleVideoPause=()=>{const e=this.state.message;e&&(this.setState({playing:!1}),this.videoRef.current&&V.a.clientUpdate({"@type":"clientUpdateMediaPause",chatId:e.chat_id,messageId:e.id}))},this.handlePlaybackRate=()=>{const e=this.state.playbackRate===B.I?B.H:B.I;this.setState({playbackRate:e},()=>{const t=this.videoRef.current;t&&(t.playbackRate=e)}),V.a.clientUpdate({"@type":"clientUpdateMediaPlaybackRate",playbackRate:e})},this.hasPrev=(e,t)=>{if(!e)return!1;if(!t||!t.messages.length)return!1;const a=e.chat_id,n=e.id,s=t.messages.findIndex(e=>e.chat_id===a&&e.id===n);return-1!==s&&s+1<t.messages.length},this.hasNext=(e,t)=>{if(!e)return!1;if(!t||!t.messages.length)return!1;const a=e.chat_id,n=e.id,s=t.messages.findIndex(e=>e.chat_id===a&&e.id===n);return-1!==s&&s-1>=0},this.handleTitleMouseEnter=()=>{V.a.clientUpdate({"@type":"clientUpdateMediaTitleMouseOver",over:!0})},this.handleTitleMouseLeave=()=>{V.a.clientUpdate({"@type":"clientUpdateMediaTitleMouseOver",over:!1})},this.handleTitleClick=()=>{const e=this.state.message;e&&Object(nt.h)(e.chat_id,e.id)},this.videoRef=s.a.createRef();const t=Mr.b.message,a=Mr.b.playlist;this.startTime=B.K,this.state={currentTime:0,currentTimeString:Object(ze.e)(0),message:t,playlist:a,playing:!1,src:this.getMediaSrc(t)}}shouldComponentUpdate(e,t,a){const n=this.props.theme,s=this.state,i=s.message,o=s.playlist,r=s.src,c=s.playing;return e.theme!==n||(t.message!==i||(t.playlist!==o||(t.src!==r||t.playing!==c)))}componentDidMount(){ft.a.on("clientUpdateVoiceNoteBlob",this.onClientUpdateMediaBlob),ft.a.on("clientUpdateVideoNoteBlob",this.onClientUpdateMediaBlob),ft.a.on("clientUpdateAudioBlob",this.onClientUpdateMediaBlob),Mr.b.on("clientUpdateMediaActive",this.onClientUpdateMediaActive),Mr.b.on("clientUpdateMediaClose",this.onClientUpdateMediaClose),Mr.b.on("clientUpdateMediaPlaylist",this.onClientUpdateMediaPlaylist),Mr.b.on("clientUpdateMediaViewerPlay",this.onClientUpdateMediaViewerPlay),Mr.b.on("clientUpdateMediaViewerPause",this.onClientUpdateMediaViewerPause),Mr.b.on("clientUpdateMediaViewerEnded",this.onClientUpdateMediaViewerEnded),Mr.b.on("clientUpdateMediaVolume",this.onClientUpdateMediaVolume),Mr.b.on("clientUpdateMediaPlaybackRate",this.onClientUpdateMediaPlaybackRate),v.a.on("clientUpdateMediaViewerContent",this.onClientUpdateMediaViewerContent)}componentWillUnmount(){ft.a.off("clientUpdateVoiceNoteBlob",this.onClientUpdateMediaBlob),ft.a.off("clientUpdateVideoNoteBlob",this.onClientUpdateMediaBlob),ft.a.off("clientUpdateAudioBlob",this.onClientUpdateMediaBlob),Mr.b.off("clientUpdateMediaActive",this.onClientUpdateMediaActive),Mr.b.off("clientUpdateMediaClose",this.onClientUpdateMediaClose),Mr.b.off("clientUpdateMediaPlaylist",this.onClientUpdateMediaPlaylist),Mr.b.off("clientUpdateMediaViewerPlay",this.onClientUpdateMediaViewerPlay),Mr.b.off("clientUpdateMediaViewerPause",this.onClientUpdateMediaViewerPause),Mr.b.off("clientUpdateMediaViewerEnded",this.onClientUpdateMediaViewerEnded),Mr.b.off("clientUpdateMediaVolume",this.onClientUpdateMediaVolume),Mr.b.off("clientUpdateMediaPlaybackRate",this.onClientUpdateMediaPlaybackRate),v.a.off("clientUpdateMediaViewerContent",this.onClientUpdateMediaViewerContent)}render(){const e=this.props.t,t=this.state,a=t.playing,n=t.message,i=t.playlist,o=t.src;let r=!1;if(n){const e=n.chat_id,t=n.id;r=Object(Tt.x)(e,t)}const c=n?n.date:null,l=Object(Tt.o)(n,e),d=Object(Tt.h)(c),h=Object(Tt.g)(c),u=!r,p=!r,m=r,g=r,f=this.hasPrev(n,i),b=this.hasNext(n,i);return s.a.createElement(s.a.Fragment,null,s.a.createElement("video",{className:"header-player-video",ref:this.videoRef,src:o,autoPlay:!0,controls:!1,width:44,height:44,onCanPlay:this.handleCanPlay,onPlay:this.handleVideoPlay,onPause:this.handleVideoPause,onTimeUpdate:this.handleTimeUpdate,onEnded:this.handleVideoEnded}),n&&s.a.createElement("div",{className:"header-player"},s.a.createElement(J.a,{disabled:!f,className:"header-player-button",color:"primary",onClick:this.handlePrev},s.a.createElement(fr.a,{fontSize:"small"})),s.a.createElement(J.a,{className:"header-player-button",color:"primary",disabled:!o,onClick:this.handlePlay},a?s.a.createElement(ur.a,null):s.a.createElement(hr.a,null)),s.a.createElement(J.a,{disabled:!b,className:"header-player-button",color:"primary",onClick:this.handleNext},s.a.createElement(mr.a,{fontSize:"small"})),s.a.createElement(Wr,null),s.a.createElement("div",{className:"header-player-content",onMouseEnter:this.handleTitleMouseEnter,onMouseLeave:this.handleTitleMouseLeave,onClick:this.handleTitleClick},s.a.createElement("div",{className:"header-player-title"},l,u&&s.a.createElement("span",{title:d},"\xa0",h)),"\xa0",s.a.createElement(zr,null)),s.a.createElement(_r,null),p&&s.a.createElement(Br,null),m&&s.a.createElement(Dr,null),g&&s.a.createElement(Ar,null),s.a.createElement(J.a,{className:"header-player-button",onClick:this.handleClose},s.a.createElement(la.a,{fontSize:"small"}))))}}var Kr=Object(p.c)()(Gr);a(455);class Zr extends s.a.Component{constructor(...e){super(...e),this.onUpdateChatActionBar=e=>{const t=this.props.chatId;e.chat_id===t&&this.forceUpdate()},this.handleClose=()=>{const e=this.props.chatId;if(!gt.a.get(e))return null;V.a.send({"@type":"removeChatActionBar",chat_id:e})},this.handleReportSpam=()=>{const e=this.props.chatId;if(!gt.a.get(e))return null;V.a.send({"@type":"reportChat",chat_id:e,reason:{"@type":"chatReportReasonSpam"},message_ids:[]})},this.handleReportUnrelatedLocation=()=>{const e=this.props.chatId;if(!gt.a.get(e))return null;V.a.send({"@type":"reportChat",chat_id:e,reason:{"@type":"chatReportReasonUnrelatedLocation"},message_ids:[]})},this.handleSharePhoneNumber=()=>{const e=this.props.chatId,t=Object(Ze.w)(e);t&&V.a.send({"@type":"sharePhoneNumber",user_id:t})},this.handleAddContact=()=>{const e=this.props.chatId,t=Object(Ze.w)(e);if(!t)return;const a=ht.a.get(t);if(!a)return;const n=a.user_id,s=a.phone_number,i=a.first_name,o=a.last_name;V.a.send({"@type":"addContact",contact:{"@type":"contact",phone_number:s,first_name:i,last_name:o,vcard:"",user_id:n},share_phone_number:!1})},this.handleBlockUser=()=>{const e=this.props.chatId,t=Object(Ze.w)(e);t&&V.a.send({"@type":"blockUser",user_id:t})}}componentDidMount(){gt.a.on("updateChatActionBar",this.onUpdateChatActionBar)}componentWillUnmount(){gt.a.off("updateChatActionBar",this.onUpdateChatActionBar)}render(){const e=this.props,t=e.chatId,a=e.t;if(!t)return null;const n=gt.a.get(t);if(!n)return null;const i=n.action_bar;if(!i)return null;let o=null;switch(i["@type"]){case"chatActionBarSharePhoneNumber":o=s.a.createElement(w.a,{color:"primary",className:"header-command-button",onClick:this.handleSharePhoneNumber},a("ShareMyPhone"));break;case"chatActionBarAddContact":o=s.a.createElement(w.a,{color:"primary",className:"header-command-button",onClick:this.handleAddContact},a("AddContactChat"));break;case"chatActionBarReportAddBlock":o=s.a.createElement(s.a.Fragment,null,s.a.createElement(w.a,{color:"primary",className:"header-command-button",onClick:this.handleAddContact},a("AddContactChat")),s.a.createElement(w.a,{color:"secondary",className:"header-command-button",onClick:this.handleBlockUser},a("ReportSpamUser")));break;case"chatActionBarUnrelatedLocation":o=s.a.createElement(w.a,{color:"secondary",className:"header-command-button",onClick:this.handleReportUnrelatedLocation},a("ReportSpamLocation"));break;case"chatActionBarReportSpam":o=s.a.createElement(w.a,{color:"secondary",className:"header-command-button",onClick:this.handleReportSpam},a("ReportSpam"))}return s.a.createElement("div",{className:"action-bar",onMouseDown:this.handleClick},s.a.createElement("div",{className:"action-bar-content"},o),s.a.createElement("div",{className:"action-bar-close-button"},s.a.createElement(J.a,{onClick:this.handleClose},s.a.createElement(la.a,null))))}}var qr=Object(p.c)()(Zr);a(456);class Yr extends s.a.Component{constructor(...e){super(...e),this.onClientUpdateLanguage=()=>{this.forceUpdate()}}componentDidMount(){m.a.on("clientUpdateLanguageChange",this.onClientUpdateLanguage)}componentWillUnmount(){m.a.off("clientUpdateLanguageChange",this.onClientUpdateLanguage)}render(){const e=this.props,t=e.date,a=e.i18n,n=new Date(1e3*t)<(new Date).setMonth((new Date).getMonth()-3)?{day:"numeric",month:"long",year:"numeric"}:{day:"numeric",month:"long"};return s.a.createElement("div",{className:"day-meta"},s.a.createElement("div",{className:"day-meta-wrapper"},s.a.createElement("div",null,new Date(1e3*t).toLocaleDateString([a.language],n))))}}var Jr=Object(p.c)()(Yr);a(457);class Qr extends s.a.Component{constructor(e){super(e),this.onClientUpdateDragging=e=>{const t=v.a.dragParams;this.setState({dragParams:t})},this.handleDragEnter=e=>{e.preventDefault(),e.stopPropagation()},this.handleDrop=e=>{e.preventDefault(),e.stopPropagation(),V.a.clientUpdate({"@type":"clientUpdateDragging",dragging:!1}),this.handleAttachDocumentComplete(e.dataTransfer.files)},this.handleDragLeave=e=>{e.preventDefault(),e.stopPropagation(),V.a.clientUpdate({"@type":"clientUpdateDragging",dragging:!1})},this.handleAttachDocumentComplete=e=>{if(0!==e.length)for(let t=0;t<e.length;t++){let a=e[t];const n={"@type":"inputMessageDocument",document:{"@type":"inputFileBlob",name:a.name,data:a}};this.onSendInternal(n,e=>ft.a.uploadFile(e.content.document.document.id,e))}},this.onSendInternal=function(){var e=Object(h.a)(d.a.mark((function e(t,a){var n,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=v.a.getChatId()){e.next=3;break}return e.abrupt("return");case 3:if(t){e.next=5;break}return e.abrupt("return");case 5:return e.prev=5,v.a.invokeScheduledAction("clientUpdateClearHistory chatId=".concat(n)),e.next=9,V.a.send({"@type":"sendMessage",chat_id:n,reply_to_message_id:0,input_message_content:t});case 9:s=e.sent,V.a.send({"@type":"viewMessages",chat_id:n,message_ids:[s.id]}),a(s),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(5),alert("sendMessage error "+JSON.stringify(e.t0));case 17:case"end":return e.stop()}}),e,null,[[5,14]])})));return function(t,a){return e.apply(this,arguments)}}();const t=v.a.dragParams;this.state={dragParams:t}}componentDidMount(){v.a.on("clientUpdateDragging",this.onClientUpdateDragging)}componentWillUnmount(){v.a.off("clientUpdateDragging",this.onClientUpdateDragging)}render(){const e=this.state.dragParams;return s.a.createElement(s.a.Fragment,null,e&&s.a.createElement("div",{className:"files-drop-target",onDragEnter:this.handleDragEnter,onDragLeave:this.handleDragLeave,onDrop:this.handleDrop},s.a.createElement("div",{className:"files-drop-target-wrapper"},s.a.createElement("div",{className:"files-drop-target-text"},s.a.createElement("div",{className:"files-drop-target-title"},"Drop files here"),s.a.createElement("div",{className:"files-drop-target-subtitle"},"to send them without compression")))))}}var Xr=Qr,$r=a(264),ec=a.n($r),tc=a(545);a(458);class ac extends s.a.Component{constructor(...e){super(...e),this.state={arrowRef:null},this.handleArrowRef=e=>{this.setState({arrowRef:e})},this.openForward=e=>{e.stopPropagation();const t=this.props.forwardInfo;if(!t)return null;const a=t.origin;switch(a["@type"]){case"messageForwardOriginUser":{const e=a.sender_user_id;Object(nt.j)(e,!0);break}case"messageForwardOriginHiddenUser":break;case"messageForwardOriginChannel":{const e=a.chat_id,t=a.message_id;Object(nt.h)(e,t);break}}}}render(){const e=this.props,t=e.t,a=e.forwardInfo,n=this.state.arrowRef,i=Object(Tt.l)(a,t),o=Object(Tt.C)(a)?s.a.createElement(s.a.Fragment,null,t("HidAccount"),s.a.createElement("span",{className:"forward-arrow",ref:this.handleArrowRef})):"";return s.a.createElement("div",{className:q()("message-author","forward")},s.a.createElement("div",null,t("ForwardedMessage")),s.a.createElement("div",null,t("From")+" ",s.a.createElement(tc.a,{title:o,classes:{popper:"forward-arrow-popper",tooltip:"forward-tooltip"},PopperProps:{popperOptions:{modifiers:{arrow:{enabled:Boolean(n),element:n}}}},placement:"top"},s.a.createElement("a",{onClick:this.openForward},i))))}}var nc=Object(p.c)()(ac);a(459);class sc extends s.a.Component{render(){const e=this.props,t=e.className,a=e.chatId,n=e.messageId,i=e.date,o=e.editDate,r=e.onDateClick,c=e.t,l=e.views,d=e.style,h=Nt.a.get(a,n);if(!h)return null;const u=h.is_outgoing,p=Object(Tt.g)(i),m=Object(Tt.h)(i);return s.a.createElement("div",{className:q()("meta",t),style:d},s.a.createElement("span",null,"\u2002"),l>0&&s.a.createElement(s.a.Fragment,null,s.a.createElement(we.a,{className:"meta-views-icon"}),s.a.createElement("span",{className:"meta-views"},"\xa0",l,"\xa0 \xa0")),o>0&&s.a.createElement("span",null,c("EditedMessage"),"\xa0"),s.a.createElement("a",{onClick:r},s.a.createElement("span",{title:m},p)),u&&s.a.createElement(Lt,{chatId:a,messageId:n}))}}var ic=Object(p.c)()(sc);a(460);var oc=Object(p.c)()((function(e){const t=e.t;return s.a.createElement("div",{className:"unread-separator"},t("UnreadMessages"))})),rc=a(143),cc=a(116),lc=a(133),dc=a(180),hc=a(68),uc=a(141),pc=a(170),mc=a(181);let gc=null;function fc(e){return bc.apply(this,arguments)}function bc(){return(bc=Object(h.a)(d.a.mark((function e(t){var a,n,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=gc=new Date,e.next=4,V.a.send({"@type":"getWebPageInstantView",url:t,force_full:!0});case 4:if(n=e.sent,gc===a){e.next=7;break}return e.abrupt("return");case 7:console.log("[IV] open",n),Object(mt.r)(n),Object(nt.n)({instantView:n}),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(0),(s=window.open()).opener=null,s.location=t;case 17:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}a(461);class Cc extends s.a.Component{constructor(...e){var t;super(...e),t=this,this.getMedia=()=>{const e=this.props,t=e.chatId,a=e.messageId,n=e.size,i=(e.displaySize,e.displaySmallSize),o=e.displayExtraSmallSize,r=e.openMedia,c=Nt.a.get(t,a);if(!c)return null;const l=c.content;if(!l)return null;const d=l.web_page;if(!d)return null;const h=d.site_name,u=d.title,p=d.description,m=(d.url,d.photo),g=d.animation,f=d.video,b=d.audio,C=d.document,y=d.voice_note,v=d.video_note,E=d.sticker,S=d.type;if(E)return[null,s.a.createElement(hc.b,{chatId:t,messageId:a,sticker:E,openMedia:r,source:hc.a.MESSAGE})];if(y)return[null,s.a.createElement(mc.a,{chatId:t,messageId:a,voiceNote:y,openMedia:r})];if(v)return[null,s.a.createElement(pc.a,{chatId:t,messageId:a,videoNote:v,openMedia:r})];if(b)return[null,s.a.createElement(lc.a,{chatId:t,messageId:a,audio:b,openMedia:r})];if(C)return[null,s.a.createElement(dc.a,{chatId:t,messageId:a,document:C,openMedia:r})];if(g){if(Object(mt.j)(g.animation)||g.thumbnail)return[null,s.a.createElement(cc.a,{chatId:t,messageId:a,animation:g,openMedia:r})]}if(f&&f.thumbnail)return[null,s.a.createElement(uc.a,{chatId:t,messageId:a,video:f,openMedia:r})];if(m){const e=Object(ze.l)(m.sizes,n),c=("article"===S||"photo"===S)&&(h||u||p)&&e&&e.width===e.height,l=c&&(!p||p.length<50),d=c||l?{float:"right",marginLeft:6}:{};return[c?s.a.createElement(Ln.a,{displaySize:l?o:i,style:d,chatId:t,messageId:a,photo:m,openMedia:r}):null,c?null:s.a.createElement(Ln.a,{chatId:t,messageId:a,photo:m,openMedia:r})]}return[null,null]},this.handleInstantViewClick=function(){var e=Object(h.a)(d.a.mark((function e(a){var n,s,i,o,r,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),a.stopPropagation(),n=t.props,s=n.chatId,i=n.messageId,o=Nt.a.get(s,i)){e.next=6;break}return e.abrupt("return",null);case 6:if(r=o.content){e.next=9;break}return e.abrupt("return",null);case 9:if(c=r.web_page){e.next=12;break}return e.abrupt("return",null);case 12:fc(c.url);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}getWebPage(){const e=this.props,t=e.chatId,a=e.messageId,n=e.t,i=Nt.a.get(t,a);if(!i)return null;const o=i.content;if(!o)return null;const r=o.web_page;if(!r)return null;const c=r.description,l=r.instant_view_version,d=r.site_name,h=r.title,u=s.a.createElement(s.a.Fragment,null,d&&s.a.createElement("div",{className:"web-page-site-name"},d),h&&s.a.createElement("div",{className:"web-page-title"},h),c&&s.a.createElement("div",{className:"web-page-description"},c)),p=this.getMedia(),m=Object(T.a)(p,2),g=m[0],f=m[1],b=l>0&&s.a.createElement(w.a,{variant:"outlined",color:"primary",classes:{outlinedPrimary:"message-control",disabled:"message-control-disabled"},fullWidth:!0,onClick:this.handleInstantViewClick,className:"web-page-button"},s.a.createElement(rc.a,null,s.a.createElement("path",{d:"M10.5159727,16.7438514 C10.1741929,18.1203636 10.687342,18.4055299 11.6053255,17.4005852 L15.4613785,12.9698209 C16.3535455,11.8808642 16.1300862,11.0059438 14.8452805,10.7872179 L12.9861121,10.4429102 L12.9861121,10.4429102 C12.8775019,10.4227962 12.8057616,10.3184447 12.8258756,10.2098345 C12.8265392,10.2062511 12.8273007,10.2026864 12.8281591,10.1991446 L13.5436135,7.24719783 C13.8863521,5.8619451 13.3150978,5.61107807 12.4582164,6.59275159 C11.2270125,7.98097123 10.2913754,9.02966176 9.65130514,9.73882318 C9.42814828,9.98606827 9.06894462,10.3719875 8.57369417,10.8965808 C7.48829706,12.1010165 8.05955136,12.9745105 9.31498713,13.1932365 L11.0917769,13.5117472 L11.0917769,13.5117472 C11.2005008,13.5312372 11.2728391,13.6351751 11.253349,13.743899 C11.2525988,13.7480841 11.2517153,13.7522442 11.2506999,13.756373 L10.5159727,16.7438514 Z"})),n("InstantView"));return s.a.createElement(s.a.Fragment,null,g,u,f,b)}render(){const e=this.props.meta;return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"web-page"},s.a.createElement("div",{className:"border"}),s.a.createElement("div",{className:"web-page-wrapper"},this.getWebPage())),e)}}Cc.defaultProps={size:B.F,displaySize:B.D,displaySmallSize:B.E,displayExtraSmallSize:B.C};var yc=Object(p.c)()(Cc),vc=a(144);a(462);class Ec extends n.Component{constructor(e){var t;super(e),t=this,this.onClientUpdateClearSelection=e=>{this.state.selected&&this.setState({selected:!1})},this.onClientUpdateMessageShake=e=>{const t=this.props,a=t.chatId,n=t.messageId,s=this.state.shook;a===e.chatId&&n===e.messageId&&(s?this.setState({shook:!1},()=>{setTimeout(()=>{this.setState({shook:!0})},0)}):this.setState({shook:!0}))},this.onClientUpdateMessageHighlighted=e=>{const t=this.props,a=t.chatId,n=t.messageId,s=this.state,i=s.selected,o=s.highlighted;i||(a===e.chatId&&n===e.messageId?o?this.setState({highlighted:!1},()=>{setTimeout(()=>{this.setState({highlighted:!0})},0)}):this.setState({highlighted:!0}):o&&this.setState({highlighted:!1}))},this.onClientUpdateMessageSelected=e=>{const t=this.props,a=t.chatId,n=t.messageId,s=e.selected;a===e.chatId&&n===e.messageId&&this.setState({selected:s,highlighted:!1})},this.onUpdateMessageEdited=e=>{const t=e.chat_id,a=e.message_id,n=this.props,s=n.chatId,i=n.messageId;s===t&&i===a&&this.forceUpdate()},this.onUpdateMessageViews=e=>{const t=e.chat_id,a=e.message_id,n=this.props,s=n.chatId,i=n.messageId;s===t&&i===a&&this.forceUpdate()},this.onUpdateMessageContent=e=>{const t=e.chat_id,a=e.message_id,n=this.props,s=n.chatId,i=n.messageId,o=this.state.emojiMatches;s===t&&i===a&&(Object(Tt.i)(s,i)!==o?this.setState({emojiMatches:Object(Tt.i)(s,i)}):this.forceUpdate())},this.handleSelectUser=e=>{Object(nt.j)(e,!0)},this.handleSelectChat=e=>{Object(nt.h)(e,null,!0)},this.handleSelection=()=>{if(!this.mouseDown)return;if(window.getSelection().toString())return;const e=this.props,t=e.chatId,a=e.messageId,n=!Nt.a.selectedItems.has("chatId=".concat(t,"_messageId=").concat(a));Object(nt.m)(t,a,n)},this.handleDateClick=e=>{e.preventDefault(),e.stopPropagation();const t=this.props,a=t.chatId,n=t.messageId,s=Nt.a.get(a,n);Object(Ze.e)(a)?V.a.clientUpdate({"@type":"clientUpdateReply",chatId:a,messageId:n}):s&&s.can_be_forwarded&&V.a.clientUpdate({"@type":"clientUpdateForward",info:{chatId:a,messageIds:[n]}})},this.openMedia=e=>{e&&(e.preventDefault(),e.stopPropagation());const t=this.props,a=t.chatId,n=t.messageId;Object(Tt.M)(a,n)},this.handleAnimationEnd=()=>{this.setState({highlighted:!1})},this.handleMouseDown=()=>{this.mouseDown=!0},this.handleMouseOver=()=>{this.mouseDown=!1},this.handleMouseOut=()=>{this.mouseOut=!1},this.handleReplyClick=()=>{const e=this.props,t=e.chatId,a=e.messageId;Object(nt.i)(t,a)},this.handleContextMenu=function(){var e=Object(h.a)(d.a.mark((function e(a){var n,s,i;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a&&(a.preventDefault(),a.stopPropagation()),!t.state.contextMenu){e.next=6;break}t.setState({contextMenu:!1}),e.next=12;break;case 6:if(!(Nt.a.selectedItems.size>1)){e.next=8;break}return e.abrupt("return");case 8:n=a.clientX,s=a.clientY,i=a.target&&"A"===a.target.tagName&&a.target.href?a.target.href:null,t.setState({contextMenu:!0,copyLink:i,left:n,top:s});case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleCloseContextMenu=e=>{e&&e.stopPropagation(),this.setState({contextMenu:!1})},this.handleReply=e=>{const t=this.props,a=t.chatId,n=t.messageId;Object(nt.a)(),this.handleCloseContextMenu(e),Object(nt.k)(a,n)},this.handlePin=e=>{const t=this.props,a=t.chatId,n=t.messageId;Object(nt.a)(),this.handleCloseContextMenu(e),Object(Tt.G)(a,n)?function(e){V.a.send({"@type":"unpinChatMessage",chat_id:e})}(a):function(e,t,a=!1){V.a.send({"@type":"pinChatMessage",chat_id:e,message_id:t,disable_notification:a})}(a,n)},this.handleForward=e=>{const t=this.props,a=t.chatId,n=t.messageId;this.handleCloseContextMenu(e),Object(nt.e)(a,[n])},this.handleEdit=e=>{const t=this.props,a=t.chatId,n=t.messageId;Object(nt.a)(),this.handleCloseContextMenu(e),Object(nt.d)(a,n)},this.handleSelect=e=>{const t=this.props,a=t.chatId,n=t.messageId;this.handleCloseContextMenu(e),Object(nt.m)(a,n,!0)},this.handleDelete=e=>{const t=this.props,a=t.chatId,n=t.messageId;this.handleCloseContextMenu(e),Object(nt.c)(a,[n])},this.handleUnvote=e=>{e&&e.stopPropagation();const t=this.props,a=t.chatId,n=t.messageId;this.state.contextMenu&&this.handleCloseContextMenu(),Object(vc.a)(a,n)},this.handleConfirmStopPoll=e=>{this.state.dialog||this.setState({confirmStopPoll:!0,contextMenu:!1})},this.handleStopPoll=e=>{e.stopPropagation();const t=this.props,a=t.chatId,n=t.messageId;this.state.confirmStopPoll&&this.setState({confirmStopPoll:!1}),Object(vc.c)(a,n)},this.handleCloseConfirm=e=>{e&&e.stopPropagation(),this.setState({confirmStopPoll:!1})},this.handleCopyLink=e=>{const t=this.state.copyLink;this.handleCloseContextMenu(e),t&&ua(t)};const a=this.props,n=a.chatId,s=a.messageId;this.state={message:Nt.a.get(n,s),emojiMatches:Object(Tt.i)(n,s),selected:!1,highlighted:!1,shook:!1,confirmStopPoll:!1,contextMenu:!1,left:0,top:0}}shouldComponentUpdate(e,t){const a=this.props,n=a.theme,s=a.chatId,i=a.messageId,o=a.sendingState,r=a.showUnreadSeparator,c=a.showTail,l=a.showTitle,d=this.state,h=d.contextMenu,u=d.selected,p=d.highlighted,m=d.shook,g=d.emojiMatches,f=d.confirmStopPoll;return e.theme!==n||(e.chatId!==s||(e.messageId!==i||(e.sendingState!==o||(e.showUnreadSeparator!==r||(e.showTail!==c||(e.showTitle!==l||(t.confirmStopPoll!==f||(t.contextMenu!==h||(t.selected!==u||(t.highlighted!==p||(t.shook!==m||t.emojiMatches!==g)))))))))))}componentDidMount(){Nt.a.on("clientUpdateMessageHighlighted",this.onClientUpdateMessageHighlighted),Nt.a.on("clientUpdateMessageSelected",this.onClientUpdateMessageSelected),Nt.a.on("clientUpdateMessageShake",this.onClientUpdateMessageShake),Nt.a.on("clientUpdateClearSelection",this.onClientUpdateClearSelection),Nt.a.on("updateMessageContent",this.onUpdateMessageContent),Nt.a.on("updateMessageEdited",this.onUpdateMessageEdited),Nt.a.on("updateMessageViews",this.onUpdateMessageViews)}componentWillUnmount(){Nt.a.off("clientUpdateMessageHighlighted",this.onClientUpdateMessageHighlighted),Nt.a.off("clientUpdateMessageSelected",this.onClientUpdateMessageSelected),Nt.a.on("clientUpdateMessageShake",this.onClientUpdateMessageShake),Nt.a.off("clientUpdateClearSelection",this.onClientUpdateClearSelection),Nt.a.off("updateMessageContent",this.onUpdateMessageContent),Nt.a.off("updateMessageEdited",this.onUpdateMessageEdited),Nt.a.off("updateMessageViews",this.onUpdateMessageViews)}getMessageStyle(e,t){const a=Nt.a.get(e,t);if(!a)return null;const n=a.content;if(!n)return null;switch(n["@type"]){case"messageAnimation":{const e=n.animation;if(!e)return null;const t=e.width,a=e.height,s=e.thumbnail,i={width:t,height:a}||s;if(!i)return null;const o=Object(ze.f)(i,B.D,!1);return o?{width:o.width}:null}case"messagePhoto":{const e=n.photo;if(!e)return null;const t=Object(ze.l)(e.sizes,B.F);if(!t)return null;const a=Object(ze.f)(t,B.D,!1);return a?{width:a.width}:null}case"messageVideo":{const e=n.video;if(!e)return null;const t=e.thumbnail,a={width:e.width,height:e.height}||t;if(!a)return null;const s=Object(ze.f)(a,B.D);return s?{width:s.width}:null}}return null}render(){const e=this.props,t=e.t,a=e.chatId,n=e.messageId,i=e.showUnreadSeparator,o=e.showTail,r=e.showTitle,c=e.showDate,l=this.state,d=l.emojiMatches,h=l.selected,u=l.highlighted,p=l.shook,m=l.copyLink,g=l.contextMenu,f=l.left,b=l.top,C=l.confirmStopPoll,y=Nt.a.get(a,n);if(!y)return s.a.createElement("div",null,"[empty message]");const v=y.is_outgoing,E=y.views,S=y.date,U=y.edit_date,k=y.reply_to_message_id,P=y.forward_info,T=y.sender_user_id,N=s.a.createElement(ic,{className:"meta-hidden",chatId:a,messageId:n,date:S,editDate:U,views:E}),D=Object(Tt.u)(y,N,t),L=null!==D&&D.length>0,j=Object(Tt.N)(a,n),R=Boolean(k),A=Object(Ze.W)(a),F=!A&&r||j||R,B=Object(Tt.w)(y),V=Object(Tt.n)(y,this.openMedia,F,L,N);let z=null;o&&(z=T?s.a.createElement(ys.a,{small:!0,userId:T,onSelect:this.handleSelectUser}):s.a.createElement(Ct,{small:!0,chatId:a,onSelect:this.handleSelectChat}));const H=this.getMessageStyle(a,n),W=Object(Tt.c)(a,n),G=Object(Tt.a)(a,n),K=Object(Ze.e)(a),Z=Object(Ze.c)(a),Y=Object(Tt.G)(a,n),J=y.can_be_forwarded,Q=y.can_be_deleted_only_for_self||y.can_be_deleted_for_all_users,X=!Nt.a.hasSelectedMessage(a,n),$=Object(Tt.b)(a,n),ee="messageSticker"!==y.content["@type"]&&"messageVideoNote"!==y.content["@type"];return s.a.createElement("div",null,c&&s.a.createElement(Jr,{date:S}),s.a.createElement("div",{className:q()("message",{"message-short":!z,"message-out":v,"message-selected":h,"message-highlighted":u&&!h,"message-top":r&&!o,"message-bottom":!r&&o,"message-middle":!r&&!o,"message-bubble-hidden":!ee}),onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onMouseDown:this.handleMouseDown,onClick:this.handleSelection,onAnimationEnd:this.handleAnimationEnd,onContextMenu:this.handleContextMenu},i&&s.a.createElement(oc,null),s.a.createElement("div",{className:"message-body"},s.a.createElement("div",{className:"message-padding"},s.a.createElement(ec.a,{className:"message-select-tick"})),s.a.createElement("div",{className:q()("message-wrapper",{"message-wrapper-shook":p})},z,s.a.createElement("div",{className:q()("message-content",{"message-bubble":ee,"message-bubble-out":ee&&v}),style:H},ee&&(r&&!A||j)&&s.a.createElement("div",{className:"message-title"},r&&!j&&s.a.createElement(is.a,{chatId:a,openChat:!0,userId:T,openUser:!0}),j&&s.a.createElement(nc,{forwardInfo:P})),R&&s.a.createElement(Mo,{chatId:a,messageId:k,onClick:this.handleReplyClick}),V,s.a.createElement("div",{className:q()("message-text",{"message-text-1emoji":1===d,"message-text-2emoji":2===d,"message-text-3emoji":3===d})},D),B&&s.a.createElement(yc,{chatId:a,messageId:n,openMedia:this.openMedia,meta:N}),ee&&s.a.createElement(ic,{className:q()("meta-text",{"meta-bubble":Object(Tt.I)(a,n)}),chatId:a,messageId:n,date:S,editDate:U,views:E,onDateClick:this.handleDateClick})),s.a.createElement("div",{className:"message-tile-padding"})),s.a.createElement("div",{className:"message-padding"})),s.a.createElement(rt.a,{open:g,onClose:this.handleCloseContextMenu,anchorReference:"anchorPosition",anchorPosition:{top:b,left:f},anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"},onMouseDown:e=>e.stopPropagation()},s.a.createElement(ot.a,{onClick:e=>e.stopPropagation()},m&&s.a.createElement(it.a,{onClick:this.handleCopyLink},t("CopyLink")),K&&s.a.createElement(it.a,{onClick:this.handleReply},t("Reply")),Z&&s.a.createElement(it.a,{onClick:this.handlePin},t(Y?"Unpin":"Pin")),X&&s.a.createElement(it.a,{onClick:this.handleSelect},t("Select")),J&&s.a.createElement(it.a,{onClick:this.handleForward},t("Forward")),$&&s.a.createElement(it.a,{onClick:this.handleEdit},t("Edit")),Q&&s.a.createElement(it.a,{onClick:this.handleDelete},t("Delete")),W&&s.a.createElement(it.a,{onClick:this.handleUnvote},t("Unvote")),G&&s.a.createElement(it.a,{onClick:this.handleConfirmStopPoll},t("StopPoll")))),s.a.createElement(M.a,{transitionDuration:0,open:C,onClose:this.handleCloseConfirm,"aria-labelledby":"form-dialog-title"},s.a.createElement(O.a,{id:"form-dialog-title"},t("StopPollAlertTitle")),s.a.createElement(_.a,null,s.a.createElement(x.a,null,t("StopPollAlertText"))),s.a.createElement(I.a,null,s.a.createElement(w.a,{onClick:this.handleCloseConfirm,color:"primary"},t("Cancel")),s.a.createElement(w.a,{onClick:this.handleStopPoll,color:"primary"},t("Stop"))))))}}var Sc=Object(u.a)(Object(u.d)(),k.a,Object(p.c)(),Object(u.c)())(Ec),Uc=a(265),kc=a.n(Uc);a(463);class wc extends s.a.Component{render(){const e=this.props.onClick;return s.a.createElement("div",{className:"scroll-down-button"},s.a.createElement(J.a,{disableRipple:!0,onMouseDown:e},s.a.createElement(kc.a,null)))}}var Mc=wc,Ic=a(42);a(464);const _c={width:64,height:64,borderRadius:"50%",margin:"0 auto 5px"};class xc extends s.a.Component{constructor(e){super(e),this.onClientUpdateMessageHighlighted=e=>{const t=this.props,a=t.chatId,n=t.messageId,s=this.state,i=s.selected,o=s.highlighted;i||(a===e.chatId&&n===e.messageId?o?this.setState({highlighted:!1},()=>{setTimeout(()=>{this.setState({highlighted:!0})},0)}):this.setState({highlighted:!0}):o&&this.setState({highlighted:!1}))},this.handleAnimationEnd=()=>{this.setState({highlighted:!1})},this.openMedia=e=>{e&&(e.preventDefault(),e.stopPropagation());const t=this.props,a=t.chatId,n=t.messageId;Object(Tt.M)(a,n)};const t=this.props,a=t.chatId,n=t.messageId;this.state={message:Nt.a.get(a,n),highlighted:!1}}shouldComponentUpdate(e,t){const a=this.props,n=a.chatId,s=a.messageId,i=a.sendingState,o=a.showUnreadSeparator,r=this.state.highlighted;return e.chatId!==n||(e.messageId!==s||(e.sendingState!==i||(e.showUnreadSeparator!==o||t.highlighted!==r)))}componentDidMount(){Nt.a.on("clientUpdateMessageHighlighted",this.onClientUpdateMessageHighlighted)}componentWillUnmount(){Nt.a.off("clientUpdateMessageHighlighted",this.onClientUpdateMessageHighlighted)}render(){const e=this.props,t=e.chatId,a=e.messageId,n=e.showUnreadSeparator,i=e.showDate,o=this.state.highlighted,r=Nt.a.get(t,a);if(!r)return null;const c=r.content,l=r.date;if(!c)return null;const d=c.photo,h=Object(Ic.a)(r,!0);return s.a.createElement("div",null,i&&s.a.createElement(Jr,{date:l}),s.a.createElement("div",{className:q()("service-message",{"message-highlighted":o}),onAnimationEnd:this.handleAnimationEnd},n&&s.a.createElement(oc,null),s.a.createElement("div",{className:"service-message-wrapper"},s.a.createElement("div",{className:"service-message-content"},s.a.createElement("div",null,h))),d&&s.a.createElement(Ln.a,{chatId:t,messageId:a,photo:d,style:_c,openMedia:this.openMedia})))}}var Oc=Object(u.a)(Object(u.d)(),Object(p.c)(),Object(u.c)())(xc),Pc=a(160);a(466);class Tc extends s.a.Component{constructor(e){super(e),this.onClientUpdateRemoteStickersHint=e=>{const t=e.hint,a=this.state.hint;if(a&&t.timestamp!==a.timestamp)return;this.setState({hint:jo.a.hint,items:this.getItems(jo.a.hint)});const n=ft.a.getStore(),s=t.stickers;Object(mt.z)(n,s.stickers)},this.onClientUpdateLocalStickersHint=e=>{const t=e.hint;if(this.setState({hint:t,items:this.getItems(t),previewStickerId:0,showPreview:!1,cancelSend:!1}),!t)return;const a=ft.a.getStore(),n=t.stickers;Object(mt.z)(a,n.stickers)},this.handleSend=e=>{this.state.cancelSend||e&&V.a.clientUpdate({"@type":"clientUpdateStickerSend",sticker:e})},this.loadPreviewContent=e=>{const t=this.state.items,a=t.find(t=>t.sticker.id===e);if(!a)return;const n=ft.a.getStore();Object(mt.w)(n,a,null);let s=8;this.hintsRef&&this.hintsRef.current&&(s=Math.floor(this.hintsRef.current.clientWidth/B.kb)),this.getNeighborStickers(e,t,s).forEach(e=>{Object(mt.w)(n,e,null)})},this.getNeighborStickers=(e,t,a)=>{if(!t)return[];const n=[],s=t.findIndex(t=>t.sticker.id===e);if(-1===s)return[];const i=Math.floor(s/a),o=s%a,r=i-1,c=i+1,l=o-1,d=o+1;return r>=0&&(l>=0&&n.push(a*r+l),n.push(a*r+o),d<a&&n.push(a*r+d)),l>=0&&n.push(a*i+l),d<a&&n.push(a*i+d),c<Math.ceil(t.length/a)&&(l>=0&&n.push(a*c+l),n.push(a*c+o),d<a&&n.push(a*c+d)),n.map(e=>t[e])},this.handleMouseEnter=e=>{const t=Number(e.currentTarget.dataset.stickerId),a=this.getSticker(t);a&&this.mouseDown&&(this.mouseDownStickerId!==t&&(this.mouseDownStickerId=null),this.setState({sticker:a}),V.a.clientUpdate({"@type":"clientUpdateStickerPreview",sticker:a}),this.loadPreviewContent(t))},this.handleMouseDown=e=>{const t=Number(e.currentTarget.dataset.stickerId),a=this.getSticker(t);if(!a)return;this.mouseDownStickerId=t;const n=Date.now();return this.setState({sticker:a,timestamp:n,showPreview:!1,cancelSend:!1}),setTimeout(()=>{this.state.timestamp===n&&(this.setState({showPreview:!0,cancelSend:!0}),V.a.clientUpdate({"@type":"clientUpdateStickerPreview",sticker:a}))},500),this.loadPreviewContent(t),this.mouseDown=!0,document.addEventListener("mouseup",this.handleMouseUp),e.preventDefault(),e.stopPropagation(),!1},this.handleMouseUp=()=>{this.setState({sticker:null,timestamp:0,showPreview:!1}),V.a.clientUpdate({"@type":"clientUpdateStickerPreview",sticker:null}),this.mouseDown=!1,document.removeEventListener("mouseup",this.handleMouseUp)},this.getItems=e=>{const t=[];if(!e)return t;const a=new Map,n=e.stickers,s=e.foundStickers;return n&&n.stickers.forEach(e=>{t.push(e),a.set(e.sticker.id,e.sticker.id)}),s&&s.stickers.forEach(e=>{a.has(e.sticker.id)||(t.push(e),a.set(e.sticker.id,e.sticker.id))}),t},this.hintsRef=s.a.createRef(),this.state={hint:null,items:[],previewStickerId:0,showPreview:!1,cancelSend:!1}}componentDidMount(){jo.a.on("clientUpdateLocalStickersHint",this.onClientUpdateLocalStickersHint),jo.a.on("clientUpdateRemoteStickersHint",this.onClientUpdateRemoteStickersHint)}componentWillUnmount(){jo.a.off("clientUpdateLocalStickersHint",this.onClientUpdateLocalStickersHint),jo.a.off("clientUpdateRemoteStickersHint",this.onClientUpdateRemoteStickersHint)}getSticker(e){const t=this.state.items,a=t.findIndex(t=>t.sticker.id===e);return-1!==a?t[a]:null}render(){const e=this.state,t=e.hint,a=e.items,n=e.sticker,i=e.showPreview;if(!t)return null;if(!a)return null;if(!a.length)return null;const o=a.map(e=>s.a.createElement("div",{className:"sticker-set-dialog-item",key:e.sticker.id,"data-sticker-id":e.sticker.id,style:{width:B.kb,height:B.kb},onClick:()=>this.handleSend(e),onMouseEnter:this.handleMouseEnter,onMouseDown:this.handleMouseDown},s.a.createElement(hc.b,{key:e.sticker.id,className:"sticker-set-dialog-item-sticker",sticker:e,autoplay:!1,blur:!1,displaySize:B.mb,preview:!0,source:hc.a.HINTS})));return s.a.createElement("div",{ref:this.hintsRef,className:"stickers-hint"},o,Boolean(n)&&i&&s.a.createElement(Pc.a,{sticker:n}))}}var Nc=Tc;a(467);const Dc=Object.freeze({SCROLL_TO_BOTTOM:"SCROLL_TO_BOTTOM",SCROLL_TO_UNREAD:"SCROLL_TO_UNREAD",SCROLL_TO_MESSAGE:"SCROLL_TO_MESSAGE",KEEP_SCROLL_POSITION:"KEEP_SCROLL_POSITION",NONE:"NONE"});class Lc extends s.a.Component{constructor(e){var t;super(e),t=this,this.onKeyDown=e=>{},this.onClientUpdateTryEditMessage=function(){var e=Object(h.a)(d.a.mark((function e(a){var n,s,i,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.completed){e.next=11;break}n=t.state.history,s=n.length-1;case 3:if(!(s>=0)){e.next=11;break}if(i=n[s],!Object(Tt.b)(i.chat_id,i.id)){e.next=8;break}return V.a.clientUpdate({"@type":"clientUpdateEditMessage",chatId:i.chat_id,messageId:i.id}),e.abrupt("return");case 8:s--,e.next=3;break;case 11:return e.next=13,V.a.send({"@type":"searchChatMessages",chat_id:t.props.chatId,query:"",sender_user_id:ht.a.getMyId(),from_message_id:0,offset:0,limit:100,filter:{"@type":"searchMessagesFilterEmpty"}});case 13:o=e.sent,s=0;case 15:if(!(s<o.messages.length)){e.next=23;break}if(i=o.messages[s],!Object(Tt.b)(i.chat_id,i.id)){e.next=20;break}return V.a.clientUpdate({"@type":"clientUpdateEditMessage",chatId:i.chat_id,messageId:i.id}),e.abrupt("return");case 20:s++,e.next=15;break;case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.onClientUpdateDialogsReady=function(){var e=Object(h.a)(d.a.mark((function e(a){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ft.a.initDB(Object(h.a)(d.a.mark((function e(){var a,n,s,i,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.props,n=a.chatId,s=a.messageId,!n){e.next=18;break}if(!(i=gt.a.get(n))){e.next=18;break}o=i.type,e.t0=o["@type"],e.next="chatTypePrivate"===e.t0||"chatTypeSecret"===e.t0?8:"chatTypeBasicGroup"===e.t0?11:"chatTypeSupergroup"===e.t0?14:17;break;case 8:return e.next=10,V.a.send({"@type":"createPrivateChat",user_id:o.user_id,force:!1});case 10:return e.abrupt("break",17);case 11:return e.next=13,V.a.send({"@type":"createBasicGroupChat",basic_group_id:o.basic_group_id,force:!1});case 13:return e.abrupt("break",17);case 14:return e.next=16,V.a.send({"@type":"createSupergroupChat",supergroup_id:o.supergroup_id,force:!1});case 16:return e.abrupt("break",17);case 17:t.handleSelectChat(n,0,s,0);case 18:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.onClientUpdateFocusWindow=e=>{e.focused&&(this.defferedActions.forEach(e=>e()),this.defferedActions=[])},this.onClientUpdateOpenReply=e=>{const t=e.chatId,a=e.messageId,n=this.state.replyHistory;if(this.props.chatId!==t)return;const s=n.length>0?n[n.length-1]:null;s&&s.chatId===t&&s.messageId===a||n.push({chatId:t,messageId:a})},this.onClientUpdateMediaActive=e=>{const t=this.listRef.current,a=t.offsetHeight,n=t.scrollTop;this.setState({playerOpened:!0},()=>{t.scrollTop===n&&(t.scrollTop+=Math.abs(a-t.offsetHeight))})},this.onClientUpdateMediaEnding=e=>{const t=this.listRef.current;this.prevOffsetHeight=t.offsetHeight,this.prevScrollTop=t.scrollTop},this.onClientUpdateMediaEnd=e=>{const t=this.listRef.current;this.setState({playerOpened:!1},()=>{t.scrollTop===this.prevScrollTop&&(t.scrollTop-=Math.abs(this.prevOffsetHeight-t.offsetHeight))})},this.onClientUpdateSelection=e=>{this.setState({selectionActive:Nt.a.selectedItems.size>0})},this.onClientUpdateClearHistory=e=>{this.props.chatId===e.chatId&&this.setState({clearHistory:e.inProgress})},this.onUpdateMessageContent=e=>{const t=this.props.chatId,a=this.state.history,n=e.chat_id,s=e.message_id;if(t===n&&-1!==a.findIndex(e=>e.id===s)){const e=Nt.a.get(n,s);if(!e)return;const t=ft.a.getStore();Object(mt.t)(t,[e])}},this.onUpdateChatLastMessage=e=>{this.props.chatId;e.chat_id},this.onUpdateMessageSendSucceeded=e=>{if(!this.completed)return;const t=e.message,a=e.old_message_id;if(this.props.chatId!==t.chat_id)return;const n=t.is_outgoing?Dc.SCROLL_TO_BOTTOM:Dc.KEEP_SCROLL_POSITION;this.replaceMessage(a,t,()=>{n!==Dc.KEEP_SCROLL_POSITION&&this.handleScrollBehavior(n,this.snapshot)});const s=ft.a.getStore();Object(mt.t)(s,[t]),this.viewMessages([t])},this.onUpdateNewMessage=e=>{if(!this.completed)return;const t=e.message;if(this.props.chatId!==t.chat_id)return;const a=this.listRef.current;let n=t.is_outgoing?Dc.SCROLL_TO_BOTTOM:Dc.NONE;a.scrollTop+a.offsetHeight>=a.scrollHeight&&(n=Dc.SCROLL_TO_BOTTOM);const s=t.is_outgoing?{scrollDownVisible:!1}:{},i=[t];this.scrollBehaviorNone=!0,this.insertPrevious(Object(Tt.e)(i),s,()=>{this.scrollBehaviorNone=!1,this.handleScrollBehavior(n,this.snapshot)});const o=ft.a.getStore();Object(mt.t)(o,i),this.viewMessages(i)},this.onUpdateDeleteMessages=e=>{const t=this.props.chatId,a=e.chat_id,n=e.is_permanent,s=e.message_ids;t===a&&n&&this.deleteHistory(s)},this.updateItemsInView=()=>{if(!this.messages)return;const e=new Map,t=Object(ze.t)(this.listRef,this.itemsRef);for(let a=0;a<t.length;a++){const n=this.messages[t[a]];if(n){const t=n.props,a=t.chatId,s=t.messageId,i="".concat(a,"_").concat(s);e.set(i,i)}}V.a.clientUpdate({"@type":"clientUpdateMessagesInView",messages:e})},this.loadIncompleteHistory=function(){var e=Object(h.a)(d.a.mark((function e(a){var n,s,i;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=5,s=a&&a.messages.length>0&&a.messages.length<B.t,i=0;case 3:if(!(i<n&&s)){e.next=11;break}return e.next=6,t.onLoadNext();case 6:a=e.sent,s=a&&a.messages.length>0&&a.messages.length<B.t;case 8:i++,e.next=3;break;case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.onLoadNext=Object(h.a)(d.a.mark((function e(){var a,n,s,i,o,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.props.chatId,n=t.state.history,a){e.next=4;break}return e.abrupt("return");case 4:if(!t.loading){e.next=6;break}return e.abrupt("return");case 6:if(!t.loadMigratedHistory){e.next=9;break}return t.onLoadMigratedHistory(),e.abrupt("return");case 9:return s=n&&n.length>0?n[0].id:0,t.loading=!0,i=t.sessionId,e.next=14,V.a.send({"@type":"getChatHistory",chat_id:a,from_message_id:s,offset:0,limit:B.t}).finally(()=>{t.loading=!1});case 14:if(o=e.sent,i===t.sessionId){e.next=17;break}return e.abrupt("return");case 17:if(t.props.chatId===a){e.next=19;break}return e.abrupt("return");case 19:return Nt.a.setItems(o.messages),o.messages.reverse(),t.insertNext(Object(Tt.e)(o.messages),()=>{o.messages.length||t.onLoadMigratedHistory()}),r=ft.a.getStore(),Object(mt.t)(r,o.messages),t.viewMessages(o.messages),e.abrupt("return",o);case 26:case"end":return e.stop()}}),e)}))),this.onLoadMigratedHistory=Object(h.a)(d.a.mark((function e(){var a,n,s,i,o,r,c,l,h;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.props.chatId,n=t.state.history,a){e.next=4;break}return e.abrupt("return");case 4:if(!t.loading){e.next=6;break}return e.abrupt("return");case 6:if(s=Object(Ze.H)(a)){e.next=9;break}return e.abrupt("return");case 9:if(i=Qt.a.getFullInfo(s)){e.next=12;break}return e.abrupt("return");case 12:if(i.upgraded_from_basic_group_id){e.next=14;break}return e.abrupt("return");case 14:return t.loadMigratedHistory=!0,e.next=17,V.a.send({"@type":"createBasicGroupChat",basic_group_id:i.upgraded_from_basic_group_id});case 17:if(o=e.sent){e.next=20;break}return e.abrupt("return");case 20:return r=n.length>0&&n[0].chat_id===o.id?n[0].id:0,t.loading=!0,c=t.sessionId,e.next=25,V.a.send({"@type":"getChatHistory",chat_id:o.id,from_message_id:r,offset:0,limit:B.t}).finally(()=>{t.loading=!1});case 25:if(l=e.sent,c===t.sessionId){e.next=28;break}return e.abrupt("return");case 28:if(t.props.chatId===a){e.next=30;break}return e.abrupt("return");case 30:Nt.a.setItems(l.messages),l.messages.reverse(),t.insertNext(Object(Tt.e)(l.messages)),h=ft.a.getStore(),Object(mt.t)(h,l.messages),t.viewMessages(l.messages);case 36:case"end":return e.stop()}}),e)}))),this.onLoadPrevious=Object(h.a)(d.a.mark((function e(){var a,n,s,i,o,r,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.props.chatId,n=t.state.history,s=gt.a.get(a)){e.next=5;break}return e.abrupt("return");case 5:if(!t.loading){e.next=7;break}return e.abrupt("return");case 7:if(!t.completed){e.next=9;break}return e.abrupt("return");case 9:return i=n&&n.length>0?n[n.length-1].id:0,t.loading=!0,o=t.sessionId,e.next=14,V.a.send({"@type":"getChatHistory",chat_id:a,from_message_id:i,offset:-B.t-1,limit:B.t+1}).finally(()=>{t.loading=!1});case 14:if(r=e.sent,o===t.sessionId){e.next=17;break}return e.abrupt("return");case 17:if(t.props.chatId===a){e.next=19;break}return e.abrupt("return");case 19:return s.last_message?t.completed=r.messages.length>0&&s.last_message.id===r.messages[0].id:t.completed=!0,Object(Tt.d)(r,t.state.history),Nt.a.setItems(r.messages),r.messages.reverse(),t.scrollBehaviorNone=!0,t.insertPrevious(Object(Tt.e)(r.messages),{},()=>{t.scrollBehaviorNone=!1}),c=ft.a.getStore(),Object(mt.t)(c,r.messages),t.viewMessages(r.messages),e.abrupt("return",r);case 29:case"end":return e.stop()}}),e)}))),this.handleScroll=()=>{const e=this.state,t=e.scrollDownVisible,a=e.replyHistory,n=e.history,s=this.listRef.current;this.updateItemsInView(),s.scrollTop<=B.gb?this.onLoadNext():s.scrollTop+s.offsetHeight>=s.scrollHeight-B.gb&&this.onLoadPrevious(),s.scrollTop+s.offsetHeight>=s.scrollHeight-B.gb?this.completed&&t&&(this.prevScrollTop!==s.scrollTop&&this.prevScrollTop&&this.prevHistory===n?this.setState({scrollDownVisible:!1,replyHistory:[]}):a.length||this.setState({scrollDownVisible:!1})):t||this.setState({scrollDownVisible:!0}),this.prevScrollTop=s.scrollTop,this.prevHistory=n},this.handleScrollBehavior=(e,t)=>{const a=this.props,n=(a.chatId,a.messageId,t||{scrollTop:0,scrollHeight:0,offsetHeight:0});n.scrollTop,n.scrollHeight,n.offsetHeight;switch(e){case Dc.SCROLL_TO_BOTTOM:this.scrollToBottom();break;case Dc.SCROLL_TO_MESSAGE:this.scrollToMessage();break;case Dc.SCROLL_TO_UNREAD:this.scrollToUnread();break;case Dc.KEEP_SCROLL_POSITION:this.keepScrollPosition(t);break;case Dc.NONE:}},this.keepScrollPosition=e=>{const t=e.scrollTop,a=e.scrollHeight,n=(e.offsetHeight,this.listRef.current);n.scrollTop=t+(n.scrollHeight-a)},this.scrollToUnread=()=>{const e=this.props,t=e.chatId,a=(e.messageId,this.state.history),n=this.listRef.current;gt.a.get(t);let s=!1;for(let o=0;o<a.length;o++){let e=this.itemsMap.get(o),t=i.findDOMNode(e);if(t&&e.props.showUnreadSeparator){n.scrollTop=t.offsetTop-0,s=!0;break}}s||this.scrollToBottom()},this.scrollToMessage=()=>{const e=this.props,t=(e.chatId,e.messageId),a=this.state.history,n=this.listRef.current;let s=!1;for(let o=0;o<a.length;o++){const e=this.itemsMap.get(o),a=i.findDOMNode(e);if(a&&e.props.messageId===t){n.scrollTop=a.offsetTop-n.offsetHeight/2,s=!0;break}}},this.scrollToBottom=()=>{const e=this.props,t=(e.chatId,e.messageId,this.listRef.current);t.scrollHeight-t.offsetHeight!==t.scrollTop&&(t.scrollTop=t.scrollHeight-t.offsetHeight)},this.scrollToStart=Object(h.a)(d.a.mark((function e(){var a,n,s,i,o,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.props.chatId,n=gt.a.get(a)){e.next=4;break}return e.abrupt("return");case 4:return t.sessionId=Date.now(),t.loading=!1,t.completed=!1,0,0,s=B.t,t.loading=!0,i=t.sessionId,e.next=14,V.a.send({"@type":"getChatHistory",chat_id:n.id,from_message_id:0,offset:0,limit:s}).finally(()=>{t.loading=!1});case 14:if(o=e.sent,i===t.sessionId){e.next=17;break}return e.abrupt("return");case 17:if(t.props.chatId===a){e.next=19;break}return e.abrupt("return");case 19:n.last_message?t.completed=o.messages.length>0&&n.last_message.id===o.messages[0].id:t.completed=!0,t.setState({scrollDownVisible:!1,replyHistory:[]}),Nt.a.setItems(o.messages),o.messages.reverse(),t.replace(t.state.separatorMessageId,o.messages,()=>{t.handleScrollBehavior(Dc.SCROLL_TO_BOTTOM,t.snapshot)}),r=ft.a.getStore(),Object(mt.t)(r,o.messages),t.viewMessages(o.messages),t.loadIncompleteHistory(o);case 28:case"end":return e.stop()}}),e)}))),this.handleListDragEnter=e=>{e.preventDefault(),e.stopPropagation();const t=this.props.chatId;Object(Ze.d)(t)&&V.a.clientUpdate({"@type":"clientUpdateDragging",dragging:!0,files:e.dataTransfer.files})},this.handleScrollDownClick=e=>{const t=this.state.replyHistory;if(t.length>0){const e=t.pop();if(e){const t=e.chatId,a=e.messageId;t===this.props.chatId&&Object(nt.h)(t,a)}}else this.scrollToStart()},this.sessionId=Date.now(),this.state={prevChatId:0,prevMessageId:null,playerOpened:!1,history:[],clearHistory:!1,selectionActive:!1,separatorMessageId:0,scrollDownVisible:!1,replyHistory:[]},this.listRef=s.a.createRef(),this.itemsRef=s.a.createRef(),this.scrollDownButtonRef=s.a.createRef(),this.defferedActions=[],this.itemsMap=new Map,this.updateItemsInView=Object(ze.x)(this.updateItemsInView,500)}static getDerivedStateFromProps(e,t){return e.chatId!==t.prevChatId||e.messageId!==t.prevMessageId?{prevChatId:e.chatId,prevMessageId:e.messageId,clearHistory:!1,selectionActive:!1,separatorMessageId:e.chatId!==t.prevChatId?0:t.separatorMessageId,scrollDownVisible:e.chatId===t.prevChatId&&(t.scrollDownVisible||t.replyHistory.length>0),replyHistory:e.chatId!==t.prevChatId?[]:t.replyHistory}:null}getSnapshotBeforeUpdate(e,t){const a=this.listRef.current,n={scrollTop:a.scrollTop,scrollHeight:a.scrollHeight,offsetHeight:a.offsetHeight};return this.snapshot=n,n}componentDidUpdate(e,t,a){const n=this.props,s=n.chatId,i=n.messageId;this.state.scrollDownVisible,this.listRef.current;e.chatId!==s||e.messageId!==i?this.handleSelectChat(s,e.chatId,i,e.messageId):this.scrollBehaviorNone||this.handleScrollBehavior(Dc.KEEP_SCROLL_POSITION,a)}shouldComponentUpdate(e,t){const a=this.props,n=a.chatId,s=a.messageId,i=a.theme,o=this.state,r=o.playerOpened,c=o.history,l=o.dragging,d=o.clearHistory,h=o.selectionActive,u=o.scrollDownVisible;return e.theme!==i||(e.chatId!==n||(e.messageId!==s||(t.scrollDownVisible!==u||(t.playerOpened!==r||(!Object(ze.m)(t.history,c)||(t.dragging!==l||(t.clearHistory!==d||t.selectionActive!==h)))))))}componentDidMount(){v.a.on("clientUpdateFocusWindow",this.onClientUpdateFocusWindow),v.a.on("clientUpdateDialogsReady",this.onClientUpdateDialogsReady),gt.a.on("clientUpdateClearHistory",this.onClientUpdateClearHistory),gt.a.on("updateChatLastMessage",this.onUpdateChatLastMessage),Nt.a.on("clientUpdateClearSelection",this.onClientUpdateSelection),Nt.a.on("clientUpdateMessageSelected",this.onClientUpdateSelection),Nt.a.on("clientUpdateOpenReply",this.onClientUpdateOpenReply),Nt.a.on("clientUpdateTryEditMessage",this.onClientUpdateTryEditMessage),Nt.a.on("updateNewMessage",this.onUpdateNewMessage),Nt.a.on("updateDeleteMessages",this.onUpdateDeleteMessages),Nt.a.on("updateMessageContent",this.onUpdateMessageContent),Nt.a.on("updateMessageSendSucceeded",this.onUpdateMessageSendSucceeded),Mr.b.on("clientUpdateMediaActive",this.onClientUpdateMediaActive),Mr.b.on("clientUpdateMediaEnding",this.onClientUpdateMediaEnding),Mr.b.on("clientUpdateMediaEnd",this.onClientUpdateMediaEnd)}componentWillUnmount(){v.a.off("clientUpdateFocusWindow",this.onClientUpdateFocusWindow),v.a.off("clientUpdateDialogsReady",this.onClientUpdateDialogsReady),gt.a.off("clientUpdateClearHistory",this.onClientUpdateClearHistory),gt.a.off("updateChatLastMessage",this.onUpdateChatLastMessage),Nt.a.off("clientUpdateClearSelection",this.onClientUpdateSelection),Nt.a.off("clientUpdateMessageSelected",this.onClientUpdateSelection),Nt.a.off("clientUpdateOpenReply",this.onClientUpdateOpenReply),Nt.a.off("clientUpdateTryEditMessage",this.onClientUpdateTryEditMessage),Nt.a.off("updateNewMessage",this.onUpdateNewMessage),Nt.a.off("updateDeleteMessages",this.onUpdateDeleteMessages),Nt.a.off("updateMessageContent",this.onUpdateMessageContent),Nt.a.off("updateMessageSendSucceeded",this.onUpdateMessageSendSucceeded),Mr.b.off("clientUpdateMediaActive",this.onClientUpdateMediaActive),Mr.b.off("clientUpdateMediaEnding",this.onClientUpdateMediaEnding),Mr.b.off("clientUpdateMediaEnd",this.onClientUpdateMediaEnd)}handleSelectChat(e,t,a,n){var s=this;return Object(h.a)(d.a.mark((function n(){var i,o,r,c,l,h,u,p,m,g,f,b,C;return d.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=gt.a.get(e),o=gt.a.get(t),s.sessionId=Date.now(),s.loading=!1,s.completed=!1,s.loadMigratedHistory=!1,s.defferedActions=[],!i){n.next=51;break}return V.a.send({"@type":"openChat",chat_id:i.id}),r=!a&&i.unread_count>0,c=r&&i.unread_count>1?i.last_read_inbox_message_id:a||0,l=r&&i.unread_count>1||a?-1-B.t:0,h=r&&i.unread_count>1||a?2*B.t:B.t,s.loading=!0,u=s.sessionId,n.next=17,V.a.send({"@type":"getChatHistory",chat_id:i.id,from_message_id:c,offset:l,limit:h}).finally(()=>{s.loading=!1});case 17:if(p=n.sent,u===s.sessionId){n.next=20;break}return n.abrupt("return");case 20:if(i.last_message?s.completed=p.messages.length>0&&i.last_message.id===p.messages[0].id:s.completed=!0,Nt.a.setItems(p.messages),p.messages.reverse(),m=s.state.separatorMessageId,e===t){n.next=39;break}if(m=Number.MAX_VALUE,!(i&&i.unread_count>1)){n.next=38;break}g=p.messages.length-1;case 28:if(!(g>=0)){n.next=38;break}if(f=p.messages[g].id,!(!p.messages[g].is_outgoing&&f>i.last_read_inbox_message_id&&f<m)){n.next=34;break}m=f,n.next=35;break;case 34:return n.abrupt("break",38);case 35:g--,n.next=28;break;case 38:m=m===Number.MAX_VALUE?0:m;case 39:b=Dc.SCROLL_TO_BOTTOM,a?b=Dc.SCROLL_TO_MESSAGE:r&&m&&(b=Dc.SCROLL_TO_UNREAD),s.replace(m,p.messages,()=>{s.handleScrollBehavior(b,s.snapshot),a&&Object(nt.f)(e,a)}),C=ft.a.getStore(),Object(mt.t)(C,p.messages),s.viewMessages(p.messages),Object(mt.p)(C,[e]),Object(mt.q)(C,e),s.loadIncompleteHistory(p),Object(Ze.o)(i.id),n.next=53;break;case 51:s.loading=!0,s.replace(0,[],()=>{s.loading=!1});case 53:o&&t!==e&&V.a.send({"@type":"closeChat",chat_id:t});case 54:case"end":return n.stop()}}),n)})))()}viewMessages(e){if(!e)return;if(0===e.length)return;if(!e[0].chat_id)return;const t=()=>{V.a.send({"@type":"viewMessages",chat_id:e[0].chat_id,message_ids:e.map(e=>e.id)})};window.hasFocus?t():this.defferedActions.push(t)}cancelLoadMessageContents(e){for(let t=e.length-1;t>=0;t--){let a=e[t];if(a&&a.content)switch(a.content["@type"]){case"messagePhoto":{let e=this.getMessagePhoto(a),t=Object(T.a)(e,2),n=t[0];if(t[1]){Object(ze.i)(a.content.photo.sizes).blob||ft.a.cancelGetRemoteFile(n,a)}break}case"messageSticker":{let e=this.getMessageSticker(a),t=Object(T.a)(e,2),n=t[0];if(t[1]){a.content.sticker.sticker.blob||ft.a.cancelGetRemoteFile(n,a)}break}}}}replace(e,t,a){this.setState({separatorMessageId:e,history:t},a)}replaceMessage(e,t,a){t?this.setState({history:this.state.history.filter(t=>t.id!==e).concat([t])},a):a&&a()}insertNext(e,t){0!==e.length?this.setState({history:e.concat(this.state.history)},t):t&&t()}insertPrevious(e,t,a){0!==e.length?this.setState(Object(ae.a)({history:this.state.history.concat(e)},t),a):a&&a()}deleteHistory(e,t){const a=this.state.history;if(0===a.length)return void(t&&t());const n=new Map(e.map(e=>[e,e]));this.setState({history:a.filter(e=>!n.has(e.id))},t)}showMessageTitle(e,t,a){if(!e)return!1;const n=e.chat_id,s=e.date,i=e.sender_user_id;e.content;return!!a||(!!Object(Ze.M)(n)||t&&(Object(Ic.b)(t)||i!==t.sender_user_id||s-t.date>B.u))}showMessageDate(e,t,a){if(a)return!0;const n=new Date(1e3*e.date),s=t?new Date(1e3*t.date):n;return n.getFullYear()!==s.getFullYear()||n.getMonth()!==s.getMonth()||n.getDate()!==s.getDate()}render(){const e=this.props.chatId,t=this.state,a=t.history,n=t.separatorMessageId,i=t.clearHistory,o=t.selectionActive,r=t.scrollDownVisible;return this.itemsMap.clear(),this.messages=i?null:a.map((e,t)=>{const i=t>0?a[t-1]:null,o=t<a.length-1?a[t+1]:null,r=this.showMessageDate(e,i,0===t);let c=null;if(Object(Ic.b)(e))c=s.a.createElement(Oc,{key:"chat_id=".concat(e.chat_id," message_id=").concat(e.id),ref:e=>this.itemsMap.set(t,e),chatId:e.chat_id,messageId:e.id,showUnreadSeparator:n===e.id});else{const a=this.showMessageTitle(e,i,0===t),l=this.showMessageTitle(o,e,!1),d=!o||Object(Ic.b)(o)||l;c=s.a.createElement(Sc,{key:"chat_id=".concat(e.chat_id," message_id=").concat(e.id),ref:e=>this.itemsMap.set(t,e),chatId:e.chat_id,messageId:e.id,sendingState:e.sending_state,showTitle:a,showTail:d,showUnreadSeparator:n===e.id,showDate:r})}return c}),s.a.createElement("div",{className:q()("messages-list",{"messages-list-selection-active":o}),onDragEnter:this.handleListDragEnter},s.a.createElement("div",{ref:this.listRef,className:"messages-list-wrapper",onScroll:this.handleScroll},s.a.createElement("div",{className:"messages-list-top"}),s.a.createElement("div",{ref:this.itemsRef,className:"messages-list-items"},this.messages)),s.a.createElement(qr,{chatId:e}),s.a.createElement($e,null),r&&s.a.createElement(Mc,{ref:this.scrollDownButtonRef,onClick:this.handleScrollDownClick}),s.a.createElement(Xr,null),s.a.createElement(Nc,null))}}var jc=Lc,Rc=a(266),Ac=a.n(Rc),Fc=a(267),Bc=a.n(Fc);class Vc extends s.a.Component{constructor(...e){super(...e),this.state={anchorEl:null},this.handleMenuClick=e=>{this.handleOpen(e.currentTarget)},this.handleOpen=e=>{this.setState({anchorEl:e})},this.handleClose=()=>{this.setState({anchorEl:null})},this.handleCopyLink=()=>{this.handleClose();const e=this.props.t,t=this.getStickersLink(jo.a.stickerSet);if(!t)return;ua(t);const a="".concat(t,"_copy_stickers_link"),n=e("LinkCopied");this.handleScheduledAction(a,n,null)},this.getStickersLink=e=>{if(!e)return"";const t=e.name;if(!t)return"";const a=re.a.get("t_me_url");return(a?a.value:"https://telegram.org/")+"addstickers/"+t},this.handleScheduledAction=(e,t,a)=>{if(!e)return;const n=this.props,i=n.enqueueSnackbar;n.classes,n.t;if(!i)return;v.a.addScheduledAction(e,B.y+300,a)&&i(t,{autoHideDuration:B.y,action:[s.a.createElement(J.a,{key:"close","aria-label":"Close",color:"inherit",className:"notification-close-button",onClick:()=>v.a.removeScheduledAction(e)},s.a.createElement(la.a,null))]})},this.handleShare=()=>{this.handleClose();const e=this.getStickersLink(jo.a.stickerSet);if(!e)return;V.a.clientUpdate({"@type":"clientUpdateStickerSet",stickerSet:null});const t={"@type":"inputMessageText",text:{"@type":"formattedText",text:e,entities:null},disable_web_page_preview:!1,clear_draft:!1};V.a.clientUpdate({"@type":"clientUpdateForward",info:{inputMessageContent:t}})}}render(){const e=this.props,t=e.t,a=e.className,n=this.state.anchorEl;return s.a.createElement(s.a.Fragment,null,s.a.createElement(J.a,{className:a,"aria-label":"Share",open:Boolean(n),onClick:this.handleMenuClick},s.a.createElement(Ws,null)),s.a.createElement(ws.a,{id:"attach-menu",anchorEl:n,open:Boolean(n),getContentAnchorEl:null,disableAutoFocusItem:!0,disableRestoreFocus:!0,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},onClose:this.handleClose},s.a.createElement(it.a,{onClick:this.handleCopyLink},s.a.createElement(ja.a,null,s.a.createElement(Ac.a,null)),s.a.createElement(Ra.a,{primary:t("CopyLink")})),s.a.createElement(it.a,{onClick:this.handleShare},s.a.createElement(ja.a,null,s.a.createElement(Bc.a,null)),s.a.createElement(Ra.a,{primary:t("StickersShare")}))))}}var zc=Object(u.a)(Object(p.c)(),ra.withSnackbar)(Vc);a(468);class Hc extends s.a.Component{constructor(e){super(e),this.handleUpdateInstalledStickerSets=e=>{const t=jo.a.stickerSet;this.setState({stickerSet:t})},this.handleClientUpdateStickerSet=e=>{const t=e.stickerSet;if(this.setState({stickerSet:t}),t){const e=ft.a.getStore();Object(mt.x)(e,t)}},this.handleClose=()=>{V.a.clientUpdate({"@type":"clientUpdateStickerSet",stickerSet:null})},this.handleDone=()=>{const e=this.state.stickerSet;if(!e)return;const t=e.is_installed;V.a.send({"@type":"changeStickerSet",set_id:e.id,is_installed:!t}),this.handleClose()},this.loadPreviewContent=e=>{const t=this.state.stickerSet.stickers.find(t=>t.sticker.id===e);if(!t)return;const a=ft.a.getStore();Object(mt.w)(a,t,null),this.getNeighborStickers(e).forEach(e=>{Object(mt.w)(a,e,null)})},this.getNeighborStickers=e=>{const t=this.state.stickerSet;if(!t)return[];const a=t.stickers;if(!a)return[];const n=[],s=a.findIndex(t=>t.sticker.id===e);if(-1===s)return[];const i=Math.floor(s/4),o=s%4,r=i-1,c=i+1,l=o-1,d=o+1;return r>=0&&(l>=0&&n.push(4*r+l),n.push(4*r+o),d<4&&n.push(4*r+d)),l>=0&&n.push(4*i+l),d<4&&n.push(4*i+d),c<Math.ceil(a.length/4)&&(l>=0&&n.push(4*c+l),n.push(4*c+o),d<4&&n.push(4*c+d)),n.map(e=>a[e])},this.handleMouseUp=()=>{this.setState({sticker:null}),V.a.clientUpdate({"@type":"clientUpdateStickerPreview",sticker:null}),this.mouseDown=!1,document.removeEventListener("mouseup",this.handleMouseUp)},this.handleMouseEnter=e=>{const t=Number(e.currentTarget.dataset.stickerId),a=this.getSticker(t);a&&this.mouseDown&&(this.setState({sticker:a}),V.a.clientUpdate({"@type":"clientUpdateStickerPreview",sticker:a}),this.loadPreviewContent(t))},this.handleMouseDown=e=>{const t=Number(e.currentTarget.dataset.stickerId),a=this.getSticker(t);if(a)return this.setState({sticker:a}),V.a.clientUpdate({"@type":"clientUpdateStickerPreview",sticker:a}),this.loadPreviewContent(t),this.mouseDown=!0,document.addEventListener("mouseup",this.handleMouseUp),e.preventDefault(),e.stopPropagation(),!1},this.state={stickerSet:jo.a.stickerSet,stickerId:0}}shouldComponentUpdate(e,t,a){const n=this.state,s=n.stickerSet,i=n.sticker;return s!==t.stickerSet||i!==t.sticker}componentDidMount(){jo.a.on("clientUpdateStickerSet",this.handleClientUpdateStickerSet),jo.a.on("updateInstalledStickerSets",this.handleUpdateInstalledStickerSets)}componentWillUnmount(){jo.a.off("clientUpdateStickerSet",this.handleClientUpdateStickerSet),jo.a.off("updateInstalledStickerSets",this.handleUpdateInstalledStickerSets)}getSticker(e){const t=this.state.stickerSet;if(!t)return null;const a=t.stickers,n=a.findIndex(t=>t.sticker.id===e);return-1!==n?a[n]:null}render(){const e=this.props.t,t=this.state,a=t.stickerSet,n=t.sticker;if(!a)return null;const i=a.title,o=a.stickers,r=a.is_installed,c=o.map(e=>s.a.createElement("div",{className:"sticker-set-dialog-item",key:e.sticker.id,"data-sticker-id":e.sticker.id,style:{width:76,height:76},onMouseEnter:this.handleMouseEnter,onMouseDown:this.handleMouseDown},s.a.createElement(hc.b,{key:e.sticker.id,className:"sticker-set-dialog-item-sticker",sticker:e,autoplay:!1,blur:!1,displaySize:B.mb,preview:!0,source:hc.a.STICKER_SET}),s.a.createElement("div",{className:"sticker-set-dialog-item-emoji"},e.emoji)));return s.a.createElement(M.a,{className:"sticker-set-dialog",open:!0,transitionDuration:0,onClose:this.handleClose,"aria-labelledby":"sticker-set-dialog-title-text",classes:{paper:"sticker-set-dialog-paper"}},s.a.createElement(O.a,{id:"sticker-set-dialog-title-text",className:q()({"sticker-set-dialog-disabled":Boolean(n)}),disableTypography:!0},s.a.createElement(Y.a,{variant:"h6",className:"sticker-set-dialog-title-typography",noWrap:!0},i),s.a.createElement(zc,{className:"sticker-set-dialog-share-button"})),s.a.createElement(_.a,{classes:{root:"sticker-set-dialog-content-root"},onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut},c),s.a.createElement(I.a,{className:q()({"sticker-set-dialog-disabled":Boolean(n)})},s.a.createElement(w.a,{color:"primary",onClick:this.handleClose},e("Cancel")),s.a.createElement(w.a,{color:"primary",onClick:this.handleDone},e(r?"StickersRemove":"Add"))),s.a.createElement(Pc.a,{sticker:n}))}}var Wc=Object(p.c)()(Hc);class Gc extends n.Component{constructor(e){super(e),this.onUpdateChatDetailsVisibility=e=>{this.forceUpdate()},this.onClientUpdateChatId=e=>{this.setState({chatId:e.nextChatId,messageId:e.nextMessageId})},this.scrollToBottom=()=>{this.messagesList.scrollToBottom()},this.scrollToStart=()=>{this.messagesList.scrollToStart()},this.scrollToMessage=()=>{this.messagesList.scrollToMessage()},this.state={chatId:v.a.getChatId(),messageId:v.a.getMessageId(),selectedCount:0}}shouldComponentUpdate(e,t){const a=this.state,n=a.chatId,s=a.messageId,i=a.selectedCount;return t.chatId!==n||(t.messageId!==s||t.selectedCount!==i)}componentDidMount(){v.a.on("clientUpdateChatDetailsVisibility",this.onUpdateChatDetailsVisibility),v.a.on("clientUpdateChatId",this.onClientUpdateChatId)}componentWillUnmount(){v.a.off("clientUpdateChatDetailsVisibility",this.onUpdateChatDetailsVisibility),v.a.off("clientUpdateChatId",this.onClientUpdateChatId)}render(){const e=this.state,t=e.chatId,a=e.messageId,n=(e.selectedCount,v.a.isChatDetailsVisible);return s.a.createElement("div",{className:q()("dialog-details",{"dialog-details-third-column":n})},s.a.createElement(Kr,null),s.a.createElement(dr,{chatId:t}),s.a.createElement(jc,{ref:e=>this.messagesList=e,chatId:t,messageId:a}),s.a.createElement(Wo,{chatId:t}),s.a.createElement(Wc,null),s.a.createElement(Hi,null))}}var Kc=Gc;const Zc=s.a.createContext(null);var qc=Zc;function Yc(e){class t extends s.a.Component{render(){return s.a.createElement(Zc.Consumer,null,t=>s.a.createElement(e,Object.assign({iv:t},this.props)))}}return t.displayName="WithIV(".concat(Object(u.b)(e),")"),t}function Jc(e){return function(e){if(!e)return null;if(e instanceof String)return e;switch(e["@type"]){case"richTextAnchor":{const t=e.name,a=e.text;return s.a.createElement(Kl,{text:a,name:t})}case"richTextBold":{const t=e.text;return s.a.createElement(Nl,{text:t})}case"richTextEmailAddress":{const t=e.email_address,a=e.text;return s.a.createElement(Dl,{emailAddress:t,text:a})}case"richTextFixed":{const t=e.text;return s.a.createElement(Ll,{text:t})}case"richTextIcon":{const t=e.document,a=e.height,n=e.width;return s.a.createElement(Rl,{document:t,height:a,width:n})}case"richTextItalic":{const t=e.text;return s.a.createElement(Al,{text:t})}case"richTextMarked":{const t=e.text;return s.a.createElement(Fl,{text:t})}case"richTextPhoneNumber":{const t=e.phone_number,a=e.text;return s.a.createElement(Bl,{phoneNumber:t,text:a})}case"richTextPlain":{const t=e.text;return s.a.createElement(zl,{text:t})}case"richTextStrikethrough":{const t=e.text;return s.a.createElement(Hl,{text:t})}case"richTextSubscript":{const t=e.text;return s.a.createElement(Wl,{text:t})}case"richTextSuperscript":{const t=e.text;return s.a.createElement(Gl,{text:t})}case"richTexts":{const t=e.texts;return s.a.createElement(Zl,{texts:t})}case"richTextUnderline":{const t=e.text;return s.a.createElement(ql,{text:t})}case"richTextUrl":{const t=e.text,a=e.url;return s.a.createElement(Jl,{text:t,url:a})}}return"[".concat(e["@type"],"]")}(e.text)}Jc.propTypes={text:Sn.a.object.isRequired};var Qc=Jc;var Xc=function(e){return s.a.createElement("a",{id:e.name})};var $c=function(e){const t=e.text,a=e.credit,n=!od(t),i=!od(a);return n||i?s.a.createElement("figcaption",null,n&&s.a.createElement(Qc,{text:t}),i&&s.a.createElement("cite",null,s.a.createElement(Qc,{text:a}))):null};var el=function(e){const t=e.animation,a=e.block,n=e.caption,i=(e.need_autoplay,e.openMedia);return s.a.createElement("figure",null,s.a.createElement(cc.a,{iv:!0,pageBlock:a,animation:t,displaySize:B.j,openMedia:i}),s.a.createElement($c,{text:n.text,credit:n.credit}))},tl=a(67);var al=function(e){const t=e.author,a=e.publishDate,n=!od(t),i=a>0;if(!n&&!i)return null;const o=a>0?new Date(1e3*a):null;return s.a.createElement("address",null,n&&s.a.createElement("a",{rel:"author"},s.a.createElement(Qc,{text:t})),n&&i&&" \u2022 ",i&&s.a.createElement("time",{dateTime:o.toISOString()},Object(tl.a)(o,"dd mmm, yyyy")))};var nl=function(e){const t=e.text,a=e.credit;return s.a.createElement("blockquote",null,s.a.createElement(Qc,{text:t}),a&&s.a.createElement("cite",null,s.a.createElement(Qc,{text:a})))};var sl=Yc((function(e){const t=e.pageBlocks,a=e.caption,n=e.iv;return s.a.createElement("div",{className:"collage"},t.map((e,t)=>id(e,n,t)),s.a.createElement($c,{text:a.text,credit:a.credit}))}));function il(e){return id(e.cover,e.iv)}il.propTypes={cover:Sn.a.object.isRequired};var ol=Yc(il);var rl=Yc((function(e){const t=e.header,a=e.pageBlocks,n=e.isOpen,i=e.iv;return s.a.createElement("details",{open:n},s.a.createElement("summary",null,s.a.createElement(Qc,{text:t})),a.map((e,t)=>id(e,i,t)))}));var cl=function(){return s.a.createElement("hr",null)},ll=a(268);class dl extends s.a.Component{constructor(e){super(e),this.updateIframe=e=>{if(e.src)return;const t=e.content||e.children;if(!t)return;const a=this.frameRef.current;if(!a)return;const n=a.contentDocument;n&&("string"===typeof t?(n.open(),n.write(t),n.close()):(n.open(),n.write('<div id="iframe-root"></div>'),n.close(),o.a.render(t,n.getElementById("iframe-root"))))},this.injectIframeResizerUrl=()=>{if(!this.props.iframeResizerUrl)return;const e=this.frameRef.current;if(!e)return;const t=e.contentDocument;if(!t)return;let a=null;if(["head","HEAD","body","BODY","div","DIV"].forEach(e=>{if(a)return;const n=t.getElementsByTagName(e);n&&n.length&&(a=n[0])}),!a)return void console.error("Unable to inject iframe resizer script");const n=document.createElement("script");n.type="text/javascript",n.src=this.props.iframeResizerUrl,a.appendChild(n)},this.onLoad=()=>{this.injectIframeResizerUrl()},this.resizeIframe=e=>{const t=this.frameRef.current;t&&e.iframeResizerEnable&&Object(ll.iframeResizer)(e.iframeResizerOptions,t)},this.frameRef=s.a.createRef()}componentDidMount(){this.updateIframe(this.props),this.resizeIframe(this.props)}componentWillUnmount(){const e=this.frameRef.current;if(!e)return;const t=e.iframeResizer;t&&t.removeListeners()}componentWillReceiveProps(e){this.updateIframe(e),this.resizeIframe(e)}render(){const e=this.props,t=e.src,a=e.id,n=e.frameBorder,i=e.className,o=e.style;return s.a.createElement("iframe",{ref:this.frameRef,src:t,id:a,frameBorder:n,className:i,style:o,onLoad:this.onLoad})}}dl.defaultProps={iframeResizerEnable:!0,iframeResizerOptions:{},iframeResizerUrl:"https://cdnjs.cloudflare.com/ajax/libs/iframe-resizer/3.5.8/iframeResizer.contentWindow.min.js",frameBorder:0,style:{width:"100%",minHeight:20}};var hl=dl;class ul extends s.a.Component{constructor(...e){super(...e),this.state={}}static getDerivedStateFromProps(e,t){return e.url!==t.prevUrl||e.html!==t.prevHtml?{url:null,html:null,prevUrl:e.url,prevHtml:e.html}:null}componentDidMount(){this.setIframeSource()}componentDidUpdate(e,t,a){const n=this.props,s=n.url,i=n.html;s===e.url&&i===e.html||this.setIframeSource()}setIframeSource(){const e=this.props,t=e.url,a=e.html;this.setState({url:t,html:a})}render(){const e=this.state,t=e.url,a=e.html,n=this.props,i=n.width,o=n.height,r=n.caption,c=n.isFullWidth,l=n.allowScrolling,d={scrolling:l},h=i>0&&o>0,u=Boolean(t)||Boolean(a);return s.a.createElement("figure",null,u&&s.a.createElement(s.a.Fragment,null,h?s.a.createElement("iframe",{src:t||null,srcDoc:t?null:a,width:i>0?i:null,height:o>0?o:null,allowFullScreen:c,scrolling:l?"auto":"no",frameBorder:0}):s.a.createElement(hl,{content:a,src:t,iframeResizerOptions:d,style:{width:"100%"}})),s.a.createElement($c,{text:r.text,credit:r.credit}))}}var pl=ul;var ml=Yc((function(e){e.url;const t=e.author,a=(e.authorPhoto,e.date),n=e.pageBlocks,i=e.caption,o=e.iv;return s.a.createElement("blockquote",null,s.a.createElement("figure",null,Boolean(t)&&s.a.createElement("h3",null,t),s.a.createElement(al,{author:null,publishDate:a}),n.map((e,t)=>id(e,o,t)),s.a.createElement($c,{text:i.text,credit:i.credit})))}));a(472);class gl extends s.a.Component{constructor(...e){super(...e),this.state={error:null,errorInfo:null}}componentDidCatch(e,t){this.setState({error:e,errorInfo:t})}render(){const e=this.props.children,t=this.state,a=t.error,n=t.errorInfo;return a||n?s.a.createElement("div",{className:"error-handler"},s.a.createElement("span",null,s.a.createElement("pre",null,"".concat(a.name,": ").concat(a.message),n.componentStack))):e}}var fl=gl;var bl=function(e){return s.a.createElement("footer",null,s.a.createElement(Qc,{text:e.footer}))};var Cl=function(e){return s.a.createElement("h3",null,s.a.createElement(Qc,{text:e.header}))};var yl=function(e){const t=e.kicker;return s.a.createElement("h6",{className:"kicker"},s.a.createElement(Qc,{text:t}))};var vl=Yc((function(e){return s.a.createElement("li",{"data-before":e.label},e.pageBlocks.map((t,a)=>id(t,e.iv,a)))}));var El=function(e){return s.a.createElement("ul",null,e.items.map((e,t)=>s.a.createElement(vl,{key:t,label:e.label,pageBlocks:e.page_blocks})))};var Sl=function(e){return s.a.createElement("p",null,s.a.createElement(Qc,{text:e.text}))};var Ul=function(e){const t=e.photo,a=e.caption,n=(e.url,e.openMedia);return s.a.createElement("figure",null,s.a.createElement(Ln.a,{photo:t,size:B.k,displaySize:B.j,openMedia:n}),s.a.createElement($c,{text:a.text,credit:a.credit}))};var kl=function(e){return s.a.createElement("pre",null,s.a.createElement(Qc,{text:e.text}))};var wl=function(e){const t=e.text,a=e.credit;return s.a.createElement("aside",null,s.a.createElement(Qc,{text:t}),a&&s.a.createElement("cite",null,s.a.createElement(Qc,{text:a})))};class Ml extends s.a.Component{constructor(...e){super(...e),this.handleClick=e=>{e.preventDefault(),e.stopPropagation();const t=this.props.url;V.a.clientUpdate({"@type":"clientUpdateInstantViewUrl",url:t})}}render(){const e=this.props,t=e.author,a=(e.description,e.publishDate),n=e.title,i=e.url,o=a>0?new Date(1e3*a):null,r=t&&o,c=o||t;return s.a.createElement("li",null,s.a.createElement(jn.a,{url:i,onClick:this.handleClick},n),c&&s.a.createElement("address",null,t,r&&" \u2022 ",o&&s.a.createElement("time",{dateTime:o.toISOString()},Object(tl.a)(o,"dd mmm, yyyy"))))}}var Il=Ml;var _l=function(e){return s.a.createElement(s.a.Fragment,null,s.a.createElement("h4",null,s.a.createElement(Qc,{text:e.header})),s.a.createElement("ul",{className:"related-articles"},e.articles.map(e=>s.a.createElement(Il,{key:e.url,url:e.url,title:e.title,description:e.description,photo:e.photo,author:e.author,publishDate:e.publish_date}))))};var xl=Yc((function(e){const t=e.pageBlocks,a=e.caption,n=e.iv;return s.a.createElement("div",{className:"slideshow"},t.map((e,t)=>id(e,n,t)),s.a.createElement($c,{text:a.text,credit:a.credit}))}));var Ol=function(e){return s.a.createElement("h4",null,s.a.createElement(Qc,{text:e.subheader}))};var Pl=function(e){return s.a.createElement("h2",null,s.a.createElement(Qc,{text:e.subtitle}))};var Tl=function(e){return s.a.createElement("h1",null,s.a.createElement(Qc,{text:e.title}))};var Nl=function(e){return s.a.createElement("b",null,s.a.createElement(Qc,{text:e.text}))};var Dl=function(e){return s.a.createElement("a",{href:"mailto:".concat(e.emailAddress)},s.a.createElement(Qc,{text:e.text}))};var Ll=function(e){return s.a.createElement("code",null,s.a.createElement(Qc,{text:e.text}))};class jl extends s.a.Component{constructor(...e){super(...e),this.onClientUpdateDocumentThumbnailBlob=e=>{const t=this.props.document;if(!t)return;const a=t.thumbnail;if(!a)return;const n=a.photo;if(!n)return;const s=e.fileId;n.id===s&&this.forceUpdate()},this.onClientUpdateDocumentBlob=e=>{const t=this.props.document;if(!t)return;const a=t.document;if(!a)return;const n=e.fileId;a.id===n&&this.forceUpdate()}}componentDidMount(){ft.a.on("clientUpdateDocumentThumbnailBlob",this.onClientUpdateDocumentThumbnailBlob),ft.a.on("clientUpdateDocumentBlob",this.onClientUpdateDocumentBlob)}componentWillUnmount(){ft.a.off("clientUpdateDocumentThumbnailBlob",this.onClientUpdateDocumentThumbnailBlob),ft.a.off("clientUpdateDocumentBlob",this.onClientUpdateDocumentBlob)}emptyPlaceholderSrc(e,t){return'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 '.concat(e," ").concat(t,'"%3E%3C/svg%3E')}render(){const e=this.props,t=e.document,a=e.height,n=e.width;if(!t)return null;const i=t.thumbnail,o=t.document,r=Object(mt.j)(i?i.photo:null),c=Object(mt.j)(o);return s.a.createElement("img",{src:c||r||this.emptyPlaceholderSrc(1,1),width:n>0?n:null,height:a>0?a:null,draggable:!1,alt:""})}}var Rl=jl;var Al=function(e){return s.a.createElement("i",null,s.a.createElement(Qc,{text:e.text}))};var Fl=function(e){return s.a.createElement("mark",null,s.a.createElement(Qc,{text:e.text}))};var Bl=function(e){return s.a.createElement("a",{href:"tel:".concat(e.phoneNumber)},s.a.createElement(Qc,{text:e.text}))};function Vl(e){return e.text}Vl.propTypes={text:Sn.a.string.isRequired};var zl=Vl;var Hl=function(e){return s.a.createElement("del",null,s.a.createElement(Qc,{text:e.text}))};var Wl=function(e){return s.a.createElement("sub",null,s.a.createElement(Qc,{text:e.text}))};var Gl=function(e){return s.a.createElement("sup",null,s.a.createElement(Qc,{text:e.text}))};var Kl=function(e){return s.a.createElement("a",{id:e.name},s.a.createElement(Qc,{text:e.text}))};var Zl=function(e){return s.a.createElement(s.a.Fragment,null,e.texts.map((e,t)=>s.a.createElement(Qc,{key:t,text:e})))};var ql=function(e){return s.a.createElement("ins",null,s.a.createElement(Qc,{text:e.text}))};class Yl extends s.a.Component{constructor(...e){super(...e),this.handleClick=e=>{e.preventDefault(),e.stopPropagation();const t=this.props.url;V.a.clientUpdate({"@type":"clientUpdateInstantViewUrl",url:t})}}render(){const e=this.props,t=e.text,a=e.url;return s.a.createElement(jn.a,{url:a,onClick:this.handleClick},s.a.createElement(Qc,{text:t}))}}var Jl=Yl;var Ql=Yc((function(e){const t=e.caption,a=e.cells,n=e.isBordered,i=e.isStriped,o=e.iv;return s.a.createElement("table",{striped:i?"":null,border:n?1:0},!od(t)&&s.a.createElement("caption",null,s.a.createElement(Qc,{text:t})),s.a.createElement("tbody",null,a.map((e,t)=>s.a.createElement("tr",{key:t},e.map((e,t)=>id(e,o,t))))))}));var Xl=function(e){const t=e.text,a=e.isHeader,n=e.colspan,i=e.rowspan,o=e.align,r=e.valign;if(od(t))return null;const c={colSpan:n,rowSpan:i,align:rd(o),valign:cd(r)},l=s.a.createElement(Qc,{text:t});return a?s.a.createElement("th",c,l):s.a.createElement("td",c,l)},$l=a(137);var ed=function(e){const t=e.location,a=e.caption;return s.a.createElement("figure",null,s.a.createElement($l.a,{width:B.i,height:B.h,location:t}),s.a.createElement($c,{text:a.text,credit:a.credit}))};var td=function(e){const t=e.audio,a=e.caption,n=e.openMedia;return s.a.createElement("figure",null,s.a.createElement(lc.a,{audio:t,displaySize:B.D,openMedia:n}),s.a.createElement($c,{text:a.text,credit:a.credit}))};var ad=function(e){return s.a.createElement("div",null)};var nd=function(e){const t=e.video,a=e.caption,n=(e.needAutoplay,e.isLooped,e.openMedia);return s.a.createElement("figure",null,s.a.createElement(uc.a,{video:t,displaySize:B.j,openMedia:n}),s.a.createElement($c,{text:a.text,credit:a.credit}))};function sd(e,t,a,n,s){if(!e)return;switch(e["@type"]){case"animation":{let i=e.animation;if(!i)return;if(i=ft.a.get(i.id)||i,s&&i.local.is_downloading_active)return void ft.a.cancelGetRemoteFile(i.id,e);if(s&&i.remote.is_uploading_active)return void ft.a.cancelUploadFile(i.id,e);Object(mt.b)(i,e,ft.a.updateAnimationBlob(0,0,i.id)),Object(nt.o)({media:e,caption:t,block:a,instantView:n});break}case"audio":{let t=e.audio;if(!t)return;if(t=ft.a.get(t.id)||t,s&&t.local.is_downloading_active)return void ft.a.cancelGetRemoteFile(t.id,e);if(s&&t.remote.is_uploading_active)return void ft.a.cancelUploadFile(t.id,e);Object(mt.b)(t,e,ft.a.updateAudioBlob(0,0,t.id)),V.a.clientUpdate({"@type":"clientUpdateMediaActive",instantView:n,block:a});break}case"photo":Object(nt.o)({media:e,caption:t,block:a,instantView:n});break;case"video":{let i=e.video;if(!i)return;if(i=ft.a.get(i.id)||i,s&&i.local.is_downloading_active)return void ft.a.cancelGetRemoteFile(i.id,e);if(s&&i.remote.is_uploading_active)return void ft.a.cancelUploadFile(i.id,e);Object(mt.b)(i,e,ft.a.updateVideoBlob(0,0,i.id)),Object(nt.o)({media:e,caption:t,block:a,instantView:n});break}}}function id(e,t,a){if(!e)return null;let n=null;switch(e["@type"]){case"pageBlockAnchor":n=s.a.createElement(Xc,{name:e.name});break;case"pageBlockAnimation":n=s.a.createElement(el,{block:e,caption:e.caption,animation:e.animation,needAutoplay:e.need_autoplay,openMedia:()=>sd(e.animation,e.caption,e,t,!0)});break;case"pageBlockAudio":n=s.a.createElement(td,{caption:e.caption,audio:e.audio,openMedia:()=>sd(e.audio,e.caption,e,t,!0)});break;case"pageBlockAuthorDate":n=s.a.createElement(al,{author:e.author,publishDate:e.publish_date});break;case"pageBlockBlockQuote":n=s.a.createElement(nl,{credit:e.credit,text:e.text});break;case"pageBlockCollage":n=s.a.createElement(sl,{pageBlocks:e.page_blocks,caption:e.caption});break;case"pageBlockChatLink":n=s.a.createElement(ad,{title:e.title,photo:e.photo,username:e.username});break;case"pageBlockCover":n=s.a.createElement(ol,{cover:e.cover});break;case"pageBlockDetails":n=s.a.createElement(rl,{header:e.header,pageBlocks:e.page_blocks,isOpen:e.is_open});break;case"pageBlockDivider":n=s.a.createElement(cl,null);break;case"pageBlockEmbedded":n=s.a.createElement(pl,{url:e.url,html:e.html,posterPhoto:e.poster_photo,width:e.width,height:e.height,caption:e.caption,isFullWidth:e.is_full_width,allowScrolling:e.allow_scrolling});break;case"pageBlockEmbeddedPost":n=s.a.createElement(ml,{url:e.url,author:e.author,authorPhoto:e.author_photo,date:e.date,pageBlocks:e.page_blocks,caption:e.caption});break;case"pageBlockFooter":n=s.a.createElement(bl,{footer:e.footer});break;case"pageBlockHeader":n=s.a.createElement(Cl,{header:e.header});break;case"pageBlockKicker":n=s.a.createElement(yl,{kicker:e.kicker});break;case"pageBlockList":n=s.a.createElement(El,{items:e.items});break;case"pageBlockListItem":n=s.a.createElement(vl,{label:e.label,pageBlocks:e.page_blocks});break;case"pageBlockMap":n=s.a.createElement(ed,{location:e.location,zoom:e.zoom,width:e.width,height:e.height,caption:e.caption});break;case"pageBlockParagraph":n=s.a.createElement(Sl,{text:e.text});break;case"pageBlockPhoto":n=s.a.createElement(Ul,{caption:e.caption,photo:e.photo,url:e.url,openMedia:()=>sd(e.photo,e.caption,e,t,!0)});break;case"pageBlockPreformatted":n=s.a.createElement(kl,{text:e.text,language:e.language});break;case"pageBlockPullQuote":n=s.a.createElement(wl,{credit:e.credit,text:e.text});break;case"pageBlockRelatedArticle":n=s.a.createElement(Il,{url:e.url,title:e.title,description:e.description,photo:e.photo,author:e.author,publishDate:e.publish_date});break;case"pageBlockRelatedArticles":n=s.a.createElement(_l,{header:e.header,articles:e.articles});break;case"pageBlockSlideshow":n=s.a.createElement(xl,{pageBlocks:e.page_blocks,caption:e.caption});break;case"pageBlockSubheader":n=s.a.createElement(Ol,{subheader:e.subheader});break;case"pageBlockSubtitle":n=s.a.createElement(Pl,{subtitle:e.subtitle});break;case"pageBlockTable":n=s.a.createElement(Ql,{caption:e.caption,cells:e.cells,isBordered:e.is_bordered,isStriped:e.is_striped});break;case"pageBlockTableCell":n=s.a.createElement(Xl,{text:e.text,isHeader:e.is_header,colspan:e.colspan,rowspan:e.rowspan,align:e.align,valign:e.valign});break;case"pageBlockTitle":n=s.a.createElement(Tl,{title:e.title});break;case"pageBlockVideo":n=s.a.createElement(nd,{caption:e.caption,video:e.video,needAutoplay:e.need_autoplay,isLooped:e.is_looped,openMedia:()=>sd(e.video,e.caption,e,t,!0)})}return n?s.a.createElement(fl,{key:a},n):s.a.createElement("div",null,"[".concat(e["@type"],"]"))}function od(e){if(!e)return!0;switch(e["@type"]){case"richTextAnchor":case"richTextBold":case"richTextEmailAddress":case"richTextFixed":return od(e.text);case"richTextIcon":return!1;case"richTextItalic":case"richTextMarked":case"richTextPhoneNumber":case"richTextPlain":case"richTextStrikethrough":case"richTextSubscript":case"richTextSuperscript":return od(e.text);case"richTexts":return e.texts.every(od);case"richTextUnderline":case"richTextUrl":return od(e.text)}return!1}function rd(e){if(!e)return null;switch(e["@type"]){case"pageBlockHorizontalAlignmentCenter":return"center";case"pageBlockHorizontalAlignmentLeft":return"left";case"pageBlockHorizontalAlignmentRight":return"right"}return null}function cd(e){if(!e)return null;switch(e["@type"]){case"pageBlockVerticalAlignmentBottom":return"bottom";case"pageBlockVerticalAlignmentMiddle":return"middle";case"pageBlockVerticalAlignmentTop":return"top"}return null}function ld(e){if(!e)return[];switch(e["@type"]){case"pageBlockAnchor":return[];case"pageBlockAnimation":case"pageBlockAudio":return[e.caption];case"pageBlockAuthorDate":case"pageBlockBlockQuote":case"pageBlockChatLink":return[];case"pageBlockCollage":{const t=e.page_blocks.map(e=>[e,...ld(e)]);return[].concat.apply([],t)}case"pageBlockCover":return[e.cover];case"pageBlockDetails":{const t=e.page_blocks.map(e=>[e,...ld(e)]);return[].concat.apply([],t)}case"pageBlockDivider":return[];case"pageBlockEmbedded":return[e.caption];case"pageBlockEmbeddedPost":{const t=e.page_blocks.map(e=>[e,...ld(e)]);return[].concat.apply([e.caption],t)}case"pageBlockFooter":case"pageBlockHeader":case"pageBlockKicker":return[];case"pageBlockList":{const t=e.items.map(e=>[e,...ld(e)]);return[].concat.apply([],t)}case"pageBlockListItem":{const t=e.page_blocks.map(e=>[e,...ld(e)]);return[].concat.apply([],t)}case"pageBlockMap":return[e.caption];case"pageBlockParagraph":return[];case"pageBlockPhoto":return[e.caption];case"pageBlockPreformatted":case"pageBlockPullQuote":case"pageBlockRelatedArticle":return[];case"pageBlockRelatedArticles":return[...e.articles];case"pageBlockSlideshow":{const t=e.page_blocks.map(e=>[e,...ld(e)]);return[].concat.apply([e.caption],t)}case"pageBlockSubheader":case"pageBlockSubtitle":return[];case"pageBlockTable":return[...e.cells];case"pageBlockTableCell":case"pageBlockTitle":return[];case"pageBlockVideo":return[e.caption]}return[]}function dd(e){if(!e)return null;switch(e["@type"]){case"pageBlockAnimation":return e.animation;case"pageBlockPhoto":return e.photo;case"pageBlockVideo":return e.video}return null}function hd(e){if(!e)return!1;switch(e["@type"]){case"pageBlockAnimation":case"pageBlockPhoto":case"pageBlockVideo":return!0}return!1}a(473);class ud extends s.a.PureComponent{render(){const e=this.props,t=e.forwardedRef,a=e.iv;if(!a)return null;const n=a.page_blocks,i=a.is_rtl;if(!n)return;const o=n.map((e,t)=>id(e,a,t));return s.a.createElement("article",{ref:t,dir:i?"rtl":"ltr"},o)}}var pd=Object(u.a)(Object(u.d)(),Yc)(ud),md=Object(Je.a)(s.a.createElement("path",{d:"M9.91421356,11.5 L16.2071068,5.20710678 C16.5976311,4.81658249 16.5976311,4.18341751 16.2071068,3.79289322 C15.8165825,3.40236893 15.1834175,3.40236893 14.7928932,3.79289322 L7.79289322,10.7928932 C7.40236893,11.1834175 7.40236893,11.8165825 7.79289322,12.2071068 L14.7928932,19.2071068 C15.1834175,19.5976311 15.8165825,19.5976311 16.2071068,19.2071068 C16.5976311,18.8165825 16.5976311,18.1834175 16.2071068,17.7928932 L9.91421356,11.5 Z"}),"Left"),gd=Object(Je.a)(s.a.createElement("path",{d:"M11.8025478,4.79529691 C11.8025478,3.93005081 12.5039683,3.22863025 13.3692144,3.22863025 C13.7633775,3.22863025 14.1430567,3.37720768 14.4325315,3.64473128 L22.2284036,10.8494344 C22.8638434,11.4366882 22.9029059,12.4278772 22.2883553,13.0917108 L22.2284036,13.1505656 L14.4325315,20.3552687 C13.7970916,20.9425225 12.8059026,20.90346 12.2186488,20.2680201 C11.9511252,19.9785454 11.8025478,19.5988662 11.8025478,19.2047031 L11.8025478,16.4249931 C8.21922017,16.6092505 5.79479016,17.8111183 4.43312712,19.9909578 L4.29164834,20.2262356 C3.95336498,20.8131459 3.20334729,21.0146979 2.61643694,20.6764146 C2.24185558,20.4605134 2.00860424,20.0633528 2.00249611,19.6310483 C1.8981509,12.2459874 5.13388305,8.13673748 11.4825227,7.6491321 L11.8025478,7.62777147 L11.8025478,4.79529691 Z M13.8025478,5.78581808 L13.8025478,8.6 C13.8025478,9.15228475 13.3548325,9.6 12.8025478,9.6 C7.49232524,9.6 4.65375859,12.0566924 4.1006582,17.2535243 C6.09650127,15.345115 9.01935671,14.4 12.8025478,14.4 C13.3548325,14.4 13.8025478,14.8477153 13.8025478,15.4 L13.8025478,18.2142808 L20.5271714,12.0005066 L13.8025478,5.78581808 Z"}),"Share"),fd=a(74);a(474);class bd extends s.a.Component{constructor(...e){super(...e),this.handleClick=e=>{e.stopPropagation()}}render(){const e=this.props.text;return s.a.createElement("div",{className:"media-caption",onClick:this.handleClick},s.a.createElement("div",{className:"media-caption-text"},e))}}bd.defaultProps={};var Cd=bd;class yd extends s.a.Component{constructor(e){super(e),this.onClientUpdateMediaBlob=e=>{const t=e.fileId,a=this.state.file;a&&a.id===t&&this.forceUpdate()},this.onClientUpdateMediaThumbnailBlob=e=>{const t=e.fileId,a=this.state.thumbnail;a&&a.id===t&&this.forceUpdate()},this.videoRef=s.a.createRef(),this.state={}}static getDerivedStateFromProps(e,t){const a=e.media,n=e.size;e.caption,e.url;if(a!==t.prevMedia){let e=Object(mt.l)(a,n),t=Object(T.a)(e,3),s=t[0],i=t[1],o=t[2];o=ft.a.get(o.id)||o;let r=Object(mt.m)(a),c=Object(T.a)(r,3),l=c[0],d=c[1],h=c[2];return h=ft.a.get(h.id)||h,{prevMedia:a,speed:1,isPlaying:!1,width:s,height:i,file:o,thumbnailWidth:l,thumbnailHeight:d,thumbnail:h}}return null}componentDidMount(){ft.a.on("clientUpdatePhotoBlob",this.onClientUpdateMediaBlob),ft.a.on("clientUpdateVideoBlob",this.onClientUpdateMediaBlob),ft.a.on("clientUpdateAnimationBlob",this.onClientUpdateMediaBlob),ft.a.on("clientUpdateVideoThumbnailBlob",this.onClientUpdateMediaThumbnailBlob),ft.a.on("clientUpdateAnimationThumbnailBlob",this.onClientUpdateMediaThumbnailBlob)}componentWillUnmount(){ft.a.off("clientUpdatePhotoBlob",this.onClientUpdateMediaBlob),ft.a.off("clientUpdateVideoBlob",this.onClientUpdateMediaBlob),ft.a.off("clientUpdateAnimationBlob",this.onClientUpdateMediaBlob),ft.a.off("clientUpdateVideoThumbnailBlob",this.onClientUpdateMediaThumbnailBlob),ft.a.off("clientUpdateAnimationThumbnailBlob",this.onClientUpdateMediaThumbnailBlob)}render(){const e=this.props,t=e.media,a=e.caption,n=e.url;if(!t)return null;const i=this.state,o=i.width,r=i.height,c=i.file,l=i.thumbnailWidth,d=i.thumbnailHeight,h=i.thumbnail,u=i.isPlaying;if(!c)return null;const p=ft.a.getBlob(c.id)||c.blob,m=ft.a.getBlobUrl(p)||"",g=h?ft.a.getBlob(h.id)||h.blob:null,f=ft.a.getBlobUrl(g),b=Object(qn.h)({width:l,height:d});let C=o,y=r;if(Math.max(C,y)>640){const e=640/Math.max(C,y);C=C>y?640:Math.floor(C*e),y=y>C?640:Math.floor(y*e)}let v=null;switch(t["@type"]){case"video":v=s.a.createElement("div",{className:"media-viewer-content-wrapper"},s.a.createElement("video",{ref:this.videoRef,className:"media-viewer-content-video-player",src:m,onClick:this.handleContentClick,controls:!0,autoPlay:!0,width:C,height:y,onPlay:()=>{this.setState({isPlaying:!0}),V.a.clientUpdate({"@type":"clientUpdateMediaViewerPlay"})},onCanPlay:()=>{const e=this.videoRef.current;e&&(e.volume=Mr.b.volume)},onPause:()=>{V.a.clientUpdate({"@type":"clientUpdateMediaViewerPause"})},onEnded:()=>{V.a.clientUpdate({"@type":"clientUpdateMediaViewerEnded"})},onVolumeChange:()=>{const e=this.videoRef.current;e&&V.a.clientUpdate({"@type":"clientUpdateMediaVolume",volume:e.volume})}}),!u&&(!m&&f?s.a.createElement("img",{className:q()("media-viewer-content-video-thumbnail",{"media-blurred":b}),src:f,alt:"",width:C,height:y}):s.a.createElement("div",{className:"media-viewer-content-video-thumbnail",style:{width:C,height:y}})));break;case"animation":v=s.a.createElement("div",{className:"media-viewer-content-wrapper"},s.a.createElement("video",{className:"media-viewer-content-video-player",src:m,onClick:this.handleContentClick,loop:!0,autoPlay:!0,width:C,height:y,onPlay:()=>{this.setState({isPlaying:!0})}}),!u&&(!m&&f?s.a.createElement("img",{className:q()("media-viewer-content-video-thumbnail",{"media-blurred":b}),src:f,alt:"",width:C,height:y}):s.a.createElement("div",{className:"media-viewer-content-video-thumbnail",style:{width:C,height:y}})));break;default:v=s.a.createElement("img",{className:"media-viewer-content-image",src:m,alt:"",onClick:this.handleContentClick})}return s.a.createElement("div",{className:"media-viewer-content"},v,s.a.createElement(fd.a,{file:c,zIndex:2}),a&&(!od(a.text)||!od(a.credit)||n)&&s.a.createElement(Cd,{text:s.a.createElement(s.a.Fragment,null,s.a.createElement($c,{text:a.text,credit:a.credit}),s.a.createElement(jn.a,{url:n}))}))}}var vd=yd;a(475);class Ed extends s.a.Component{constructor(...e){super(...e),this.handleClick=e=>{e.stopPropagation();const t=this.props,a=t.disabled,n=t.onClick;a||n(e)}}render(){const e=this.props,t=e.disabled,a=e.grow,n=e.children,i=e.className,o=e.style,r=q()(t?"media-viewer-button-disabled":"media-viewer-button",{grow:a},i);return s.a.createElement("div",{className:r,style:o,onClick:this.handleClick},n)}}var Sd=Ed;a(476);class Ud extends s.a.Component{render(){const e=this.props,t=e.title,a=e.subtitle,n=e.style;return s.a.createElement("div",{className:"media-viewer-footer-text",style:n},s.a.createElement("div",{className:"media-viewer-footer-text-wrapper"},s.a.createElement("span",null,t),Boolean(a)&&s.a.createElement("span",null,"\xa0",a)))}}var kd=Ud;a(225);class wd extends s.a.Component{constructor(...e){super(...e),this.handleClick=e=>{e.stopPropagation();const t=this.props,a=t.onClick;t.disabled||a(e)}}render(){const e=this.props,t=e.checked,a=e.children,n=e.disabled,i=e.title;return s.a.createElement("div",{className:q()("media-viewer-footer-button",{"media-viewer-footer-button-checked":t,"media-viewer-footer-button-disabled":n}),title:i,onClick:this.handleClick},a)}}var Md=wd,Id=a(94);class _d extends s.a.Component{constructor(e){super(e),this.onClientUpdateMediaBlob=e=>{const t=this.state.fileId;t===e.fileId&&this.setState({disabled:_d.saveDisabled(t)})},this.handleClick=e=>{e.stopPropagation();const t=this.props.onClick;this.state.disabled||t(e)};const t=e.fileId;this.state={prevPropsFileId:t,fileId:t,disabled:_d.saveDisabled(t)}}static getDerivedStateFromProps(e,t){const a=e.fileId;return a!==t.prevPropsFileId?{prevPropsFileId:a,fileId:a,disabled:_d.saveDisabled(a)}:null}componentDidMount(){ft.a.on("clientUpdateAnimationBlob",this.onClientUpdateMediaBlob),ft.a.on("clientUpdateChatBlob",this.onClientUpdateMediaBlob),ft.a.on("clientUpdateDocumentBlob",this.onClientUpdateMediaBlob),ft.a.on("clientUpdatePhotoBlob",this.onClientUpdateMediaBlob),ft.a.on("clientUpdateUserBlob",this.onClientUpdateMediaBlob),ft.a.on("clientUpdateVideoBlob",this.onClientUpdateMediaBlob)}componentWillUnmount(){ft.a.off("clientUpdateAnimationBlob",this.onClientUpdateMediaBlob),ft.a.off("clientUpdateChatBlob",this.onClientUpdateMediaBlob),ft.a.off("clientUpdateDocumentBlob",this.onClientUpdateMediaBlob),ft.a.off("clientUpdatePhotoBlob",this.onClientUpdateMediaBlob),ft.a.off("clientUpdateUserBlob",this.onClientUpdateMediaBlob),ft.a.off("clientUpdateVideoBlob",this.onClientUpdateMediaBlob)}render(){const e=this.props,t=e.title,a=e.children,n=this.state.disabled;return s.a.createElement(Md,{disabled:n,title:t,onClick:this.handleClick},a||s.a.createElement(Id.a,null))}}_d.saveDisabled=e=>!Boolean(ft.a.getBlob(e));var xd=_d;a(477);class Od extends s.a.Component{constructor(...e){super(...e),this.state={index:-1,hasPreviousMedia:!1,hasNextMedia:!1,blocks:[]},this.onKeyDown=e=>{39===e.keyCode?this.handlePrevious():37===e.keyCode&&this.handleNext()},this.handlePrevious=e=>{e&&e.stopPropagation();const t=this.state,a=t.index,n=t.blocks,s=a+1;this.hasPreviousMedia(a,n)&&this.setState({index:s,hasPreviousMedia:this.hasPreviousMedia(s,n),hasNextMedia:this.hasNextMedia(s,n)})},this.handleNext=e=>{e&&e.stopPropagation();const t=this.state,a=t.index,n=t.blocks,s=a-1;this.hasNextMedia(a,n)&&this.setState({index:s,hasPreviousMedia:this.hasPreviousMedia(s,n),hasNextMedia:this.hasNextMedia(s,n)})},this.handleClose=()=>{Object(nt.o)(null)},this.handleForward=()=>{const e=this.props.media,t=Object(qn.e)(e,null);t&&V.a.clientUpdate({"@type":"clientUpdateForward",info:{inputMessageContent:t}})},this.handleSave=()=>{const e=this.props.media;Object(mt.D)(e,null)}}componentDidMount(){this.loadContent(),document.addEventListener("keydown",this.onKeyDown,!1)}componentWillUnmount(){document.removeEventListener("keydown",this.onKeyDown,!1)}loadContent(){const e=this.props,t=e.iv,a=e.media,n=function(e){if(!e)return[];const t=e.page_blocks,a=[];return t.forEach(e=>{a.push(e),ld(e).forEach(e=>{a.push(e)})}),a.filter(hd)}(t),s=n.findIndex(e=>dd(e)===a);this.setState({blocks:n,index:s,hasPreviousMedia:this.hasPreviousMedia(s,n),hasNextMedia:this.hasNextMedia(s,n)})}hasPreviousMedia(e,t){if(-1===e)return!1;return e+1<t.length}hasNextMedia(e,t){if(-1===e)return!1;return e-1>=0}render(){const e=this.props,t=e.size,a=e.t,n=this.state,i=n.index,o=n.blocks,r=n.hasNextMedia,c=n.hasPreviousMedia;if(!o)return null;if(-1===i)return null;const l=o[i],d=dd(l),h=function(e){if(!e)return null;switch(e["@type"]){case"pageBlockAnimation":case"pageBlockPhoto":case"pageBlockVideo":return e.caption}return null}(l),u=function(e){if(!e)return null;switch(e["@type"]){case"pageBlockPhoto":return e.url}return null}(l),p=Object(mt.l)(d,t),m=Object(T.a)(p,3),g=(m[0],m[1],m[2]);let f="";"photo"===d["@type"]&&(f=a("AttachPhoto")),"video"===d["@type"]?f=a("AttachVideo"):"animation"===d["@type"]&&(f=a("AttachGif"));const b=o.length;return s.a.createElement("div",{className:q()("instant-view-media-viewer","media-viewer-default")},s.a.createElement("div",{className:"media-viewer-footer"},s.a.createElement(kd,{title:f,subtitle:b&&i>=0?"".concat(i+1," of ").concat(b):null,style:{marginLeft:128}}),s.a.createElement(xd,{title:a("Save"),fileId:g.id,onClick:this.handleSave}),s.a.createElement(Md,{title:a("Forward"),onClick:this.handleForward},s.a.createElement(gd,null)),s.a.createElement(Md,{title:a("Close"),onClick:this.handleClose},s.a.createElement(la.a,null))),s.a.createElement("div",{className:"media-viewer-wrapper"},s.a.createElement("div",{className:"media-viewer-left-column"},s.a.createElement(Sd,{disabled:!r,grow:!0,onClick:this.handleNext},s.a.createElement(md,null))),s.a.createElement("div",{className:"media-viewer-content-column"},s.a.createElement(vd,{media:d,size:t,caption:h,url:u})),s.a.createElement("div",{className:"media-viewer-right-column"},s.a.createElement(Sd,{disabled:!c,grow:!0,onClick:this.handlePrevious},s.a.createElement(md,{style:{transform:"rotate(180deg)"}})))))}}var Pd=Object(u.a)(Object(p.c)(),Yc)(Od),Td=a(44);a(478);class Nd extends s.a.Component{constructor(e){var t;super(e),t=this,this.onClientUpdateInstantViewViewerContent=e=>{const t=e.content;if(!t)return void this.setState({media:null,caption:null,url:null});const a=t.media,n=t.caption,s=t.url,i=t.instantView;this.props.instantView===i&&this.setState({media:a,caption:n,url:s})},this.onClientUpdateInstantViewUrl=function(){var e=Object(h.a)(d.a.mark((function e(a){var n,s,i,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("[IV] clientUpdateInstantViewUrl",a),n=a.url,s=Td.a.getCurrent(),i=t.props.instantView,s===i){e.next=6;break}return e.abrupt("return");case 6:if(!i||!n.startsWith(i.url)){e.next=15;break}if(o=new URL(n).hash,n.indexOf("#")!==n.length-1){e.next=13;break}return t.scrollTop("smooth"),e.abrupt("return");case 13:if(!o||!t.scrollToHash(o,"smooth")){e.next=15;break}return e.abrupt("return");case 15:fc(n);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.onKeyDown=e=>{if(27===e.keyCode){if(this.state.media)return void Object(nt.o)(null);this.handleClose()}},this.handleBack=()=>{const e=this.state,t=e.hasPrev;e.hasScroll?this.scrollTop("smooth"):t?V.a.clientUpdate({"@type":"clientUpdatePrevInstantView"}):this.handleClose()},this.handleScroll=()=>{const e=this.instantViewerRef.current;this.setState({hasScroll:e.scrollTop>50}),this.updateItemsInView()},this.articleRef=s.a.createRef(),this.instantViewerRef=s.a.createRef(),this.state={},this.updateItemsInView=Object(ze.x)(this.updateItemsInView,500)}static getDerivedStateFromProps(e,t){return e.instantView!==t.prevInstantView?{prevInstantView:e.instantView,hasPrev:Td.a.hasPrev(),hasScroll:!1,media:null,caption:null,url:null}:null}shouldComponentUpdate(e,t,a){const n=this.props.instantView,s=this.state,i=s.hasScroll,o=s.hasPrev,r=s.media,c=s.caption,l=s.url;return n!==e.instantView||(i!==t.hasScroll||(o!==t.hasPrev||(r!==t.media||(c!==t.caption||l!==t.url))))}componentDidMount(){this.mounted=!0,this.handleScroll(),document.addEventListener("keydown",this.onKeyDown,!1),Td.a.on("clientUpdateInstantViewUrl",this.onClientUpdateInstantViewUrl),Td.a.on("clientUpdateInstantViewViewerContent",this.onClientUpdateInstantViewViewerContent)}componentWillUnmount(){this.mounted=!1,document.removeEventListener("keydown",this.onKeyDown,!1),Td.a.off("clientUpdateInstantViewUrl",this.onClientUpdateInstantViewUrl),Td.a.off("clientUpdateInstantViewViewerContent",this.onClientUpdateInstantViewViewerContent)}scrollToHash(e,t){if(!e)return!1;const a=document.getElementById(e.substr(1));if(a){const e=[];let n=!1,s=a;do{s=s.parentNode,s?"DETAILS"===s.nodeName?e.push(s):"ARTICLE"===s.nodeName&&(n=!0):n=!0}while(!n);return e.forEach(e=>e.open=!0),a.scrollIntoView({block:"center",behavior:t}),!0}return!1}scrollTop(e){const t=this.instantViewerRef.current;switch(e){case"smooth":ea(t);break;default:t.scrollTo({top:0,behavior:e})}}componentDidUpdate(e,t,a){const n=this.props,s=n.instantView;n.url;console.log("[IV] componentDidUpdate",s.url,s.url===e.instantView.url);const i=new URL(s.url).hash;e.instantView!==s&&(e.instantView.url!==s.url?s.url.indexOf("#")===s.url.length-1?(console.log("[IV] componentDidUpdate scrollTop auto"),this.scrollTop("auto")):i?(console.log("[IV] componentDidUpdate scrollToHash",i),this.scrollToHash(i,"auto")):(console.log("[IV] componentDidUpdate scrollTop auto"),this.scrollTop("auto")):i?(console.log("[IV] componentDidUpdate scrollToHash",i),this.scrollToHash(i,"auto")):(console.log("[IV] componentDidUpdate scrollTop smooth"),this.scrollTop("smooth")),this.handleScroll())}handleClose(){Object(nt.n)(null)}updateItemsInView(){if(!this.mounted)return;const e=this.props.instantView;if(!e)return;const t=e.page_blocks,a=new Map,n=Object(ze.t)(this.instantViewerRef,this.articleRef);for(let s=0;s<n.length;s++){const e=t[n[s]];a.set(e,e),ld(e).forEach(e=>a.set(e,e))}V.a.clientUpdate({"@type":"clientUpdateBlocksInView",blocks:a})}render(){const e=this.props,t=(e.classes,e.instantView),a=this.state,n=(a.hasPrev,a.hasScroll),i=a.media,o=a.caption,r=a.url;return t?s.a.createElement(qc.Provider,{value:t},s.a.createElement("div",{ref:this.instantViewerRef,className:"instant-viewer",onScroll:this.handleScroll},s.a.createElement("div",{className:"instant-viewer-left-column",onClick:this.handleBack},s.a.createElement(Sd,{className:"instant-viewer-left-button",style:{alignItems:"flex-start"},onClick:this.handleBack},s.a.createElement(md,{style:{transition:"transform 0.25s ease-out",transform:n?"rotate(90deg)":"rotate(0deg)"}}))),s.a.createElement("div",{className:"instant-viewer-content-column"},s.a.createElement("div",null,s.a.createElement(pd,{ref:this.articleRef}))),s.a.createElement("div",{className:"instant-viewer-right-column"},s.a.createElement(Sd,{className:"instant-viewer-right-button",onClick:this.handleClose},s.a.createElement(la.a,null)))),i&&s.a.createElement(Pd,{media:i,size:B.k,caption:o,url:r})):null}}var Dd=Object(p.c)()(Nd),Ld=Object(Je.a)(s.a.createElement("path",{d:"M18,6.5 C18.5522847,6.5 19,6.94771525 19,7.5 L19,18 C19,19.6568542 17.6568542,21 16,21 L8,21 C6.34314575,21 5,19.6568542 5,18 L5,7.5 C5,6.94771525 5.44771525,6.5 6,6.5 L18,6.5 Z M17,8.5 L7,8.5 L7,18 C7,18.5522847 7.44771525,19 8,19 L16,19 C16.5522847,19 17,18.5522847 17,18 L17,8.5 Z M10,2 L14,2 C14.2210137,2 14.434484,2.07316447 14.6080295,2.20608063 L14.7071068,2.29289322 L15.415,3 L19,3 C19.5128358,3 19.9355072,3.38604019 19.9932723,3.88337887 L20,4 C20,4.51283584 19.6139598,4.93550716 19.1166211,4.99327227 L19,5 L5,5 C4.44771525,5 4,4.55228475 4,4 C4,3.48716416 4.38604019,3.06449284 4.88337887,3.00672773 L5,3 L8.584,3 L9.29289322,2.29289322 C9.44917353,2.1366129 9.65185492,2.03740171 9.86855602,2.00867243 L10,2 L14,2 L10,2 Z"}),"Delete");a(226);class jd extends s.a.Component{constructor(e){super(e)}render(){const e=this.props,t=e.chatId,a=e.messageId,n=Nt.a.get(t,a);if(!n)return null;const i=n.date,o=Object(Tt.t)(n),r=Object(Tt.h)(i),c=o?s.a.createElement(ys.a,{userId:o}):s.a.createElement(Ct,{chatId:t});return s.a.createElement("div",{className:"media-info"},s.a.createElement("div",{className:"media-info-wrapper"},c,s.a.createElement("div",{className:"media-info-content"},s.a.createElement("div",{className:"media-info-row"},s.a.createElement(is.a,{chatId:t,userId:o})),s.a.createElement("div",{className:"media-info-row meta"},s.a.createElement("span",null,r)))))}}var Rd=jd;a(479);const Ad=s.a.lazy(()=>Promise.resolve().then(a.bind(null,169)));class Fd extends s.a.Component{constructor(e){var t;super(e),t=this,this.onClientUpdateDocumentBlob=e=>{const t=this.props,a=t.chatId,n=t.messageId;a===e.chatId&&n===e.messageId&&this.updateAnimationData()},this.updateAnimationData=Object(h.a)(d.a.mark((function e(){var a,n,s,i,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.props,n=a.chatId,s=a.messageId,Object(Tt.D)(n,s)){e.next=3;break}return e.abrupt("return");case 3:return i=t.state.file,e.next=6,Object(mt.c)(i);case 6:o=e.sent,t.setState({animationData:o});case 8:case"end":return e.stop()}}),e)}))),this.onClientUpdateMediaBlob=e=>{const t=this.props,a=t.chatId,n=t.messageId,s=t.size;if(a===e.chatId&&n===e.messageId){const e=Object(mt.h)(a,n,s),t=Object(T.a)(e,3),i=t[0],o=t[1],r=t[2];this.setState({width:i,height:o,file:r})}},this.onClientUpdateMediaThumbnailBlob=e=>{const t=this.props,a=t.chatId,n=t.messageId;if(a===e.chatId&&n===e.messageId){const e=Object(mt.i)(a,n),t=Object(T.a)(e,3),s=t[0],i=t[1],o=t[2];this.setState({thumbnailWidth:s,thumbnailHeight:i,thumbnail:o})}},this.onUpdateMessageContent=e=>{const t=this.props,a=t.chatId,n=t.messageId,s=t.size,i=t.t,o=e.chat_id,r=e.message_id;if(a===o&&n===r){const e=Object(mt.h)(a,n,s),t=Object(T.a)(e,3),o=t[0],r=t[1],c=t[2],l=Nt.a.get(a,n),d=Object(Tt.u)(l,null,i);this.setState({width:o,height:r,file:c,text:d})}},this.handleContentClick=e=>{e&&e.stopPropagation()},this.changeSpeed=e=>{this.setState({speed:e})},this.state={},this.videoRef=s.a.createRef(),this.lottieRef=s.a.createRef(),this.updateAnimationData()}static getDerivedStateFromProps(e,t){const a=e.chatId,n=e.messageId,s=e.size,i=e.t;if(a!==t.prevChatId||n!==t.prevMessageId){let e=Object(mt.h)(a,n,s),t=Object(T.a)(e,3),o=t[0],r=t[1],c=t[2];c=ft.a.get(c.id)||c;let l=Object(mt.i)(a,n),d=Object(T.a)(l,3),h=d[0],u=d[1],p=d[2];p=ft.a.get(p.id)||p;const m=Nt.a.get(a,n);return{prevChatId:a,prevMessageId:n,speed:1,isPlaying:!1,width:o,height:r,file:c,text:Object(Tt.u)(m,null,i),thumbnailWidth:h,thumbnailHeight:u,thumbnail:p}}return null}componentDidMount(){ft.a.on("clientUpdateDocumentBlob",this.onClientUpdateDocumentBlob),ft.a.on("clientUpdatePhotoBlob",this.onClientUpdateMediaBlob),ft.a.on("clientUpdateVideoBlob",this.onClientUpdateMediaBlob),ft.a.on("clientUpdateAnimationBlob",this.onClientUpdateMediaBlob),ft.a.on("clientUpdateVideoThumbnailBlob",this.onClientUpdateMediaThumbnailBlob),ft.a.on("clientUpdateAnimationThumbnailBlob",this.onClientUpdateMediaThumbnailBlob),Nt.a.on("updateMessageContent",this.onUpdateMessageContent)}componentWillUnmount(){ft.a.off("clientUpdateDocumentBlob",this.onClientUpdateDocumentBlob),ft.a.off("clientUpdatePhotoBlob",this.onClientUpdateMediaBlob),ft.a.off("clientUpdateVideoBlob",this.onClientUpdateMediaBlob),ft.a.off("clientUpdateAnimationBlob",this.onClientUpdateMediaBlob),ft.a.off("clientUpdateVideoThumbnailBlob",this.onClientUpdateMediaThumbnailBlob),ft.a.off("clientUpdateAnimationThumbnailBlob",this.onClientUpdateMediaThumbnailBlob),Nt.a.off("updateMessageContent",this.onUpdateMessageContent)}componentDidUpdate(e,t,a){const n=this.props,s=n.chatId,i=n.messageId;e.chatId===s&&e.messageId===i||this.updateAnimationData()}render(){const e=this.props,t=e.chatId,a=e.messageId,n=this.state,i=n.animationData,o=n.width,r=n.height,c=n.file,l=n.text,d=n.thumbnailWidth,h=n.thumbnailHeight,u=n.thumbnail,p=n.isPlaying;if(!c)return null;const m=ft.a.getBlob(c.id)||c.blob,g=ft.a.getBlobUrl(m)||"",f=u?ft.a.getBlob(u.id)||u.blob:null,b=ft.a.getBlobUrl(f),C=Object(qn.h)({width:d,height:h}),y=Object(Tt.K)(t,a),v=Object(Tt.z)(t,a),E=Object(Tt.D)(t,a);let S=o,U=r;if(Math.max(S,U)>640){const e=640/Math.max(S,U);S=S>U?640:Math.floor(S*e),U=U>S?640:Math.floor(U*e)}let k=null;if(y)k=s.a.createElement("div",{className:"media-viewer-content-wrapper"},s.a.createElement("video",{ref:this.videoRef,className:"media-viewer-content-video-player",src:g,onClick:this.handleContentClick,controls:!0,autoPlay:!0,width:S,height:U,onPlay:()=>{this.setState({isPlaying:!0}),V.a.clientUpdate({"@type":"clientUpdateMediaViewerPlay"})},onCanPlay:()=>{const e=this.videoRef.current;e&&(e.volume=Mr.b.volume)},onPause:()=>{V.a.clientUpdate({"@type":"clientUpdateMediaViewerPause"})},onEnded:()=>{V.a.clientUpdate({"@type":"clientUpdateMediaViewerEnded"})},onVolumeChange:()=>{const e=this.videoRef.current;e&&V.a.clientUpdate({"@type":"clientUpdateMediaVolume",volume:e.volume})}}),!p&&(!g&&b?s.a.createElement("img",{className:q()("media-viewer-content-video-thumbnail",{"media-blurred":C}),src:b,alt:"",width:S,height:U}):s.a.createElement("div",{className:"media-viewer-content-video-thumbnail",style:{width:S,height:U}})));else if(v)k=s.a.createElement("div",{className:"media-viewer-content-wrapper"},s.a.createElement("video",{className:"media-viewer-content-video-player",src:g,onClick:this.handleContentClick,loop:!0,autoPlay:!0,width:S,height:U,onPlay:()=>{this.setState({isPlaying:!0})}}),!p&&(!g&&b?s.a.createElement("img",{className:q()("media-viewer-content-video-thumbnail",{"media-blurred":C}),src:b,alt:"",width:S,height:U}):s.a.createElement("div",{className:"media-viewer-content-video-thumbnail",style:{width:S,height:U}})));else if(E){const e={loop:!0,autoplay:!0,animationData:i,rendererSettings:{preserveAspectRatio:"xMidYMid slice"}},t=this.state.speed;k=s.a.createElement(Ad,{ref:this.lottieRef,speed:t,options:e,height:"auto",width:400,isStopped:!1,isPaused:!1})}else k=s.a.createElement("img",{className:"media-viewer-content-image",src:g,alt:"",onClick:this.handleContentClick});return s.a.createElement("div",{className:"media-viewer-content"},s.a.createElement(s.a.Suspense,{fallback:""},k),s.a.createElement(fd.a,{file:c,zIndex:2}),l&&l.length>0&&s.a.createElement(Cd,{text:l}))}}var Bd=Object(p.c)()(Fd);a(227);class Vd extends s.a.Component{constructor(e){var t;super(e),t=this,this.onKeyDown=e=>{if(27===e.keyCode){if(this.state.deleteConfirmationOpened)return;this.handleClose()}else 39===e.keyCode?this.handleNext():37===e.keyCode&&this.handlePrevious()},this.onUpdateMessageContent=e=>{const t=e.chat_id,a=e.message_id,n=e.new_content,s=e.old_content,i=this.props.chatId,o=this.state,r=o.currentMessageId,c=o.totalCount;if(i!==t)return;const l=Nt.a.get(t,a);if(l){if(Object(mt.s)([l]),Object(Tt.E)(n)&&!Object(Tt.E)(s)){if(this.history.length>=2&&(this.firstSliceLoaded||Object(ze.b)(a,this.history[0].id,this.history[this.history.length-1].id))){let e=!1,t=[];for(let n=0;n<this.history.length;n++)this.history[n].id>a||e||(e=!0,t.push(l)),t.push(this.history[n]);this.history=t}const e=this.history.findIndex(e=>e.id===r);this.setState({hasNextMedia:this.hasNextMedia(e),hasPreviousMedia:this.hasPreviousMedia(e),totalCount:c+1})}if(!Object(Tt.E)(n)&&Object(Tt.E)(s)){let e=this.history;if(this.history=this.history.filter(e=>e.id!==a),r===a){const t=new Map;t.set(a,a),this.moveToNextMedia(e,t),this.setState({totalCount:Math.max(c-1,0)})}else{const e=this.history.findIndex(e=>e.id===r);this.setState({hasNextMedia:this.hasNextMedia(e),hasPreviousMedia:this.hasPreviousMedia(e),totalCount:Math.max(c-1,0)})}}}},this.onUpdateDeleteMessages=e=>{const t=e.chat_id,a=e.message_ids,n=e.is_permanent,s=this.props.chatId,i=this.state,o=i.currentMessageId,r=i.totalCount;if(!n)return;if(s!==t)return;const c=a.reduce((e,t)=>(e.set(t,t),e),new Map),l=this.history;let d=l.length;this.history=this.history.filter(e=>!c.has(e.id)),d-=this.history.length,this.setState({totalCount:Math.max(r-d,0)}),this.history.length?c.has(o)&&this.moveToNextMedia(l,c):Object(nt.p)(null)},this.onUpdateNewMessage=e=>{const t=this.props.chatId,a=this.state,n=a.currentMessageId,s=a.totalCount,i=e.message;if(!i)return;if(!Object(Tt.E)(i.content))return;if(i.chat_id!==t)return;if(!this.firstSliceLoaded)return;this.history=[i].concat(this.history);const o=this.history.findIndex(e=>e.id===n);this.setState({hasNextMedia:this.hasNextMedia(o),hasPreviousMedia:this.hasPreviousMedia(o),totalCount:s+1})},this.getFilter=(e,t)=>{const a=Nt.a.get(e,t);if(!a)return null;const n=a.content;if(!n)return null;switch(n["@type"]){case"messageChatChangePhoto":return{"@type":"searchMessagesFilterChatPhoto"};case"messagePhoto":case"messageVideo":return{"@type":"searchMessagesFilterPhotoAndVideo"};default:return null}},this.loadHistory=Object(h.a)(d.a.mark((function e(){var a,n,s,i,o,r,c,l,h;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.props,n=a.chatId,s=a.messageId,i=t.getFilter(n,s),o={"@type":"messages",messages:[],total_count:0},!i){e.next=7;break}return e.next=6,V.a.send({"@type":"searchChatMessages",chat_id:n,query:"",sender_user_id:0,from_message_id:s,offset:-B.s,limit:2*B.s,filter:i});case 6:o=e.sent;case 7:if(Object(Tt.d)(o,t.history),Nt.a.setItems(o.messages),t.history=o.messages,t.firstSliceLoaded=0===o.messages.length,r=t.state.currentMessageId,c=t.history.findIndex(e=>e.id===r),t.setState({hasNextMedia:t.hasNextMedia(c),hasPreviousMedia:t.hasPreviousMedia(c)}),-1!==c){e.next=19;break}t.history=[Nt.a.get(n,r)],Object(mt.B)(0,t.history),e.next=39;break;case 19:if(Object(mt.B)(c,t.history),i=t.getFilter(n,s)){e.next=23;break}return e.abrupt("return");case 23:l=1500,h=0;case 25:if(t.firstSliceLoaded||!(h<l)){e.next=39;break}return e.next=28,V.a.send({"@type":"searchChatMessages",chat_id:n,query:"",sender_user_id:0,from_message_id:t.history.length>0?t.history[0].id:0,offset:-99,limit:100,filter:i});case 28:o=e.sent,h+=o.messages.length,Object(Tt.d)(o,t.history),Nt.a.setItems(o.messages),t.history=o.messages.concat(t.history),t.firstSliceLoaded=0===o.messages.length,r=t.state.currentMessageId,c=t.history.findIndex(e=>e.id===r),t.setState({hasNextMedia:t.hasNextMedia(c),hasPreviousMedia:t.hasPreviousMedia(c),firstSliceLoaded:t.firstSliceLoaded,totalCount:o.total_count}),e.next=25;break;case 39:case"end":return e.stop()}}),e)}))),this.handleClose=()=>{Object(nt.p)(null);const e=this.state.currentMessageId,t=this.history.findIndex(t=>t.id===e);-1!==t&&Object(mt.a)(t,this.history)},this.handleSave=()=>{const e=this.props.chatId,t=this.state.currentMessageId,a=Nt.a.get(e,t);if(!a)return;const n=a.content;if(!n)return;let s=null;switch(n["@type"]){case"messageAnimation":s=n.animation;break;case"messageChatChangePhoto":s=n.photo;break;case"messageDocument":s=n.document;break;case"messagePhoto":s=n.photo;break;case"messageText":{const e=n.web_page;if(!e)return;const t=e.animation,a=e.document,i=e.photo,o=e.video;if(t){s=t;break}if(a){s=a;break}if(i){s=i;break}if(o){s=o;break}break}case"messageVideo":s=n.video;break}Object(mt.D)(s,a)},this.handleForward=()=>{const e=this.props.chatId,t=this.state.currentMessageId;V.a.clientUpdate({"@type":"clientUpdateForward",info:{chatId:e,messageIds:[t]}})},this.handleDelete=()=>{this.handleDialogOpen()},this.hasPreviousMedia=e=>{if(-1===e)return!1;return e+1<this.history.length},this.handlePrevious=e=>{e&&e.stopPropagation();const t=this.state.currentMessageId,a=this.history.findIndex(e=>e.id===t)+1;return this.loadMedia(a,()=>{a===this.history.length-1&&this.loadPrevious()})},this.loadPrevious=Object(h.a)(d.a.mark((function e(){var a,n,s,i,o,r,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.props,n=a.chatId,s=a.messageId,i=t.state.currentMessageId,o=t.getFilter(n,s),r={"@type":"messages",messages:[],total_count:0},!o){e.next=8;break}return e.next=7,V.a.send({"@type":"searchChatMessages",chat_id:n,query:"",sender_user_id:0,from_message_id:i,offset:0,limit:B.s,filter:o});case 7:r=e.sent;case 8:Object(Tt.d)(r,t.history),Nt.a.setItems(r.messages),t.history=t.history.concat(r.messages),c=t.history.findIndex(e=>e.id===i),t.setState({hasNextMedia:t.hasNextMedia(c),hasPreviousMedia:t.hasPreviousMedia(c),totalCount:r.total_count});case 13:case"end":return e.stop()}}),e)}))),this.hasNextMedia=e=>{if(-1===e)return!1;return e-1>=0},this.handleNext=e=>{e&&e.stopPropagation();const t=this.state.currentMessageId,a=this.history.findIndex(e=>e.id===t)-1;return this.loadMedia(a,()=>{0===a&&this.loadNext()})},this.loadNext=Object(h.a)(d.a.mark((function e(){var a,n,s,i,o,r,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.props,n=a.chatId,s=a.messageId,i=t.state.currentMessageId,o=t.getFilter(n,s),r={"@type":"messages",messages:[],total_count:0},!o){e.next=8;break}return e.next=7,V.a.send({"@type":"searchChatMessages",chat_id:n,query:"",sender_user_id:0,from_message_id:i,offset:-B.s,limit:B.s+1,filter:o});case 7:r=e.sent;case 8:Object(Tt.d)(r,t.history),Nt.a.setItems(r.messages),t.firstSliceLoaded=0===r.messages.length,t.history=r.messages.concat(t.history),c=t.history.findIndex(e=>e.id===i),t.setState({hasNextMedia:t.hasNextMedia(c),hasPreviousMedia:t.hasPreviousMedia(c),firstSliceLoaded:t.firstSliceLoaded,totalCount:r.total_count});case 14:case"end":return e.stop()}}),e)}))),this.loadMedia=(e,t)=>!(e<0)&&(!(e>=this.history.length)&&(this.setState({currentMessageId:this.history[e].id,hasNextMedia:this.hasNextMedia(e),hasPreviousMedia:this.hasPreviousMedia(e)},t),Object(mt.B)(e,this.history),!0)),this.moveToNextMedia=(e,t)=>{const a=this.state.currentMessageId,n=e.findIndex(e=>e.id===a);let s=0;for(let o=n-1;o>=0;o--)if(t&&!t.has(e[o].id)){s=e[o].id;break}if(!s)for(let o=n+1;o<e.length;o++)if(t&&!t.has(e[o].id)){s=e[o].id;break}if(!s)return;const i=this.history.findIndex(e=>e.id===s);return this.loadMedia(i,()=>{0===i?this.loadNext():i===this.history.length-1&&this.loadPrevious()})},this.handleDialogOpen=()=>{this.setState({deleteConfirmationOpened:!0})},this.handleDialogClose=()=>{this.setState({deleteConfirmationOpened:!1})},this.handleDone=()=>{this.setState({deleteConfirmationOpened:!1});const e=this.props.chatId,t=this.state,a=t.currentMessageId,n=t.deleteForAll,s=Nt.a.get(e,a);if(!s)return;const i=s.can_be_deleted_only_for_self,o=s.can_be_deleted_for_all_users;(i||o)&&V.a.send({"@type":"deleteMessages",chat_id:e,message_ids:[a],revoke:o&&n})},this.handleChangeDeleteForAll=e=>{this.setState({deleteForAll:e.target.checked})},this.handleInvertColors=()=>{let e="media-viewer-default";switch(this.state.background){case"media-viewer-default":e="media-viewer-dark";break;case"media-viewer-dark":e="media-viewer-light";break;case"media-viewer-light":e="media-viewer-default"}this.setState({background:e})},this.handleChangeSpeed=()=>{if(!this.contentRef)return;const e=this.contentRef.current;if(!e)return;const t=this.state.speed<1?1:.1;this.setState({speed:t}),e.changeSpeed(t)},this.canBeForwarded=(e,t)=>{const a=Nt.a.get(e,t);if(!a)return!1;const n=a.can_be_forwarded,s=a.content;if(!s)return!1;switch(s["@type"]){case"messageChatChangePhoto":return!0;default:return n}},this.contentRef=s.a.createRef(),this.history=[];const a=this.props,n=a.chatId,i=a.messageId;this.state={speed:1,background:"media-viewer-default",prevChatId:n,prevMessageId:i,currentMessageId:i,hasNextMedia:!1,hasPreviousMedia:!1,deleteConfirmationOpened:!1,deleteForAll:!0}}shouldComponentUpdate(e,t){const a=this.props,n=a.chatId,s=a.messageId,i=this.state,o=i.background,r=i.currentMessageId,c=i.deleteConfirmationOpened,l=i.firstSliceLoaded,d=i.hasNextMedia,h=i.hasPreviousMedia,u=i.speed,p=i.totalCount;return t.background!==o||(e.chatId!==n||(e.messageId!==s||(t.currentMessageId!==r||(t.hasPrevousMedia!==h||(t.hasNextMedia!==d||(t.firstSliceLoaded!==l||(t.totalCount!==p||(t.deleteConfirmationOpened!==c||t.speed!==u))))))))}componentDidMount(){this.loadHistory(),document.addEventListener("keydown",this.onKeyDown,!1),Nt.a.on("updateDeleteMessages",this.onUpdateDeleteMessages),Nt.a.on("updateNewMessage",this.onUpdateNewMessage),Nt.a.on("updateMessageContent",this.onUpdateMessageContent)}componentWillUnmount(){document.removeEventListener("keydown",this.onKeyDown,!1),Nt.a.off("updateDeleteMessages",this.onUpdateDeleteMessages),Nt.a.off("updateNewMessage",this.onUpdateNewMessage),Nt.a.off("updateMessageContent",this.onUpdateMessageContent)}render(){const e=this.props,t=e.chatId,a=e.t,n=this.state,i=n.background,o=n.currentMessageId,r=n.deleteConfirmationOpened,c=n.deleteForAll,l=n.firstSliceLoaded,d=n.hasNextMedia,h=n.hasPreviousMedia,u=(n.speed,n.totalCount);let p=-1;u&&l&&(p=this.history.findIndex(e=>e.id===o));const m=Math.max(this.history.length,u),g=Nt.a.get(t,o),f=g.can_be_deleted_for_all_users,b=g.can_be_deleted_only_for_self,C=f||b,y=this.canBeForwarded(t,o);let v="";v=Object(Tt.K)(t,o)?a("AreYouSureDeleteVideo"):Object(Tt.z)(t,o)?a("AreYouSureDeleteGIF"):a("AreYouSureDeletePhoto");const E=r?s.a.createElement(M.a,{transitionDuration:0,open:r,onClose:this.handleDialogClose,"aria-labelledby":"form-dialog-title"},s.a.createElement(O.a,{id:"form-dialog-title"},a("Confirm")),s.a.createElement(_.a,null,s.a.createElement(x.a,null,v),f&&s.a.createElement(Un.a,{label:a("DeleteForAll"),control:s.a.createElement(se.a,{color:"primary",value:"deleteAll",onChange:this.handleChangeDeleteForAll}),checked:c})),s.a.createElement(I.a,null,s.a.createElement(w.a,{onClick:this.handleDialogClose,color:"primary"},a("Cancel")),s.a.createElement(w.a,{onClick:this.handleDone,color:"primary"},a("Ok")))):null,S=Object(mt.h)(t,o,B.B),U=Object(T.a)(S,3),k=(U[0],U[1],U[2]),P=k?k.id:0;let N=a("AttachPhoto");return Object(Tt.K)(t,o)?N=a("AttachVideo"):Object(Tt.z)(t,o)?N=a("AttachGif"):Object(Tt.D)(t,o)&&(N=""),s.a.createElement("div",{className:q()("media-viewer",i)},s.a.createElement("div",{className:"media-viewer-footer"},s.a.createElement(Rd,{chatId:t,messageId:o}),s.a.createElement(kd,{title:N,subtitle:m&&p>=0?"".concat(m-p," of ").concat(m):null}),s.a.createElement(xd,{title:a("Save"),fileId:P,onClick:this.handleSave}),s.a.createElement(Md,{title:a("Forward"),disabled:!y,onClick:this.handleForward},s.a.createElement(gd,null)),s.a.createElement(Md,{title:a("Delete"),disabled:!C,onClick:this.handleDelete},s.a.createElement(Ld,null)),s.a.createElement(Md,{title:a("Close"),onClick:this.handleClose},s.a.createElement(la.a,null))),s.a.createElement("div",{className:"media-viewer-wrapper",onClick:this.handlePrevious},s.a.createElement("div",{className:"media-viewer-left-column"},s.a.createElement(Sd,{disabled:!h,grow:!0,onClick:this.handlePrevious},s.a.createElement(md,null))),s.a.createElement("div",{className:"media-viewer-content-column"},s.a.createElement(Bd,{ref:this.contentRef,chatId:t,messageId:o,size:B.B,onClick:this.handlePrevious})),s.a.createElement("div",{className:"media-viewer-right-column"},s.a.createElement(Sd,{disabled:!d,grow:!0,onClick:this.handleNext},s.a.createElement(md,{style:{transform:"rotate(180deg)"}})))),E)}}var zd=Object(p.c)()(Vd);a(228);class Hd extends s.a.Component{constructor(e){super(e),this.onClientUpdateChatBlob=e=>{const t=this.props,a=t.chatId,n=t.photo;if(a===e.chatId&&n.big.id===e.fileId){const t=ft.a.get(e.fileId)||this.state.file;this.setState({file:t})}},this.onClientUpdateUserBlob=e=>{const t=this.props,a=t.chatId,n=t.photo;if(Object(Ze.w)(a)===e.userId&&n.big.id===e.fileId){const t=ft.a.get(e.fileId)||this.state.file;this.setState({file:t})}},this.handleContentClick=e=>{e&&e.stopPropagation(),this.props.onClick(e)};const t=this.props,a=t.chatId,n=t.photo;let s=n.big;s=ft.a.get(s.id)||s,this.state={prevChatId:a,prevPhoto:n,width:B.db,height:B.db,file:s}}static getDerivedStateFromProps(e,t){const a=e.chatId,n=e.photo;return a!==t.prevChatId||n!==t.prevPhoto?{prevChatId:a,prevPhoto:n,width:B.db,height:B.db,file:n.big}:null}componentDidMount(){ft.a.on("clientUpdateChatBlob",this.onClientUpdateChatBlob),ft.a.on("clientUpdateUserBlob",this.onClientUpdateUserBlob)}componentWillUnmount(){ft.a.off("clientUpdateChatBlob",this.onClientUpdateChatBlob),ft.a.off("clientUpdateUserBlob",this.onClientUpdateUserBlob)}render(){const e=this.state,t=(e.width,e.height,e.file);if(!t)return null;const a=ft.a.getBlob(t.id)||t.blob,n=ft.a.getBlobUrl(a);return s.a.createElement("div",{className:"media-viewer-content"},s.a.createElement("img",{className:"media-viewer-content-image",src:n,alt:"",onClick:this.handleContentClick}),s.a.createElement(fd.a,{file:t}))}}var Wd=Hd;class Gd extends s.a.Component{constructor(e){super(e)}render(){const e=this.props,t=e.chatId,a=e.date;return s.a.createElement("div",{className:"media-info"},s.a.createElement("div",{className:"media-info-wrapper"},s.a.createElement(Ct,{chatId:t,showSavedMessages:!1}),s.a.createElement("div",{className:"media-info-content"},s.a.createElement("div",{className:"media-info-row"},s.a.createElement(is.a,{chatId:t})),a&&s.a.createElement("div",{className:"media-info-row meta"},s.a.createElement("span",null,a)))))}}var Kd=Gd;class Zd extends s.a.Component{constructor(e){var t;super(e),t=this,this.onKeyDown=e=>{if(27===e.keyCode){if(this.state.deleteConfirmationOpened)return;this.handleClose()}else 39===e.keyCode?this.handlePrevious():37===e.keyCode&&this.handleNext()},this.loadHistory=function(){var e=Object(h.a)(d.a.mark((function e(a){var n,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.props.chatId,Object(Ze.W)(n)){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,V.a.send({"@type":"getUserProfilePhotos",user_id:Object(Ze.w)(n),offset:0,limit:100});case 5:s=e.sent,t.history=s.photos,t.firstSliceLoaded=0===s.photos.length,0,t.setState({currentIndex:0,hasNextMedia:t.hasNextMedia(0),hasPreviousMedia:t.hasPreviousMedia(0),totalCount:s.total_count}),Object(mt.C)(n,0,t.history);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleClose=()=>{Object(nt.q)(null)},this.handleSave=()=>{const e=this.props.chatId,t=this.state,a=t.currentIndex,n=t.totalCount,s=gt.a.get(e);if(!s)return;let i=-1;n&&(i=a);const o=i>0&&i<this.history.length?Object(dt.a)(this.history[i]):Object(Ze.G)(e);if(!o)return;if(!o.big)return;const r=ft.a.get(o.big.id)||o.big;r&&Object(mt.E)(r,r.id+".jpg",s,()=>ft.a.updateChatPhotoBlob(e,r.id))},this.handleForward=()=>{const e=this.props.chatId,t=this.state,a=t.currentIndex;let n=-1;t.totalCount&&(n=a);let s=null;if(this.history&&n>=0&&n<this.history.length){const e=Object(dt.a)(this.history[n]);if(!e)return;let t=e.big;if(!t)return;s={"@type":"inputFileId",id:t.id}}else{const t=Object(Ze.G)(e);if(!t)return;const a=t.big;if(!a)return;const n=ft.a.getBlob(a.id);if(!n)return;s={"@type":"inputFileBlob",data:n,name:""}}if(!s)return;const i={"@type":"inputMessagePhoto",photo:s,thumbnail:null,added_sticker_file_ids:[],width:B.db,height:B.db,caption:{"@type":"formattedText",text:"",entities:null},ttl:0};V.a.clientUpdate({"@type":"clientUpdateForward",info:{inputMessageContent:i}})},this.handleDelete=()=>{const e=this.props,t=e.chatId,a=(e.messageId,this.state),n=a.currentIndex;let s=-1;a.totalCount&&(s=n);const i=s>0&&s<this.history.length?Object(dt.a)(this.history[s]):Object(Ze.G)(t);if(i){let e=i.big;if(e=ft.a.get(e.id)||e,e){const t=ft.a.getReadWriteStore();ft.a.deleteLocalFile(t,e)}}},this.hasPreviousMedia=e=>{if(-1===e)return!1;return e+1<this.history.length},this.handlePrevious=e=>{e&&e.stopPropagation();const t=this.state.currentIndex+1;return this.loadMedia(t,()=>{t===this.history.length-1&&this.loadPrevious()})},this.loadPrevious=Object(h.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return");case 1:case"end":return e.stop()}}),e)}))),this.hasNextMedia=e=>{if(-1===e)return!1;return e-1>=0},this.handleNext=e=>{e&&e.stopPropagation();const t=this.state.currentIndex-1;return this.loadMedia(t,()=>{0===t&&this.loadNext()})},this.loadNext=Object(h.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return");case 1:case"end":return e.stop()}}),e)}))),this.loadMedia=(e,t)=>{if(e<0)return!1;if(e>=this.history.length)return!1;this.setState({currentIndex:e,hasNextMedia:this.hasNextMedia(e),hasPreviousMedia:this.hasPreviousMedia(e)},t);const a=this.props.chatId;return Object(mt.C)(a,e,this.history),!0},this.history=[];const a=this.props,n=a.chatId,s=a.fileId;this.state={prevChatId:n,prevFileId:s,currentIndex:0,hasNextMedia:!1,hasPreviousMedia:!1,deleteConfirmationOpened:!1}}shouldComponentUpdate(e,t){const a=this.props,n=a.chatId,s=a.messageId,i=this.state,o=i.currentFileId,r=i.hasPreviousMedia,c=i.hasNextMedia,l=i.firstSliceLoaded,d=i.totalCount,h=i.deleteConfirmationOpened;return e.chatId!==n||(e.messageId!==s||(t.currentFileId!==o||(t.hasPrevousMedia!==r||(t.hasNextMedia!==c||(t.firstSliceLoaded!==l||(t.totalCount!==d||t.deleteConfirmationOpened!==h))))))}componentDidMount(){const e=this.props.chatId,t=Object(Ze.G)(e);Object(mt.u)(e,[t]),this.loadHistory(t),document.addEventListener("keydown",this.onKeyDown,!1)}componentWillUnmount(){document.removeEventListener("keydown",this.onKeyDown,!1)}render(){const e=this.props,t=e.chatId,a=e.t,n=this.state,i=n.currentIndex,o=n.hasNextMedia,r=n.hasPreviousMedia,c=(n.firstSliceLoaded,n.totalCount);n.deleteConfirmationOpened,n.deleteForAll;let l=-1;c&&(l=i);const d=l>=0&&l<this.history.length,h=d&&0!==l?Object(dt.a)(this.history[l]):Object(Ze.G)(t),u=d?this.history[l]:null,p=h.big;return s.a.createElement("div",{className:q()("media-viewer","media-viewer-default")},s.a.createElement("div",{className:"media-viewer-footer"},s.a.createElement(Kd,{chatId:t,date:Object(dt.b)(u)}),s.a.createElement(kd,{title:a("AttachPhoto"),subtitle:c&&l>=0?"".concat(l+1," of ").concat(c):null}),s.a.createElement(xd,{title:a("Save"),fileId:p.id,onClick:this.handleSave}),s.a.createElement(xd,{title:a("Forward"),fileId:p.id,onClick:this.handleForward},s.a.createElement(gd,null)),s.a.createElement(Md,{title:a("Delete"),disabled:!0,onClick:this.handleDelete},s.a.createElement(Ld,null)),s.a.createElement(Md,{title:a("Close"),onClick:this.handleClose},s.a.createElement(la.a,null))),s.a.createElement("div",{className:"media-viewer-wrapper",onClick:this.handlePrevious},s.a.createElement("div",{className:"media-viewer-left-column"},s.a.createElement(Sd,{disabled:!o,grow:!0,onClick:this.handleNext},s.a.createElement(md,null))),s.a.createElement("div",{className:"media-viewer-content-column"},s.a.createElement(Wd,{chatId:t,photo:h,onClick:this.handlePrevious})),s.a.createElement("div",{className:"media-viewer-right-column"},s.a.createElement(Sd,{disabled:!r,grow:!0,onClick:this.handlePrevious},s.a.createElement(md,{style:{transform:"rotate(180deg)"}})))),null)}}var qd=Object(p.c)()(Zd);class Yd extends s.a.Component{constructor(e){var t;super(e),t=this,this.onClientUpdateInstantViewContent=e=>{const t=e.content;this.setState({instantViewContent:t})},this.onClientUpdateOpenChat=e=>{const t=e.chatId,a=e.messageId,n=e.popup;this.handleSelectChat(t,a,n)},this.onClientUpdateOpenUser=e=>{const t=e.userId,a=e.popup;this.handleSelectUser(t,a)},this.onClientUpdateChatDetailsVisibility=e=>{this.setState({isChatDetailsVisible:v.a.isChatDetailsVisible})},this.onClientUpdateMediaViewerContent=e=>{this.setState({mediaViewerContent:v.a.mediaViewerContent})},this.onClientUpdateProfileMediaViewerContent=e=>{this.setState({profileMediaViewerContent:v.a.profileMediaViewerContent})},this.onClientUpdateForward=e=>{const t=e.info;this.setState({forwardInfo:t})},this.handleSelectChat=(e,t=null,a=!1)=>{const n=v.a.getChatId(),s=v.a.dialogChatId,i=v.a.getMessageId();a?s!==e&&V.a.clientUpdate({"@type":"clientUpdateDialogChatId",chatId:e}):n===e&&t&&i===t?(this.dialogDetailsRef.current.scrollToMessage(),t&&Object(nt.f)(e,t)):n!==e||t?V.a.setChatId(e,t):this.dialogDetailsRef.current.scrollToStart()},this.handleSelectUser=function(){var e=Object(h.a)(d.a.mark((function e(a,n){var s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,V.a.send({"@type":"createPrivateChat",user_id:a,force:!0});case 4:s=e.sent,t.handleSelectChat(s.id,null,n);case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),this.dialogDetailsRef=s.a.createRef(),this.state={isChatDetailsVisible:v.a.isChatDetailsVisible,mediaViewerContent:v.a.mediaViewerContent,profileMediaViewerContent:v.a.profileMediaViewerContent,forwardInfo:null,instantViewContent:null}}componentDidMount(){ht.a.on("clientUpdateOpenUser",this.onClientUpdateOpenUser),gt.a.on("clientUpdateOpenChat",this.onClientUpdateOpenChat),v.a.on("clientUpdateChatDetailsVisibility",this.onClientUpdateChatDetailsVisibility),v.a.on("clientUpdateMediaViewerContent",this.onClientUpdateMediaViewerContent),v.a.on("clientUpdateProfileMediaViewerContent",this.onClientUpdateProfileMediaViewerContent),v.a.on("clientUpdateForward",this.onClientUpdateForward),Td.a.on("clientUpdateInstantViewContent",this.onClientUpdateInstantViewContent)}componentWillUnmount(){ht.a.off("clientUpdateOpenUser",this.onClientUpdateOpenUser),gt.a.off("clientUpdateOpenChat",this.onClientUpdateOpenChat),v.a.off("clientUpdateChatDetailsVisibility",this.onClientUpdateChatDetailsVisibility),v.a.off("clientUpdateMediaViewerContent",this.onClientUpdateMediaViewerContent),v.a.off("clientUpdateProfileMediaViewerContent",this.onClientUpdateProfileMediaViewerContent),v.a.off("clientUpdateForward",this.onClientUpdateForward),Td.a.off("clientUpdateInstantViewContent",this.onClientUpdateInstantViewContent)}render(){const e=this.state,t=e.instantViewContent,a=e.isChatDetailsVisible,n=e.mediaViewerContent,i=e.profileMediaViewerContent,o=e.forwardInfo;return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:q()("page",{"page-third-column":a})},s.a.createElement(Vi,null),s.a.createElement(Kc,{ref:this.dialogDetailsRef}),a&&s.a.createElement(us,null)),t&&s.a.createElement(Dd,t),n&&s.a.createElement(zd,n),i&&s.a.createElement(qd,i),o&&s.a.createElement(ya,o))}}var Jd=Object(u.a)(g,ca)(Yd);class Qd extends n.Component{constructor(e){super(e),this.onClientUpdateTdLibDatabaseExists=e=>{const t=e.exists;t||this.setState({authorizationState:{"@type":"authorizationStateWaitTdlib"},tdlibDatabaseExists:t})},this.onUpdate=e=>{if(B.A&&!this.checkServiceWorker){this.checkServiceWorker=!0,localStorage.getItem("register")||Object(ia.a)()}},this.onUpdateFatalError=e=>{this.setState({fatalError:!0})},this.onUpdateAuthorizationState=e=>{const t=e.authorization_state;this.setState({authorizationState:t}),window.hasFocus&&t&&V.a.send({"@type":"setOption",name:"online",value:{"@type":"optionValueBoolean",value:!0}})},this.onClientUpdateAppInactive=e=>{this.setState({inactive:!0})},this.handleChangePhone=()=>{this.setState({authorizationState:{"@type":"authorizationStateWaitPhoneNumber"}})},this.handleDragOver=e=>{e.preventDefault(),e.stopPropagation()},this.handleDrop=e=>{e.preventDefault(),e.stopPropagation()},this.handleRefresh=()=>{this.setState({fatalError:!1}),window.location.reload()},this.handleDestroy=()=>{this.setState({fatalError:!1}),V.a.send({"@type":"destroy"})},this.handleKeyDown=e=>{},console.log("Start Telegram Web ".concat(P.version)),this.state={prevAuthorizationState:W.current,authorizationState:null,tdlibDatabaseExists:!1,inactive:!1,fatalError:!1,nativeMobile:Object(ze.r)()}}componentWillMount(){const e=this.props.location;V.a.init(e)}componentDidMount(){setTimeout(()=>Object(oa.b)(),1500),V.a.on("update",this.onUpdate),v.a.on("clientUpdateAppInactive",this.onClientUpdateAppInactive),v.a.on("clientUpdateTdLibDatabaseExists",this.onClientUpdateTdLibDatabaseExists),v.a.on("updateAuthorizationState",this.onUpdateAuthorizationState),v.a.on("updateFatalError",this.onUpdateFatalError)}componentWillUnmount(){V.a.off("update",this.onUpdate),v.a.off("clientUpdateAppInactive",this.onClientUpdateAppInactive),v.a.off("clientUpdateTdLibDatabaseExists",this.onClientUpdateTdLibDatabaseExists),v.a.off("updateAuthorizationState",this.onUpdateAuthorizationState),v.a.off("updateFatalError",this.onUpdateFatalError)}render(){const e=this.props,t=e.t,a=e.theme,n=this.state,i=n.inactive,o=n.nativeMobile,r=(n.tdlibDatabaseExists,n.fatalError);let c=this.state,l=c.authorizationState,d=c.prevAuthorizationState;l&&"authorizationStateWaitEncryptionKey"!==l["@type"]&&"authorizationStateWaitTdlibParameters"!==l["@type"]||(l=d||{"@type":"authorizationStateWaitPhoneNumber"});t("Loading").replace("...","");let h=s.a.createElement(Jd,null);if(o)h=s.a.createElement(Ke,null);else if(i)h=s.a.createElement(Ve,null);else if(l)switch(l["@type"]){case"authorizationStateClosed":case"authorizationStateClosing":case"authorizationStateLoggingOut":case"authorizationStateReady":break;case"authorizationStateWaitCode":case"authorizationStateWaitPassword":case"authorizationStateWaitPhoneNumber":case"authorizationStateWaitTdlib":h=s.a.createElement(Ne,{authorizationState:l,onChangePhone:this.handleChangePhone})}return s.a.createElement("div",{id:"app",className:"dark"===a.palette.type?"dark":"light",onDragOver:this.handleDragOver,onDrop:this.handleDrop,onKeyDown:this.handleKeyDown},h,s.a.createElement(M.a,{transitionDuration:0,open:r,onClose:this.handleRefresh,"aria-labelledby":"fatal-error-dialog-title","aria-describedby":"fatal-error-dialog-description"},s.a.createElement(O.a,{id:"fatal-error-dialog-title"},"Telegram"),s.a.createElement(_.a,null,s.a.createElement(x.a,{id:"fatal-error-dialog-description"},"Oops! Something went wrong. We need to refresh this page.")),s.a.createElement(I.a,null,s.a.createElement(w.a,{onClick:this.handleDestroy,color:"primary"},"Log out"),s.a.createElement(w.a,{onClick:this.handleRefresh,color:"primary",autoFocus:!0},"Refresh"))))}}const Xd=new Map;function $d(e){return eh.apply(this,arguments)}function eh(){return(eh=Object(h.a)(d.a.mark((function e(t){var a,n,s,i;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.a.send({"@type":"getChats",offset_order:"9223372036854775807",offset_chat_id:0,limit:10});case 2:if(!(a=e.sent)){e.next=15;break}n=-1,s=0;case 6:if(!(s<a.chat_ids.length)){e.next=15;break}if((i=gt.a.get(a.chat_ids[s]))&&i.is_pinned&&n++,n!==t){e.next=12;break}return V.a.setChatId(i.id),e.abrupt("return");case 12:s++,e.next=6;break;case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}window.keyMap=Xd,document.addEventListener("keyup",e=>{Xd.delete(e.key)}),document.addEventListener("keydown",function(){var e=Object(h.a)(d.a.mark((function e(t){var a,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Xd.set(t.key,t.key),a=v.a.authorizationState){e.next=4;break}return e.abrupt("return");case 4:if("authorizationStateReady"===a["@type"]){e.next=6;break}return e.abrupt("return");case 6:if(!(Xd.size>3)){e.next=8;break}return e.abrupt("return");case 8:if(!t.altKey||!t.ctrlKey){e.next=39;break}e.t0=t.key,e.next="0"===e.t0?12:"1"===e.t0?19:"2"===e.t0?23:"3"===e.t0?27:"4"===e.t0?31:"5"===e.t0?35:39;break;case 12:return t.preventDefault(),t.stopPropagation(),e.next=16,V.a.send({"@type":"createPrivateChat",user_id:ht.a.getMyId(),force:!0});case 16:return(n=e.sent)&&V.a.setChatId(n.id),e.abrupt("break",39);case 19:return t.preventDefault(),t.stopPropagation(),$d(0),e.abrupt("break",39);case 23:return t.preventDefault(),t.stopPropagation(),$d(1),e.abrupt("break",39);case 27:return t.preventDefault(),t.stopPropagation(),$d(2),e.abrupt("break",39);case 31:return t.preventDefault(),t.stopPropagation(),$d(3),e.abrupt("break",39);case 35:return t.preventDefault(),t.stopPropagation(),$d(4),e.abrupt("break",39);case 39:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),window.hasFocus=!0,window.onblur=function(){Xd.clear(),window.hasFocus=!1,V.a.clientUpdate({"@type":"clientUpdateFocusWindow",focused:!1})},window.onfocus=function(){Xd.clear(),window.hasFocus=!0,V.a.clientUpdate({"@type":"clientUpdateFocusWindow",focused:!0})},window.history.pushState(null,null,window.location.href),window.onpopstate=function(){window.history.go(1)};var th=Object(u.a)(g,Object(p.c)(),S,k.a)(Qd);a(480);if(o.a.render(s.a.createElement(r.a,null,s.a.createElement(c.a,{path:"",component:th})),document.getElementById("root")),B.A){localStorage.getItem("register")&&Object(ia.a)()}else Object(ia.a)()}],[[291,1,2]]]);
//# sourceMappingURL=main.9154795f.chunk.js.map