(this.webpackJsonptelegram_react=this.webpackJsonptelegram_react||[]).push([[4],{680:function(e,t,n){},682:function(e,t,n){},683:function(e,t,n){},684:function(e,t,n){},686:function(e,t,n){"use strict";n.r(t);var a=n(43),r=n(11),s=n.n(r),i=n(3),o=n(5),c=n(7),l=n(6),u=n(8),d=n(0),p=n.n(d),h=n(13),f=n.n(h),k=n(26),m=n(15),S=n.n(m),v=n(23),b=n(342),w=n(598),g=n(273),E=n.n(g),y=n(685),C=n(194),j=n(44),O=n(42),P=n(51),R=n(681),M=n.n(R),x=n(78),U=n(9),D=(n(680),function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(o.a)(t,[{key:"shouldComponentUpdate",value:function(e,t,n){var a=this.props,r=a.info;return a.theme!==e.theme||r!==e.info}},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.info,a=e.onSelect,r=e.onMouseDown,s=e.onMouseEnter,i=e.onDeleteClick;if(!n)return null;var o=n.title,c=n.stickers.map((function(e,n){return p.a.createElement("div",{className:f()("sticker-set-item",t.stickerSetItem),key:e.sticker.id,"data-sticker-id":e.sticker.id,onClick:function(){return a(e)},onMouseEnter:s,onMouseDown:r},p.a.createElement(x.b,{key:e.sticker.id,sticker:e,autoplay:!1,blur:!1,displaySize:U.ib-6,preview:!0,source:x.a.PICKER}))}));return p.a.createElement("div",{className:"sticker-set"},p.a.createElement("div",{className:f()("sticker-set-title",t.title)},p.a.createElement("div",{className:"sticker-set-title-wrapper"},p.a.createElement("span",null,o)),i&&p.a.createElement(w.a,{"aria-label":"delete",classes:{root:t.iconRoot},size:"small",onClick:i},p.a.createElement(M.a,{fontSize:"inherit"}))),p.a.createElement("div",{className:"sticker-set-content"},c))}}]),t}(p.a.Component)),I=S()((function(e){return{title:{backgroundColor:e.palette.background.paper,color:e.palette.text.primary},stickerSetItem:{width:U.ib,height:U.ib,padding:3,boxSizing:"border-box","&:hover":{background:"dark"===e.palette.type?"#303030":"#f4f4f4",borderRadius:6}},iconRoot:{fontSize:16,padding:4,margin:"4px 8px 4px 4px"}}}),{withTheme:!0})(D),T=n(30),N=function(){function e(t){var n=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];Object(i.a)(this,e),this.start=function(){n.stopped=!1,n.id=requestAnimationFrame(n.startAnim)},this.startAnim=function(e){var t=n.start,a=n.duration;n.start=e,n.end=t+a,n.draw(e)},this.draw=function(t){var a=n.stopped,r=n.duration,s=n.start,i=n.options;if(t-s>r&&i.every((function(e){return e.to===e.last}))&&(n.stopped=!0),!a){var o=Math.min(t-s,r),c=0===r?1:o/r,l=e.outSine(c);i.forEach((function(e){var t=e.from,n=e.to,a=e.func;e.last=t+(n-t)*l,a(e.last)})),n.id=requestAnimationFrame(n.draw)}},this.stop=function(){n.stopped=!0,cancelAnimationFrame(n.id)},this.options=a,this.duration=t}return Object(o.a)(e,null,[{key:"outSine",value:function(e){return Math.sin(e*Math.PI/2)}}]),e}(),L=n(37),_=n(57),V=(n(682),function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(l.a)(t).call(this,e))).onClientUpdateStickerSetPosition=function(e){var t=e.position;n.setState({position:t})},n.scrollToPosition=function(){var e=n.state.position,t=Object(j.a)(n),a=t.animator,r=t.anchorRef,s=t.scrollRef.current,i=r.current,o=O.findDOMNode(i),c=s.scrollLeft,l=44*e-147,u=Number(o.style.left.replace("px","")),d=44*e;a&&a.stop(),n.animator=new N(0,[{from:c,to:l,func:function(e){return s.scrollLeft=e}},{from:Math.abs(d-u)>338?d-338*Math.sign(d-u):u,to:d,func:function(e){return o.style.left=e+"px"}}]),setTimeout((function(){n.animator&&n.animator.start()}),0)},n.handleWheel=function(e){var t=Object(j.a)(n).scrollRef;0===e.deltaX&&(t.current.scrollLeft+=e.deltaY)},n.handleSelect=function(e){var t=n.props,a=t.stickers;(0,t.onSelect)(a.indexOf(e))},n.state={position:0},n.scrollRef=p.a.createRef(),n.anchorRef=p.a.createRef(),n}return Object(u.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){_.a.on("clientUpdateStickerSetPosition",this.onClientUpdateStickerSetPosition)}},{key:"componentWillUnmount",value:function(){_.a.off("clientUpdateStickerSetPosition",this.onClientUpdateStickerSetPosition)}},{key:"componentDidUpdate",value:function(e,t,n){t.position!==this.state.position&&this.scrollToPosition()}},{key:"render",value:function(){var e=this,t=this.props,n=t.classes,a=t.stickers.map((function(t){return p.a.createElement(x.b,{key:t.sticker.id,className:"stickers-picker-header-sticker",style:{width:32,height:32},sticker:t,play:!1,autoplay:!1,blur:!1,displaySize:32,preview:!0,source:x.a.PICKER_HEADER,openMedia:function(){return e.handleSelect(t)}})}));return p.a.createElement("div",{className:f()("stickers-picker-header",n.borderColor)},p.a.createElement("div",{ref:this.scrollRef,className:"stickers-picker-header-scroll",onWheel:this.handleWheel},p.a.createElement("div",{className:"stickers-picker-header-items"},a),p.a.createElement("div",{ref:this.anchorRef,className:f()("stickers-picker-header-anchor",n.accentBackgroundDark)})))}}]),t}(p.a.Component)),z=S()((function(e){return Object(T.a)({},Object(L.b)(e),{},Object(L.a)(e))}))(V),A=n(24),B=n(20),F=n(47),H=n(2),W=n(1),X=(n(683),function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(l.a)(t).call(this,e))).onUpdateInstalledStickerSets=function(e){var t=e.is_masks;e.sticker_set_ids;t&&n.filterSets()},n.onUpdateRecentStickers=function(e){n.reloadRecentContent()},n.scrollTop=function(){n.scrollRef.current.scrollTop=0},n.loadContent=function(e,t,a){var r,i,o,c;return s.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:if(e){l.next=4;break}return l.next=3,s.a.awrap(W.a.send({"@type":"getRecentStickers",is_attached:!1}));case 3:e=l.sent;case 4:if(a){l.next=13;break}return l.next=7,s.a.awrap(W.a.send({"@type":"getInstalledStickerSets",is_masks:!1}));case 7:return r=l.sent,i=[],r.sets.forEach((function(e){i.push(W.a.send({"@type":"getStickerSet",set_id:e.id}))})),l.next=12,s.a.awrap(Promise.all(i));case 12:a=l.sent;case 13:o=a.slice(0,5),c=a.reduce((function(e,t){return t.stickers.length>0&&e.push(t.stickers[0]),e}),[]),n.setState({recent:e,stickerSets:t,sets:o,fullSets:a,headerStickers:c}),n.setsLength=o.length;case 17:case"end":return l.stop()}}))},n.loadInViewContentOnScroll=function(){n.loadInViewContent()},n.loadInViewContentOnScrollEnd=function(){n.loadInViewContent(400)},n.loadInViewContent=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=n.scrollRef.current,a=n.state.sets,r=[];a.forEach((function(a){var s=n.itemsMap.get(a.id),i=O.findDOMNode(s);if(i){var o=t.scrollTop-e,c=t.scrollTop+t.offsetHeight+e,l=i.offsetTop,u=i.offsetTop+i.clientHeight;l>=o&&i.offsetTop<=c?r.push(a):u>=o&&u<=c?r.push(a):l<=o&&u>=c&&r.push(a)}})),r.forEach((function(e){var t=H.a.getStore();n.loadedSets.has(e.id)||(n.loadedSets.set(e.id,e.id),Object(B.x)(t,e))}))},n.updatePosition=function(){var e=n.scrollRef.current,t=n.state.sets,a=e.scrollHeight,r=0,s=0;t.forEach((function(t,i){var o=n.itemsMap.get(t.id);if(o){var c=O.findDOMNode(o);if(c){s=0===i?c.offsetTop:s;var l=c.offsetTop-s;if(c&&l<=e.scrollTop){var u=Math.abs(e.scrollTop-l);u<=a&&(a=u,r=i)}}}})),W.a.clientUpdate({"@type":"clientUpdateStickerSetPosition",position:r})},n.handleScroll=function(){var e,t,a,r,i,o,c;return s.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:if(n.loadInViewContentOnScrollEnd(),n.updatePosition(),e=n.scrollRef.current,!n.loadingChunk){l.next=5;break}return l.abrupt("return");case 5:if(t=!1,e.scrollTop+e.offsetHeight>=e.scrollHeight-400&&(t=!0),t){l.next=9;break}return l.abrupt("return",!1);case 9:if(a=n.state,r=a.sets,(i=a.stickerSets).sets.length!==r.length){l.next=12;break}return l.abrupt("return");case 12:return n.loadingChunk=!0,o=[],i.sets.slice(n.setsLength,n.setsLength+5).forEach((function(e){o.push(W.a.send({"@type":"getStickerSet",set_id:e.id}))})),l.next=17,s.a.awrap(Promise.all(o).finally((function(){n.loadingChunk=!1})));case 17:c=l.sent,n.setsLength+=c.length,n.setState({sets:r.concat(c)});case 20:case"end":return l.stop()}}))},n.loadPreviewContent=function(e){var t=n.state,a=t.recent,r=t.sets,s=Object(F.e)([a].concat(r)).find((function(t){return t.sticker.id===e}));if(s){var i=H.a.getStore();Object(B.w)(i,s,null);Object(F.d)(s,r,5).forEach((function(e){Object(B.w)(i,e,null)}))}},n.handleMouseEnter=function(e){var t=Number(e.currentTarget.dataset.stickerId);if(t&&n.mouseDown){n.mouseDownStickerId!==t&&(n.mouseDownStickerId=null),n.setState({previewStickerId:t}),n.loadPreviewContent(t);var a=n.props.onPreview,r=n.state,s=r.recent,i=r.sets;a(Object(F.e)([s].concat(i)).find((function(e){return e.sticker.id===t})))}},n.handleMouseDown=function(e){var t=Number(e.currentTarget.dataset.stickerId);if(t){n.mouseDownStickerId=t;var a=Date.now();return n.setState({previewStickerId:t,timestamp:a,showPreview:!1,cancelSend:!1}),setTimeout((function(){n.state.timestamp===a&&n.setState({showPreview:!0,cancelSend:!0},(function(){var e=n.props.onPreview,a=n.state,r=a.recent,s=a.sets;e(Object(F.e)([r].concat(s)).find((function(e){return e.sticker.id===t})))}))}),500),n.loadPreviewContent(t),n.mouseDown=!0,document.addEventListener("mouseup",n.handleMouseUp),e.preventDefault(),e.stopPropagation(),!1}},n.handleMouseUp=function(){n.setState({previewStickerId:0,timestamp:0,showPreview:!1}),(0,n.props.onPreview)(null),n.mouseDown=!1,document.removeEventListener("mouseup",n.handleMouseUp)},n.handleStickerSelect=function(e){var t=n.props.onSelect;n.state.cancelSend||t(e)},n.handleSelectSet=function(e){var t,a,r,i,o,c,l,u,d,p;return s.a.async((function(h){for(;;)switch(h.prev=h.next){case 0:if(t=n.state,a=t.sets,r=t.stickerSets,i=Object(j.a)(n),o=i.scrollRef,!(e<a.length)){h.next=7;break}(c=n.itemsMap.get(a[e].id))&&(l=O.findDOMNode(c))&&(o.current.scrollTop=l.offsetTop),h.next=21;break;case 7:if(!(e<r.sets.length)){h.next=21;break}if(!n.loadingChunk){h.next=10;break}return h.abrupt("return");case 10:if(r.sets.length!==a.length){h.next=12;break}return h.abrupt("return");case 12:return n.loadingChunk=!0,u=[],r.sets.slice(n.setsLength,e+1).forEach((function(e){u.push(W.a.send({"@type":"getStickerSet",set_id:e.id}))})),h.next=17,s.a.awrap(Promise.all(u).finally((function(){return n.loadingChunk=!1})));case 17:d=h.sent,n.setsLength+=d.length,p=a.concat(d),n.setState({sets:p},(function(){e<p.length&&n.handleSelectSet(e)}));case 21:case"end":return h.stop()}}))},n.handleDeleteRecent=function(){W.a.send({"@type":"clearRecentStickers",is_attached:!1})},n.handleDeleteStickerSet=function(e){W.a.send({"@type":"changeStickerSet",set_id:e,is_installed:!1})},n.scrollRef=p.a.createRef(),n.itemsMap=new Map,n.loadedSets=new Map,n.state={recent:null,stickerSets:null,sets:[],headerStickers:[],position:0},n.loadInViewContentOnScrollEnd=Object(A.c)(n.loadInViewContentOnScrollEnd,100),n.loadInViewContentOnScroll=Object(A.y)(n.loadInViewContentOnScroll,2e3),n.updatePosition=Object(A.y)(n.updatePosition,250),n}return Object(u.a)(t,e),Object(o.a)(t,[{key:"shouldComponentUpdate",value:function(e,t,n){var a=this.state,r=a.position,s=a.recent,i=a.stickerSets,o=a.sets,c=a.showPreview;return t.recent!==s||(t.stickerSets!==i||(t.sets!==o||(t.showPreview!==c||t.position!==r)))}},{key:"componentDidMount",value:function(){_.a.on("updateInstalledStickerSets",this.onUpdateInstalledStickerSets),_.a.on("updateRecentStickers",this.onUpdateRecentStickers)}},{key:"componentWillUnmount",value:function(){_.a.off("updateInstalledStickerSets",this.onUpdateInstalledStickerSets),_.a.off("updateRecentStickers",this.onUpdateRecentStickers)}},{key:"filterSets",value:function(e){var t=this.state;t.sets,t.stickerSets}},{key:"reloadRecentContent",value:function(){var e;return s.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.a.awrap(W.a.send({"@type":"getRecentStickers",is_attached:!1}));case 2:e=t.sent,this.setState({recent:e});case 4:case"end":return t.stop()}}),null,this)}},{key:"render",value:function(){var e=this,t=this.props.t,n=this.state,a=n.recent,r=(n.stickerSets,n.sets),s=n.headerStickers;this.itemsMap.clear();var i=r.map((function(t){return p.a.createElement(I,{key:t.id,ref:function(n){return e.itemsMap.set(t.id,n)},info:t,onSelect:e.handleStickerSelect,onMouseDown:e.handleMouseDown,onMouseEnter:e.handleMouseEnter})})),o=a&&a.stickers.length>0?{stickers:a.stickers,title:t("RecentStickers")}:null;return p.a.createElement("div",{className:"stickers-picker"},p.a.createElement(z,{onSelect:this.handleSelectSet,stickers:s}),p.a.createElement("div",{ref:this.scrollRef,className:"stickers-picker-scroll",onScroll:this.handleScroll},Boolean(o)&&p.a.createElement(I,{info:o,onSelect:this.handleStickerSelect,onMouseDown:this.handleMouseDown,onMouseEnter:this.handleMouseEnter,onDeleteClick:this.handleDeleteRecent}),i))}}]),t}(p.a.Component)),q=Object(k.a)(Object(P.c)(),Object(v.c)(),Object(P.b)())(X),J=n(12),K=n(96),Y=(n(684),function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(l.a)(t).call(this,e))).onClientUpdateChange=function(e){n.picker=null},n.handleButtonMouseEnter=function(e){n.buttonEnter=!0,setTimeout((function(){n.buttonEnter&&(n.updatePicker(!0),n.loadStickerSets())}),U.f)},n.loadStickerSets=function(){var e,t,a;return s.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(!n.sets){r.next=2;break}return r.abrupt("return");case 2:return r.next=4,s.a.awrap(W.a.send({"@type":"getRecentStickers",is_attached:!1}));case 4:return n.recent=r.sent,r.next=7,s.a.awrap(W.a.send({"@type":"getInstalledStickerSets",is_masks:!1}));case 7:return n.stickerSets=r.sent,e=[],n.stickerSets.sets.forEach((function(t){e.push(W.a.send({"@type":"getStickerSet",set_id:t.id}))})),r.next=12,s.a.awrap(Promise.all(e));case 12:n.sets=r.sent,t=n.stickersPickerRef.current,a=H.a.getStore(),Object(B.v)(a,n.recent),n.sets.slice(0,5).reverse().forEach((function(e){Object(B.x)(a,e),t.loadedSets.set(e.id,e.id)})),n.sets.reduce((function(e,t){return t.stickers.length>0&&e.push(t.stickers[0]),e}),[]).forEach((function(e){Object(B.y)(a,e)}));case 20:case"end":return r.stop()}}))},n.handleButtonMouseLeave=function(){n.buttonEnter=!1,setTimeout((function(){n.tryClosePicker()}),U.f)},n.tryClosePicker=function(){var e=n.state.sticker;n.paperEnter||n.buttonEnter||e||n.updatePicker(!1)},n.handlePaperMouseEnter=function(){n.paperEnter=!0},n.handlePaperMouseLeave=function(){n.paperEnter=!1,setTimeout((function(){n.tryClosePicker()}),U.f)},n.updatePicker=function(e){n.setState({open:e})},n.handleEmojiClick=function(){n.setState({tab:0})},n.handleStickersClick=function(){var e=n.stickersPickerRef.current,t=n.state.tab;e.loadContent(n.recent,n.stickerSets,n.sets),n.setState({tab:1}),1===t&&e.scrollTop()},n.handleStickerSend=function(e){e&&(W.a.clientUpdate({"@type":"clientUpdateStickerSend",sticker:e}),n.updatePicker(!1))},n.handleStickerPreview=function(e){n.setState({sticker:e}),W.a.clientUpdate({"@type":"clientUpdateStickerPreview",sticker:e}),e||n.tryClosePicker()},n.state={open:!1,tab:0},n.emojiPickerRef=p.a.createRef(),n.stickersPickerRef=p.a.createRef(),n}return Object(u.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){J.a.on("clientUpdateThemeChange",this.onClientUpdateChange),K.a.on("clientUpdateLanguageChange",this.onClientUpdateChange)}},{key:"componentWillUnmount",value:function(){J.a.off("clientUpdateThemeChange",this.onClientUpdateChange),K.a.off("clientUpdateLanguageChange",this.onClientUpdateChange)}},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.theme,r=e.t,s=this.state,i=s.open,o=s.tab,c=s.sticker;if(i&&!this.picker){var l={search:r("Search"),notfound:r("NotEmojiFound"),skintext:r("ChooseDefaultSkinTone"),categories:{search:r("SearchResults"),recent:r("Recent"),people:r("SmileysPeople"),nature:r("AnimalsNature"),foods:r("FoodDrink"),activity:r("Activity"),places:r("TravelPlaces"),objects:r("Objects"),symbols:r("Symbols"),flags:r("Flags"),custom:r("Custom")}};this.picker=p.a.createElement(y.a,{ref:this.emojiPickerRef,set:"apple",showPreview:!1,showSkinTones:!1,onSelect:this.props.onSelect,color:n.palette.primary.dark,i18n:l,native:Object(A.p)(),style:{width:338,overflowX:"hidden"}}),this.stickersPicker=p.a.createElement(q,{ref:this.stickersPickerRef,onSelect:this.handleStickerSend,onPreview:this.handleStickerPreview})}return p.a.createElement(p.a.Fragment,null,p.a.createElement("link",{rel:"stylesheet",type:"text/css",href:"dark"===n.palette.type?"emoji-mart.dark.css":"emoji-mart.light.css"}),p.a.createElement(w.a,{className:"inputbox-icon-button","aria-label":"Emoticon",onMouseEnter:this.handleButtonMouseEnter,onMouseLeave:this.handleButtonMouseLeave},p.a.createElement(E.a,null)),p.a.createElement("div",{className:f()(t.pickerRoot,Object(a.a)({},t.pickerRootOpened,i)),onMouseEnter:this.handlePaperMouseEnter,onMouseLeave:this.handlePaperMouseLeave},p.a.createElement("div",{className:"emoji-picker-header"},p.a.createElement(b.a,{color:0===o?"primary":"default",className:"emoji-picker-header-button",onClick:this.handleEmojiClick},r("Emoji")),p.a.createElement(b.a,{color:1===o?"primary":"default",className:"emoji-picker-header-button",onClick:this.handleStickersClick},r("Stickers"))),p.a.createElement("div",{className:f()("emoji-picker-content",{"emoji-picker-content-stickers":1===o})},this.picker,this.stickersPicker),Boolean(c)&&p.a.createElement(C.a,{sticker:c})))}}]),t}(p.a.Component)),G=Object(k.a)(S()((function(e){return{pickerRoot:{zIndex:e.zIndex.modal,width:338,overflowX:"hidden",backgroundColor:e.palette.background.paper,color:e.palette.text.primary,borderRadius:e.shape.borderRadius,boxShadow:e.shadows[8],position:"absolute",bottom:54,display:"none"},pickerRootOpened:{display:"block"}}}),{withTheme:!0}),Object(v.c)());t.default=G(Y)}}]);
//# sourceMappingURL=4.50cdd409.chunk.js.map