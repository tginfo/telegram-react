{"version":3,"sources":["Actions/Client.js","Stores/MessageStore.js","Stores/SupergroupStore.js","Utils/Store.js","Stores/NotificationStore.js","Utils/ActionScheduler.js","Stores/ApplicationStore.js","Language.js","Constants.js","Controllers/TdLibController.js","Stores/EventEmitter.js","Utils/Common.js","Theme.js","Assets/telegram-logo.svg","Stores/AuthorizationStore.js","Components/Auth/Caption.js","Components/Auth/Country.js","Components/Auth/Phone.js","Components/Auth/Code.js","Components/Auth/Password.js","Components/Auth/AuthErrorDialog.js","Components/Auth/AuthForm.js","Components/Additional/AppInactive.js","Components/Footer.js","Components/InactivePage.js","Components/Additional/NativeApp.js","Components/NativeAppPage.js","TelegramApp.js","index.js","Utils/InputTypingManager.js","Stores/ChatStore.js","registerServiceWorker.js","Utils/HOC.js","Stores/OptionStore.js","Localization/Cache.js","Stores/LocalizationStore.js","Components/ColumnMiddle/HeaderProgress.js","Stores/UserStore.js","Utils/Phone.js"],"names":["openArchive","TdLibController","clientUpdate","open","editMessage","chatId","messageId","deleteMessages","messageIds","replyMessage","forward","info","forwardMessages","openUser","userId","popup","openChat","closeChat","openReply","highlightMessage","selectMessage","selected","clearSelection","setInstantViewViewerContent","content","setMediaViewerContent","setProfileMediaViewerContent","setInstantViewContent","searchChat","query","store","reset","items","Map","selectedItems","onUpdate","update","authorization_state","set","message","emit","chat","get","chat_id","message_id","reply_markup","edit_date","views","old_content","new_content","is_listened","is_viewed","old_message_id","sending_state","id","error_code","error_message","onClientUpdate","size","clear","delete","addTdLibListener","on","removeTdLibListener","off","this","has","send","then","catch","error","deletedMessage","messages","i","length","EventEmitter","window","fullInfoItems","supergroup","setFullInfo","supergroup_id","supergroup_full_info","fullInfo","isChatMuted","ChatStore","notification_settings","use_default_mute_for","mute_for","settings","getScopeNotificationSettings","getChatMuteFor","type","NotificationStore","SupergroupStore","is_channel","isChannelChat","isMessageMuted","contains_unread_mention","hasMention","use_default_disable_mention_notifications","disable_mention_notifications","getChatDisableMentionNotifications","hasPinnedMessage","use_default_disable_pinned_message_notifications","disable_pinned_message_notifications","getChatDisablePinnedMessageNotifications","chatStore","messageStore","MessageStore","appInactive","newMessages","windowFocused","timerHandler","nextSoundAt","Date","enableSound","onTimer","unreadCount","getUnreadCount","document","title","APP_NAME","getElementById","href","last_read_inbox_message_id","chatMap","newChatMap","filter","updateTimer","message_ids","is_permanent","filterMap","map","is_outgoing","Audio","play","setMilliseconds","getMilliseconds","NOTIFICATION_AUDIO_DELAY_MS","scope","focused","forEach","m","setInterval","clearInterval","notifications","ActionScheduler","actionCallback","cancelCallback","add","key","timeout","action","cancel","actions","expire","timerId","clearTimeout","setTimeout","invoke","a","item","remove","now","actionTimeout","handleTimer","expired","value","push","dialogsReady","cacheLoaded","setPhoneNumberRequest","dialogChatId","statistics","authorizationState","defaultPhone","connectionState","isChatDetailsVisible","mediaViewerContent","profileMediaViewerContent","dragParams","actionScheduler","handleScheduledAction","handleCancelScheduledAction","addScheduledAction","invokeScheduledAction","removeScheduledAction","console","log","loggingOut","sendTdParameters","subscribeNotifications","init","is_marked_as_unread","state","text","confirm","logOut","alert","extendedUpdate","nextChatId","nextMessageId","previousChatId","previousMessageId","dragging","files","phone","setPhoneNumber","name","inProgress","setChatId","phone_number","result","onUpdateStatistics","count","addStatistics","visibility","source1","source2","Object","assign","app","withLanguage","WrappedComponent","LanguageWrapper","i18n","LocalizationStore","props","React","Component","displayName","getDisplayName","ANIMATION_DURATION_100MS","ANIMATION_DURATION_200MS","ANIMATION_DURATION_300MS","CHAT_SLICE_LIMIT","EMOJI_PICKER_TIMEOUT_MS","FILE_PRIORITY","IV_LOCATION_HEIGHT","IV_LOCATION_WIDTH","IV_PHOTO_SIZE","IV_PHOTO_DISPLAY_SIZE","KEY_AUTH_STATE","KEY_SUGGESTED_LANGUAGE_PACK_ID","LOCATION_HEIGHT","LOCATION_SCALE","LOCATION_WIDTH","LOCATION_ZOOM","MAX_SNACK","MEDIA_SLICE_LIMIT","MESSAGE_SLICE_LIMIT","MESSAGE_SPLIT_MAX_TIME_S","MUTED_VALUE_MAX","MUTED_VALUE_MIN","NOTIFICATION_AUTO_HIDE_DURATION_MS","NOTIFICATION_DEBOUNCE_DELAY_MS","OPTIMIZATIONS_FIRST_START","PHOTO_BIG_SIZE","PHOTO_DISPLAY_SIZE","PHOTO_DISPLAY_SMALL_SIZE","PHOTO_DISPLAY_EXTRA_SMALL_SIZE","PHOTO_SIZE","PHOTO_THUMBNAIL_SIZE","PLAYER_VOLUME_NORMAL","PLAYER_STARTTIME","PLAYER_PLAYBACKRATE_NORMAL","PLAYER_PLAYBACKRATE_FAST","PLAYER_PROGRESS_TIMEOUT_MS","POLL_QUESTION_LENGTH","POLL_QUESTION_HINT_LENGTH","POLL_QUESTION_MAX_LENGTH","POLL_OPTION_LENGTH","POLL_OPTION_HINT_LENGTH","POLL_OPTION_MAX_LENGTH","POLL_OPTIONS_MAX_COUNT","POLL_RESULTS_FIRST_SLICE_LENGTH","POLL_RESULTS_LEAVE_LENGTH","POLL_RESULTS_SLICE_LENGTH","PRELOAD_AUDIO_SIZE","PRELOAD_ANIMATION_SIZE","PRELOAD_DOCUMENT_SIZE","PRELOAD_STICKER_SIZE","PRELOAD_VOICENOTE_SIZE","PRELOAD_VIDEO_SIZE","PRELOAD_VIDEONOTE_SIZE","PROFILE_PHOTO_BIG_SIZE","PROFILE_PHOTO_SMALL_SIZE","SCROLL_PRECISION","SCROLL_CHATS_PRECISION","SERVICE_NOTIFICATIONS_USER_ID","SHARED_MESSAGE_SLICE_LIMIT","STICKER_DISPLAY_SIZE","STICKER_HINT_DISPLAY_SIZE","STICKER_PREVIEW_DISPLAY_SIZE","STICKER_SMALL_DISPLAY_SIZE","THUMBNAIL_BLURRED_SIZE_90","THUMBNAIL_PRIORITY","TYPING_INPUT_INTERVAL_S","TYPING_OUTPUT_INTERVAL_S","VERBOSITY_JS_MAX","VERBOSITY_JS_MIN","VERBOSITY_MAX","VERBOSITY_MIN","USERNAME_LENGTH_MIN","WASM_FILE_NAME","WASM_FILE_HASH","replace","controller","location","setParameters","parameters","verbosity","jsVerbosity","useTestDC","readOnly","fastUpdating","useDatabase","mode","dbname","callback","req","indexedDB","existed","onsuccess","close","deleteDatabase","onupgradeneeded","databaseExists","exists","options","logVerbosityLevel","jsLogVerbosityLevel","prefix","isBackground","wasmUrl","JSON","stringify","client","TdClient","disableLog","file","search","params","URLSearchParams","toLowerCase","stringToBoolean","parseInt","tag","split","tagVerbosity","request","process","version","packageJson","use_test_dc","api_id","api_hash","system_language_code","navigator","language","device_model","getBrowser","system_version","getOSName","application_version","use_secret_chats","use_message_database","use_file_database","database_directory","files_directory","new_verbosity_level","observers","events","listener","event","l","args","cloned","concat","observer","apply","isMobile","userAgent","indexOf","isIOS","isWindowsPhone","platform","test","MSStream","match","isAppleDevice","OSName","isEdge","documentMode","StyleMedia","string","trim","Boolean","orderCompare","order1","order2","diff","getPhotoThumbnailSize","sizes","getSize","getPhotoSize","dimension","useWidth","width","height","Math","abs","index","photo","local","is_downloading_completed","currDiff","getFitSize","max","increaseToMax","floor","itemsInView","scrollContainerRef","itemsContainerRef","scrollContainer","current","itemsContainer","children","child","offsetTop","offsetHeight","scrollTop","throttle","func","wait","context","previous","later","leading","remaining","arguments","trailing","debounce","immediate","callNow","getFirstLetter","str","char","toUpperCase","getLetters","readImageSize","Promise","resolve","reject","reader","FileReader","addEventListener","image","Image","src","readAsDataURL","arrayBufferToBase64","buffer","binary","bytes","Uint8Array","len","byteLength","String","fromCharCode","btoa","isAuthorizationReady","between","first","last","clamp","getDurationString","secondsTotal","hours","minutes","seconds","getRandomInt","min","ceil","random","historyEquals","second","insertByOrder","array","element","comparator","slice","createTheme","primary","MuiTouchRipple","color","rippleVisible","opacity","transform","hover","hoverOpacity","theme","createMuiTheme","palette","secondary","main","typography","useNextVariants","shape","borderRadius","overrides","MuiOutlinedInput","input","padding","MuiAutocomplete","option","paddingLeft","paddingTop","paddingRight","paddingBottom","paper","maxHeight","MuiMenuList","root","minWidth","MuiList","style","documentElement","setProperty","disabled","zIndex","modal","dark","light","grey","divider","background","updateDarkTheme","default","updateLightTheme","withTheme","ThemeWrapper","onClientUpdateThemeChanging","localStorage","setItem","setState","ApplicationStore","themeOptions","parse","getItem","StylesProvider","injectFirst","_extends","target","source","prototype","hasOwnProperty","call","_objectWithoutProperties","excluded","sourceKeys","keys","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","createElement","stroke","strokeWidth","fillRule","d","_ref","svgRef","className","viewBox","ref","ForwardRef","forwardRef","save","load","removeItem","authorization","Lottie","lazy","Caption","loadData","closeData","requests","fetch","all","results","x","json","idleData","peekData","trackingData","lastUpdate","onClientUpdateMonkeyIdle","onClientUpdateMonkeyTracking","onClientUpdateMonkeyClose","onClientUpdateMonkeyPeek","data","lottieRef","anim","playSegments","code","prevCode","from","to","peek","createRef","AuthStore","control","Suspense","fallback","autoplay","loop","animationData","renderer","rendererSettings","preserveAspectRatio","clearCanvas","progressiveLoad","hideOnTransparent","Country","emoji","cleanProgressStatus","status","isConnecting","formatPhoneNumber","country","getCountryFromPhone","pattern","clearPhone","substring","formatByPattern","isWhitelistKey","findIndex","startsWith","isPhoneWithOptionCode","getCountryFromCode","Phone","onUpdateConnectionState","setCountryCode","connecting","onClientUpdateSetPhoneCanceled","loading","onClientUpdateSetPhoneError","errorString","onClientUpdateSetPhoneResult","onUpdateOption","setSuggestedLanguagePackId","handleKeyPress","preventDefault","handleDone","stopPropagation","phoneNumber","isBad","isValidPhoneNumber","handleChangeLanguage","suggestedLanguage","nextLanguage","fallbackLng","handleFilterOptions","inputValue","names","some","isValidOption","handleCountryChange","nextCountry","prevPhone","nextPhone","trimStart","phoneInputRef","focus","handleKeepChange","keep","handlePhoneChange","phone1","phone2","handlePaste","plainText","clipboardData","getData","ch","execCommand","AppStore","countryCode","nextProps","nextState","nextContext","OptionStore","languagePackId","loadLanguage","t","autoComplete","Typography","variant","HeaderProgress","Autocomplete","debug","noOptionsText","autoHighlight","getOptionLabel","renderOption","renderInput","TextField","classes","label","inputProps","fullWidth","filterOptions","onChange","inputRef","helperText","autoFocus","onKeyPress","onPaste","Checkbox","checked","Button","disableElevation","onClick","Link","lng","withTranslation","Code","handleNext","isValid","first_name","last_name","finally","handleBack","onChangePhone","handleChange","e","codeLength","codeInfo","getPhoneNumber","getCodeLength","subtitle","getSubtitle","classNames","IconButton","aria-label","fontSize","maxLength","Password","password","handleMouseDownPassword","handleClickShowPassword","showPassword","sendMonkeyPeek","passwordHint","FormControl","InputLabel","htmlFor","OutlinedInput","endAdornment","InputAdornment","position","onMouseDown","edge","labelWidth","FormHelperText","AuthErrorDialog","handleAuthError","bind","handleClose","handleKeyDown","Dialog","transitionDuration","onKeyDown","onClose","aria-labelledby","DialogTitle","DialogContent","DialogContentText","DialogActions","AuthForm","loadContent","terms_of_service","code_info","termsOfService","password_hint","has_recovery_email_address","recovery_email_address_pattern","hasRecoveryEmailAddress","recoveryEmailAddressPattern","onLoad","handleLoad","AppInactive","alt","handleReload","reload","Footer","PureComponent","InactivePage","NativeApp","handleInstall","NativeAppPage","MainPage","TelegramApp","onClientUpdateTdLibDatabaseExists","tdlibDatabaseExists","checkServiceWorker","registerServiceWorker","onUpdateFatalError","fatalError","onUpdateAuthorizationState","hasFocus","onClientUpdateAppInactive","inactive","handleChangePhone","handleDragOver","handleDrop","handleRefresh","handleDestroy","prevAuthorizationState","AuthorizationStore","nativeMobile","page","onDragOver","onDrop","aria-describedby","keyMap","openPinnedChat","offset_order","offset_chat_id","limit","chats","pinnedIndex","chat_ids","is_pinned","altKey","ctrlKey","user_id","UserStore","getMyId","force","onblur","onfocus","history","pushState","onpopstate","go","enhance","compose","withTelegramTheme","ReactDOM","render","path","component","InputTypingManager","timeoutCallback","addAction","clearAction","setActionsTimeout","expiredActions","setSeconds","getSeconds","typingManagers","onlineMemberCount","counters","skippedUpdates","chatList","wallpaper","loadClientData","clientData","Number","saveClientData","obj","Array","entries","reduce","updating","emitUpdate","updates","action_bar","emitFastUpdate","chat_list","updateChatChatList","setOnlineMemberCount","online_member_count","order","draft_message","is_sponsored","last_message","user","profile_photo","pinned_message_id","unread_count","last_read_outbox_message_id","reply_markup_message_id","unread_mention_count","typingManager","getTypingManager","setTypingManager","client_data","setClientData","idMap","isLocalhost","hostname","register","URL","origin","swUrl","registerValidSW","checkValidServiceWorker","serviceWorker","registration","onupdatefound","installingWorker","installing","onstatechange","ready","pushManager","getSubscription","pushSubscription","unsubscribe","subscribe","userVisibleOnly","endpoint","p256dh_base64url","getKey","auth_base64url","deviceToken","device_token","other_user_ids","response","headers","unregister","funcs","b","arg","withSaveRef","forwardedRef","withRestoreRef","rest","Storage","getDefaults","expirationTime","Infinity","versions","Cache","services","storage","namespace","nowMS","getTime","i18nStamp","i18nVersion","defaultNS","use","initReactI18next","ns","fallbackNS","resources","en","ChatsAndContacts","SearchMessagesIn","ContactJoinedEnabled","ContactJoinedDisabled","NotificationsEnabled","NotificationsDisabled","PreviewEnabled","PreviewDisabled","BioAbout","Archived","Saved","EditProfile","GeneralSettings","PollQuizOneRightAnswer","LeftChannel","LeftGroup","EnterPassword","YourAccountProtectedWithPassword","DeletedMessage","YourPhone","SignInToTelegram","PhoneNumber","KeepMeSignedIn","StartText","Next","InvalidPhoneNumber","More","SendFileConfirmation","SendFilesConfirmation","SendMessage","ChatInfo","ChannelInfo","Stickers","Emoji","SelectChatToStartMessaging","Text","ViewChannelInfo","ViewGroupInfo","ViewProfile","GoToMessage","PhotosTitle","VideosTitle","VoiceTitle","UpdateDraftConfirmation","Search","NotEmojiFound","ChooseDefaultSkinTone","SearchResults","Recent","SmileysPeople","AnimalsNature","FoodDrink","Activity","TravelPlaces","Objects","Symbols","Flags","Custom","translation","AppName","Connecting","ConnectingToProxy","Loading","Updating","WaitingForNetwork","ContinueOnThisLanguage","SendAsFile","SendAsPhoto","ru","interpolation","escapeValue","react","cache","LocalizationCache","enabled","defaultResources","read","err","currentResources","addResourceBundle","only_local","changeLanguage","processStrings","languagePackStrings","strings","zero_value","one_value","two_value","few_value","many_value","other_value","language_pack_id","localization","user_full_info","myId","lines","data2"],"mappings":"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","file":"static/js/main.9f3c76e6.chunk.js","sourcesContent":["/*\r\n *  Copyright (c) 2018-present, Evgeny Nadymov\r\n *\r\n * This source code is licensed under the GPL v.3.0 license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport TdLibController from '../Controllers/TdLibController';\r\n\r\nexport function openArchive() {\r\n    TdLibController.clientUpdate({\r\n        '@type': 'clientUpdateArchive',\r\n        open: true\r\n    });\r\n}\r\n\r\nexport function closeArchive() {\r\n    TdLibController.clientUpdate({\r\n        '@type': 'clientUpdateArchive',\r\n        open: false\r\n    });\r\n}\r\n\r\nexport function editMessage(chatId, messageId) {\r\n    TdLibController.clientUpdate({\r\n        '@type': 'clientUpdateEditMessage',\r\n        chatId,\r\n        messageId\r\n    });\r\n}\r\n\r\nexport function deleteMessages(chatId, messageIds) {\r\n    TdLibController.clientUpdate({\r\n        '@type': 'clientUpdateDeleteMessages',\r\n        chatId,\r\n        messageIds\r\n    });\r\n}\r\n\r\nexport function replyMessage(chatId, messageId) {\r\n    TdLibController.clientUpdate({\r\n        '@type': 'clientUpdateReply',\r\n        chatId,\r\n        messageId\r\n    });\r\n}\r\n\r\nexport function forward(info) {\r\n    TdLibController.clientUpdate({\r\n        '@type': 'clientUpdateForward',\r\n        info\r\n    });\r\n}\r\n\r\nexport function forwardMessages(chatId, messageIds) {\r\n    TdLibController.clientUpdate({\r\n        '@type': 'clientUpdateForward',\r\n        info: {\r\n            chatId,\r\n            messageIds\r\n        }\r\n    });\r\n}\r\n\r\nexport function openUser(userId, popup = false) {\r\n    TdLibController.clientUpdate({\r\n        '@type': 'clientUpdateOpenUser',\r\n        userId,\r\n        popup\r\n    });\r\n}\r\n\r\nexport function openChat(chatId, messageId = null, popup = false) {\r\n    TdLibController.clientUpdate({\r\n        '@type': 'clientUpdateOpenChat',\r\n        chatId,\r\n        messageId,\r\n        popup\r\n    });\r\n}\r\n\r\nexport function closeChat() {\r\n    TdLibController.clientUpdate({\r\n        '@type': 'clientUpdateOpenChat',\r\n        chatId: 0,\r\n        messageId: null,\r\n        popup: false\r\n    });\r\n}\r\n\r\nexport function openReply(chatId, messageId) {\r\n    TdLibController.clientUpdate({\r\n        '@type': 'clientUpdateOpenReply',\r\n        chatId,\r\n        messageId\r\n    });\r\n}\r\n\r\nexport function highlightMessage(chatId, messageId) {\r\n    TdLibController.clientUpdate({\r\n        '@type': 'clientUpdateMessageHighlighted',\r\n        chatId,\r\n        messageId\r\n    });\r\n}\r\n\r\nexport function selectMessage(chatId, messageId, selected) {\r\n    TdLibController.clientUpdate({\r\n        '@type': 'clientUpdateMessageSelected',\r\n        chatId,\r\n        messageId,\r\n        selected\r\n    });\r\n}\r\n\r\nexport function clearSelection() {\r\n    TdLibController.clientUpdate({ '@type': 'clientUpdateClearSelection' });\r\n}\r\n\r\nexport function setInstantViewViewerContent(content) {\r\n    TdLibController.clientUpdate({\r\n        '@type': 'clientUpdateInstantViewViewerContent',\r\n        content\r\n    });\r\n}\r\n\r\nexport function setMediaViewerContent(content) {\r\n    TdLibController.clientUpdate({\r\n        '@type': 'clientUpdateMediaViewerContent',\r\n        content\r\n    });\r\n}\r\n\r\nexport function setProfileMediaViewerContent(content) {\r\n    TdLibController.clientUpdate({\r\n        '@type': 'clientUpdateProfileMediaViewerContent',\r\n        content\r\n    });\r\n}\r\n\r\nexport function setInstantViewContent(content) {\r\n    TdLibController.clientUpdate({\r\n        '@type': 'clientUpdateInstantViewContent',\r\n        content\r\n    });\r\n}\r\n\r\nexport function searchChat(chatId, query = null) {\r\n    TdLibController.clientUpdate({\r\n        '@type': 'clientUpdateSearchChat',\r\n        chatId,\r\n        query\r\n    });\r\n}\r\n","/*\r\n *  Copyright (c) 2018-present, Evgeny Nadymov\r\n *\r\n * This source code is licensed under the GPL v.3.0 license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport EventEmitter from './EventEmitter';\r\nimport TdLibController from '../Controllers/TdLibController';\r\n\r\nclass MessageStore extends EventEmitter {\r\n    constructor() {\r\n        super();\r\n\r\n        this.reset();\r\n\r\n        this.addTdLibListener();\r\n    }\r\n\r\n    reset = () => {\r\n        this.items = new Map();\r\n        this.selectedItems = new Map();\r\n    };\r\n\r\n    onUpdate = update => {\r\n        switch (update['@type']) {\r\n            case 'updateAuthorizationState': {\r\n                const { authorization_state } = update;\r\n                if (!authorization_state) break;\r\n\r\n                switch (authorization_state['@type']) {\r\n                    case 'authorizationStateClosed': {\r\n                        this.reset();\r\n                        break;\r\n                    }\r\n                }\r\n\r\n                break;\r\n            }\r\n            case 'updateNewMessage':\r\n                this.set(update.message);\r\n                this.emit('updateNewMessage', update);\r\n                break;\r\n            case 'updateDeleteMessages':\r\n                this.emit('updateDeleteMessages', update);\r\n                break;\r\n            case 'updateMessageEdited': {\r\n                const chat = this.items.get(update.chat_id);\r\n                if (chat) {\r\n                    const message = chat.get(update.message_id);\r\n                    if (message) {\r\n                        message.reply_markup = update.reply_markup;\r\n                        message.edit_date = update.edit_date;\r\n                    }\r\n                }\r\n                this.emit('updateMessageEdited', update);\r\n                break;\r\n            }\r\n            case 'updateMessageViews': {\r\n                const chat = this.items.get(update.chat_id);\r\n                if (chat) {\r\n                    const message = chat.get(update.message_id);\r\n                    if (message && update.views > message.views) {\r\n                        message.views = update.views;\r\n                    }\r\n                }\r\n                this.emit('updateMessageViews', update);\r\n                break;\r\n            }\r\n            case 'updateMessageContent': {\r\n                const chat = this.items.get(update.chat_id);\r\n                if (chat) {\r\n                    const message = chat.get(update.message_id);\r\n                    if (message) {\r\n                        update.old_content = message.content;\r\n                        message.content = update.new_content;\r\n                    }\r\n                }\r\n                this.emit('updateMessageContent', update);\r\n                break;\r\n            }\r\n            case 'updateMessageContentOpened': {\r\n                const { chat_id, message_id } = update;\r\n\r\n                const message = this.get(chat_id, message_id);\r\n                if (message) {\r\n                    const { content } = message;\r\n                    switch (content['@type']) {\r\n                        case 'messageVoiceNote': {\r\n                            message.content.is_listened = true;\r\n                            break;\r\n                        }\r\n                        case 'messageVideoNote': {\r\n                            message.content.is_viewed = true;\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                this.emit('updateMessageContentOpened', update);\r\n                break;\r\n            }\r\n            case 'updateMessageSendSucceeded': {\r\n                const chat = this.items.get(update.message.chat_id);\r\n                if (chat) {\r\n                    const message = chat.get(update.old_message_id);\r\n                    if (message) {\r\n                        message.sending_state = update.message.sending_state;\r\n                    }\r\n                    if (update.old_message_id !== update.message.id) {\r\n                        this.set(update.message);\r\n                    }\r\n                }\r\n\r\n                this.set(update.message);\r\n                this.emit('updateMessageSendSucceeded', update);\r\n                break;\r\n            }\r\n            case 'updateMessageSendFailed': {\r\n                if (update.message.sending_state) {\r\n                    update.message.sending_state.error_code = update.error_code;\r\n                    update.message.sending_state.error_message = update.error_message;\r\n                }\r\n\r\n                const chat = this.items.get(update.message.chat_id);\r\n                if (chat) {\r\n                    const message = chat.get(update.old_message_id);\r\n                    if (message) {\r\n                        message.sending_state = update.message.sending_state;\r\n                        if (message.sending_state) {\r\n                            message.sending_state.error_code = update.error_code;\r\n                            message.sending_state.error_message = update.error_message;\r\n                        }\r\n                    }\r\n                    if (update.old_message_id !== update.message.id) {\r\n                        this.set(update.message);\r\n                    }\r\n                }\r\n                this.emit('updateMessageSendFailed', update);\r\n                break;\r\n            }\r\n            default:\r\n                break;\r\n        }\r\n    };\r\n\r\n    onClientUpdate = update => {\r\n        switch (update['@type']) {\r\n            case 'clientUpdateChatId': {\r\n                if (this.selectedItems.size > 0) {\r\n                    this.selectedItems.clear();\r\n\r\n                    this.emit('clientUpdateClearSelection', { '@type': 'clientUpdateClearSelection' });\r\n                }\r\n\r\n                break;\r\n            }\r\n            case 'clientUpdateClearSelection': {\r\n                this.selectedItems.clear();\r\n\r\n                this.emit('clientUpdateClearSelection', update);\r\n                break;\r\n            }\r\n            case 'clientUpdateMessageShake': {\r\n                this.emit('clientUpdateMessageShake', update);\r\n                break;\r\n            }\r\n            case 'clientUpdateMessageHighlighted': {\r\n                this.emit('clientUpdateMessageHighlighted', update);\r\n                break;\r\n            }\r\n            case 'clientUpdateMessageSelected': {\r\n                if (update.selected) {\r\n                    this.selectedItems.set(`chatId=${update.chatId}_messageId=${update.messageId}`, {\r\n                        chatId: update.chatId,\r\n                        messageId: update.messageId\r\n                    });\r\n                } else {\r\n                    this.selectedItems.delete(`chatId=${update.chatId}_messageId=${update.messageId}`);\r\n                }\r\n\r\n                this.emit('clientUpdateMessageSelected', update);\r\n                break;\r\n            }\r\n            case 'clientUpdateMessagesInView': {\r\n                this.emit('clientUpdateMessagesInView', update);\r\n                break;\r\n            }\r\n            case 'clientUpdateOpenReply': {\r\n                this.emit('clientUpdateOpenReply', update);\r\n                break;\r\n            }\r\n            case 'clientUpdateReply': {\r\n                this.emit('clientUpdateReply', update);\r\n                break;\r\n            }\r\n            case 'clientUpdateTryEditMessage': {\r\n                this.emit('clientUpdateTryEditMessage', update);\r\n                break;\r\n            }\r\n        }\r\n    };\r\n\r\n    hasSelectedMessage(chatId, messageId) {\r\n        return this.selectedItems.has(`chatId=${chatId}_messageId=${messageId}`);\r\n    }\r\n\r\n    addTdLibListener = () => {\r\n        TdLibController.on('update', this.onUpdate);\r\n        TdLibController.on('clientUpdate', this.onClientUpdate);\r\n    };\r\n\r\n    removeTdLibListener = () => {\r\n        TdLibController.off('update', this.onUpdate);\r\n        TdLibController.off('clientUpdate', this.onClientUpdate);\r\n    };\r\n\r\n    load(chatId, messageId) {\r\n        TdLibController.send({\r\n            '@type': 'getMessage',\r\n            chat_id: chatId,\r\n            message_id: messageId\r\n        })\r\n            .then(message => {\r\n                this.set(message);\r\n                this.emit('getMessageResult', message);\r\n            })\r\n            .catch(error => {\r\n                const deletedMessage = {\r\n                    '@type': 'deletedMessage',\r\n                    chat_id: chatId,\r\n                    id: messageId,\r\n                    content: null\r\n                };\r\n                this.set(deletedMessage);\r\n                this.emit('getMessageResult', deletedMessage);\r\n            });\r\n    }\r\n\r\n    get(chatId, messageId) {\r\n        let chat = this.items.get(chatId);\r\n        if (!chat) {\r\n            //this.load(chatId, messageId);\r\n            return null;\r\n        }\r\n\r\n        let message = chat.get(messageId);\r\n        if (!message) {\r\n            //this.load(chatId, messageId);\r\n            return null;\r\n        }\r\n\r\n        return message;\r\n    }\r\n\r\n    set(message) {\r\n        if (!message) return;\r\n\r\n        let chat = this.items.get(message.chat_id);\r\n        if (!chat) {\r\n            chat = new Map();\r\n            this.items.set(message.chat_id, chat);\r\n        }\r\n\r\n        chat.set(message.id, message);\r\n    }\r\n\r\n    setItems(messages) {\r\n        for (let i = 0; i < messages.length; i++) {\r\n            this.set(messages[i]);\r\n        }\r\n    }\r\n}\r\n\r\nconst store = new MessageStore();\r\nwindow.message = store;\r\nexport default store;\r\n","/*\r\n *  Copyright (c) 2018-present, Evgeny Nadymov\r\n *\r\n * This source code is licensed under the GPL v.3.0 license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport EventEmitter from './EventEmitter';\r\nimport TdLibController from '../Controllers/TdLibController';\r\n\r\nclass SupergroupStore extends EventEmitter {\r\n    constructor() {\r\n        super();\r\n\r\n        this.reset();\r\n\r\n        this.addTdLibListener();\r\n    }\r\n\r\n    reset = () => {\r\n        this.items = new Map();\r\n        this.fullInfoItems = new Map();\r\n    };\r\n\r\n    onUpdate = update => {\r\n        switch (update['@type']) {\r\n            case 'updateAuthorizationState': {\r\n                const { authorization_state } = update;\r\n                if (!authorization_state) break;\r\n\r\n                switch (authorization_state['@type']) {\r\n                    case 'authorizationStateClosed': {\r\n                        this.reset();\r\n                        break;\r\n                    }\r\n                }\r\n\r\n                break;\r\n            }\r\n            case 'updateSupergroup':\r\n                this.set(update.supergroup);\r\n\r\n                this.emit(update['@type'], update);\r\n                break;\r\n            case 'updateSupergroupFullInfo':\r\n                this.setFullInfo(update.supergroup_id, update.supergroup_full_info);\r\n\r\n                this.emit(update['@type'], update);\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    };\r\n\r\n    onClientUpdate = update => {};\r\n\r\n    addTdLibListener = () => {\r\n        TdLibController.on('update', this.onUpdate);\r\n        TdLibController.on('clientUpdate', this.onClientUpdate);\r\n    };\r\n\r\n    removeTdLibListener = () => {\r\n        TdLibController.off('update', this.onUpdate);\r\n        TdLibController.off('clientUpdate', this.onClientUpdate);\r\n    };\r\n\r\n    get(id) {\r\n        return this.items.get(id);\r\n    }\r\n\r\n    set(supergroup) {\r\n        this.items.set(supergroup.id, supergroup);\r\n    }\r\n\r\n    getFullInfo(id) {\r\n        return this.fullInfoItems.get(id);\r\n    }\r\n\r\n    setFullInfo(id, fullInfo) {\r\n        this.fullInfoItems.set(id, fullInfo);\r\n    }\r\n}\r\n\r\nconst store = new SupergroupStore();\r\nwindow.supergroup = store;\r\nexport default store;\r\n","/*\r\n *  Copyright (c) 2018-present, Evgeny Nadymov\r\n *\r\n * This source code is licensed under the GPL v.3.0 license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport ChatStore from '../Stores/ChatStore';\r\nimport NotificationStore from '../Stores/NotificationStore';\r\nimport SupergroupStore from '../Stores/SupergroupStore';\r\n\r\nfunction isChatMuted(chatId) {\r\n    return getChatMuteFor(chatId) > 0;\r\n}\r\n\r\nfunction getChatMuteFor(chatId) {\r\n    const chat = ChatStore.get(chatId);\r\n    if (!chat) return 0;\r\n\r\n    const { notification_settings } = chat;\r\n    if (!notification_settings) return 0;\r\n\r\n    const { use_default_mute_for, mute_for } = notification_settings;\r\n\r\n    if (use_default_mute_for) {\r\n        const settings = getScopeNotificationSettings(chatId);\r\n\r\n        return settings ? settings.mute_for : false;\r\n    }\r\n\r\n    return mute_for;\r\n}\r\n\r\nfunction isChannelChat(chatId) {\r\n    const chat = ChatStore.get(chatId);\r\n    if (!chat) return false;\r\n    if (!chat.type) return false;\r\n\r\n    switch (chat.type['@type']) {\r\n        case 'chatTypeSupergroup': {\r\n            const supergroup = SupergroupStore.get(chat.type.supergroup_id);\r\n\r\n            return supergroup && supergroup.is_channel;\r\n        }\r\n        case 'chatTypeBasicGroup':\r\n        case 'chatTypePrivate':\r\n        case 'chatTypeSecret': {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\nfunction getScopeNotificationSettings(chatId) {\r\n    const chat = ChatStore.get(chatId);\r\n    if (!chat) return null;\r\n\r\n    switch (chat.type['@type']) {\r\n        case 'chatTypePrivate':\r\n        case 'chatTypeSecret': {\r\n            return NotificationStore.settings.get('notificationSettingsScopePrivateChats');\r\n        }\r\n        case 'chatTypeBasicGroup':\r\n        case 'chatTypeSupergroup': {\r\n            let settings = null;\r\n            if (isChannelChat(chatId)) {\r\n                settings = NotificationStore.settings.get('notificationSettingsScopeChannelChats');\r\n            } else {\r\n                settings = NotificationStore.settings.get('notificationSettingsScopeGroupChats');\r\n            }\r\n            return settings;\r\n        }\r\n    }\r\n\r\n    return null;\r\n}\r\n\r\nfunction getChatDisablePinnedMessageNotifications(chatId) {\r\n    const chat = ChatStore.get(chatId);\r\n    if (!chat) return false;\r\n\r\n    const { notification_settings } = chat;\r\n    if (!chat) return false;\r\n\r\n    const {\r\n        use_default_disable_pinned_message_notifications,\r\n        disable_pinned_message_notifications\r\n    } = notification_settings;\r\n    if (use_default_disable_pinned_message_notifications) {\r\n        const settings = getScopeNotificationSettings(chatId);\r\n\r\n        return settings ? settings.disable_pinned_message_notifications : false;\r\n    }\r\n\r\n    return disable_pinned_message_notifications;\r\n}\r\n\r\nfunction getChatDisableMentionNotifications(chatId) {\r\n    const chat = ChatStore.get(chatId);\r\n    if (!chat) return false;\r\n\r\n    const { notification_settings } = chat;\r\n    if (!notification_settings) return false;\r\n\r\n    const { use_default_disable_mention_notifications, disable_mention_notifications } = notification_settings;\r\n    if (use_default_disable_mention_notifications) {\r\n        const settings = getScopeNotificationSettings(chatId);\r\n\r\n        return settings ? settings.disable_mention_notifications : false;\r\n    }\r\n\r\n    return disable_mention_notifications;\r\n}\r\n\r\nfunction hasMention(message) {\r\n    return message && message.contains_unread_mention;\r\n}\r\n\r\nfunction hasPinnedMessage(message) {\r\n    return message && message.content['@type'] === 'messagePinMessage';\r\n}\r\n\r\nexport function isMessageMuted(message) {\r\n    const { chat_id } = message;\r\n\r\n    if (hasMention(message)) {\r\n        return getChatDisableMentionNotifications(chat_id);\r\n    }\r\n    if (hasPinnedMessage(message)) {\r\n        return getChatDisablePinnedMessageNotifications(chat_id);\r\n    }\r\n\r\n    return isChatMuted(chat_id);\r\n}\r\n","/*\r\n *  Copyright (c) 2018-present, Evgeny Nadymov\r\n *\r\n * This source code is licensed under the GPL v.3.0 license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport EventEmitter from './EventEmitter';\r\nimport { isMessageMuted } from '../Utils/Store';\r\nimport { APP_NAME, NOTIFICATION_AUDIO_DELAY_MS } from '../Constants';\r\nimport ChatStore from './ChatStore';\r\nimport MessageStore from './MessageStore';\r\nimport TdLibController from '../Controllers/TdLibController';\r\n\r\nclass NotificationStore extends EventEmitter {\r\n    constructor() {\r\n        super();\r\n\r\n        this.reset();\r\n\r\n        this.addTdLibListener();\r\n    }\r\n\r\n    reset = () => {\r\n        // depends on ChatStore and MessageStore updates\r\n        this.chatStore = ChatStore;\r\n        this.messageStore = MessageStore;\r\n\r\n        this.appInactive = false;\r\n        this.newMessages = new Map();\r\n        this.settings = new Map();\r\n        this.windowFocused = true;\r\n        this.timerHandler = null;\r\n        this.nextSoundAt = new Date();\r\n        this.enableSound = false;\r\n    };\r\n\r\n    getUnreadCount() {\r\n        let unreadCount = 0;\r\n        this.newMessages.forEach(chat => {\r\n            chat.forEach(m => {\r\n                if (!m.is_outgoing && !isMessageMuted(m)) {\r\n                    unreadCount++;\r\n                }\r\n            });\r\n        });\r\n\r\n        return unreadCount;\r\n    }\r\n\r\n    updateTimer() {\r\n        const unreadCount = this.getUnreadCount();\r\n        // console.log('[ns] updateTimer', unreadCount, this.newMessages);\r\n\r\n        if (unreadCount > 0) {\r\n            if (!this.timerHandler) {\r\n                // console.log('[ns] setInterval');\r\n\r\n                this.onTimer();\r\n                this.timerHandler = setInterval(this.onTimer, 1000);\r\n            }\r\n        } else {\r\n            if (this.timerHandler) {\r\n                // console.log('[ns] clearInterval');\r\n\r\n                clearInterval(this.timerHandler);\r\n                this.timerHandler = null;\r\n                this.onTimer();\r\n            }\r\n        }\r\n    }\r\n\r\n    onTimer = () => {\r\n        // console.log('[ns] onTimer');\r\n\r\n        const unreadCount = this.getUnreadCount();\r\n        const showBadge = document.title === APP_NAME && unreadCount > 0;\r\n\r\n        if (showBadge) {\r\n            let title = '+99 notifications';\r\n            if (unreadCount === 1) {\r\n                title = '1 notification';\r\n            } else if (unreadCount < 99) {\r\n                title = `${unreadCount} notifications`;\r\n            }\r\n            document.title = title;\r\n            document.getElementById('favicon').href = 'favicon_unread.ico';\r\n        } else {\r\n            document.title = APP_NAME + (this.appInactive ? ': Zzz' : '');\r\n            document.getElementById('favicon').href = 'favicon.ico';\r\n        }\r\n    };\r\n\r\n    onUpdate = update => {\r\n        switch (update['@type']) {\r\n            case 'updateAuthorizationState': {\r\n                const { authorization_state } = update;\r\n                if (!authorization_state) break;\r\n\r\n                switch (authorization_state['@type']) {\r\n                    case 'authorizationStateClosed': {\r\n                        this.reset();\r\n                        break;\r\n                    }\r\n                }\r\n\r\n                break;\r\n            }\r\n            case 'updateChatReadInbox': {\r\n                const { windowFocused } = this;\r\n                if (!windowFocused) {\r\n                    const { chat_id, last_read_inbox_message_id } = update;\r\n\r\n                    const chatMap = this.newMessages.get(chat_id);\r\n                    if (chatMap) {\r\n                        const newChatMap = new Map([...chatMap].filter(([id, m]) => m.id > last_read_inbox_message_id));\r\n                        if (newChatMap.size < chatMap.size) {\r\n                            this.newMessages.set(chat_id, newChatMap);\r\n                            this.updateTimer();\r\n                        }\r\n                    }\r\n                }\r\n\r\n                break;\r\n            }\r\n            case 'updateChatNotificationSettings': {\r\n                const { windowFocused } = this;\r\n                if (!windowFocused) {\r\n                    this.updateTimer();\r\n                }\r\n\r\n                break;\r\n            }\r\n            case 'updateDeleteMessages': {\r\n                const { windowFocused } = this;\r\n                if (!windowFocused) {\r\n                    const { chat_id, message_ids, is_permanent } = update;\r\n                    if (is_permanent && message_ids.length > 0) {\r\n                        const chatMap = this.newMessages.get(chat_id);\r\n                        if (chatMap) {\r\n                            const filterMap = new Map(message_ids.map(id => [id, id]));\r\n\r\n                            const newChatMap = new Map([...chatMap].filter(([id, m]) => !filterMap.has(id)));\r\n                            if (newChatMap.size < chatMap.size) {\r\n                                this.newMessages.set(chat_id, newChatMap);\r\n                                this.updateTimer();\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n\r\n                break;\r\n            }\r\n            case 'updateNewMessage': {\r\n                const { windowFocused } = this;\r\n                // console.log('[ns] updateNewMessage', windowFocused);\r\n                if (!windowFocused) {\r\n                    const { message } = update;\r\n                    const { chat_id, id } = message;\r\n\r\n                    const chatMap = this.newMessages.get(chat_id) || new Map();\r\n                    chatMap.set(id, message);\r\n                    this.newMessages.set(chat_id, chatMap);\r\n                    this.updateTimer();\r\n\r\n                    if (!message.is_outgoing && !isMessageMuted(message) && this.enableSound) {\r\n                        const now = new Date();\r\n                        if (now > this.nextSoundAt) {\r\n                            // console.log('[ns] audio play');\r\n                            try {\r\n                                const audio = new Audio('sound_a.mp3');\r\n                                audio.play();\r\n                            } catch {}\r\n\r\n                            const nextSoundAt = new Date();\r\n                            nextSoundAt.setMilliseconds(nextSoundAt.getMilliseconds() + NOTIFICATION_AUDIO_DELAY_MS);\r\n                            this.nextSoundAt = nextSoundAt;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                break;\r\n            }\r\n            case 'updateScopeNotificationSettings': {\r\n                const { scope, notification_settings } = update;\r\n\r\n                this.settings.set(scope['@type'], notification_settings);\r\n\r\n                const { windowFocused } = this;\r\n                if (!windowFocused) {\r\n                    this.updateTimer();\r\n                }\r\n\r\n                this.emit('updateScopeNotificationSettings', update);\r\n                break;\r\n            }\r\n            default:\r\n                break;\r\n        }\r\n    };\r\n\r\n    onClientUpdate = update => {\r\n        switch (update['@type']) {\r\n            case 'clientUpdateAppInactive': {\r\n                this.appInactive = true;\r\n                this.newMessages = new Map();\r\n                this.updateTimer();\r\n                break;\r\n            }\r\n            case 'clientUpdateFocusWindow': {\r\n                const { focused } = update;\r\n                // console.log('[ns] clientUpdateFocusWindow', update);\r\n\r\n                this.windowFocused = focused;\r\n                if (focused) {\r\n                    this.newMessages = new Map();\r\n                    this.updateTimer();\r\n                }\r\n\r\n                break;\r\n            }\r\n            default:\r\n                break;\r\n        }\r\n    };\r\n\r\n    addTdLibListener = () => {\r\n        TdLibController.on('update', this.onUpdate);\r\n        TdLibController.on('clientUpdate', this.onClientUpdate);\r\n    };\r\n\r\n    removeTdLibListener = () => {\r\n        TdLibController.off('update', this.onUpdate);\r\n        TdLibController.off('clientUpdate', this.onClientUpdate);\r\n    };\r\n}\r\n\r\nconst store = new NotificationStore();\r\nwindow.notifications = store;\r\nexport default store;\r\n","/*\r\n *  Copyright (c) 2018-present, Evgeny Nadymov\r\n *\r\n * This source code is licensed under the GPL v.3.0 license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nclass ActionScheduler {\r\n    constructor(actionCallback, cancelCallback) {\r\n        this.actions = new Map();\r\n        this.actionCallback = actionCallback;\r\n        this.cancelCallback = cancelCallback;\r\n    }\r\n\r\n    add = (key, timeout, action, cancel) => {\r\n        if (this.actions.has(key)) {\r\n            return false;\r\n        }\r\n\r\n        let expire = new Date();\r\n        expire.setMilliseconds(expire.getMilliseconds() + timeout);\r\n\r\n        this.actions.set(key, { expire: expire, action: action, cancel: cancel });\r\n\r\n        if (this.timerId) {\r\n            clearTimeout(this.timerId);\r\n        }\r\n\r\n        this.setTimeout();\r\n\r\n        return true;\r\n    };\r\n\r\n    invoke = async key => {\r\n        const item = this.actions.get(key);\r\n        if (!item) return;\r\n\r\n        this.actions.delete(key);\r\n\r\n        await this.actionCallback({ key: key, action: item.action, cancel: item.cancel });\r\n        if (item.action) await item.action();\r\n\r\n        if (this.timerId) {\r\n            clearTimeout(this.timerId);\r\n        }\r\n\r\n        this.setTimeout();\r\n    };\r\n\r\n    remove = key => {\r\n        const item = this.actions.get(key);\r\n        if (!item) return;\r\n\r\n        this.actions.delete(key);\r\n\r\n        this.cancelCallback({ key: key, action: item.action, cancel: item.cancel });\r\n        if (item.cancel) item.cancel();\r\n\r\n        if (this.timerId) {\r\n            clearTimeout(this.timerId);\r\n        }\r\n\r\n        this.setTimeout();\r\n    };\r\n\r\n    setTimeout = () => {\r\n        let now = new Date();\r\n        let timeout = 1000000;\r\n        for (let [key, value] of this.actions) {\r\n            let actionTimeout = value.expire - now;\r\n            if (actionTimeout < timeout) timeout = actionTimeout;\r\n            if (timeout < 0) timeout = 0;\r\n        }\r\n\r\n        if (timeout < 1000000) {\r\n            this.timerId = setTimeout(this.handleTimer, timeout);\r\n        }\r\n    };\r\n\r\n    handleTimer = () => {\r\n        let now = new Date();\r\n        let expired = [];\r\n        for (let [key, value] of this.actions) {\r\n            let actionTimeout = value.expire - now;\r\n            if (actionTimeout <= 0) expired.push({ key: key, value: value });\r\n        }\r\n\r\n        for (let item of expired) {\r\n            this.actions.delete(item.key);\r\n            this.actionCallback({ key: item.key, action: item.value.action, cancel: item.value.cancel });\r\n            if (item.value.action) item.value.action();\r\n        }\r\n\r\n        this.setTimeout();\r\n    };\r\n}\r\n\r\nexport default ActionScheduler;\r\n","/*\r\n *  Copyright (c) 2018-present, Evgeny Nadymov\r\n *\r\n * This source code is licensed under the GPL v.3.0 license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport EventEmitter from './EventEmitter';\r\nimport ActionScheduler from '../Utils/ActionScheduler';\r\nimport { closeChat } from '../Actions/Client';\r\nimport { subscribeNotifications } from '../registerServiceWorker';\r\nimport TdLibController from '../Controllers/TdLibController';\r\n\r\nclass ApplicationStore extends EventEmitter {\r\n    constructor() {\r\n        super();\r\n\r\n        this.reset();\r\n\r\n        this.addTdLibListener();\r\n        this.addStatistics();\r\n    }\r\n\r\n    reset = () => {\r\n        this.dialogsReady = false;\r\n        this.cacheLoaded = false;\r\n        this.setPhoneNumberRequest = null;\r\n        this.chatId = 0;\r\n        this.dialogChatId = 0;\r\n        this.messageId = null;\r\n        this.statistics = new Map();\r\n        this.authorizationState = null;\r\n        this.defaultPhone = null;\r\n        this.connectionState = null;\r\n        this.isChatDetailsVisible = false;\r\n        this.mediaViewerContent = null;\r\n        this.profileMediaViewerContent = null;\r\n        this.dragParams = null;\r\n        this.actionScheduler = new ActionScheduler(this.handleScheduledAction, this.handleCancelScheduledAction);\r\n    };\r\n\r\n    addScheduledAction = (key, timeout, action, cancel) => {\r\n        return this.actionScheduler.add(key, timeout, action, cancel);\r\n    };\r\n\r\n    invokeScheduledAction = async key => {\r\n        await this.actionScheduler.invoke(key);\r\n    };\r\n\r\n    removeScheduledAction = key => {\r\n        this.actionScheduler.remove(key);\r\n    };\r\n\r\n    handleScheduledAction = item => {\r\n        console.log('Invoked scheduled action key=', item.key);\r\n    };\r\n\r\n    handleCancelScheduledAction = item => {\r\n        console.log('Cancel scheduled action key=', item.key);\r\n    };\r\n\r\n    onUpdate = update => {\r\n        switch (update['@type']) {\r\n            case 'updateAuthorizationState': {\r\n                this.authorizationState = update.authorization_state;\r\n\r\n                switch (update.authorization_state['@type']) {\r\n                    case 'authorizationStateLoggingOut':\r\n                        this.loggingOut = true;\r\n                        break;\r\n                    case 'authorizationStateWaitTdlibParameters':\r\n                        TdLibController.sendTdParameters();\r\n                        break;\r\n                    case 'authorizationStateWaitEncryptionKey':\r\n                        TdLibController.send({ '@type': 'checkDatabaseEncryptionKey' });\r\n                        break;\r\n                    case 'authorizationStateWaitPhoneNumber': {\r\n                        if (this.setPhoneNumberRequest) {\r\n                            this.setPhoneNumberRequest();\r\n\r\n                            this.setPhoneNumberRequest = null;\r\n                        }\r\n\r\n                        break;\r\n                    }\r\n                    case 'authorizationStateWaitCode':\r\n                        break;\r\n                    case 'authorizationStateWaitPassword':\r\n                        break;\r\n                    case 'authorizationStateReady':\r\n                        this.loggingOut = false;\r\n                        this.setPhoneNumberRequest = null;\r\n                        subscribeNotifications();\r\n                        break;\r\n                    case 'authorizationStateClosing':\r\n                        break;\r\n                    case 'authorizationStateClosed':\r\n                        this.reset();\r\n\r\n                        if (!this.loggingOut) {\r\n                            document.title += ': Zzz';\r\n\r\n                            TdLibController.clientUpdate({\r\n                                '@type': 'clientUpdateAppInactive'\r\n                            });\r\n                        } else {\r\n                            TdLibController.init();\r\n                        }\r\n                        break;\r\n                    default:\r\n                        break;\r\n                }\r\n\r\n                this.emit(update['@type'], update);\r\n                break;\r\n            }\r\n            case 'updateChatIsMarkedAsUnread': {\r\n                const { chat_id, is_marked_as_unread } = update;\r\n                if (chat_id === this.chatId && is_marked_as_unread) {\r\n                    closeChat();\r\n                }\r\n\r\n                break;\r\n            }\r\n            case 'updateConnectionState': {\r\n                this.connectionState = update.state;\r\n\r\n                this.emit(update['@type'], update);\r\n                break;\r\n            }\r\n            case 'updateFatalError': {\r\n                this.emit(update['@type'], update);\r\n\r\n                break;\r\n            }\r\n            case 'updateServiceNotification': {\r\n                const { type, content } = update;\r\n\r\n                if (!content) return;\r\n                if (content['@type'] === 'messageText') {\r\n                    const { text } = content;\r\n                    if (!text) return;\r\n\r\n                    if (text['@type'] === 'formattedText' && text.text) {\r\n                        switch (type) {\r\n                            case 'AUTH_KEY_DROP_DUPLICATE':\r\n                                let result = window.confirm(text.text);\r\n                                if (result) {\r\n                                    TdLibController.logOut();\r\n                                }\r\n                                break;\r\n                            default:\r\n                                alert(text.text);\r\n                                break;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                break;\r\n            }\r\n            default:\r\n                break;\r\n        }\r\n    };\r\n\r\n    onClientUpdate = update => {\r\n        switch (update['@type']) {\r\n            case 'clientUpdateAppInactive': {\r\n                this.emit('clientUpdateAppInactive');\r\n                break;\r\n            }\r\n            case 'clientUpdateCacheLoaded': {\r\n                this.cacheLoaded = true;\r\n                this.emit('clientUpdateCacheLoaded');\r\n                break;\r\n            }\r\n            case 'clientUpdateChatId': {\r\n                const extendedUpdate = {\r\n                    '@type': 'clientUpdateChatId',\r\n                    nextChatId: update.chatId,\r\n                    nextMessageId: update.messageId,\r\n                    previousChatId: this.chatId,\r\n                    previousMessageId: this.messageId\r\n                };\r\n\r\n                this.chatId = update.chatId;\r\n                this.messageId = update.messageId;\r\n\r\n                this.emit('clientUpdateChatId', extendedUpdate);\r\n                break;\r\n            }\r\n            case 'clientUpdateTdLibDatabaseExists': {\r\n                this.emit('clientUpdateTdLibDatabaseExists', update);\r\n                break;\r\n            }\r\n            case 'clientUpdateDeleteMessages': {\r\n                this.emit('clientUpdateDeleteMessages', update);\r\n                break;\r\n            }\r\n            case 'clientUpdateDialogsReady': {\r\n                this.dialogsReady = true;\r\n                this.emit('clientUpdateDialogsReady', update);\r\n                break;\r\n            }\r\n            case 'clientUpdateDragging': {\r\n                const { dragging, files } = update;\r\n\r\n                this.dragParams = dragging ? { dragging, files } : null;\r\n                this.emit('clientUpdateDragging', update);\r\n                break;\r\n            }\r\n            case 'clientUpdateEditMessage': {\r\n                this.emit('clientUpdateEditMessage', update);\r\n                break;\r\n            }\r\n            case 'clientUpdateMediaViewerContent': {\r\n                const { content } = update;\r\n                this.mediaViewerContent = content;\r\n\r\n                this.emit('clientUpdateMediaViewerContent', update);\r\n                break;\r\n            }\r\n            case 'clientUpdateNewContentAvailable': {\r\n                this.emit('clientUpdateNewContentAvailable', update);\r\n                break;\r\n            }\r\n            case 'clientUpdateProfileMediaViewerContent': {\r\n                const { content } = update;\r\n                this.profileMediaViewerContent = content;\r\n\r\n                this.emit('clientUpdateProfileMediaViewerContent', update);\r\n                break;\r\n            }\r\n            case 'clientUpdateSearchChat': {\r\n                this.emit('clientUpdateSearchChat', update);\r\n                break;\r\n            }\r\n            case 'clientUpdateSetPhone': {\r\n                const { phone } = update;\r\n\r\n                this.defaultPhone = phone;\r\n\r\n                if (!phone) {\r\n                    this.setPhoneNumberRequest = null;\r\n                    TdLibController.clientUpdate({\r\n                        '@type': 'clientUpdateSetPhoneCanceled'\r\n                    });\r\n                } else {\r\n                    if (\r\n                        this.authorizationState &&\r\n                        this.authorizationState['@type'] === 'authorizationStateWaitPhoneNumber'\r\n                    ) {\r\n                        this.setPhoneNumber(phone);\r\n                    } else {\r\n                        this.setPhoneNumberRequest = () => this.setPhoneNumber(phone);\r\n                    }\r\n                }\r\n\r\n                this.emit('clientUpdateSetPhone', update);\r\n                break;\r\n            }\r\n            case 'clientUpdateSetPhoneResult': {\r\n                this.emit('clientUpdateSetPhoneResult', update);\r\n                break;\r\n            }\r\n            case 'clientUpdateSetPhoneError': {\r\n                this.emit('clientUpdateSetPhoneError', update);\r\n                break;\r\n            }\r\n            case 'clientUpdateDialogChatId': {\r\n                const { chatId } = update;\r\n                this.dialogChatId = chatId;\r\n\r\n                this.emit('clientUpdateDialogChatId', update);\r\n                break;\r\n            }\r\n            case 'clientUpdateFocusWindow': {\r\n                if (!this.authorizationState) {\r\n                    break;\r\n                }\r\n\r\n                TdLibController.send({\r\n                    '@type': 'setOption',\r\n                    name: 'online',\r\n                    value: { '@type': 'optionValueBoolean', value: update.focused }\r\n                });\r\n\r\n                this.emit('clientUpdateFocusWindow', update);\r\n                break;\r\n            }\r\n            case 'clientUpdateForward': {\r\n                this.emit('clientUpdateForward', update);\r\n                break;\r\n            }\r\n            case 'clientUpdateLeaveChat': {\r\n                if (update.inProgress && this.chatId === update.chatId) {\r\n                    TdLibController.setChatId(0);\r\n                }\r\n\r\n                break;\r\n            }\r\n        }\r\n    };\r\n\r\n    setPhoneNumber = phone => {\r\n        TdLibController.send({\r\n            '@type': 'setAuthenticationPhoneNumber',\r\n            phone_number: phone\r\n        })\r\n            .then(result => {\r\n                TdLibController.clientUpdate({\r\n                    '@type': 'clientUpdateSetPhoneResult',\r\n                    result\r\n                });\r\n            })\r\n            .catch(error => {\r\n                TdLibController.clientUpdate({\r\n                    '@type': 'clientUpdateSetPhoneError',\r\n                    error\r\n                });\r\n            });\r\n    };\r\n\r\n    onUpdateStatistics = update => {\r\n        if (!update) return;\r\n\r\n        if (this.statistics.has(update['@type'])) {\r\n            const count = this.statistics.get(update['@type']);\r\n\r\n            this.statistics.set(update['@type'], count + 1);\r\n        } else {\r\n            this.statistics.set(update['@type'], 1);\r\n        }\r\n    };\r\n\r\n    addTdLibListener = () => {\r\n        TdLibController.on('update', this.onUpdate);\r\n        TdLibController.on('clientUpdate', this.onClientUpdate);\r\n    };\r\n\r\n    removeTdLibListener = () => {\r\n        TdLibController.off('update', this.onUpdate);\r\n        TdLibController.off('clientUpdate', this.onClientUpdate);\r\n    };\r\n\r\n    addStatistics = () => {\r\n        TdLibController.on('update', this.onUpdateStatistics);\r\n    };\r\n\r\n    setChatId = (chatId, messageId = null) => {\r\n        const update = {\r\n            '@type': 'clientUpdateChatId',\r\n            nextChatId: chatId,\r\n            nextMessageId: messageId,\r\n            previousChatId: this.chatId,\r\n            previousMessageId: this.messageId\r\n        };\r\n\r\n        this.chatId = chatId;\r\n        this.messageId = messageId;\r\n        this.emit(update['@type'], update);\r\n    };\r\n\r\n    getChatId() {\r\n        return this.chatId;\r\n    }\r\n\r\n    getMessageId() {\r\n        return this.messageId;\r\n    }\r\n\r\n    changeChatDetailsVisibility(visibility) {\r\n        this.isChatDetailsVisible = visibility;\r\n        this.emit('clientUpdateChatDetailsVisibility', visibility);\r\n    }\r\n\r\n    getConnectionState() {\r\n        return this.connectionState;\r\n    }\r\n\r\n    getAuthorizationState() {\r\n        return this.authorizationState;\r\n    }\r\n\r\n    assign(source1, source2) {\r\n        Object.assign(source1, source2);\r\n        //this.set(Object.assign({}, source1, source2));\r\n    }\r\n}\r\n\r\nconst store = new ApplicationStore();\r\nwindow.app = store;\r\nexport default store;\r\n","/*\r\n *  Copyright (c) 2018-present, Evgeny Nadymov\r\n *\r\n * This source code is licensed under the GPL v.3.0 license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport React from 'react';\r\nimport { I18nextProvider } from 'react-i18next';\r\nimport { getDisplayName } from './Utils/HOC';\r\nimport LocalizationStore from './Stores/LocalizationStore';\r\n\r\nfunction withLanguage(WrappedComponent) {\r\n    class LanguageWrapper extends React.Component {\r\n        render() {\r\n            const i18n = LocalizationStore.i18n;\r\n\r\n            return (\r\n                <I18nextProvider i18n={i18n}>\r\n                    <WrappedComponent {...this.props} />\r\n                </I18nextProvider>\r\n            );\r\n        }\r\n    }\r\n    LanguageWrapper.displayName = `WithLanguage(${getDisplayName(WrappedComponent)})`;\r\n\r\n    return LanguageWrapper;\r\n}\r\n\r\nexport default withLanguage;\r\n","/*\r\n *  Copyright (c) 2018-present, Evgeny Nadymov\r\n *\r\n * This source code is licensed under the GPL v.3.0 license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nexport const ANIMATION_FRAME_DURATION_MS = 40;\r\nexport const ANIMATION_DURATION_100MS = 100;\r\nexport const ANIMATION_DURATION_200MS = 200;\r\nexport const ANIMATION_DURATION_300MS = 300;\r\nexport const ANIMATION_DURATION_500MS = 500;\r\nexport const APP_NAME = 'Telegram Web';\r\nexport const CHAT_SLICE_LIMIT = 25;\r\nexport const EMOJI_PICKER_TIMEOUT_MS = 100;\r\nexport const FILE_PRIORITY = 1;\r\nexport const IV_LOCATION_HEIGHT = 300;\r\nexport const IV_LOCATION_WIDTH = 600;\r\nexport const IV_PHOTO_SIZE = 800;\r\nexport const IV_PHOTO_DISPLAY_SIZE = 600;\r\nexport const KEY_AUTH_STATE = 'auth';\r\nexport const KEY_SUGGESTED_LANGUAGE_PACK_ID = 'suggested_language_pack_id';\r\nexport const LOCATION_HEIGHT = 150;\r\nexport const LOCATION_SCALE = 2;\r\nexport const LOCATION_WIDTH = 300;\r\nexport const LOCATION_ZOOM = 16;\r\nexport const MAX_SNACK = 10;\r\nexport const MEDIA_SLICE_LIMIT = 20;\r\nexport const MESSAGE_SLICE_LIMIT = 30;\r\nexport const MESSAGE_SPLIT_MAX_TIME_S = 600;\r\nexport const MUTED_VALUE_MAX = 2147483647; // int32.max = 2^32 - 1\r\nexport const MUTED_VALUE_MIN = 0;\r\nexport const NOTIFICATION_AUDIO_DELAY_MS = 5000;\r\nexport const NOTIFICATION_AUTO_HIDE_DURATION_MS = 5000;\r\nexport const NOTIFICATION_DEBOUNCE_DELAY_MS = 500;\r\nexport const OPTIMIZATIONS_FIRST_START = true;\r\nexport const PHOTO_BIG_SIZE = 1280;\r\nexport const PHOTO_DISPLAY_SIZE = 320;\r\nexport const PHOTO_DISPLAY_SMALL_SIZE = 65;\r\nexport const PHOTO_DISPLAY_EXTRA_SMALL_SIZE = 40;\r\nexport const PHOTO_SIZE = 320;\r\nexport const PHOTO_THUMBNAIL_SIZE = 90;\r\nexport const PLAYER_VOLUME_NORMAL = 0.25;\r\nexport const PLAYER_STARTTIME = 0.0;\r\nexport const PLAYER_PLAYBACKRATE_NORMAL = 1.0;\r\nexport const PLAYER_PLAYBACKRATE_FAST = 1.75;\r\nexport const PLAYER_PROGRESS_TIMEOUT_MS = 250;\r\nexport const POLL_QUESTION_LENGTH = 255;\r\nexport const POLL_QUESTION_HINT_LENGTH = POLL_QUESTION_LENGTH - 79;\r\nexport const POLL_QUESTION_MAX_LENGTH = POLL_QUESTION_LENGTH + 99;\r\nexport const POLL_OPTION_LENGTH = 100;\r\nexport const POLL_OPTION_HINT_LENGTH = POLL_OPTION_LENGTH - 29;\r\nexport const POLL_OPTION_MAX_LENGTH = POLL_OPTION_LENGTH + 99;\r\nexport const POLL_OPTIONS_MAX_COUNT = 10;\r\nexport const POLL_RESULTS_FIRST_SLICE_LENGTH = 15;\r\nexport const POLL_RESULTS_LEAVE_LENGTH = 5;\r\nexport const POLL_RESULTS_SLICE_LENGTH = 50;\r\nexport const PRELOAD_AUDIO_SIZE = 200 * 1024; //10 * 1024 * 1024;\r\nexport const PRELOAD_ANIMATION_SIZE = 200 * 1024; //10 * 1024 * 1024;\r\nexport const PRELOAD_DOCUMENT_SIZE = 200 * 1024;\r\nexport const PRELOAD_STICKER_SIZE = 10 * 200 * 1024;\r\nexport const PRELOAD_VOICENOTE_SIZE = 200 * 1024; //10 * 1024 * 1024;\r\nexport const PRELOAD_VIDEO_SIZE = 10 * 1024 * 1024;\r\nexport const PRELOAD_VIDEONOTE_SIZE = 200 * 1024; //10 * 1024 * 1024;\r\nexport const PROFILE_PHOTO_BIG_SIZE = 640;\r\nexport const PROFILE_PHOTO_SMALL_SIZE = 160;\r\nexport const SCROLL_PRECISION = 0;\r\nexport const SCROLL_CHATS_PRECISION = 400;\r\nexport const SERVICE_NOTIFICATIONS_USER_ID = 777000;\r\nexport const SHARED_MESSAGE_SLICE_LIMIT = 30;\r\nexport const STICKER_DISPLAY_SIZE = 192;\r\nexport const STICKER_HINT_DISPLAY_SIZE = 76;\r\nexport const STICKER_PREVIEW_DISPLAY_SIZE = 256;\r\nexport const STICKER_SMALL_DISPLAY_SIZE = 64;\r\nexport const THUMBNAIL_BLURRED_SIZE = 100;\r\nexport const THUMBNAIL_BLURRED_SIZE_90 = 90;\r\nexport const THUMBNAIL_PRIORITY = 32;\r\nexport const TYPING_INPUT_INTERVAL_S = 8;\r\nexport const TYPING_OUTPUT_INTERVAL_S = 8;\r\nexport const VERBOSITY_JS_MAX = 20;\r\nexport const VERBOSITY_JS_MIN = 0;\r\nexport const VERBOSITY_MAX = 20;\r\nexport const VERBOSITY_MIN = 0;\r\nexport const USERNAME_LENGTH_MIN = 5;\r\nexport const REPLACE_PREFIX = '/telegram-react';\r\nexport const WASM_FILE_NAME = '0c21eb3eef1463ecc905405e1e470b08.wasm';\r\nexport const WASM_FILE_HASH = WASM_FILE_NAME.replace('.wasm', '');\r\n","/*\r\n *  Copyright (c) 2018-present, Evgeny Nadymov\r\n *\r\n * This source code is licensed under the GPL v.3.0 license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport EventEmitter from '../Stores/EventEmitter';\r\nimport packageJson from '../../package.json';\r\nimport { stringToBoolean, getBrowser, getOSName } from '../Utils/Common';\r\nimport {\r\n    VERBOSITY_JS_MAX,\r\n    VERBOSITY_JS_MIN,\r\n    VERBOSITY_MAX,\r\n    VERBOSITY_MIN,\r\n    WASM_FILE_HASH,\r\n    WASM_FILE_NAME\r\n} from '../Constants';\r\nimport TdClient from 'tdweb/dist/tdweb';\r\n// import TdClient from '@arseny30/tdweb/dist/tdweb';\r\n\r\nfunction databaseExists(dbname, callback) {\r\n    var req = indexedDB.open(dbname);\r\n    var existed = true;\r\n    req.onsuccess = function() {\r\n        req.result.close();\r\n        if (!existed) indexedDB.deleteDatabase(dbname);\r\n        callback(existed);\r\n    };\r\n    req.onupgradeneeded = function() {\r\n        existed = false;\r\n    };\r\n}\r\n\r\nclass TdLibController extends EventEmitter {\r\n    constructor() {\r\n        super();\r\n\r\n        this.parameters = {\r\n            useTestDC: false,\r\n            readOnly: false,\r\n            verbosity: VERBOSITY_MAX,\r\n            jsVerbosity: VERBOSITY_JS_MAX,\r\n            fastUpdating: true,\r\n            useDatabase: false,\r\n            mode: 'wasm'\r\n        };\r\n\r\n        this.disableLog = true;\r\n    }\r\n\r\n    init = location => {\r\n        this.setParameters(location);\r\n\r\n        const { verbosity, jsVerbosity, useTestDC, readOnly, fastUpdating, useDatabase, mode } = this.parameters;\r\n        const dbName = useTestDC ? 'tdlib_test' : 'tdlib';\r\n\r\n        databaseExists(dbName, exists => {\r\n            this.clientUpdate({ '@type': 'clientUpdateTdLibDatabaseExists', exists });\r\n\r\n            let options = {\r\n                logVerbosityLevel: verbosity,\r\n                jsLogVerbosityLevel: jsVerbosity,\r\n                mode: mode, // 'wasm-streaming'/'wasm'/'asmjs'\r\n                prefix: useTestDC ? 'tdlib_test' : 'tdlib',\r\n                readOnly: readOnly,\r\n                isBackground: false,\r\n                useDatabase: useDatabase,\r\n                wasmUrl: `${WASM_FILE_NAME}?_sw-precache=${WASM_FILE_HASH}`\r\n                // onUpdate: update => this.emit('update', update)\r\n            };\r\n\r\n            console.log(\r\n                `[TdLibController] (fast_updating=${fastUpdating}) Start client with params=${JSON.stringify(options)}`\r\n            );\r\n\r\n            this.client = new TdClient(options);\r\n            this.client.onUpdate = update => {\r\n                if (!this.disableLog) {\r\n                    if (update['@type'] === 'updateFile') {\r\n                        console.log('receive updateFile file_id=' + update.file.id, update);\r\n                    } else {\r\n                        console.log('receive update', update);\r\n                    }\r\n                }\r\n                this.emit('update', update);\r\n            };\r\n        });\r\n    };\r\n\r\n    clientUpdate = update => {\r\n        if (!this.disableLog) {\r\n            console.log('clientUpdate', update);\r\n        }\r\n        this.emit('clientUpdate', update);\r\n    };\r\n\r\n    setParameters = location => {\r\n        if (!location) return;\r\n\r\n        const { search } = location;\r\n        if (!search) return;\r\n\r\n        const params = new URLSearchParams(search.toLowerCase());\r\n\r\n        if (params.has('test')) {\r\n            this.parameters.useTestDC = stringToBoolean(params.get('test'));\r\n        }\r\n\r\n        if (params.has('verbosity')) {\r\n            const verbosity = parseInt(params.get('verbosity'), 10);\r\n            if (verbosity >= VERBOSITY_MIN && verbosity <= VERBOSITY_MAX) {\r\n                this.parameters.verbosity = verbosity;\r\n            }\r\n        }\r\n\r\n        if (params.has('jsverbosity')) {\r\n            const jsVerbosity = parseInt(params.get('jsverbosity'), 10);\r\n            if (jsVerbosity >= VERBOSITY_JS_MIN && jsVerbosity <= VERBOSITY_JS_MAX) {\r\n                this.parameters.jsVerbosity = jsVerbosity;\r\n            }\r\n        }\r\n\r\n        if (params.has('tag') && params.has('tagverbosity')) {\r\n            const tag = params\r\n                .get('tag')\r\n                .replace('[', '')\r\n                .replace(']', '')\r\n                .split(',');\r\n            const tagVerbosity = params\r\n                .get('tagverbosity')\r\n                .replace('[', '')\r\n                .replace(']', '')\r\n                .split(',');\r\n            if (tag && tagVerbosity && tag.length === tagVerbosity.length) {\r\n                this.parameters.tag = tag;\r\n                this.parameters.tagVerbosity = tagVerbosity;\r\n            }\r\n        }\r\n\r\n        if (params.has('readonly')) {\r\n            this.parameters.readOnly = stringToBoolean(params.get('readonly'));\r\n        }\r\n\r\n        if (params.has('fastupdating')) {\r\n            this.parameters.fastUpdating = stringToBoolean(params.get('fastupdating'));\r\n        }\r\n\r\n        if (params.has('db')) {\r\n            this.parameters.useDatabase = stringToBoolean(params.get('db'));\r\n        }\r\n        if (params.has('mode')) {\r\n            this.parameters.mode = params.get('mode');\r\n        }\r\n        if (params.has('clientlog')) {\r\n            this.disableLog = !stringToBoolean(params.get('clientlog'));\r\n        }\r\n    };\r\n\r\n    send = request => {\r\n        if (!this.client) {\r\n            console.log('send (none init)', request);\r\n            return;\r\n        }\r\n\r\n        if (!this.disableLog) {\r\n            console.log('send', request);\r\n\r\n            return this.client\r\n                .send(request)\r\n                .then(result => {\r\n                    console.log('send result', result);\r\n                    return result;\r\n                })\r\n                .catch(error => {\r\n                    console.error('send error', error);\r\n\r\n                    throw error;\r\n                });\r\n        } else {\r\n            return this.client.send(request);\r\n        }\r\n    };\r\n\r\n    sendTdParameters = async () => {\r\n        const apiId = process.env.REACT_APP_TELEGRAM_API_ID;\r\n        const apiHash = process.env.REACT_APP_TELEGRAM_API_HASH;\r\n\r\n        // console.log('[td] sendTdParameters', apiHash, apiId);\r\n        if (!apiId || !apiHash) {\r\n            if (\r\n                window.confirm(\r\n                    'API id is missing!\\n' +\r\n                        'In order to obtain an API id and develop your own application ' +\r\n                        'using the Telegram API please visit https://core.telegram.org/api/obtaining_api_id'\r\n                )\r\n            ) {\r\n                window.location.href = 'https://core.telegram.org/api/obtaining_api_id';\r\n            }\r\n        }\r\n\r\n        const { useTestDC } = this.parameters;\r\n        const { version } = packageJson;\r\n\r\n        this.send({\r\n            '@type': 'setTdlibParameters',\r\n            parameters: {\r\n                '@type': 'tdParameters',\r\n                use_test_dc: useTestDC,\r\n                api_id: apiId,\r\n                api_hash: apiHash,\r\n                system_language_code: navigator.language || 'en',\r\n                device_model: getBrowser(),\r\n                system_version: getOSName(),\r\n                application_version: version,\r\n                use_secret_chats: false,\r\n                use_message_database: true,\r\n                use_file_database: false,\r\n                database_directory: '/db',\r\n                files_directory: '/'\r\n            }\r\n            // ,\r\n            // extra: {\r\n            //     a: ['a', 'b'],\r\n            //     b: 123\r\n            // }\r\n        });\r\n\r\n        if (this.parameters.tag && this.parameters.tagVerbosity) {\r\n            for (let i = 0; i < this.parameters.tag.length; i++) {\r\n                let tag = this.parameters.tag[i];\r\n                let tagVerbosity = this.parameters.tagVerbosity[i];\r\n\r\n                this.send({\r\n                    '@type': 'setLogTagVerbosityLevel',\r\n                    tag: tag,\r\n                    new_verbosity_level: tagVerbosity\r\n                });\r\n            }\r\n        }\r\n    };\r\n\r\n    logOut() {\r\n        this.send({ '@type': 'logOut' }).catch(error => {\r\n            this.emit('tdlib_auth_error', error);\r\n        });\r\n    }\r\n\r\n    setChatId = (chatId, messageId = null) => {\r\n        const update = {\r\n            '@type': 'clientUpdateChatId',\r\n            chatId: chatId,\r\n            messageId: messageId\r\n        };\r\n\r\n        this.clientUpdate(update);\r\n    };\r\n\r\n    setMediaViewerContent(content) {\r\n        this.clientUpdate({\r\n            '@type': 'clientUpdateMediaViewerContent',\r\n            content: content\r\n        });\r\n    }\r\n}\r\n\r\nconst controller = new TdLibController();\r\n\r\nexport default controller;\r\n","/*\r\n *  Copyright (c) 2018-present, Evgeny Nadymov\r\n *\r\n * This source code is licensed under the GPL v.3.0 license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nclass EventEmitter {\r\n    constructor() {\r\n        this.observers = {};\r\n    }\r\n\r\n    on(events, listener) {\r\n        events.split(' ').forEach(event => {\r\n            this.observers[event] = this.observers[event] || [];\r\n            this.observers[event].push(listener);\r\n        });\r\n        return this;\r\n    }\r\n\r\n    off(event, listener) {\r\n        if (!this.observers[event]) return;\r\n        if (!listener) {\r\n            delete this.observers[event];\r\n            return;\r\n        }\r\n\r\n        this.observers[event] = this.observers[event].filter(l => l !== listener);\r\n    }\r\n\r\n    emit(event, ...args) {\r\n        if (this.observers[event]) {\r\n            const cloned = [].concat(this.observers[event]);\r\n            cloned.forEach(observer => {\r\n                observer(...args);\r\n            });\r\n        }\r\n\r\n        if (this.observers['*']) {\r\n            const cloned = [].concat(this.observers['*']);\r\n            cloned.forEach(observer => {\r\n                observer.apply(observer, [event, ...args]);\r\n            });\r\n        }\r\n    }\r\n}\r\n\r\nexport default EventEmitter;\r\n","/*\r\n *  Copyright (c) 2018-present, Evgeny Nadymov\r\n *\r\n * This source code is licensed under the GPL v.3.0 license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport { PHOTO_SIZE, PHOTO_THUMBNAIL_SIZE } from '../Constants';\r\n\r\nexport function isMobile() {\r\n    return isAndroid() || isIOS() || isWindowsPhone();\r\n}\r\n\r\nexport function isIOS() {\r\n    const iDevices = ['iPad Simulator', 'iPhone Simulator', 'iPod Simulator', 'iPad', 'iPhone', 'iPod'];\r\n\r\n    if (!!navigator.platform && iDevices.indexOf(navigator.platform) > -1) {\r\n        return true;\r\n    }\r\n\r\n    return /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;\r\n}\r\n\r\nexport function isAndroid() {\r\n    const ua = navigator.userAgent.toLowerCase();\r\n    return ua.indexOf('android') > -1;\r\n}\r\n\r\nexport function isWindowsPhone() {\r\n    if (navigator.userAgent.match(/Windows Phone/i)) {\r\n        return true;\r\n    }\r\n\r\n    if (navigator.userAgent.match(/iemobile/i)) {\r\n        return true;\r\n    }\r\n\r\n    if (navigator.userAgent.match(/WPDesktop/i)) {\r\n        return true;\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\nfunction isAppleDevice() {\r\n    const iDevices = ['iPad Simulator', 'iPhone Simulator', 'iPod Simulator', 'iPad', 'iPhone', 'iPod', 'MacIntel'];\r\n\r\n    if (!!navigator.platform) {\r\n        return iDevices.indexOf(navigator.platform) > -1;\r\n    }\r\n\r\n    return /iPad|iPhone|iPod|Mac\\sOS\\sX/.test(navigator.userAgent) && !window.MSStream;\r\n}\r\n\r\nfunction getOSName() {\r\n    let OSName = 'Unknown';\r\n    if (window.navigator.userAgent.indexOf('Windows NT 10.0') !== -1) OSName = 'Windows 10';\r\n    if (window.navigator.userAgent.indexOf('Windows NT 6.2') !== -1) OSName = 'Windows 8';\r\n    if (window.navigator.userAgent.indexOf('Windows NT 6.1') !== -1) OSName = 'Windows 7';\r\n    if (window.navigator.userAgent.indexOf('Windows NT 6.0') !== -1) OSName = 'Windows Vista';\r\n    if (window.navigator.userAgent.indexOf('Windows NT 5.1') !== -1) OSName = 'Windows XP';\r\n    if (window.navigator.userAgent.indexOf('Windows NT 5.0') !== -1) OSName = 'Windows 2000';\r\n    if (window.navigator.userAgent.indexOf('Mac') !== -1) OSName = 'Mac/iOS';\r\n    if (window.navigator.userAgent.indexOf('X11') !== -1) OSName = 'UNIX';\r\n    if (window.navigator.userAgent.indexOf('Linux') !== -1) OSName = 'Linux';\r\n\r\n    return OSName;\r\n}\r\n\r\nfunction getBrowser() {\r\n    let browser_name = '';\r\n    let isIE = /*@cc_on!@*/ false || !!document.documentMode;\r\n    let isEdge = !isIE && !!window.StyleMedia;\r\n    if (navigator.userAgent.indexOf('Chrome') !== -1 && !isEdge) {\r\n        browser_name = 'Chrome';\r\n    } else if (navigator.userAgent.indexOf('Safari') !== -1 && !isEdge) {\r\n        browser_name = 'Safari';\r\n    } else if (navigator.userAgent.indexOf('Firefox') !== -1) {\r\n        browser_name = 'Firefox';\r\n    } else if (navigator.userAgent.indexOf('MSIE') !== -1 || !!document.documentMode === true) {\r\n        //IF IE > 10\r\n        browser_name = 'IE';\r\n    } else if (isEdge) {\r\n        browser_name = 'Edge';\r\n    } else {\r\n        browser_name = 'Unknown';\r\n    }\r\n\r\n    return browser_name;\r\n}\r\n\r\nfunction stringToBoolean(string) {\r\n    switch (string.toLowerCase().trim()) {\r\n        case 'true':\r\n        case 'yes':\r\n        case '1':\r\n            return true;\r\n        case 'false':\r\n        case 'no':\r\n        case '0':\r\n        case null:\r\n            return false;\r\n        default:\r\n            return Boolean(string);\r\n    }\r\n}\r\n\r\nfunction orderCompare(order1, order2) {\r\n    let diff = order1.length - order2.length;\r\n    if (diff !== 0) return diff < 0 ? -1 : 1;\r\n    if (order1 === order2) return 0;\r\n\r\n    return order1 > order2 ? 1 : -1;\r\n}\r\n\r\nfunction getPhotoThumbnailSize(sizes) {\r\n    return getSize(sizes, PHOTO_THUMBNAIL_SIZE);\r\n}\r\n\r\nfunction getPhotoSize(sizes, displaySize = PHOTO_SIZE) {\r\n    return getSize(sizes, displaySize);\r\n}\r\n\r\nfunction getSize(sizes, dimension) {\r\n    if (!sizes) return null;\r\n    if (sizes.length === 0) return null;\r\n    if (dimension === 0) return null;\r\n\r\n    // let iSize = sizes[2];//.find(x => x.type === 'i');\r\n    // if (iSize){\r\n    //     return iSize;\r\n    // }\r\n\r\n    let useWidth = sizes[0].width >= sizes[0].height;\r\n    let diff = Math.abs(dimension - (useWidth ? sizes[0].width : sizes[0].height));\r\n    let index = 0;\r\n    for (let i = 1; i < sizes.length; i++) {\r\n        if (sizes[i].type === 'i' && !sizes[i].photo.local.is_downloading_completed) {\r\n            continue;\r\n        }\r\n\r\n        let currDiff = Math.abs(dimension - (useWidth ? sizes[i].width : sizes[i].height));\r\n        if (currDiff < diff) {\r\n            index = i;\r\n            currDiff = diff;\r\n        }\r\n    }\r\n\r\n    return sizes[index];\r\n}\r\n\r\nfunction getFitSize(size, max, increaseToMax = true) {\r\n    if (!size) return { width: 0, height: 0 };\r\n\r\n    if (!increaseToMax) {\r\n        if (size.width < max && size.height < max) {\r\n            return size;\r\n        }\r\n    }\r\n\r\n    if (size.width > size.height) {\r\n        return { width: max, height: Math.floor((size.height * max) / size.width) };\r\n    }\r\n\r\n    return { width: Math.floor((size.width * max) / size.height), height: max };\r\n}\r\n\r\nfunction itemsInView(scrollContainerRef, itemsContainerRef) {\r\n    let scrollContainer = scrollContainerRef.current;\r\n    let itemsContainer = itemsContainerRef ? itemsContainerRef.current : scrollContainer;\r\n\r\n    const items = [];\r\n    for (let i = 0; i < itemsContainer.children.length; i++) {\r\n        let child = itemsContainer.children[i];\r\n        if (\r\n            child.offsetTop + child.offsetHeight >= scrollContainer.scrollTop &&\r\n            child.offsetTop <= scrollContainer.scrollTop + scrollContainer.offsetHeight\r\n        ) {\r\n            items.push(i);\r\n        }\r\n    }\r\n\r\n    return items;\r\n}\r\n\r\n// Returns a function, that, when invoked, will only be triggered at most once\r\n// during a given window of time. Normally, the throttled function will run\r\n// as much as it can, without ever going more than once per `wait` duration;\r\n// but if you'd like to disable the execution on the leading edge, pass\r\n// `{leading: false}`. To disable execution on the trailing edge, ditto.\r\nfunction throttle(func, wait, options) {\r\n    var context, args, result;\r\n    var timeout = null;\r\n    var previous = 0;\r\n    if (!options) options = {};\r\n    var later = function() {\r\n        previous = options.leading === false ? 0 : Date.now();\r\n        timeout = null;\r\n        result = func.apply(context, args);\r\n        if (!timeout) context = args = null;\r\n    };\r\n    return function() {\r\n        var now = Date.now();\r\n        if (!previous && options.leading === false) previous = now;\r\n        var remaining = wait - (now - previous);\r\n        context = this;\r\n        args = arguments;\r\n        if (remaining <= 0 || remaining > wait) {\r\n            if (timeout) {\r\n                clearTimeout(timeout);\r\n                timeout = null;\r\n            }\r\n            previous = now;\r\n            result = func.apply(context, args);\r\n            if (!timeout) context = args = null;\r\n        } else if (!timeout && options.trailing !== false) {\r\n            timeout = setTimeout(later, remaining);\r\n        }\r\n        return result;\r\n    };\r\n}\r\n\r\n// Returns a function, that, as long as it continues to be invoked, will not\r\n// be triggered. The function will be called after it stops being called for\r\n// N milliseconds. If `immediate` is passed, trigger the function on the\r\n// leading edge, instead of the trailing.\r\nfunction debounce(func, wait, immediate) {\r\n    var timeout;\r\n    return function() {\r\n        var context = this,\r\n            args = arguments;\r\n        var later = function() {\r\n            timeout = null;\r\n            if (!immediate) {\r\n                func.apply(context, args);\r\n            }\r\n        };\r\n        var callNow = immediate && !timeout;\r\n        clearTimeout(timeout);\r\n        timeout = setTimeout(later, wait);\r\n        if (callNow) {\r\n            func.apply(context, args);\r\n        }\r\n    };\r\n}\r\n\r\nexport function getFirstLetter(str) {\r\n    if (!str) return '';\r\n\r\n    for (let char of str) {\r\n        if (char.toUpperCase() !== char.toLowerCase()) {\r\n            return char;\r\n        } else if (char >= '0' && char <= '9') {\r\n            return char;\r\n        } else if (char.length > 1) {\r\n            return char;\r\n        }\r\n    }\r\n\r\n    return '';\r\n}\r\n\r\nfunction getLetters(title) {\r\n    if (!title) return null;\r\n    if (title.length === 0) return null;\r\n\r\n    const split = title.split(' ');\r\n    if (split.length === 1) {\r\n        return getFirstLetter(split[0]);\r\n    }\r\n    if (split.length > 1) {\r\n        return getFirstLetter(split[0]) + getFirstLetter(split[split.length - 1]);\r\n    }\r\n\r\n    return null;\r\n}\r\n\r\nasync function readImageSize(file) {\r\n    return new Promise((resolve, reject) => {\r\n        let useBlob = false;\r\n        const reader = new FileReader();\r\n\r\n        reader.addEventListener('load', function() {\r\n            try {\r\n                const image = new Image();\r\n                image.addEventListener('load', function() {\r\n                    const { width, height } = image;\r\n                    if (useBlob) {\r\n                        window.URL.revokeObjectURL(image.src);\r\n                    }\r\n\r\n                    console.log('[photo]', width, height);\r\n                    resolve([width, height]);\r\n                });\r\n\r\n                image.src = useBlob ? window.URL.createObjectURL(file) : reader.result;\r\n            } catch {\r\n                reject();\r\n            }\r\n        });\r\n\r\n        reader.readAsDataURL(file);\r\n    });\r\n}\r\n\r\n/**\r\n * use this to make a Base64 encoded string URL friendly,\r\n * i.e. '+' and '/' are replaced with '-' and '_' also any trailing '='\r\n * characters are removed\r\n *\r\n * @param {String} str the encoded string\r\n * @returns {String} the URL friendly encoded String\r\n */\r\nfunction Base64EncodeUrl(str) {\r\n    return str\r\n        .replace(/\\+/g, '-')\r\n        .replace(/\\//g, '_')\r\n        .replace(/\\=+$/, '');\r\n}\r\n\r\n/**\r\n * Use this to recreate a Base64 encoded string that was made URL friendly\r\n * using Base64EncodeurlFriendly.\r\n * '-' and '_' are replaced with '+' and '/' and also it is padded with '+'\r\n *\r\n * @param {String} str the encoded string\r\n * @returns {String} the URL friendly encoded String\r\n */\r\nfunction Base64DecodeUrl(str) {\r\n    str = (str + '===').slice(0, str.length + (str.length % 4));\r\n    return str.replace(/-/g, '+').replace(/_/g, '/');\r\n}\r\n\r\nfunction arrayBufferToBase64(buffer) {\r\n    var binary = '';\r\n    var bytes = new Uint8Array(buffer);\r\n    var len = bytes.byteLength;\r\n    for (var i = 0; i < len; i++) {\r\n        binary += String.fromCharCode(bytes[i]);\r\n    }\r\n    return Base64EncodeUrl(window.btoa(binary));\r\n}\r\n\r\nfunction isAuthorizationReady(state) {\r\n    if (!state) return false;\r\n\r\n    return state['@type'] === 'authorizationStateReady';\r\n}\r\n\r\nfunction between(item, first, last, inclusive = false) {\r\n    return inclusive ? item >= first && item <= last : item > first && item < last;\r\n}\r\n\r\nfunction clamp(item, first, last) {\r\n    if (item < first) return first;\r\n    if (item > last) return last;\r\n\r\n    return item;\r\n}\r\n\r\nfunction getDurationString(secondsTotal) {\r\n    let hours = Math.floor(secondsTotal / 3600);\r\n    let minutes = Math.floor((secondsTotal - hours * 3600) / 60);\r\n    let seconds = secondsTotal - hours * 3600 - minutes * 60;\r\n\r\n    if (hours > 0 && minutes < 10) {\r\n        minutes = '0' + minutes;\r\n    }\r\n    if (seconds < 10) {\r\n        seconds = '0' + seconds;\r\n    }\r\n\r\n    return (hours > 0 ? hours + ':' : '') + minutes + ':' + seconds;\r\n}\r\n\r\nexport function getRandomInt(min, max) {\r\n    min = Math.ceil(min);\r\n    max = Math.floor(max);\r\n    return Math.floor(Math.random() * (max - min)) + min; //The maximum is exclusive and the minimum is inclusive\r\n}\r\n\r\nfunction historyEquals(first, second) {\r\n    if (!first && second) return false;\r\n    if (first && !second) return false;\r\n\r\n    if (!first && !second) return true;\r\n    if (first.length === 0 && second.length === 0) return true;\r\n\r\n    return first === second;\r\n}\r\n\r\nfunction insertByOrder(array, element, comparator) {\r\n    let i = 0;\r\n    for (; i < array.length && comparator(array[i], element) < 0; i++) {}\r\n\r\n    return [...array.slice(0, i), element, ...array.slice(i)];\r\n}\r\n\r\nexport {\r\n    getBrowser,\r\n    getOSName,\r\n    stringToBoolean,\r\n    orderCompare,\r\n    getSize,\r\n    getPhotoThumbnailSize,\r\n    getPhotoSize,\r\n    getFitSize,\r\n    itemsInView,\r\n    throttle,\r\n    debounce,\r\n    getLetters,\r\n    readImageSize,\r\n    arrayBufferToBase64,\r\n    isAuthorizationReady,\r\n    between,\r\n    clamp,\r\n    getDurationString,\r\n    isAppleDevice,\r\n    historyEquals,\r\n    insertByOrder\r\n};\r\n","/*\r\n *  Copyright (c) 2018-present, Evgeny Nadymov\r\n *\r\n * This source code is licensed under the GPL v.3.0 license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport React from 'react';\r\nimport blue from '@material-ui/core/colors/blue';\r\nimport createMuiTheme from '@material-ui/core/styles/createMuiTheme';\r\nimport { ThemeProvider as MuiThemeProvider } from '@material-ui/core/styles';\r\nimport { StylesProvider } from '@material-ui/core/styles';\r\nimport { getDisplayName } from './Utils/HOC';\r\nimport ApplicationStore from './Stores/ApplicationStore';\r\n\r\nfunction updateLightTheme(theme) {\r\n    // const root = document.querySelector(':root');\r\n    // const style = getComputedStyle(root);\r\n    const { style } = document.documentElement;\r\n\r\n    style.setProperty('--text-primary', '#000000');\r\n    style.setProperty('--text-secondary', '#707579');\r\n    style.setProperty('--text-disabled', 'rgba(0, 0, 0, 0.38)');\r\n\r\n    style.setProperty('--error', '#E53935');\r\n\r\n    style.setProperty('--tile-size', '54px');\r\n    style.setProperty('--tile-size-normal', '48px');\r\n    style.setProperty('--tile-size-extra-small', '16px');\r\n    style.setProperty('--tile-size-small', '33px');\r\n    style.setProperty('--tile-size-big', '120px');\r\n\r\n    style.setProperty('--z-index-modal', theme.zIndex.modal);\r\n\r\n    style.setProperty('--color-accent-main', theme.palette.primary.main);\r\n    style.setProperty('--color-accent-main22', theme.palette.primary.main + '44');\r\n    style.setProperty('--color-accent-dark', theme.palette.primary.dark);\r\n    style.setProperty('--color-accent-light', theme.palette.primary.light);\r\n    style.setProperty('--color-grey700', theme.palette.grey[700]);\r\n    style.setProperty('--color-grey', '#9AA7B2');\r\n    style.setProperty('--color-hover', '#70757914');\r\n\r\n    style.setProperty('--search-input-background', '#f4f4f5');\r\n    style.setProperty('--search-input-icon', '#9aa7b2');\r\n\r\n    style.setProperty('--header-color', '#000000');\r\n    style.setProperty('--header-subtle-color', '#707579');\r\n\r\n    style.setProperty('--badge-unmuted', '#4DCD5E');\r\n    style.setProperty('--badge-muted', '#C4C9CC');\r\n\r\n    style.setProperty('--online-indicator', '#0AC630');\r\n\r\n    style.setProperty('--message-service-color', '#FFFFFF');\r\n    style.setProperty('--message-service-background', '#00000033');\r\n\r\n    style.setProperty('--panel-background', '#ffffff');\r\n    style.setProperty('--border', '#DADCE0');\r\n    style.setProperty('--chat-background', '#e6ebee');\r\n    style.setProperty('--background', '#ffffff');\r\n    style.setProperty('--background-paper', theme.palette.background.paper);\r\n    style.setProperty('--shared-media-background', theme.palette.background.default);\r\n\r\n    style.setProperty('--dialog-color', '#000000');\r\n    style.setProperty('--dialog-subtle-color', '#707579');\r\n    style.setProperty('--dialog-meta-color', '#5F6369');\r\n    style.setProperty('--dialog-meta-read-color', '#4FAE4E');\r\n\r\n    style.setProperty('--media-in-tile-background', theme.palette.primary.main);\r\n    style.setProperty('--media-out-tile-background', '#4FAE4E');\r\n\r\n    style.setProperty('--message-in-link', theme.palette.primary.main);\r\n    style.setProperty('--message-in-author', theme.palette.primary.main);\r\n    style.setProperty('--message-in-background', '#FFFFFF');\r\n    style.setProperty('--message-in-color', '#000000');\r\n    style.setProperty('--message-in-subtle-color', '#707579');\r\n    style.setProperty('--message-in-meta-color', '#8D969C');\r\n    style.setProperty('--message-in-reply-title', theme.palette.primary.main);\r\n    style.setProperty('--message-in-reply-border', theme.palette.primary.main);\r\n    style.setProperty('--message-in-control', theme.palette.primary.main);\r\n    style.setProperty('--message-in-control-hover', theme.palette.primary.main + '22');\r\n    style.setProperty('--message-in-control-border', theme.palette.primary.main + '77');\r\n    style.setProperty('--message-in-control-border-hover', theme.palette.primary.main);\r\n\r\n    style.setProperty('--message-out-link', '#4FAE4E');\r\n    style.setProperty('--message-out-author', '#4FAE4E');\r\n    style.setProperty('--message-out-background', '#EEFFDE');\r\n    style.setProperty('--message-out-color', '#000000');\r\n    style.setProperty('--message-out-subtle-color', '#4FAE4E');\r\n    style.setProperty('--message-out-meta-color', '#4FAE4E');\r\n    style.setProperty('--message-out-reply-title', '#4FAE4E');\r\n    style.setProperty('--message-out-reply-border', '#4FAE4E');\r\n    style.setProperty('--message-out-control', '#4FAE4E');\r\n    style.setProperty('--message-out-control-hover', '#4FAE4E' + '22');\r\n    style.setProperty('--message-out-control-border', '#4FAE4E' + '77');\r\n    style.setProperty('--message-out-control-border-hover', '#4FAE4E');\r\n}\r\n\r\nfunction updateDarkTheme(theme) {\r\n    // const root = document.querySelector(':root');\r\n    // const style = getComputedStyle(root);\r\n    const { style } = document.documentElement;\r\n\r\n    style.setProperty('--text-primary', theme.palette.text.primary);\r\n    style.setProperty('--text-secondary', theme.palette.text.secondary);\r\n    style.setProperty('--text-disabled', theme.palette.text.disabled);\r\n\r\n    style.setProperty('--error', '#E53935');\r\n\r\n    style.setProperty('--tile-size', '54px');\r\n    style.setProperty('--tile-size-normal', '48px');\r\n    style.setProperty('--tile-size-extra-small', '16px');\r\n    style.setProperty('--tile-size-small', '33px');\r\n    style.setProperty('--tile-size-big', '120px');\r\n\r\n    style.setProperty('--z-index-modal', theme.zIndex.modal);\r\n\r\n    style.setProperty('--color-accent-main', theme.palette.primary.main);\r\n    style.setProperty('--color-accent-main22', theme.palette.primary.main + '44');\r\n    style.setProperty('--color-accent-dark', theme.palette.primary.dark);\r\n    style.setProperty('--color-accent-light', theme.palette.primary.light);\r\n    style.setProperty('--color-grey700', theme.palette.grey[700]);\r\n    style.setProperty('--color-grey', '#9AA7B2');\r\n    style.setProperty('--color-hover', 'rgba(112, 117, 121, 0.15)');\r\n\r\n    style.setProperty('--search-input-background', '#424242');\r\n    style.setProperty('--search-input-icon', '#fff');\r\n\r\n    style.setProperty('--header-color', '#ffffff');\r\n    style.setProperty('--header-subtle-color', theme.palette.text.secondary);\r\n\r\n    style.setProperty('--badge-unmuted', '#4DCD5E');\r\n    style.setProperty('--badge-muted', 'rgba(255, 255, 255, 0.5)');\r\n\r\n    style.setProperty('--online-indicator', '#0AC630');\r\n\r\n    style.setProperty('--message-service-color', '#FFFFFF');\r\n    style.setProperty('--message-service-background', '#303030');\r\n\r\n    style.setProperty('--panel-background', '#303030');\r\n    style.setProperty('--border', theme.palette.divider);\r\n    style.setProperty('--chat-background', theme.palette.grey[900]);\r\n    style.setProperty('--background', theme.palette.grey[900]);\r\n    style.setProperty('--background-paper', theme.palette.background.paper);\r\n    style.setProperty('--shared-media-background', theme.palette.background.paper);\r\n\r\n    style.setProperty('--dialog-color', '#ffffff');\r\n    style.setProperty('--dialog-subtle-color', theme.palette.text.secondary);\r\n    style.setProperty('--dialog-meta-color', theme.palette.text.secondary);\r\n    style.setProperty('--dialog-meta-read-color', '#4FAE4E');\r\n\r\n    style.setProperty('--media-in-tile-background', theme.palette.primary.main);\r\n    style.setProperty('--media-out-tile-background', theme.palette.primary.main);\r\n\r\n    style.setProperty('--message-in-link', theme.palette.primary.main);\r\n    style.setProperty('--message-in-author', theme.palette.primary.main);\r\n    style.setProperty('--message-in-background', '#303030'); // background.default\r\n    style.setProperty('--message-in-color', '#FFFFFF');\r\n    style.setProperty('--message-in-subtle-color', 'rgba(255, 255, 255, 0.7)');\r\n    style.setProperty('--message-in-meta-color', 'rgba(255, 255, 255, 0.7)');\r\n    style.setProperty('--message-in-reply-title', theme.palette.primary.main);\r\n    style.setProperty('--message-in-reply-border', theme.palette.primary.main);\r\n    style.setProperty('--message-in-control', theme.palette.primary.main);\r\n    style.setProperty('--message-in-control-hover', theme.palette.primary.main + '22');\r\n    style.setProperty('--message-in-control-border', theme.palette.primary.main + '77');\r\n    style.setProperty('--message-in-control-border-hover', theme.palette.primary.main);\r\n\r\n    style.setProperty('--message-out-link', theme.palette.primary.main);\r\n    style.setProperty('--message-out-author', theme.palette.primary.main);\r\n    style.setProperty('--message-out-background', '#303030'); // background.default\r\n    style.setProperty('--message-out-color', '#FFFFFF');\r\n    style.setProperty('--message-out-subtle-color', 'rgba(255, 255, 255, 0.7)');\r\n    style.setProperty('--message-out-meta-color', 'rgba(255, 255, 255, 0.7)'); // text.secondary\r\n    style.setProperty('--message-out-reply-title', theme.palette.primary.main);\r\n    style.setProperty('--message-out-reply-border', theme.palette.primary.main);\r\n    style.setProperty('--message-out-control', theme.palette.primary.main);\r\n    style.setProperty('--message-out-control-hover', theme.palette.primary.main + '22');\r\n    style.setProperty('--message-out-control-border', theme.palette.primary.main + '77');\r\n    style.setProperty('--message-out-control-border-hover', theme.palette.primary.main);\r\n}\r\n\r\nfunction createTheme(type, primary) {\r\n    let MuiTouchRipple = {};\r\n    let action = {};\r\n    if (type === 'light') {\r\n        MuiTouchRipple = {\r\n            child: {\r\n                color: type === 'dark' ? 'currentColor' : 'rgba(112, 117, 121)'\r\n            },\r\n            rippleVisible: {\r\n                opacity: 0.08 //type === 'dark' ? 0.15 : 1\r\n            },\r\n            '@keyframes enter': {\r\n                '0%': {\r\n                    transform: 'scale(0)',\r\n                    opacity: 0.03\r\n                },\r\n                '100%': {\r\n                    transform: 'scale(1)',\r\n                    opacity: 0.08 //type === 'dark' ? 0.15 : 1\r\n                }\r\n            }\r\n        };\r\n        action = {\r\n            hover: 'rgba(112, 117, 121, 0.08)',\r\n            hoverOpacity: 0.08\r\n        };\r\n    }\r\n\r\n    const theme = createMuiTheme({\r\n        palette: {\r\n            type: type,\r\n            primary: primary,\r\n            secondary: { main: '#E53935' },\r\n            action\r\n        },\r\n        typography: {\r\n            useNextVariants: true\r\n        },\r\n        shape: {\r\n            borderRadius: 8\r\n        },\r\n        overrides: {\r\n            MuiOutlinedInput: {\r\n                input: {\r\n                    padding: '17.5px 14px'\r\n                }\r\n            },\r\n            MuiAutocomplete: {\r\n                option: {\r\n                    paddingLeft: 0,\r\n                    paddingTop: 0,\r\n                    paddingRight: 0,\r\n                    paddingBottom: 0\r\n                },\r\n                paper: {\r\n                    '& > ul': {\r\n                        maxHeight: 56 * 5.5\r\n                    }\r\n                }\r\n            },\r\n            MuiMenuList: {\r\n                root: {\r\n                    minWidth: 150\r\n                }\r\n            },\r\n            MuiList: {\r\n                root: {\r\n                    minWidth: 150\r\n                }\r\n            },\r\n            MuiTouchRipple\r\n        }\r\n    });\r\n\r\n    if (type === 'dark') {\r\n        updateDarkTheme(theme);\r\n    } else {\r\n        updateLightTheme(theme);\r\n    }\r\n\r\n    return theme;\r\n}\r\n\r\nfunction withTheme(WrappedComponent) {\r\n    class ThemeWrapper extends React.Component {\r\n        constructor(props) {\r\n            super(props);\r\n\r\n            let { type, primary } = { type: 'light', primary: { main: '#50A2E9' } };\r\n            try {\r\n                const themeOptions = JSON.parse(localStorage.getItem('themeOptions'));\r\n                if (themeOptions) {\r\n                    type = themeOptions.type;\r\n                    primary = themeOptions.primary;\r\n                }\r\n            } catch {}\r\n            const theme = createTheme(type, primary);\r\n\r\n            this.state = { theme };\r\n        }\r\n\r\n        componentDidMount() {\r\n            ApplicationStore.on('clientUpdateThemeChanging', this.onClientUpdateThemeChanging);\r\n        }\r\n\r\n        componentWillUnmount() {\r\n            ApplicationStore.off('clientUpdateThemeChanging', this.onClientUpdateThemeChanging);\r\n        }\r\n\r\n        onClientUpdateThemeChanging = update => {\r\n            const { type, primary } = update;\r\n\r\n            const theme = createTheme(type, primary);\r\n            localStorage.setItem('themeOptions', JSON.stringify({ type, primary }));\r\n\r\n            this.setState({ theme }, () => ApplicationStore.emit('clientUpdateThemeChange'));\r\n        };\r\n\r\n        render() {\r\n            const { theme } = this.state;\r\n\r\n            return (\r\n                <StylesProvider injectFirst={true}>\r\n                    <MuiThemeProvider theme={theme}>\r\n                        <WrappedComponent {...this.props} />\r\n                    </MuiThemeProvider>\r\n                </StylesProvider>\r\n            );\r\n        }\r\n    }\r\n    ThemeWrapper.displayName = `WithTheme(${getDisplayName(WrappedComponent)})`;\r\n\r\n    return ThemeWrapper;\r\n}\r\n\r\nexport default withTheme;\r\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"g\", {\n  id: \"Login\",\n  stroke: \"none\",\n  strokeWidth: 1,\n  fillRule: \"evenodd\"\n}, React.createElement(\"g\", {\n  id: \"Login_5_Phone\",\n  transform: \"translate(-760.000000, -186.000000)\"\n}, React.createElement(\"path\", {\n  d: \"M840,346 C795.81722,346 760,310.18278 760,266 C760,221.81722 795.81722,186 840,186 C884.18278,186 920,221.81722 920,266 C920,310.18278 884.18278,346 840,346 Z M794.596303,264.66919 C790.659174,266.234556 788.596733,267.765936 788.408978,269.263329 C788.048509,272.138166 792.188142,273.033142 797.396667,274.725906 C801.643184,276.106018 807.355495,277.720609 810.325092,277.784753 C813.018799,277.842938 816.025284,276.732617 819.344546,274.453789 C841.998088,259.16492 853.691946,251.437186 854.426119,251.270588 C854.944065,251.153055 855.661811,251.005273 856.148118,251.437434 C856.634425,251.869594 856.586618,252.688022 856.535106,252.907586 C856.123224,254.663156 834.84286,274.015606 833.61816,275.287388 C828.938462,280.146996 823.615302,283.120543 831.826781,288.530755 C838.932147,293.212193 843.067503,296.19863 850.387542,300.996094 C855.065474,304.061953 858.733031,307.697601 863.562866,307.253237 C865.785287,307.048765 868.080902,304.959403 869.246762,298.727987 C872.002037,284.001293 877.417883,252.09303 878.669527,238.944397 C878.779187,237.792407 878.641237,236.318088 878.530455,235.670896 C878.419672,235.023705 878.188168,234.101592 877.346762,233.418979 C876.350285,232.610561 874.811937,232.440083 874.123923,232.4522 C870.995743,232.507295 866.196346,234.175802 843.099163,243.78089 C835.009657,247.144954 818.842037,254.107721 794.596303,264.66919 Z\"\n})));\n\nvar SvgTelegramLogo = function SvgTelegramLogo(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, [\"svgRef\", \"title\"]);\n\n  return React.createElement(\"svg\", _extends({\n    className: \"telegram-logo\",\n    width: \"160px\",\n    height: \"160px\",\n    viewBox: \"0 0 160 160\",\n    ref: svgRef\n  }, props), React.createElement(\"title\", null, title), _ref2);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgTelegramLogo, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/telegram-logo.8e3f975b.svg\";\nexport { ForwardRef as ReactComponent };","/*\r\n *  Copyright (c) 2018-present, Evgeny Nadymov\r\n *\r\n * This source code is licensed under the GPL v.3.0 license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport EventEmitter from './EventEmitter';\r\nimport { KEY_AUTH_STATE } from '../Constants';\r\nimport TdLibController from '../Controllers/TdLibController';\r\n\r\nclass AuthorizationStore extends EventEmitter {\r\n    constructor() {\r\n        super();\r\n\r\n        this.reset();\r\n        this.load();\r\n\r\n        this.addTdLibListener();\r\n    }\r\n\r\n    load() {\r\n        try {\r\n            const value = localStorage.getItem(KEY_AUTH_STATE);\r\n            if (value) {\r\n                this.current = JSON.parse(value);\r\n            } else {\r\n                this.current = null;\r\n            }\r\n        } catch {}\r\n    }\r\n\r\n    save(state) {\r\n        if (state) {\r\n            localStorage.setItem(KEY_AUTH_STATE, JSON.stringify(state));\r\n        } else {\r\n            localStorage.removeItem(KEY_AUTH_STATE);\r\n        }\r\n    }\r\n\r\n    reset = () => {\r\n        this.current = null;\r\n    };\r\n\r\n    onUpdate = update => {\r\n        switch (update['@type']) {\r\n            case 'updateAuthorizationState': {\r\n                const { authorization_state } = update;\r\n\r\n                this.current = authorization_state;\r\n                this.save(authorization_state);\r\n\r\n                this.emit(update['@type'], update);\r\n                break;\r\n            }\r\n            default:\r\n                break;\r\n        }\r\n    };\r\n\r\n    onClientUpdate = update => {\r\n        switch (update['@type']) {\r\n            case 'clientUpdateMonkeyIdle': {\r\n                this.emit(update['@type'], update);\r\n                break;\r\n            }\r\n            case 'clientUpdateMonkeyTracking': {\r\n                this.emit(update['@type'], update);\r\n                break;\r\n            }\r\n            case 'clientUpdateMonkeyClose': {\r\n                this.emit(update['@type'], update);\r\n                break;\r\n            }\r\n            case 'clientUpdateMonkeyPeek': {\r\n                this.emit(update['@type'], update);\r\n                break;\r\n            }\r\n            default:\r\n                break;\r\n        }\r\n    };\r\n\r\n    addTdLibListener = () => {\r\n        TdLibController.on('update', this.onUpdate);\r\n        TdLibController.on('clientUpdate', this.onClientUpdate);\r\n    };\r\n\r\n    removeTdLibListener = () => {\r\n        TdLibController.off('update', this.onUpdate);\r\n        TdLibController.off('clientUpdate', this.onClientUpdate);\r\n    };\r\n}\r\n\r\nconst store = new AuthorizationStore();\r\nwindow.authorization = store;\r\nexport default store;\r\n","/*\r\n *  Copyright (c) 2018-present, Evgeny Nadymov\r\n *\r\n * This source code is licensed under the GPL v.3.0 license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport React from 'react';\r\nimport { ReactComponent as Logo } from '../../Assets/telegram-logo.svg';\r\n// import Lottie from '../Viewer/Lottie';\r\nimport AuthStore from '../../Stores/AuthorizationStore';\r\nimport './Caption.css';\r\n\r\nconst Lottie = React.lazy(() => import('../Viewer/Lottie'));\r\n\r\nclass Caption extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            data: null,\r\n            lastUpdate: null\r\n        };\r\n\r\n        this.lottieRef = React.createRef();\r\n    }\r\n\r\n    loadData = async () => {\r\n        const { closeData } = this.state;\r\n        if (closeData) return;\r\n\r\n        try {\r\n            const requests = [\r\n                fetch('data/TwoFactorSetupMonkeyClose.json'),\r\n                fetch('data/TwoFactorSetupMonkeyIdle.json'),\r\n                fetch('data/TwoFactorSetupMonkeyPeek.json'),\r\n                fetch('data/TwoFactorSetupMonkeyTracking.json')\r\n            ];\r\n\r\n            const results = await Promise.all(requests);\r\n\r\n            const [closeData, idleData, peekData, trackingData] = await Promise.all(results.map(x => x.json()));\r\n\r\n            this.setState(\r\n                {\r\n                    closeData,\r\n                    idleData,\r\n                    peekData,\r\n                    trackingData\r\n                },\r\n                () => {\r\n                    const { lastUpdate } = this.state;\r\n                    if (lastUpdate) {\r\n                        switch (lastUpdate['@type']) {\r\n                            case 'clientUpdateMonkeyIdle': {\r\n                                this.onClientUpdateMonkeyIdle(lastUpdate);\r\n                                break;\r\n                            }\r\n                            case 'clientUpdateMonkeyTracking': {\r\n                                this.onClientUpdateMonkeyTracking(lastUpdate);\r\n                                break;\r\n                            }\r\n                            case 'clientUpdateMonkeyClose': {\r\n                                this.onClientUpdateMonkeyClose(lastUpdate);\r\n                                break;\r\n                            }\r\n                            case 'clientUpdateMonkeyPeek': {\r\n                                this.onClientUpdateMonkeyPeek(lastUpdate);\r\n                                break;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            );\r\n        } catch (error) {\r\n            console.error(error);\r\n        }\r\n    };\r\n\r\n    async componentDidMount() {\r\n        setTimeout(this.loadData, 100);\r\n\r\n        AuthStore.on('clientUpdateMonkeyIdle', this.onClientUpdateMonkeyIdle);\r\n        AuthStore.on('clientUpdateMonkeyTracking', this.onClientUpdateMonkeyTracking);\r\n        AuthStore.on('clientUpdateMonkeyClose', this.onClientUpdateMonkeyClose);\r\n        AuthStore.on('clientUpdateMonkeyPeek', this.onClientUpdateMonkeyPeek);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        AuthStore.off('clientUpdateMonkeyIdle', this.onClientUpdateMonkeyIdle);\r\n        AuthStore.off('clientUpdateMonkeyTracking', this.onClientUpdateMonkeyTracking);\r\n        AuthStore.off('clientUpdateMonkeyClose', this.onClientUpdateMonkeyClose);\r\n        AuthStore.off('clientUpdateMonkeyPeek', this.onClientUpdateMonkeyPeek);\r\n    }\r\n\r\n    onClientUpdateMonkeyIdle = update => {\r\n        const { idleData } = this.state;\r\n\r\n        this.setState(\r\n            {\r\n                data: idleData,\r\n                lastUpdate: update\r\n            },\r\n            () => {\r\n                const { current } = this.lottieRef;\r\n                if (!current) return;\r\n\r\n                current.anim.playSegments([0, 180], true);\r\n            }\r\n        );\r\n    };\r\n\r\n    onClientUpdateMonkeyTracking = update => {\r\n        const { code, prevCode } = update;\r\n        const { trackingData } = this.state;\r\n\r\n        const from = Math.min(15 * prevCode.length, 180);\r\n        const to = Math.min(15 * code.length, 180);\r\n\r\n        this.setState(\r\n            {\r\n                data: trackingData,\r\n                lastUpdate: update\r\n            },\r\n            () => {\r\n                const { current } = this.lottieRef;\r\n                if (!current) return;\r\n\r\n                current.anim.playSegments([from, to], true);\r\n            }\r\n        );\r\n    };\r\n\r\n    onClientUpdateMonkeyClose = update => {\r\n        const { closeData } = this.state;\r\n\r\n        this.setState(\r\n            {\r\n                data: closeData,\r\n                lastUpdate: update\r\n            },\r\n            () => {\r\n                const { current } = this.lottieRef;\r\n                if (!current) return;\r\n\r\n                current.anim.playSegments([0, 49], true);\r\n            }\r\n        );\r\n    };\r\n\r\n    onClientUpdateMonkeyPeek = update => {\r\n        const { peek } = update;\r\n        const { peekData, lastUpdate } = this.state;\r\n\r\n        if (lastUpdate && lastUpdate['@type'] === 'clientUpdateMonkeyPeek' && lastUpdate.peek === peek) {\r\n            return;\r\n        }\r\n\r\n        this.setState(\r\n            {\r\n                data: peekData,\r\n                lastUpdate: update\r\n            },\r\n            () => {\r\n                const { current } = this.lottieRef;\r\n                if (!current) return;\r\n\r\n                if (peek) {\r\n                    current.anim.playSegments([0, 15], true);\r\n                } else {\r\n                    current.anim.playSegments([15, 33], true);\r\n                }\r\n            }\r\n        );\r\n    };\r\n\r\n    render() {\r\n        const { state } = this.props;\r\n        const { data } = this.state;\r\n\r\n        let control = null;\r\n        switch (state['@type']) {\r\n            case 'authorizationStateWaitPhoneNumber':\r\n            case 'authorizationStateWaitEncryptionKey':\r\n            case 'authorizationStateWaitTdlibParameters':\r\n            case 'authorizationStateWaitTdlib': {\r\n                control = <Logo className='auth-caption-telegram-logo' />;\r\n                break;\r\n            }\r\n            case 'authorizationStateWaitCode':\r\n            case 'authorizationStateWaitPassword': {\r\n                control = (\r\n                    <div className='auth-caption-telegram-logo'>\r\n                        <React.Suspense fallback={null}>\r\n                            <Lottie\r\n                                ref={this.lottieRef}\r\n                                options={{\r\n                                    autoplay: false,\r\n                                    loop: false,\r\n                                    animationData: data,\r\n                                    renderer: 'svg',\r\n                                    rendererSettings: {\r\n                                        preserveAspectRatio: 'xMinYMin slice', // Supports the same options as the svg element's preserveAspectRatio property\r\n                                        clearCanvas: false,\r\n                                        progressiveLoad: true, // Boolean, only svg renderer, loads dom elements when needed. Might speed up initialization for large number of elements.\r\n                                        hideOnTransparent: true, //Boolean, only svg renderer, hides elements when opacity reaches 0 (defaults to true)\r\n                                        className: 'auth-caption-lottie'\r\n                                    }\r\n                                }}\r\n                            />\r\n                        </React.Suspense>\r\n                    </div>\r\n                );\r\n                break;\r\n            }\r\n            default:\r\n                break;\r\n        }\r\n\r\n        return <div className='auth-caption'>{control}</div>;\r\n    }\r\n}\r\n\r\nexport default Caption;\r\n","/*\r\n *  Copyright (c) 2018-present, Evgeny Nadymov\r\n *\r\n * This source code is licensed under the GPL v.3.0 license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport './Country.css';\r\n\r\nfunction Country({ emoji, name, phone }) {\r\n    return (\r\n        <div className='country'>\r\n            <span className='country-emoji'>{emoji}</span>\r\n            <span className='country-name'>{name}</span>\r\n            <span className='country-phone'>{phone}</span>\r\n        </div>\r\n    );\r\n}\r\n\r\nCountry.propTypes = {\r\n    emoji: PropTypes.string,\r\n    name: PropTypes.string,\r\n    phone: PropTypes.string\r\n};\r\n\r\nexport default Country;\r\n","/*\r\n *  Copyright (c) 2018-present, Evgeny Nadymov\r\n *\r\n * This source code is licensed under the GPL v.3.0 license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { withTranslation } from 'react-i18next';\r\nimport Autocomplete from '@material-ui/lab/Autocomplete';\r\nimport Button from '@material-ui/core/Button';\r\nimport Checkbox from '@material-ui/core/Checkbox';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Link from '@material-ui/core/Link';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Country from './Country';\r\nimport HeaderProgress from '../ColumnMiddle/HeaderProgress';\r\nimport { KEY_SUGGESTED_LANGUAGE_PACK_ID } from '../../Constants';\r\nimport AppStore from '../../Stores/ApplicationStore';\r\nimport AuthStore from '../../Stores/AuthorizationStore';\r\nimport OptionStore from '../../Stores/OptionStore';\r\nimport LocalizationStore from '../../Stores/LocalizationStore';\r\nimport TdLibController from '../../Controllers/TdLibController';\r\nimport './Phone.css';\r\n\r\nexport function cleanProgressStatus(status) {\r\n    if (!status) return status;\r\n\r\n    return status.replace('...', '').replace('', '');\r\n}\r\n\r\nexport function isConnecting(state) {\r\n    if (!state) return false;\r\n\r\n    switch (state['@type']) {\r\n        case 'connectionStateConnecting': {\r\n            return true;\r\n        }\r\n        case 'connectionStateConnectingToProxy': {\r\n            return true;\r\n        }\r\n        case 'connectionStateReady': {\r\n            return false;\r\n        }\r\n        case 'connectionStateUpdating': {\r\n            return false;\r\n        }\r\n        case 'connectionStateWaitingForNetwork': {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\nfunction isValidPhoneNumber(phoneNumber) {\r\n    if (!phoneNumber) return false;\r\n\r\n    let isBad = !phoneNumber.match(/^[\\d\\-+\\s]+$/);\r\n    if (!isBad) {\r\n        phoneNumber = phoneNumber.replace(/\\D/g, '');\r\n        if (phoneNumber.length < 7) {\r\n            isBad = true;\r\n        }\r\n    }\r\n\r\n    return !isBad;\r\n}\r\n\r\nfunction formatByPattern(phone, pattern) {\r\n    phone = clearPhone(phone);\r\n\r\n    let result = '';\r\n    let index = 0;\r\n    for (let i = 0; i < pattern.length && index < phone.length; i++) {\r\n        if (pattern[i] >= '0' && pattern[i] <= '9') {\r\n            result += pattern[i];\r\n            if (phone[index] === pattern[i]) {\r\n                index++;\r\n            }\r\n        } else if (pattern[i] === ' ') {\r\n            result += pattern[i];\r\n        } else if (pattern[i] === 'X') {\r\n            result += phone[index++];\r\n        }\r\n    }\r\n\r\n    result += ' ' + phone.substring(index);\r\n\r\n    return '+' + result;\r\n}\r\n\r\nexport function formatPhoneNumber(phone) {\r\n    const { data } = AuthStore;\r\n    if (!data) return phone;\r\n\r\n    const country = getCountryFromPhone(phone, data);\r\n    if (!country) return phone;\r\n\r\n    return formatByPattern(phone, country.pattern);\r\n}\r\n\r\nfunction phoneEquals(phone1, phone2) {\r\n    return clearPhone(phone1) === clearPhone(phone2);\r\n}\r\n\r\nfunction isWhitelistKey(key) {\r\n    if (key >= '0' && key <= '9') return true;\r\n    if (key === ' ') return true;\r\n    if (key === '+') return true;\r\n\r\n    return false;\r\n}\r\n\r\nfunction clearPhone(phone) {\r\n    if (!phone) return phone;\r\n\r\n    return phone\r\n        .replace(/ /g, '')\r\n        .replace('+', '')\r\n        .toLowerCase();\r\n}\r\n\r\nfunction isPhoneWithOptionCode(phone, option) {\r\n    if (!phone) return false;\r\n    if (!option) return false;\r\n\r\n    phone = clearPhone(phone);\r\n    const code = clearPhone(option.phone);\r\n\r\n    return phone.startsWith(code);\r\n}\r\n\r\nfunction isValidOption(x, value) {\r\n    if (!x) return false;\r\n    if (!value) return true;\r\n\r\n    if (value.length > 0 && value[0] === '(') {\r\n        value = value.substring(1);\r\n    }\r\n\r\n    const names = x.name.toLowerCase().split(' ');\r\n    for (let i = 0; i < names.length; i++) {\r\n        if (names[i].length > 0 && names[i][0] === '(') {\r\n            names[i] = names[i].substring(1);\r\n        }\r\n    }\r\n    const phone = clearPhone(x.phone);\r\n\r\n    if (names.some(x => x.startsWith(value))) return true;\r\n    if (phone.startsWith(value) || value.startsWith(phone)) return true;\r\n\r\n    return false;\r\n}\r\n\r\nfunction getCountryFromPhone(phone, data) {\r\n    if (!data) return null;\r\n\r\n    const index = data.findIndex(x => isPhoneWithOptionCode(phone, x));\r\n\r\n    return index !== -1 ? data[index] : null;\r\n}\r\n\r\nfunction getCountryFromCode(code, data) {\r\n    if (!code) return null;\r\n    if (!data) return null;\r\n\r\n    const index = data.findIndex(x => x.code.toLowerCase() === code.toLowerCase());\r\n\r\n    return index !== -1 ? data[index] : null;\r\n}\r\n\r\nclass Phone extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        const { defaultPhone, data } = props;\r\n\r\n        const phone = defaultPhone || '';\r\n        const country = getCountryFromPhone(phone, data);\r\n        const countryCode = null;\r\n\r\n        this.state = {\r\n            connecting: isConnecting(AppStore.connectionState),\r\n            error: null,\r\n            loading: false,\r\n            suggestedLanguage: localStorage.getItem(KEY_SUGGESTED_LANGUAGE_PACK_ID),\r\n            keep: true,\r\n\r\n            phone,\r\n            country,\r\n            countryCode\r\n        };\r\n\r\n        this.phoneInputRef = React.createRef();\r\n    }\r\n\r\n    async setCountryCode() {\r\n        const { countryCode } = this.state;\r\n        if (countryCode) return;\r\n\r\n        const code = await TdLibController.send({ '@type': 'getCountryCode' });\r\n        if (!code) return;\r\n\r\n        const { data } = this.props;\r\n        let { country, phone } = this.state;\r\n        if (!country && !phone && data) {\r\n            country = getCountryFromCode(code.text, data);\r\n            if (country) {\r\n                phone = '+' + clearPhone(country.phone) + ' ';\r\n            }\r\n        }\r\n\r\n        this.setState({ phone, country, countryCode });\r\n    }\r\n\r\n    shouldComponentUpdate(nextProps, nextState, nextContext) {\r\n        return true;\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.setSuggestedLanguagePackId();\r\n\r\n        AppStore.on('clientUpdateSetPhoneCanceled', this.onClientUpdateSetPhoneCanceled);\r\n        AppStore.on('clientUpdateSetPhoneError', this.onClientUpdateSetPhoneError);\r\n        AppStore.on('clientUpdateSetPhoneResult', this.onClientUpdateSetPhoneResult);\r\n        AppStore.on('updateConnectionState', this.onUpdateConnectionState);\r\n        OptionStore.on('updateOption', this.onUpdateOption);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        AppStore.off('clientUpdateSetPhoneCanceled', this.onClientUpdateSetPhoneCanceled);\r\n        AppStore.off('clientUpdateSetPhoneError', this.onClientUpdateSetPhoneError);\r\n        AppStore.off('clientUpdateSetPhoneResult', this.onClientUpdateSetPhoneResult);\r\n        AppStore.off('updateConnectionState', this.onUpdateConnectionState);\r\n        OptionStore.off('updateOption', this.onUpdateOption);\r\n    }\r\n\r\n    onUpdateConnectionState = update => {\r\n        const { state } = update;\r\n\r\n        if (state['@type'] === 'connectionStateReady') {\r\n            this.setCountryCode();\r\n        }\r\n\r\n        this.setState({ connecting: isConnecting(state) });\r\n    };\r\n\r\n    onClientUpdateSetPhoneCanceled = update => {\r\n        this.setState({ loading: false });\r\n    };\r\n\r\n    onClientUpdateSetPhoneError = update => {\r\n        const { error } = update;\r\n\r\n        let errorString = null;\r\n        if (error && error['@type'] === 'error' && error.message) {\r\n            if (error.message === 'PHONE_NUMBER_INVALID') {\r\n                this.setState({ error: { code: 'InvalidPhoneNumber' }, loading: false });\r\n                return;\r\n            } else {\r\n                errorString = error.message;\r\n            }\r\n        } else {\r\n            errorString = JSON.stringify(error);\r\n        }\r\n\r\n        this.setState({ error: { string: errorString }, loading: false });\r\n    };\r\n\r\n    onClientUpdateSetPhoneResult = update => {\r\n        this.setState({ loading: false });\r\n    };\r\n\r\n    onUpdateOption = update => {\r\n        const { name } = update;\r\n\r\n        if (name === 'suggested_language_pack_id') {\r\n            this.setSuggestedLanguagePackId();\r\n        }\r\n    };\r\n\r\n    async setSuggestedLanguagePackId() {\r\n        const { i18n } = this.props;\r\n        if (!i18n) return;\r\n\r\n        const languagePackId = OptionStore.get('suggested_language_pack_id');\r\n        if (!languagePackId) return;\r\n\r\n        const { value } = languagePackId;\r\n\r\n        await LocalizationStore.loadLanguage(value);\r\n\r\n        this.setState({ suggestedLanguage: value });\r\n    }\r\n\r\n    handleKeyPress = event => {\r\n        if (event.key === 'Enter') {\r\n            event.preventDefault();\r\n            this.handleDone();\r\n        } else if (!isWhitelistKey(event.key)) {\r\n            event.preventDefault();\r\n            event.stopPropagation();\r\n        }\r\n    };\r\n\r\n    handleDone = () => {\r\n        const { phone } = this.state;\r\n        if (!isValidPhoneNumber(phone)) {\r\n            this.setState({ error: { code: 'InvalidPhoneNumber' } });\r\n            return;\r\n        }\r\n\r\n        this.setState({ error: null, loading: true });\r\n        TdLibController.clientUpdate({\r\n            '@type': 'clientUpdateSetPhone',\r\n            phone\r\n        });\r\n    };\r\n\r\n    handleChangeLanguage = () => {\r\n        const { i18n } = this.props;\r\n        const { suggestedLanguage } = this.state;\r\n\r\n        if (!i18n) return;\r\n        if (!suggestedLanguage) return;\r\n\r\n        const nextLanguage = suggestedLanguage === i18n.language ? LocalizationStore.fallbackLng : suggestedLanguage;\r\n\r\n        TdLibController.clientUpdate({ '@type': 'clientUpdateLanguageChange', language: nextLanguage });\r\n    };\r\n\r\n    handleFilterOptions = (options, { inputValue }) => {\r\n        if (!options) return;\r\n\r\n        let value = inputValue.toLowerCase().replace(/ /g, '');\r\n        value = value.length > 0 && value[0] === '+' ? value.substring(1) : value;\r\n\r\n        return options.filter(x => isValidOption(x, value));\r\n    };\r\n\r\n    handleCountryChange = (event, nextCountry) => {\r\n        if (!nextCountry) return;\r\n\r\n        const { phone, country } = this.state;\r\n\r\n        const prevPhone = country ? phone.replace(country.phone, '') : phone;\r\n        const nextPhone = nextCountry.phone + ' ' + prevPhone.trimStart();\r\n\r\n        this.setState({ country: nextCountry, phone: nextPhone }, () => {\r\n            this.phoneInputRef.current.focus();\r\n        });\r\n    };\r\n\r\n    handleKeepChange = (event, value) => {\r\n        this.setState({ keep: !this.state.keep });\r\n    };\r\n\r\n    handlePhoneChange = event => {\r\n        let nextPhone = event.target.value;\r\n\r\n        const { data } = this.props;\r\n        let { country } = this.state;\r\n        if (country) {\r\n            if (!nextPhone.startsWith(country.phone)) {\r\n                country = null;\r\n            }\r\n        }\r\n\r\n        if (!country && data && nextPhone) {\r\n            country = getCountryFromPhone(nextPhone, data);\r\n            if (country && phoneEquals(nextPhone, country.phone)) {\r\n                nextPhone = '+' + clearPhone(nextPhone) + ' ';\r\n            }\r\n        }\r\n\r\n        this.setState({ phone: nextPhone, country });\r\n    };\r\n\r\n    handlePaste = event => {\r\n        const plainText = event.clipboardData.getData('text/plain');\r\n        if (plainText) {\r\n            event.preventDefault();\r\n            // const phoneRegExp = '/^[+]*[(]{0,1}[0-9]{1,3}[)]{0,1}[-\\s\\./0-9]*$/g';\r\n\r\n            let phone = '';\r\n            for (let ch of plainText) {\r\n                if (isWhitelistKey(ch)) {\r\n                    phone += ch;\r\n                }\r\n            }\r\n\r\n            document.execCommand('insertText', false, phone);\r\n        }\r\n    };\r\n\r\n    render() {\r\n        const { data, i18n, t } = this.props;\r\n        const { connecting, loading, error, suggestedLanguage, keep, phone, country } = this.state;\r\n\r\n        let errorString = '';\r\n        if (error) {\r\n            const { code, string } = error;\r\n            if (code) {\r\n                errorString = t(code);\r\n            } else {\r\n                errorString = string;\r\n            }\r\n        }\r\n\r\n        const title = connecting ? cleanProgressStatus(t('Connecting')) : t('SignInToTelegram');\r\n        const nextLanguage = suggestedLanguage === i18n.language ? LocalizationStore.fallbackLng : suggestedLanguage;\r\n\r\n        return (\r\n            <form className='auth-root' autoComplete='off'>\r\n                <Typography variant='body1' className='auth-title'>\r\n                    <span>{title}</span>\r\n                    {connecting && <HeaderProgress />}\r\n                </Typography>\r\n                <Typography variant='body1' className='auth-subtitle' style={{ width: 254 }}>\r\n                    {t('StartText')}\r\n                </Typography>\r\n                <Autocomplete\r\n                    debug={false}\r\n                    id='country-select'\r\n                    noOptionsText={t('NoResult')}\r\n                    options={data}\r\n                    disabled={loading}\r\n                    autoHighlight\r\n                    getOptionLabel={option => option.name}\r\n                    renderOption={option => <Country name={option.name} emoji={option.emoji} phone={option.phone} />}\r\n                    renderInput={params => (\r\n                        <TextField\r\n                            classes={{ root: 'auth-input' }}\r\n                            {...params}\r\n                            label={t('Country')}\r\n                            variant='outlined'\r\n                            inputProps={{\r\n                                ...params.inputProps\r\n                            }}\r\n                            fullWidth\r\n                            autoComplete='off'\r\n                        />\r\n                    )}\r\n                    filterOptions={this.handleFilterOptions}\r\n                    value={country}\r\n                    onChange={this.handleCountryChange}\r\n                />\r\n                <TextField\r\n                    id='phoneNumber'\r\n                    classes={{ root: 'auth-input' }}\r\n                    inputRef={this.phoneInputRef}\r\n                    variant='outlined'\r\n                    color='primary'\r\n                    label={t('PhoneNumber')}\r\n                    disabled={loading}\r\n                    error={Boolean(errorString)}\r\n                    helperText={errorString}\r\n                    fullWidth\r\n                    autoFocus\r\n                    autoComplete='off'\r\n                    value={phone}\r\n                    onChange={this.handlePhoneChange}\r\n                    onKeyPress={this.handleKeyPress}\r\n                    onPaste={this.handlePaste}\r\n                />\r\n                <div className='sign-in-keep'>\r\n                    <Checkbox color='primary' checked={keep} disabled={loading} onChange={this.handleKeepChange} />\r\n                    <Typography variant='body1'>{t('KeepMeSignedIn')}</Typography>\r\n                </div>\r\n                <Button\r\n                    classes={{ root: 'auth-button' }}\r\n                    variant='contained'\r\n                    disableElevation\r\n                    fullWidth\r\n                    color='primary'\r\n                    disabled={loading}\r\n                    onClick={this.handleDone}>\r\n                    {t('Next')}\r\n                </Button>\r\n                <Typography className='sign-in-continue-on'>\r\n                    <Link onClick={this.handleChangeLanguage}>\r\n                        {Boolean(nextLanguage) ? t('ContinueOnThisLanguage', { lng: nextLanguage }) : ' '}\r\n                    </Link>\r\n                </Typography>\r\n            </form>\r\n        );\r\n    }\r\n}\r\n\r\nPhone.propTypes = {\r\n    defaultPhone: PropTypes.string\r\n};\r\n\r\nexport default withTranslation()(Phone);\r\n","/*\r\n *  Copyright (c) 2018-present, Evgeny Nadymov\r\n *\r\n * This source code is licensed under the GPL v.3.0 license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport React from 'react';\r\nimport classNames from 'classnames';\r\nimport { withTranslation } from 'react-i18next';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport EditIcon from '@material-ui/icons/EditOutlined';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport HeaderProgress from '../ColumnMiddle/HeaderProgress';\r\nimport { cleanProgressStatus, formatPhoneNumber, isConnecting } from './Phone';\r\nimport AppStore from '../../Stores/ApplicationStore';\r\nimport TdLibController from '../../Controllers/TdLibController';\r\nimport './Code.css';\r\n\r\nclass Code extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            connecting: isConnecting(AppStore.connectionState),\r\n            error: '',\r\n            loading: false\r\n        };\r\n\r\n        this.inputRef = React.createRef();\r\n    }\r\n\r\n    componentDidMount() {\r\n        TdLibController.clientUpdate({\r\n            '@type': 'clientUpdateMonkeyIdle'\r\n        });\r\n\r\n        AppStore.on('updateConnectionState', this.onUpdateConnectionState);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        AppStore.off('updateConnectionState', this.onUpdateConnectionState);\r\n    }\r\n\r\n    onUpdateConnectionState = update => {\r\n        const { state } = update;\r\n\r\n        this.setState({ connecting: isConnecting(state) });\r\n    };\r\n\r\n    handleNext = () => {\r\n        if (this.code && this.isValid(this.code)) {\r\n            this.setState({ error: '' });\r\n            this.handleDone();\r\n        } else {\r\n            this.setState({ error: 'Invalid code. Please try again.' });\r\n        }\r\n    };\r\n\r\n    handleDone = () => {\r\n        const { t } = this.props;\r\n        const code = this.code;\r\n\r\n        this.setState({ loading: true });\r\n        TdLibController.send({\r\n            '@type': 'checkAuthenticationCode',\r\n            code: code,\r\n            first_name: 'A',\r\n            last_name: 'B'\r\n        })\r\n            .then(result => {})\r\n            .catch(error => {\r\n                let errorString = null;\r\n                if (error && error['@type'] === 'error' && error.message) {\r\n                    if (error.message === 'PHONE_CODE_INVALID') {\r\n                        errorString = t('InvalidCode');\r\n                    } else {\r\n                        errorString = error.message;\r\n                    }\r\n                } else {\r\n                    errorString = JSON.stringify(error);\r\n                }\r\n\r\n                this.setState({ error: errorString }, () => {\r\n                    setTimeout(() => this.inputRef.current.focus(), 100);\r\n                });\r\n            })\r\n            .finally(() => {\r\n                this.setState({ loading: false });\r\n            });\r\n    };\r\n\r\n    handleBack = () => {\r\n        this.props.onChangePhone();\r\n    };\r\n\r\n    isValid(code) {\r\n        let isBad = !code.match(/^[\\d\\-+\\s]+$/);\r\n        if (!isBad) {\r\n            code = code.replace(/\\D/g, '');\r\n            if (code.length !== 5) {\r\n                isBad = true;\r\n            }\r\n        }\r\n\r\n        return !isBad;\r\n    }\r\n\r\n    handleChange = e => {\r\n        const prevCode = this.code || '';\r\n        this.code = e.target.value || '';\r\n\r\n        TdLibController.clientUpdate({\r\n            '@type': 'clientUpdateMonkeyTracking',\r\n            prevCode,\r\n            code: this.code\r\n        });\r\n\r\n        if (this.code && this.codeLength > 0 && this.code.length === this.codeLength) {\r\n            this.handleNext();\r\n        }\r\n    };\r\n\r\n    handleKeyPress = e => {\r\n        if (e.key === 'Enter') {\r\n            e.preventDefault();\r\n            this.handleNext();\r\n        }\r\n    };\r\n\r\n    getPhoneNumber(codeInfo) {\r\n        if (!codeInfo) return null;\r\n        return codeInfo.phone_number;\r\n    }\r\n\r\n    getCodeLength(codeInfo) {\r\n        if (!codeInfo) return 0;\r\n        if (!codeInfo.type) return 0;\r\n\r\n        switch (codeInfo.type['@type']) {\r\n            case 'authenticationCodeTypeCall': {\r\n                return codeInfo.type.length;\r\n            }\r\n            case 'authenticationCodeTypeFlashCall': {\r\n                return 0;\r\n            }\r\n            case 'authenticationCodeTypeSms': {\r\n                return codeInfo.type.length;\r\n            }\r\n            case 'authenticationCodeTypeTelegramMessage': {\r\n                return codeInfo.type.length;\r\n            }\r\n        }\r\n\r\n        return 0;\r\n    }\r\n\r\n    getSubtitle(codeInfo, t = k => k) {\r\n        if (!codeInfo) return 'Subtitle';\r\n        if (!codeInfo.type) return 'Subtitle';\r\n\r\n        switch (codeInfo.type['@type']) {\r\n            case 'authenticationCodeTypeCall': {\r\n                return 'Telegram dialed your number';\r\n            }\r\n            case 'authenticationCodeTypeFlashCall': {\r\n                return 'Telegram dialed your number';\r\n            }\r\n            case 'authenticationCodeTypeSms': {\r\n                return 'We have sent you a message with activation code to your phone. Please enter it below.';\r\n            }\r\n            case 'authenticationCodeTypeTelegramMessage': {\r\n                return \"Please enter the code you've just received in your previous Telegram app.\";\r\n            }\r\n        }\r\n\r\n        return 'Subtitle';\r\n    }\r\n\r\n    render() {\r\n        const { codeInfo, t } = this.props;\r\n        const { connecting, loading, error } = this.state;\r\n\r\n        this.phoneNumber = this.getPhoneNumber(codeInfo);\r\n        this.codeLength = this.getCodeLength(codeInfo);\r\n        const subtitle = this.getSubtitle(codeInfo);\r\n\r\n        let title = 'Title';\r\n        if (connecting) {\r\n            title = cleanProgressStatus(t('Connecting'));\r\n        } else if (this.phoneNumber) {\r\n            title = formatPhoneNumber(this.phoneNumber);\r\n        }\r\n\r\n        return (\r\n            <form className='auth-root' autoComplete='off'>\r\n                <div className={classNames('code-title', 'auth-title')}>\r\n                    <Typography variant='body1' className='auth-title-typography'>\r\n                        <span>{title}</span>\r\n                        {connecting && <HeaderProgress />}\r\n                    </Typography>\r\n                    <IconButton aria-label='edit' onClick={this.handleBack} disabled={loading}>\r\n                        <EditIcon fontSize='small' />\r\n                    </IconButton>\r\n                </div>\r\n                <Typography variant='body1' className='auth-subtitle' style={{ width: 300 }}>\r\n                    {subtitle}\r\n                </Typography>\r\n                <TextField\r\n                    classes={{ root: 'auth-input' }}\r\n                    inputRef={this.inputRef}\r\n                    variant='outlined'\r\n                    color='primary'\r\n                    disabled={loading}\r\n                    error={Boolean(error)}\r\n                    helperText={error}\r\n                    fullWidth\r\n                    autoFocus\r\n                    autoComplete='off'\r\n                    label={t('Code')}\r\n                    maxLength={this.codeLength > 0 ? this.codeLength : 256}\r\n                    onChange={this.handleChange}\r\n                    onKeyPress={this.handleKeyPress}\r\n                />\r\n            </form>\r\n        );\r\n    }\r\n}\r\n\r\nexport default withTranslation()(Code);\r\n","/*\r\n *  Copyright (c) 2018-present, Evgeny Nadymov\r\n *\r\n * This source code is licensed under the GPL v.3.0 license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport React from 'react';\r\nimport { withTranslation } from 'react-i18next';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport InputAdornment from '@material-ui/core/InputAdornment';\r\nimport InputLabel from '@material-ui/core/InputLabel';\r\nimport OutlinedInput from '@material-ui/core/OutlinedInput';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport FormControl from '@material-ui/core/FormControl';\r\nimport FormHelperText from '@material-ui/core/FormHelperText';\r\nimport Button from '@material-ui/core/Button';\r\nimport Visibility from '@material-ui/icons/Visibility';\r\nimport VisibilityOff from '@material-ui/icons/VisibilityOff';\r\nimport HeaderProgress from '../ColumnMiddle/HeaderProgress';\r\nimport { cleanProgressStatus, isConnecting } from './Phone';\r\nimport AppStore from '../../Stores/ApplicationStore';\r\nimport TdLibController from '../../Controllers/TdLibController';\r\nimport './Password.css';\r\n\r\nfunction debounce(func, wait, immediate) {\r\n    let timeout;\r\n    return function() {\r\n        let context = this,\r\n            args = arguments;\r\n        let later = function() {\r\n            timeout = null;\r\n            if (!immediate) {\r\n                func.apply(context, args);\r\n            }\r\n        };\r\n        let callNow = immediate && !timeout;\r\n        clearTimeout(timeout);\r\n        timeout = setTimeout(later, wait);\r\n        if (callNow) {\r\n            func.apply(context, args);\r\n        }\r\n    };\r\n}\r\n\r\nclass Password extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            connecting: isConnecting(AppStore.connectionState),\r\n            password: '',\r\n            showPassword: false,\r\n            error: ''\r\n        };\r\n\r\n        this.inputRef = React.createRef();\r\n        this.sendMonkeyPeek = debounce(this.sendMonkeyPeek, 200, false);\r\n    }\r\n\r\n    componentDidMount() {\r\n        TdLibController.clientUpdate({\r\n            '@type': 'clientUpdateMonkeyClose'\r\n        });\r\n\r\n        AppStore.on('updateConnectionState', this.onUpdateConnectionState);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        AppStore.off('updateConnectionState', this.onUpdateConnectionState);\r\n    }\r\n\r\n    onUpdateConnectionState = update => {\r\n        const { state } = update;\r\n\r\n        this.setState({ connecting: isConnecting(state) });\r\n    };\r\n\r\n    handleNext = () => {\r\n        if (this.password) {\r\n            this.setState({ error: '' });\r\n            this.handleDone();\r\n        } else {\r\n            this.setState({ error: 'Invalid password. Please try again.' });\r\n        }\r\n    };\r\n\r\n    handleBack = () => {\r\n        this.props.onChangePhone();\r\n    };\r\n\r\n    handleDone = () => {\r\n        const password = this.password;\r\n\r\n        this.setState({ loading: true });\r\n        TdLibController.send({\r\n            '@type': 'checkAuthenticationPassword',\r\n            password: password\r\n        })\r\n            .then(result => {})\r\n            .catch(error => {\r\n                let errorString = null;\r\n                if (error && error['@type'] === 'error' && error.message) {\r\n                    errorString = error.message;\r\n                } else {\r\n                    errorString = JSON.stringify(error);\r\n                }\r\n\r\n                this.setState({ error: errorString }, () => {\r\n                    setTimeout(() => this.inputRef.current.focus(), 100);\r\n                });\r\n            })\r\n            .finally(() => {\r\n                this.setState({ loading: false });\r\n            });\r\n    };\r\n\r\n    handleMouseDownPassword = event => {\r\n        event.preventDefault();\r\n    };\r\n\r\n    handleClickShowPassword = () => {\r\n        this.setState({ showPassword: !this.state.showPassword });\r\n\r\n        this.sendMonkeyPeek();\r\n    };\r\n\r\n    sendMonkeyPeek() {\r\n        TdLibController.clientUpdate({\r\n            '@type': 'clientUpdateMonkeyPeek',\r\n            peek: this.state.showPassword\r\n        });\r\n    }\r\n\r\n    handleChange = e => {\r\n        this.password = e.target.value;\r\n    };\r\n\r\n    handleKeyPress = e => {\r\n        if (e.key === 'Enter') {\r\n            e.preventDefault();\r\n            this.handleNext();\r\n        }\r\n    };\r\n\r\n    render() {\r\n        const { passwordHint, t } = this.props;\r\n        const { connecting, loading, error, showPassword } = this.state;\r\n\r\n        let title = t('EnterPassword');\r\n        if (connecting) {\r\n            title = cleanProgressStatus(t('Connecting'));\r\n        }\r\n\r\n        return (\r\n            <form className='auth-root' autoComplete='off'>\r\n                <Typography variant='body1' className='auth-title'>\r\n                    <span>{title}</span>\r\n                    {connecting && <HeaderProgress />}\r\n                </Typography>\r\n                <Typography variant='body1' className='auth-subtitle' style={{ width: 235 }}>\r\n                    {t('YourAccountProtectedWithPassword')}\r\n                </Typography>\r\n                <FormControl className='auth-input' fullWidth variant='outlined'>\r\n                    <InputLabel htmlFor='adornment-password' error={Boolean(error)}>\r\n                        {t('LoginPassword')}\r\n                    </InputLabel>\r\n                    <OutlinedInput\r\n                        fullWidth\r\n                        autoFocus\r\n                        autoComplete='off'\r\n                        id='adornment-password'\r\n                        inputRef={this.inputRef}\r\n                        type={showPassword ? 'text' : 'password'}\r\n                        disabled={loading}\r\n                        error={Boolean(error)}\r\n                        onChange={this.handleChange}\r\n                        onKeyPress={this.handleKeyPress}\r\n                        endAdornment={\r\n                            <InputAdornment position='end'>\r\n                                <IconButton\r\n                                    aria-label='Toggle password visibility'\r\n                                    onClick={this.handleClickShowPassword}\r\n                                    onMouseDown={this.handleMouseDownPassword}\r\n                                    edge='end'>\r\n                                    {showPassword ? <Visibility /> : <VisibilityOff />}\r\n                                </IconButton>\r\n                            </InputAdornment>\r\n                        }\r\n                        labelWidth={70}\r\n                    />\r\n                    {passwordHint && <FormHelperText id='password-hint-text'>{passwordHint}</FormHelperText>}\r\n                    {error && (\r\n                        <FormHelperText id='password-error-text' error>\r\n                            {error}\r\n                        </FormHelperText>\r\n                    )}\r\n                </FormControl>\r\n                <Button\r\n                    classes={{ root: 'auth-button' }}\r\n                    fullWidth\r\n                    color='primary'\r\n                    variant='contained'\r\n                    disableElevation\r\n                    onClick={this.handleNext}\r\n                    disabled={loading}>\r\n                    {t('Next')}\r\n                </Button>\r\n            </form>\r\n        );\r\n    }\r\n}\r\n\r\nexport default withTranslation()(Password);\r\n","/*\r\n *  Copyright (c) 2018-present, Evgeny Nadymov\r\n *\r\n * This source code is licensed under the GPL v.3.0 license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport React from 'react';\r\nimport Button from '@material-ui/core/Button';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogContentText from '@material-ui/core/DialogContentText';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport TdLibController from '../../Controllers/TdLibController';\r\n\r\nclass AuthErrorDialog extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            open: false,\r\n            error: null\r\n        };\r\n\r\n        this.handleAuthError = this.handleAuthError.bind(this);\r\n        this.handleClose = this.handleClose.bind(this);\r\n        this.handleKeyDown = this.handleKeyDown.bind(this);\r\n    }\r\n\r\n    componentDidMount() {\r\n        TdLibController.on('tdlib_auth_error', this.handleAuthError);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        TdLibController.off('tdlib_auth_error', this.handleAuthError);\r\n    }\r\n\r\n    handleAuthError(error) {\r\n        this.setState({\r\n            open: true,\r\n            error: error\r\n        });\r\n    }\r\n\r\n    handleClose() {\r\n        this.setState({\r\n            open: false\r\n        });\r\n    }\r\n\r\n    handleKeyDown(e) {\r\n        if (e.key === 'Enter') {\r\n            e.preventDefault();\r\n            this.handleClose();\r\n        }\r\n    }\r\n\r\n    render() {\r\n        let errorString = null;\r\n        if (this.state.error && this.state.error['@type'] === 'error' && this.state.error.message) {\r\n            errorString = this.state.error.message;\r\n        } else {\r\n            errorString = JSON.stringify(this.state.error);\r\n        }\r\n\r\n        return (\r\n            <Dialog\r\n                transitionDuration={0}\r\n                open={this.state.open}\r\n                onKeyDown={this.handleKeyDown}\r\n                onClose={this.handleClose}\r\n                aria-labelledby='form-dialog-title'>\r\n                <DialogTitle id='form-dialog-title'>Error</DialogTitle>\r\n                <DialogContent>\r\n                    <DialogContentText>{errorString}</DialogContentText>\r\n                </DialogContent>\r\n                <DialogActions>\r\n                    <Button onClick={this.handleClose} color='primary'>\r\n                        Ok\r\n                    </Button>\r\n                </DialogActions>\r\n            </Dialog>\r\n        );\r\n    }\r\n}\r\n\r\nexport default AuthErrorDialog;\r\n","/*\r\n *  Copyright (c) 2018-present, Evgeny Nadymov\r\n *\r\n * This source code is licensed under the GPL v.3.0 license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport React from 'react';\r\nimport Caption from './Caption';\r\nimport Code from './Code';\r\nimport Password from './Password';\r\nimport Phone from './Phone';\r\nimport AuthErrorDialog from './AuthErrorDialog';\r\nimport { loadData } from '../../Utils/Phone';\r\nimport AppStore from '../../Stores/ApplicationStore';\r\nimport AuthStore from '../../Stores/AuthorizationStore';\r\nimport './AuthForm.css';\r\n\r\nclass AuthForm extends React.Component {\r\n    state = {\r\n        data: null\r\n    };\r\n\r\n    componentDidMount() {\r\n        setTimeout(this.loadContent, 100);\r\n    }\r\n\r\n    loadContent = async () => {\r\n        const { data } = this.state;\r\n        if (data) return;\r\n\r\n        try {\r\n            AuthStore.data = await loadData();\r\n\r\n            this.setState({ data: AuthStore.data });\r\n        } catch (error) {\r\n            console.error(error);\r\n        }\r\n    };\r\n\r\n    render() {\r\n        const { authorizationState: state } = this.props;\r\n        const { data } = this.state;\r\n        const { defaultPhone } = AppStore;\r\n\r\n        let control = null;\r\n        switch (state['@type']) {\r\n            case 'authorizationStateWaitPhoneNumber':\r\n            case 'authorizationStateWaitEncryptionKey':\r\n            case 'authorizationStateWaitTdlibParameters':\r\n            case 'authorizationStateWaitTdlib': {\r\n                control = <Phone defaultPhone={defaultPhone} data={data} />;\r\n                break;\r\n            }\r\n            case 'authorizationStateWaitCode': {\r\n                const { onChangePhone } = this.props;\r\n                const { terms_of_service, code_info } = state;\r\n\r\n                control = (\r\n                    <Code\r\n                        termsOfService={terms_of_service}\r\n                        codeInfo={code_info}\r\n                        onChangePhone={onChangePhone}\r\n                        data={data}\r\n                    />\r\n                );\r\n                break;\r\n            }\r\n            case 'authorizationStateWaitPassword': {\r\n                const { onChangePhone } = this.props;\r\n                const { password_hint, has_recovery_email_address, recovery_email_address_pattern } = state;\r\n\r\n                control = (\r\n                    <Password\r\n                        passwordHint={password_hint}\r\n                        hasRecoveryEmailAddress={has_recovery_email_address}\r\n                        recoveryEmailAddressPattern={recovery_email_address_pattern}\r\n                        onChangePhone={onChangePhone}\r\n                    />\r\n                );\r\n                break;\r\n            }\r\n            default:\r\n                break;\r\n        }\r\n\r\n        return (\r\n            <div className='authorization-form' onLoad={this.handleLoad}>\r\n                <div className='authorization-form-content'>\r\n                    <Caption state={state} />\r\n                    {control}\r\n                </div>\r\n                <AuthErrorDialog />\r\n            </div>\r\n        );\r\n    }\r\n}\r\nexport default AuthForm;\r\n","/*\r\n *  Copyright (c) 2018-present, Evgeny Nadymov\r\n *\r\n * This source code is licensed under the GPL v.3.0 license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport React from 'react';\r\nimport Button from '@material-ui/core/Button/Button';\r\nimport './AppInactive.css';\r\n\r\nclass AppInactive extends React.Component {\r\n    static handleReload() {\r\n        window.location.reload();\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className='app-inactive'>\r\n                <div className='app-inactive-wrapper'>\r\n                    <img\r\n                        className='app-inactive-image'\r\n                        src='Manytabs_2x.png'\r\n                        alt=''\r\n                        onClick={AppInactive.handleReload}\r\n                    />\r\n                    <h3 className='app-inactive-title'>Such error, many tabs</h3>\r\n                    <div className='app-inactive-description'>\r\n                        Telegram supports only one active tab with the app.\r\n                        <br />\r\n                        Please reload this page to continue using this tab or close it.\r\n                    </div>\r\n                    <div className='app-inactive-actions'>\r\n                        <Button color='primary' onClick={AppInactive.handleReload}>\r\n                            Reload app\r\n                        </Button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default AppInactive;\r\n","/*\r\n *  Copyright (c) 2018-present, Evgeny Nadymov\r\n *\r\n * This source code is licensed under the GPL v.3.0 license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport React from 'react';\r\nimport packageJson from '../../package.json';\r\nimport './Footer.css';\r\n\r\nclass Footer extends React.PureComponent {\r\n    render() {\r\n        return (\r\n            <div className='footer-wrapper'>\r\n                <span>{packageJson.version}</span>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default Footer;\r\n","/*\r\n *  Copyright (c) 2018-present, Evgeny Nadymov\r\n *\r\n * This source code is licensed under the GPL v.3.0 license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport React from 'react';\r\nimport AppInactive from './Additional/AppInactive';\r\nimport Footer from './Footer';\r\n\r\nclass InactivePage extends React.Component {\r\n    render() {\r\n        return (\r\n            <>\r\n                <div className='header-wrapper' />\r\n                <div className='page'>\r\n                    <AppInactive />\r\n                </div>\r\n                <Footer />\r\n            </>\r\n        );\r\n    }\r\n}\r\n\r\nexport default InactivePage;\r\n","/*\r\n *  Copyright (c) 2018-present, Evgeny Nadymov\r\n *\r\n * This source code is licensed under the GPL v.3.0 license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport React from 'react';\r\nimport Button from '@material-ui/core/Button';\r\nimport { isIOS, isWindowsPhone } from '../../Utils/Common';\r\nimport './NativeApp.css';\r\n\r\nclass NativeApp extends React.Component {\r\n    static handleInstall = () => {\r\n        if (isIOS()) {\r\n            window.location.href = 'https://telegram.org/dl/ios';\r\n        } else if (isWindowsPhone()) {\r\n            window.location.href = 'https://telegram.org/dl/wp';\r\n        } else {\r\n            window.location.href = 'https://telegram.org/dl/android';\r\n        }\r\n    };\r\n\r\n    render() {\r\n        let src = 'Android_2x.jpg';\r\n        if (isIOS()) {\r\n            src = 'iOS_2x.jpg';\r\n        } else if (isWindowsPhone()) {\r\n            src = 'WP_2x.jpg';\r\n        }\r\n\r\n        return (\r\n            <div className='app-inactive'>\r\n                <div className='app-inactive-wrapper'>\r\n                    <img src={src} alt='' className='app-inactive-image' onClick={NativeApp.handleInstall} />\r\n                    <h3 className='app-inactive-title'>Work is in progress!</h3>\r\n                    <div className='app-inactive-description'>\r\n                        This client has not been optimized for mobile devices yet.\r\n                        <br />\r\n                        Please consider using our native mobile app.\r\n                    </div>\r\n                    <div className='app-inactive-actions'>\r\n                        <Button color='primary' onClick={NativeApp.handleInstall}>\r\n                            Install app\r\n                        </Button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default NativeApp;\r\n","/*\r\n *  Copyright (c) 2018-present, Evgeny Nadymov\r\n *\r\n * This source code is licensed under the GPL v.3.0 license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport React from 'react';\r\nimport Footer from './Footer';\r\nimport NativeApp from './Additional/NativeApp';\r\n\r\nclass NativeAppPage extends React.Component {\r\n    render() {\r\n        return (\r\n            <>\r\n                <div className='header-wrapper' />\r\n                <div\r\n                    className='page'\r\n                    style={{\r\n                        background: '#FFFFFF',\r\n                        color: '#000000'\r\n                    }}>\r\n                    <NativeApp />\r\n                </div>\r\n                <Footer />\r\n            </>\r\n        );\r\n    }\r\n}\r\n\r\nexport default NativeAppPage;\r\n","/*\r\n *  Copyright (c) 2018-present, Evgeny Nadymov\r\n *\r\n * This source code is licensed under the GPL v.3.0 license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport React, { Component } from 'react';\r\nimport { compose } from './Utils/HOC';\r\nimport withLanguage from './Language';\r\nimport withTelegramTheme from './Theme';\r\nimport withTheme from '@material-ui/core/styles/withTheme';\r\nimport { withTranslation } from 'react-i18next';\r\nimport Button from '@material-ui/core/Button';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogContentText from '@material-ui/core/DialogContentText';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport packageJson from '../package.json';\r\nimport AuthForm from './Components/Auth/AuthForm';\r\nimport InactivePage from './Components/InactivePage';\r\nimport NativeAppPage from './Components/NativeAppPage';\r\n// import StubPage from './Components/StubPage';\r\nimport registerServiceWorker from './registerServiceWorker';\r\nimport { isMobile } from './Utils/Common';\r\nimport { loadData } from './Utils/Phone';\r\nimport { OPTIMIZATIONS_FIRST_START } from './Constants';\r\nimport ChatStore from './Stores/ChatStore';\r\nimport UserStore from './Stores/UserStore';\r\nimport AppStore from './Stores/ApplicationStore';\r\nimport AuthorizationStore from './Stores/AuthorizationStore';\r\nimport TdLibController from './Controllers/TdLibController';\r\nimport './TelegramApp.css';\r\n\r\n// import MainPage from './Components/MainPage';\r\nconst MainPage = React.lazy(() => import('./Components/MainPage'));\r\n\r\nclass TelegramApp extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        console.log(`Start Telegram Web ${packageJson.version}`);\r\n\r\n        this.state = {\r\n            prevAuthorizationState: AuthorizationStore.current,\r\n            authorizationState: null,\r\n            tdlibDatabaseExists: false,\r\n            inactive: false,\r\n            fatalError: false,\r\n            nativeMobile: isMobile()\r\n        };\r\n    }\r\n\r\n    componentWillMount() {\r\n        const { location } = this.props;\r\n\r\n        TdLibController.init(location);\r\n    }\r\n\r\n    componentDidMount() {\r\n        setTimeout(() => loadData(), 1500);\r\n        TdLibController.on('update', this.onUpdate);\r\n\r\n        AppStore.on('clientUpdateAppInactive', this.onClientUpdateAppInactive);\r\n        AppStore.on('clientUpdateTdLibDatabaseExists', this.onClientUpdateTdLibDatabaseExists);\r\n        AppStore.on('updateAuthorizationState', this.onUpdateAuthorizationState);\r\n        AppStore.on('updateFatalError', this.onUpdateFatalError);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        TdLibController.off('update', this.onUpdate);\r\n\r\n        AppStore.off('clientUpdateAppInactive', this.onClientUpdateAppInactive);\r\n        AppStore.off('clientUpdateTdLibDatabaseExists', this.onClientUpdateTdLibDatabaseExists);\r\n        AppStore.off('updateAuthorizationState', this.onUpdateAuthorizationState);\r\n        AppStore.off('updateFatalError', this.onUpdateFatalError);\r\n    }\r\n\r\n    onClientUpdateTdLibDatabaseExists = update => {\r\n        const { exists } = update;\r\n\r\n        if (!exists) {\r\n            this.setState({\r\n                authorizationState: {\r\n                    '@type': 'authorizationStateWaitTdlib'\r\n                },\r\n                tdlibDatabaseExists: exists\r\n            });\r\n        }\r\n    };\r\n\r\n    onUpdate = update => {\r\n        if (OPTIMIZATIONS_FIRST_START) {\r\n            if (!this.checkServiceWorker) {\r\n                this.checkServiceWorker = true;\r\n\r\n                const register = localStorage.getItem('register');\r\n                if (!register) {\r\n                    registerServiceWorker();\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    onUpdateFatalError = update => {\r\n        this.setState({ fatalError: true });\r\n    };\r\n\r\n    onUpdateAuthorizationState = update => {\r\n        const { authorization_state: authorizationState } = update;\r\n\r\n        this.setState({ authorizationState });\r\n\r\n        if (!window.hasFocus) return;\r\n        if (!authorizationState) return;\r\n\r\n        TdLibController.send({\r\n            '@type': 'setOption',\r\n            name: 'online',\r\n            value: { '@type': 'optionValueBoolean', value: true }\r\n        });\r\n    };\r\n\r\n    onClientUpdateAppInactive = update => {\r\n        this.setState({ inactive: true });\r\n    };\r\n\r\n    handleChangePhone = () => {\r\n        this.setState({\r\n            authorizationState: { '@type': 'authorizationStateWaitPhoneNumber' }\r\n        });\r\n    };\r\n\r\n    handleDragOver = event => {\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n    };\r\n\r\n    handleDrop = event => {\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n    };\r\n\r\n    handleRefresh = () => {\r\n        this.setState({ fatalError: false });\r\n        window.location.reload();\r\n    };\r\n\r\n    handleDestroy = () => {\r\n        this.setState({ fatalError: false });\r\n        TdLibController.send({ '@type': 'destroy' });\r\n    };\r\n\r\n    handleKeyDown = event => {\r\n        //console.log('KeyDown', event);\r\n    };\r\n\r\n    render() {\r\n        const { t, theme } = this.props;\r\n        const { inactive, nativeMobile, tdlibDatabaseExists, fatalError } = this.state;\r\n        let { authorizationState, prevAuthorizationState } = this.state;\r\n        const state = authorizationState;\r\n        if (\r\n            !authorizationState ||\r\n            authorizationState['@type'] === 'authorizationStateWaitEncryptionKey' ||\r\n            authorizationState['@type'] === 'authorizationStateWaitTdlibParameters'\r\n        ) {\r\n            if (prevAuthorizationState) {\r\n                authorizationState = prevAuthorizationState;\r\n            }\r\n            // else if (tdlibDatabaseExists) {\r\n            //     authorizationState = {\r\n            //         '@type': 'authorizationStateReady'\r\n            //     }\r\n            // }\r\n            else {\r\n                authorizationState = {\r\n                    '@type': 'authorizationStateWaitPhoneNumber'\r\n                };\r\n            }\r\n        }\r\n\r\n        const loading = t('Loading').replace('...', '');\r\n        let page = ( //<MainPage />;\r\n            <React.Suspense fallback={null}>\r\n                <MainPage />\r\n            </React.Suspense>\r\n        );\r\n\r\n        if (nativeMobile) {\r\n            page = <NativeAppPage />;\r\n        } else if (inactive) {\r\n            page = <InactivePage />;\r\n        } else if (authorizationState) {\r\n            switch (authorizationState['@type']) {\r\n                case 'authorizationStateClosed':\r\n                case 'authorizationStateClosing':\r\n                case 'authorizationStateLoggingOut':\r\n                case 'authorizationStateReady': {\r\n                    break;\r\n                }\r\n                case 'authorizationStateWaitCode':\r\n                case 'authorizationStateWaitPassword':\r\n                case 'authorizationStateWaitPhoneNumber':\r\n                case 'authorizationStateWaitTdlib':\r\n                    page = <AuthForm authorizationState={authorizationState} onChangePhone={this.handleChangePhone} />;\r\n                    break;\r\n                case 'authorizationStateWaitEncryptionKey':\r\n                case 'authorizationStateWaitTdlibParameters': {\r\n                    // if (!tdlibDatabaseExists) {\r\n                    //     page = (\r\n                    //         <AuthForm\r\n                    //             authorizationState={authorizationState}\r\n                    //             onChangePhone={this.handleChangePhone}\r\n                    //         />\r\n                    //     );\r\n                    // }\r\n\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        // console.log(\r\n        //     'TelegramApp.render',\r\n        //     state,\r\n        //     prevAuthorizationState,\r\n        //     'nativeMobile=' + nativeMobile,\r\n        //     'inactive=' + inactive,\r\n        //     'tdlibDb=' + tdlibDatabaseExists,\r\n        //     page\r\n        // );\r\n\r\n        return (\r\n            <div\r\n                id='app'\r\n                className={theme.palette.type === 'dark' ? 'dark' : 'light'}\r\n                onDragOver={this.handleDragOver}\r\n                onDrop={this.handleDrop}\r\n                onKeyDown={this.handleKeyDown}>\r\n                {page}\r\n                <Dialog\r\n                    transitionDuration={0}\r\n                    open={fatalError}\r\n                    onClose={this.handleRefresh}\r\n                    aria-labelledby='fatal-error-dialog-title'\r\n                    aria-describedby='fatal-error-dialog-description'>\r\n                    <DialogTitle id='fatal-error-dialog-title'>Telegram</DialogTitle>\r\n                    <DialogContent>\r\n                        <DialogContentText id='fatal-error-dialog-description'>\r\n                            Oops! Something went wrong. We need to refresh this page.\r\n                        </DialogContentText>\r\n                    </DialogContent>\r\n                    <DialogActions>\r\n                        <Button onClick={this.handleDestroy} color='primary'>\r\n                            Log out\r\n                        </Button>\r\n                        <Button onClick={this.handleRefresh} color='primary' autoFocus>\r\n                            Refresh\r\n                        </Button>\r\n                    </DialogActions>\r\n                </Dialog>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nconst keyMap = new Map();\r\nwindow.keyMap = keyMap;\r\n\r\nasync function openPinnedChat(index) {\r\n    const chats = await TdLibController.send({\r\n        '@type': 'getChats',\r\n        offset_order: '9223372036854775807',\r\n        offset_chat_id: 0,\r\n        limit: 10\r\n    });\r\n\r\n    if (chats) {\r\n        let pinnedIndex = -1;\r\n        for (let i = 0; i < chats.chat_ids.length; i++) {\r\n            const chat = ChatStore.get(chats.chat_ids[i]);\r\n            if (chat && chat.is_pinned) {\r\n                pinnedIndex++;\r\n            }\r\n\r\n            if (pinnedIndex === index) {\r\n                TdLibController.setChatId(chat.id);\r\n                return;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\ndocument.addEventListener('keyup', event => {\r\n    keyMap.delete(event.key);\r\n    //console.log('keyup key=' + event.key, keyMap);\r\n});\r\n\r\ndocument.addEventListener('keydown', async event => {\r\n    keyMap.set(event.key, event.key);\r\n    //console.log('keydown key=' + event.key, event.altKey, event.ctrlKey, event, keyMap);\r\n\r\n    const { authorizationState } = AppStore;\r\n    if (!authorizationState) return;\r\n    if (authorizationState['@type'] !== 'authorizationStateReady') return;\r\n    if (keyMap.size > 3) return;\r\n\r\n    if (event.altKey && event.ctrlKey) {\r\n        switch (event.key) {\r\n            case '0': {\r\n                event.preventDefault();\r\n                event.stopPropagation();\r\n\r\n                const chat = await TdLibController.send({\r\n                    '@type': 'createPrivateChat',\r\n                    user_id: UserStore.getMyId(),\r\n                    force: true\r\n                });\r\n\r\n                if (chat) {\r\n                    TdLibController.setChatId(chat.id);\r\n                }\r\n                break;\r\n            }\r\n            case '1': {\r\n                event.preventDefault();\r\n                event.stopPropagation();\r\n\r\n                openPinnedChat(0);\r\n                break;\r\n            }\r\n            case '2': {\r\n                event.preventDefault();\r\n                event.stopPropagation();\r\n\r\n                openPinnedChat(1);\r\n                break;\r\n            }\r\n            case '3': {\r\n                event.preventDefault();\r\n                event.stopPropagation();\r\n\r\n                openPinnedChat(2);\r\n                break;\r\n            }\r\n            case '4': {\r\n                event.preventDefault();\r\n                event.stopPropagation();\r\n\r\n                openPinnedChat(3);\r\n                break;\r\n            }\r\n            case '5': {\r\n                event.preventDefault();\r\n                event.stopPropagation();\r\n\r\n                openPinnedChat(4);\r\n                break;\r\n            }\r\n        }\r\n    }\r\n});\r\n\r\nwindow.hasFocus = true;\r\n\r\n// set offline on page lost focus\r\n// console.log('[ns] window.onblur attach');\r\nwindow.onblur = function() {\r\n    keyMap.clear();\r\n\r\n    window.hasFocus = false;\r\n\r\n    TdLibController.clientUpdate({\r\n        '@type': 'clientUpdateFocusWindow',\r\n        focused: false\r\n    });\r\n};\r\n\r\n// set online on page get focus\r\n// console.log('[ns] window.onfocus attach');\r\nwindow.onfocus = function() {\r\n    keyMap.clear();\r\n\r\n    window.hasFocus = true;\r\n\r\n    TdLibController.clientUpdate({\r\n        '@type': 'clientUpdateFocusWindow',\r\n        focused: true\r\n    });\r\n};\r\n\r\n// disable back navigation\r\nwindow.history.pushState(null, null, window.location.href);\r\nwindow.onpopstate = function() {\r\n    window.history.go(1);\r\n};\r\n\r\nconst enhance = compose(\r\n    withLanguage,\r\n    withTranslation(),\r\n    withTelegramTheme,\r\n    withTheme\r\n);\r\n\r\nexport default enhance(TelegramApp);\r\n","/*\r\n *  Copyright (c) 2018-present, Evgeny Nadymov\r\n *\r\n * This source code is licensed under the GPL v.3.0 license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { BrowserRouter as Router, Route } from 'react-router-dom';\r\n// import TelegramApp from './Components/Auth/TestPage';\r\nimport TelegramApp from './TelegramApp';\r\nimport registerServiceWorker from './registerServiceWorker';\r\nimport { OPTIMIZATIONS_FIRST_START } from './Constants';\r\nimport './index.css';\r\n\r\nReactDOM.render(\r\n    <Router>\r\n        <Route path='' component={TelegramApp} />\r\n    </Router>,\r\n    document.getElementById('root')\r\n);\r\n\r\nif (OPTIMIZATIONS_FIRST_START) {\r\n    const register = localStorage.getItem('register');\r\n    if (register) {\r\n        registerServiceWorker();\r\n    }\r\n} else {\r\n    registerServiceWorker();\r\n}\r\n","/*\r\n *  Copyright (c) 2018-present, Evgeny Nadymov\r\n *\r\n * This source code is licensed under the GPL v.3.0 license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport { TYPING_INPUT_INTERVAL_S } from '../Constants';\r\n\r\nclass InputTypingManager {\r\n    constructor(chatId, timeoutCallback) {\r\n        this.actions = new Map();\r\n        this.timerId = null;\r\n        this.chatId = chatId;\r\n        this.timeoutCallback = timeoutCallback;\r\n\r\n        this.handleTimer = this.handleTimer.bind(this);\r\n        this.addAction = this.addAction.bind(this);\r\n        this.clearAction = this.clearAction.bind(this);\r\n        this.setActionsTimeout = this.setActionsTimeout.bind(this);\r\n    }\r\n\r\n    handleTimer() {\r\n        let now = new Date();\r\n        let expiredActions = [];\r\n        for (let [key, value] of this.actions) {\r\n            let actionTimeout = value.expire - now;\r\n            if (actionTimeout <= 0) expiredActions.push(key);\r\n        }\r\n\r\n        for (let key of expiredActions) {\r\n            this.actions.delete(key);\r\n        }\r\n\r\n        let update = {\r\n            '@type': 'updateUserChatAction',\r\n            chat_id: this.chatId,\r\n            action: { '@type': 'chatActionTimerUpdate' }\r\n        };\r\n\r\n        this.timeoutCallback(update);\r\n        // ChatStore.emit('updateUserChatAction', update);\r\n\r\n        this.setActionsTimeout();\r\n    }\r\n\r\n    addAction(userId, action) {\r\n        let expire = new Date();\r\n        expire.setSeconds(expire.getSeconds() + TYPING_INPUT_INTERVAL_S);\r\n\r\n        this.actions.set(userId, { expire: expire, action: action });\r\n\r\n        if (this.timerId) {\r\n            clearTimeout(this.timerId);\r\n        }\r\n\r\n        this.setActionsTimeout();\r\n    }\r\n\r\n    setActionsTimeout() {\r\n        let now = new Date();\r\n        let timeout = 1000000;\r\n        for (let [key, value] of this.actions) {\r\n            let actionTimeout = value.expire - now;\r\n            if (actionTimeout < timeout) timeout = actionTimeout;\r\n            if (timeout < 0) timeout = 0;\r\n        }\r\n\r\n        if (timeout < 1000000) {\r\n            this.timerId = setTimeout(this.handleTimer, timeout);\r\n        }\r\n    }\r\n\r\n    clearAction(userId) {\r\n        this.actions.delete(userId);\r\n\r\n        if (this.timerId) {\r\n            clearTimeout(this.timerId);\r\n        }\r\n\r\n        this.setActionsTimeout();\r\n    }\r\n}\r\n\r\nexport default InputTypingManager;\r\n","/*\r\n *  Copyright (c) 2018-present, Evgeny Nadymov\r\n *\r\n * This source code is licensed under the GPL v.3.0 license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport EventEmitter from './EventEmitter';\r\nimport InputTypingManager from '../Utils/InputTypingManager';\r\nimport UserStore from './UserStore';\r\nimport TdLibController from '../Controllers/TdLibController';\r\n\r\nclass ChatStore extends EventEmitter {\r\n    constructor() {\r\n        super();\r\n\r\n        this.reset();\r\n        this.loadClientData();\r\n\r\n        this.addTdLibListener();\r\n    }\r\n\r\n    reset = () => {\r\n        this.items = new Map();\r\n        this.typingManagers = new Map();\r\n        this.onlineMemberCount = new Map();\r\n        this.counters = new Map();\r\n        this.skippedUpdates = [];\r\n        this.chatList = new Map();\r\n        this.wallpaper = null;\r\n    };\r\n\r\n    loadClientData = () => {\r\n        const clientData = new Map();\r\n        try {\r\n            let data = localStorage.get('clientData');\r\n            if (data) {\r\n                data = JSON.parse(data);\r\n                if (data) {\r\n                    Object.keys(data).forEach(key => {\r\n                        clientData.set(Number(key), data[key]);\r\n                    });\r\n                }\r\n            }\r\n        } catch {}\r\n\r\n        this.clientData = clientData;\r\n    };\r\n\r\n    saveClientData = () => {\r\n        const arr = Array.from(this.clientData.entries());\r\n        const obj = arr.reduce((obj, [key, value]) => {\r\n            if (value) {\r\n                obj[String(key)] = value;\r\n            }\r\n            return obj;\r\n        }, {});\r\n\r\n        localStorage.setItem('clientData', JSON.stringify(obj));\r\n    };\r\n\r\n    updateChatChatList(chatId, chatList) {\r\n        if (!chatList) {\r\n            for (const key of this.chatList.keys()) {\r\n                this.chatList.get(key).delete(chatId);\r\n            }\r\n\r\n            return;\r\n        }\r\n\r\n        let idMap = this.chatList.get(chatList['@type']);\r\n        if (!idMap) {\r\n            idMap = new Map();\r\n            this.chatList.set(chatList['@type'], idMap);\r\n        }\r\n\r\n        idMap.set(chatId, chatId);\r\n        for (const key of this.chatList.keys()) {\r\n            if (key !== chatList['@type']) {\r\n                this.chatList.get(key).delete(chatId);\r\n            }\r\n        }\r\n    }\r\n\r\n    onUpdate = update => {\r\n        switch (update['@type']) {\r\n            case 'updateAuthorizationState': {\r\n                const { authorization_state } = update;\r\n                if (!authorization_state) break;\r\n\r\n                switch (authorization_state['@type']) {\r\n                    case 'authorizationStateClosed': {\r\n                        this.reset();\r\n                        break;\r\n                    }\r\n                }\r\n\r\n                break;\r\n            }\r\n            case 'updateConnectionState': {\r\n                if (update.state['@type'] === 'connectionStateUpdating') {\r\n                    this.updating = true;\r\n                    this.skippedUpdates = [];\r\n                } else {\r\n                    this.updating = false;\r\n                    if (this.skippedUpdates.length > 0) {\r\n                        TdLibController.parameters.fastUpdating = false;\r\n                        this.emitUpdate({\r\n                            '@type': 'clientUpdateFastUpdatingComplete',\r\n                            updates: this.skippedUpdates\r\n                        });\r\n                        this.skippedUpdates = [];\r\n                    }\r\n                }\r\n                break;\r\n            }\r\n            case 'updateChatActionBar': {\r\n                const { chat_id, action_bar } = update;\r\n\r\n                const chat = this.get(chat_id);\r\n                if (chat) {\r\n                    this.assign(chat, { action_bar });\r\n                }\r\n\r\n                this.emitFastUpdate(update);\r\n                break;\r\n            }\r\n            case 'updateChatChatList': {\r\n                const { chat_id, chat_list } = update;\r\n\r\n                const chat = this.get(chat_id);\r\n                if (chat) {\r\n                    this.assign(chat, { chat_list });\r\n                }\r\n\r\n                this.updateChatChatList(chat_id, chat_list);\r\n\r\n                this.emitFastUpdate(update);\r\n                break;\r\n            }\r\n            case 'updateChatDefaultDisableNotification': {\r\n                //TODO: handle updateChatDefaultDisableNotification\r\n\r\n                this.emitFastUpdate(update);\r\n                break;\r\n            }\r\n            case 'updateChatOnlineMemberCount': {\r\n                this.setOnlineMemberCount(update.chat_id, update.online_member_count);\r\n\r\n                this.emitFastUpdate(update);\r\n                break;\r\n            }\r\n            case 'updateChatDraftMessage': {\r\n                const { chat_id, order, draft_message } = update;\r\n\r\n                const chat = this.get(chat_id);\r\n                if (chat) {\r\n                    this.assign(chat, {\r\n                        order: order === '0' ? chat.order : order,\r\n                        draft_message\r\n                    });\r\n                }\r\n\r\n                this.emitFastUpdate(update);\r\n                break;\r\n            }\r\n            case 'updateChatIsMarkedAsUnread': {\r\n                const { chat_id, is_marked_as_unread } = update;\r\n\r\n                const chat = this.get(chat_id);\r\n                if (chat) {\r\n                    this.assign(chat, { is_marked_as_unread });\r\n                }\r\n\r\n                this.emitFastUpdate(update);\r\n                break;\r\n            }\r\n            case 'updateChatIsPinned': {\r\n                const { chat_id, order, is_pinned } = update;\r\n\r\n                const chat = this.get(chat_id);\r\n                if (chat) {\r\n                    this.assign(chat, { order, is_pinned });\r\n                }\r\n\r\n                this.emitFastUpdate(update);\r\n                break;\r\n            }\r\n            case 'updateChatIsSponsored': {\r\n                const { chat_id, order, is_sponsored } = update;\r\n\r\n                const chat = this.get(chat_id);\r\n                if (chat) {\r\n                    this.assign(chat, { order, is_sponsored });\r\n                }\r\n\r\n                this.emitFastUpdate(update);\r\n                break;\r\n            }\r\n            case 'updateChatLastMessage': {\r\n                const { chat_id, order, last_message } = update;\r\n\r\n                const chat = this.get(chat_id);\r\n                if (chat) {\r\n                    this.assign(chat, {\r\n                        order: order === '0' ? chat.order : order,\r\n                        last_message\r\n                    });\r\n                }\r\n\r\n                this.emitFastUpdate(update);\r\n                break;\r\n            }\r\n            case 'updateChatNotificationSettings': {\r\n                const { chat_id, notification_settings } = update;\r\n\r\n                const chat = this.get(chat_id);\r\n                if (chat) {\r\n                    this.assign(chat, { notification_settings });\r\n                }\r\n\r\n                this.emitFastUpdate(update);\r\n                break;\r\n            }\r\n            case 'updateChatOrder': {\r\n                const { chat_id, order } = update;\r\n\r\n                const chat = this.get(chat_id);\r\n                if (chat) {\r\n                    this.assign(chat, { order });\r\n                }\r\n\r\n                this.emitFastUpdate(update);\r\n                break;\r\n            }\r\n            case 'updateChatPhoto': {\r\n                const { chat_id, photo } = update;\r\n\r\n                const chat = this.get(chat_id);\r\n                if (chat) {\r\n                    this.assign(chat, { photo });\r\n\r\n                    switch (chat.type['@type']) {\r\n                        case 'chatTypeBasicGroup': {\r\n                            break;\r\n                        }\r\n                        case 'chatTypeSupergroup': {\r\n                            break;\r\n                        }\r\n                        case 'chatTypePrivate':\r\n                        case 'chatTypeSecret': {\r\n                            const user = UserStore.get(chat.type.user_id);\r\n                            if (user) {\r\n                                UserStore.assign(user, { profile_photo: update.photo });\r\n                            }\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                this.emitFastUpdate(update);\r\n                break;\r\n            }\r\n            case 'updateChatPinnedMessage': {\r\n                const { chat_id, pinned_message_id } = update;\r\n\r\n                const chat = this.get(chat_id);\r\n                if (chat) {\r\n                    this.assign(chat, { pinned_message_id });\r\n                }\r\n\r\n                this.emitFastUpdate(update);\r\n                break;\r\n            }\r\n            case 'updateChatReadInbox': {\r\n                const { chat_id, last_read_inbox_message_id, unread_count } = update;\r\n\r\n                const chat = this.get(chat_id);\r\n                if (chat) {\r\n                    this.assign(chat, { last_read_inbox_message_id, unread_count });\r\n                }\r\n\r\n                this.emitFastUpdate(update);\r\n                break;\r\n            }\r\n            case 'updateChatReadOutbox': {\r\n                const { chat_id, last_read_outbox_message_id } = update;\r\n\r\n                const chat = this.get(chat_id);\r\n                if (chat) {\r\n                    this.assign(chat, { last_read_outbox_message_id });\r\n                }\r\n\r\n                this.emitFastUpdate(update);\r\n                break;\r\n            }\r\n            case 'updateChatReplyMarkup': {\r\n                const { chat_id, reply_markup_message_id } = update;\r\n\r\n                const chat = this.get(chat_id);\r\n                if (chat) {\r\n                    this.assign(chat, { reply_markup_message_id });\r\n                }\r\n\r\n                this.emitFastUpdate(update);\r\n                break;\r\n            }\r\n            case 'updateChatTitle': {\r\n                const { chat_id, title } = update;\r\n\r\n                const chat = this.get(chat_id);\r\n                if (chat) {\r\n                    this.assign(chat, { title });\r\n                }\r\n\r\n                this.emitFastUpdate(update);\r\n                break;\r\n            }\r\n            case 'updateChatUnreadMentionCount': {\r\n                const { chat_id, unread_mention_count } = update;\r\n\r\n                const chat = this.get(chat_id);\r\n                if (chat) {\r\n                    this.assign(chat, { unread_mention_count });\r\n                }\r\n\r\n                this.emitFastUpdate(update);\r\n                break;\r\n            }\r\n            case 'updateNewChat': {\r\n                this.set(update.chat);\r\n\r\n                this.emitFastUpdate(update);\r\n                break;\r\n            }\r\n            case 'updateSecretChat': {\r\n                //TODO: handle updateSecretChat\r\n\r\n                this.emitFastUpdate(update);\r\n                break;\r\n            }\r\n            case 'updateUnreadChatCount': {\r\n                //TODO: handle updateUnreadChatCount\r\n\r\n                this.emitFastUpdate(update);\r\n                break;\r\n            }\r\n            case 'updateUserChatAction': {\r\n                let typingManager = this.getTypingManager(update.chat_id);\r\n                if (!typingManager) {\r\n                    typingManager = new InputTypingManager(update.chat_id, update => this.emitUpdate(update));\r\n                    this.setTypingManager(update.chat_id, typingManager);\r\n                }\r\n\r\n                const key = update.user_id;\r\n                if (update.action['@type'] === 'chatActionCancel') {\r\n                    typingManager.clearAction(key);\r\n                } else {\r\n                    typingManager.addAction(key, update.action);\r\n                }\r\n\r\n                this.emitFastUpdate(update);\r\n                break;\r\n            }\r\n            case 'updateMessageMentionRead': {\r\n                const { chat_id, unread_mention_count } = update;\r\n\r\n                const chat = this.get(chat_id);\r\n                if (chat) {\r\n                    this.assign(chat, { unread_mention_count });\r\n                }\r\n\r\n                this.emitFastUpdate(update);\r\n                break;\r\n            }\r\n            default:\r\n                break;\r\n        }\r\n    };\r\n\r\n    onClientUpdate = update => {\r\n        switch (update['@type']) {\r\n            case 'clientUpdateChatBackground': {\r\n                const { wallpaper } = update;\r\n                this.wallpaper = wallpaper;\r\n\r\n                this.emitUpdate(update);\r\n                break;\r\n            }\r\n            case 'clientUpdateClearHistory': {\r\n                this.emitUpdate(update);\r\n                break;\r\n            }\r\n            case 'clientUpdateLeaveChat': {\r\n                this.emitUpdate(update);\r\n                break;\r\n            }\r\n            case 'clientUpdateArchive': {\r\n                this.emitUpdate(update);\r\n                break;\r\n            }\r\n            case 'clientUpdateOpenChat': {\r\n                this.emitUpdate(update);\r\n                break;\r\n            }\r\n            case 'clientUpdateContacts': {\r\n                this.emitUpdate(update);\r\n                break;\r\n            }\r\n            case 'clientUpdateSettings': {\r\n                this.emitUpdate(update);\r\n                break;\r\n            }\r\n            case 'clientUpdateSetChatClientData': {\r\n                const { chatId, clientData } = update;\r\n\r\n                TdLibController.send({\r\n                    '@type': 'setChatClientData',\r\n                    chat_id: chatId,\r\n                    client_data: JSON.stringify(clientData)\r\n                });\r\n                this.setClientData(chatId, clientData);\r\n                this.saveClientData();\r\n\r\n                this.emitUpdate(update);\r\n                break;\r\n            }\r\n            case 'clientUpdateUnpin': {\r\n                this.emitUpdate(update);\r\n                break;\r\n            }\r\n        }\r\n    };\r\n\r\n    emitUpdate = update => {\r\n        this.emit(update['@type'], update);\r\n    };\r\n\r\n    emitFastUpdate = update => {\r\n        if (this.updating && TdLibController.parameters.fastUpdating) {\r\n            this.skippedUpdates.push(update);\r\n            return;\r\n        }\r\n\r\n        this.emit(update['@type'], update);\r\n    };\r\n\r\n    addTdLibListener = () => {\r\n        TdLibController.on('update', this.onUpdate);\r\n        TdLibController.on('clientUpdate', this.onClientUpdate);\r\n    };\r\n\r\n    removeTdLibListener = () => {\r\n        TdLibController.off('update', this.onUpdate);\r\n        TdLibController.off('clientUpdate', this.onClientUpdate);\r\n    };\r\n\r\n    assign(source1, source2) {\r\n        //Object.assign(source1, source2);\r\n        this.set(Object.assign({}, source1, source2));\r\n    }\r\n\r\n    get(chatId) {\r\n        return this.items.get(chatId);\r\n    }\r\n\r\n    set(chat) {\r\n        this.items.set(chat.id, chat);\r\n    }\r\n\r\n    getCounters(chatId) {\r\n        return this.counters.get(chatId);\r\n    }\r\n\r\n    setCounters(chatId, counters) {\r\n        this.counters.set(chatId, counters);\r\n    }\r\n\r\n    getClientData(chatId) {\r\n        return this.clientData.get(chatId) || {};\r\n    }\r\n\r\n    setClientData(chatId, data) {\r\n        this.clientData.set(chatId, data);\r\n    }\r\n\r\n    setOnlineMemberCount(chatId, onlineMemberCount) {\r\n        this.onlineMemberCount.set(chatId, onlineMemberCount);\r\n    }\r\n\r\n    getOnlineMemberCount(chatId) {\r\n        return this.onlineMemberCount.get(chatId) || 0;\r\n    }\r\n\r\n    getTypingManager(chatId) {\r\n        return this.typingManagers.get(chatId);\r\n    }\r\n\r\n    setTypingManager(chatId, typingManager) {\r\n        return this.typingManagers.set(chatId, typingManager);\r\n    }\r\n}\r\n\r\nconst store = new ChatStore();\r\nwindow.chat = store;\r\nexport default store;\r\n","/*\r\n *  Copyright (c) 2018-present, Evgeny Nadymov\r\n *\r\n * This source code is licensed under the GPL v.3.0 license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport { arrayBufferToBase64, isAuthorizationReady } from './Utils/Common';\r\nimport { OPTIMIZATIONS_FIRST_START } from './Constants';\r\nimport ApplicationStore from './Stores/ApplicationStore';\r\nimport NotificationStore from './Stores/NotificationStore';\r\nimport TdLibController from './Controllers/TdLibController';\r\n\r\n// In production, we register a service worker to serve assets from local cache.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\r\n// cached resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\r\n// This link also includes instructions on opting out of this behavior.\r\n\r\nconst isLocalhost =\r\n    //false;\r\n    Boolean(\r\n        window.location.hostname === 'localhost' ||\r\n            // [::1] is the IPv6 localhost address.\r\n            window.location.hostname === '[::1]' ||\r\n            // 127.0.0.1/8 is considered localhost for IPv4.\r\n            window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\r\n    );\r\n\r\nexport default async function register() {\r\n    console.log('[SW] Register');\r\n\r\n    if (OPTIMIZATIONS_FIRST_START) {\r\n        localStorage.setItem('register', 'true');\r\n    }\r\n\r\n    if ('serviceWorker' in navigator) {\r\n        // The URL constructor is available in all browsers that support SW.\r\n        const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\r\n        if (publicUrl.origin !== window.location.origin) {\r\n            // Our service worker won't work if PUBLIC_URL is on a different origin\r\n            // from what our page is served on. This might happen if a CDN is used to\r\n            // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\r\n            return;\r\n        }\r\n\r\n        const serviceWorkerName =\r\n            process.env.NODE_ENV === 'production' ? 'service-worker.js' : 'custom-service-worker.js';\r\n        const swUrl = `${process.env.PUBLIC_URL}/${serviceWorkerName}`;\r\n        console.log(`[SW] Service worker url: ${swUrl}`);\r\n\r\n        if (!isLocalhost) {\r\n            // Is not local host. Just register service worker\r\n            await registerValidSW(swUrl);\r\n        } else {\r\n            // This is running on localhost. Lets check if a service worker still exists or not.\r\n            await checkValidServiceWorker(swUrl);\r\n        }\r\n    }\r\n}\r\n\r\nasync function registerValidSW(swUrl) {\r\n    console.log('[SW] RegisterValidSW');\r\n    try {\r\n        const registration = await navigator.serviceWorker.register(swUrl);\r\n        registration.onupdatefound = () => {\r\n            const installingWorker = registration.installing;\r\n            installingWorker.onstatechange = () => {\r\n                if (installingWorker.state === 'installed') {\r\n                    if (navigator.serviceWorker.controller) {\r\n                        // At this point, the old content will have been purged and\r\n                        // the fresh content will have been added to the cache.\r\n                        // It's the perfect time to display a \"New content is\r\n                        // available; please refresh.\" message in your web app.\r\n                        console.log('[SW] New content is available; please refresh.');\r\n\r\n                        TdLibController.clientUpdate({ '@type': 'clientUpdateNewContentAvailable' });\r\n                    } else {\r\n                        // At this point, everything has been precached.\r\n                        // It's the perfect time to display a\r\n                        // \"Content is cached for offline use.\" message.\r\n                        console.log('[SW] Content is cached for offline use.');\r\n                    }\r\n                }\r\n            };\r\n        };\r\n    } catch (error) {\r\n        console.error('[SW] Error during service worker registration: ', error);\r\n    }\r\n}\r\n\r\nexport async function subscribeNotifications() {\r\n    try {\r\n        const registration = await navigator.serviceWorker.ready;\r\n\r\n        let pushSubscription = await registration.pushManager.getSubscription();\r\n        if (pushSubscription) await pushSubscription.unsubscribe();\r\n\r\n        pushSubscription = await registration.pushManager.subscribe({ userVisibleOnly: true });\r\n        console.log('[SW] Received push subscription: ', JSON.stringify(pushSubscription));\r\n\r\n        const { endpoint } = pushSubscription;\r\n        const p256dh_base64url = arrayBufferToBase64(pushSubscription.getKey('p256dh'));\r\n        const auth_base64url = arrayBufferToBase64(pushSubscription.getKey('auth'));\r\n\r\n        if (endpoint && p256dh_base64url && auth_base64url) {\r\n            const { authorizationState } = ApplicationStore;\r\n            if (isAuthorizationReady(authorizationState)) {\r\n                const deviceToken = {\r\n                    '@type': 'deviceTokenWebPush',\r\n                    endpoint,\r\n                    p256dh_base64url,\r\n                    auth_base64url\r\n                };\r\n                console.log('[SW] registerDevice', deviceToken);\r\n                const result = await TdLibController.send({\r\n                    '@type': 'registerDevice',\r\n                    device_token: deviceToken,\r\n                    other_user_ids: []\r\n                });\r\n                console.log('[SW] registerDevice result', result);\r\n            }\r\n        }\r\n    } catch (error) {\r\n        console.error('[SW] Error during service worker push subscription: ', error);\r\n        NotificationStore.enableSound = true;\r\n    }\r\n}\r\n\r\nasync function checkValidServiceWorker(swUrl) {\r\n    console.log('[SW] CheckValidServiceWorker');\r\n    // Check if the service worker can be found. If it can't reload the page.\r\n    try {\r\n        const response = await fetch(swUrl);\r\n\r\n        // Ensure service worker exists, and that we really are getting a JS file.\r\n        if (response.status === 404 || response.headers.get('content-type').indexOf('javascript') === -1) {\r\n            // No service worker found. Probably a different app. Reload the page.\r\n            const registration = await navigator.serviceWorker.ready;\r\n            await registration.unregister();\r\n\r\n            window.location.reload();\r\n        } else {\r\n            // Service worker found. Proceed as normal.\r\n            await registerValidSW(swUrl);\r\n        }\r\n    } catch (error) {\r\n        console.log('[SW] No internet connection found. App is running in offline mode.');\r\n    }\r\n}\r\n\r\nexport async function unregister() {\r\n    if ('serviceWorker' in navigator) {\r\n        const registration = await navigator.serviceWorker.ready;\r\n\r\n        await registration.unregister();\r\n    }\r\n}\r\n\r\nexport async function update() {\r\n    if ('serviceWorker' in navigator) {\r\n        const registration = await navigator.serviceWorker.ready;\r\n\r\n        await registration.update();\r\n    }\r\n}\r\n","/*\r\n *  Copyright (c) 2018-present, Evgeny Nadymov\r\n *\r\n * This source code is licensed under the GPL v.3.0 license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport React from 'react';\r\n\r\nexport function compose(...funcs) {\r\n    return funcs.reduce((a, b) => (...args) => a(b(...args)), arg => arg);\r\n}\r\n\r\nexport function withSaveRef() {\r\n    return Component => {\r\n        return React.forwardRef((props, ref) => <Component {...props} forwardedRef={ref} />);\r\n    };\r\n}\r\n\r\nexport function withRestoreRef() {\r\n    return Component => {\r\n        return class extends React.Component {\r\n            render() {\r\n                const { forwardedRef, ...rest } = this.props;\r\n\r\n                return <Component {...rest} ref={forwardedRef} />;\r\n            }\r\n        };\r\n    };\r\n}\r\n\r\nexport function getDisplayName(WrappedComponent) {\r\n    return WrappedComponent.displayName || WrappedComponent.name || 'Component';\r\n}\r\n","/*\r\n *  Copyright (c) 2018-present, Evgeny Nadymov\r\n *\r\n * This source code is licensed under the GPL v.3.0 license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport EventEmitter from './EventEmitter';\r\nimport { KEY_SUGGESTED_LANGUAGE_PACK_ID } from '../Constants';\r\nimport TdLibController from '../Controllers/TdLibController';\r\n\r\nclass OptionStore extends EventEmitter {\r\n    constructor() {\r\n        super();\r\n\r\n        this.reset();\r\n\r\n        this.addTdLibListener();\r\n    }\r\n\r\n    reset = () => {\r\n        this.items = new Map();\r\n    };\r\n\r\n    onUpdate = update => {\r\n        switch (update['@type']) {\r\n            case 'updateAuthorizationState': {\r\n                const { authorization_state } = update;\r\n                if (!authorization_state) break;\r\n\r\n                switch (authorization_state['@type']) {\r\n                    case 'authorizationStateClosed': {\r\n                        this.reset();\r\n                        break;\r\n                    }\r\n                }\r\n\r\n                break;\r\n            }\r\n            case 'updateOption':\r\n                const { name, value } = update;\r\n\r\n                this.set(name, value);\r\n\r\n                if (name === KEY_SUGGESTED_LANGUAGE_PACK_ID) {\r\n                    localStorage.setItem(name, value.value);\r\n                }\r\n\r\n                this.emit('updateOption', update);\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    };\r\n\r\n    onClientUpdate = update => {};\r\n\r\n    addTdLibListener = () => {\r\n        TdLibController.on('update', this.onUpdate);\r\n        TdLibController.on('clientUpdate', this.onClientUpdate);\r\n    };\r\n\r\n    removeTdLibListener = () => {\r\n        TdLibController.off('update', this.onUpdate);\r\n        TdLibController.off('clientUpdate', this.onClientUpdate);\r\n    };\r\n\r\n    get(name) {\r\n        return this.items.get(name);\r\n    }\r\n\r\n    set(name, value) {\r\n        this.items.set(name, value);\r\n    }\r\n}\r\n\r\nconst store = new OptionStore();\r\nwindow.option = store;\r\nexport default store;\r\n","class Storage {\r\n    constructor(options) {\r\n        this.store = options.store;\r\n    }\r\n\r\n    setItem(key, value) {\r\n        if (!this.store) return;\r\n\r\n        try {\r\n            this.store.setItem(key, value);\r\n        } catch (e) {}\r\n    }\r\n\r\n    getItem(key, value) {\r\n        if (!this.store) return;\r\n\r\n        try {\r\n            return this.store.getItem(key, value);\r\n        } catch (e) {}\r\n\r\n        return undefined;\r\n    }\r\n}\r\n\r\nfunction getDefaults() {\r\n    return {\r\n        prefix: 'i18next_res_',\r\n        expirationTime: Infinity,\r\n        versions: {},\r\n        store: window.localStorage\r\n    };\r\n}\r\n\r\nclass Cache {\r\n    constructor(services, options = {}) {\r\n        this.init(services, options);\r\n\r\n        this.type = 'backend';\r\n    }\r\n\r\n    init(services, options = {}) {\r\n        this.services = services;\r\n        this.options = { ...getDefaults(), ...this.options, ...options };\r\n        this.storage = new Storage(this.options);\r\n    }\r\n\r\n    read(language, namespace, callback) {\r\n        const nowMS = new Date().getTime();\r\n\r\n        if (!this.storage.store) {\r\n            return callback(null, null);\r\n        }\r\n\r\n        let local = this.storage.getItem(`${this.options.prefix}${language}-${namespace}`);\r\n\r\n        if (local) {\r\n            local = JSON.parse(local);\r\n            if (\r\n                // expiration field is mandatory, and should not be expired\r\n                local.i18nStamp &&\r\n                local.i18nStamp + this.options.expirationTime > nowMS &&\r\n                // there should be no language version set, or if it is, it should match the one in translation\r\n                this.options.versions[language] === local.i18nVersion\r\n            ) {\r\n                delete local.i18nVersion;\r\n                delete local.i18nStamp;\r\n                return callback(null, local);\r\n            }\r\n        }\r\n\r\n        return callback(null, null);\r\n    }\r\n\r\n    save(language, namespace, data) {\r\n        if (this.storage.store) {\r\n            data.i18nStamp = new Date().getTime();\r\n\r\n            // language version (if set)\r\n            if (this.options.versions[language]) {\r\n                data.i18nVersion = this.options.versions[language];\r\n            }\r\n\r\n            // save\r\n            this.storage.setItem(`${this.options.prefix}${language}-${namespace}`, JSON.stringify(data));\r\n        }\r\n    }\r\n}\r\n\r\nCache.type = 'backend';\r\n\r\nexport default Cache;\r\n","/*\r\n *  Copyright (c) 2018-present, Evgeny Nadymov\r\n *\r\n * This source code is licensed under the GPL v.3.0 license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport EventEmitter from './EventEmitter';\r\nimport i18n from 'i18next';\r\nimport LocalizationCache from '../Localization/Cache';\r\nimport { initReactI18next } from 'react-i18next';\r\nimport TdLibController from '../Controllers/TdLibController';\r\n\r\nconst fallbackLng = 'en';\r\nconst defaultNS = 'translation';\r\nconst lng = localStorage.getItem('i18next') || fallbackLng;\r\n\r\ni18n.use(initReactI18next).init({\r\n    ns: [defaultNS, 'local'],\r\n    defaultNS,\r\n    fallbackNS: ['local', 'emoji', 'settings', 'translation', 'search'],\r\n    resources: {\r\n        en: {\r\n            search: {\r\n                ChatsAndContacts: 'Chats and contacts',\r\n                SearchMessagesIn: 'Search messages in'\r\n            },\r\n            settings: {\r\n                ContactJoinedEnabled: 'Enabled',\r\n                ContactJoinedDisabled: 'Disabled',\r\n                NotificationsEnabled: 'Enabled',\r\n                NotificationsDisabled: 'Disabled',\r\n                PreviewEnabled: 'Enabled',\r\n                PreviewDisabled: 'Disabled',\r\n                BioAbout: 'Any details such as age, occupation or city.\\nExample: 23 y.o. designer from San Francisco.',\r\n                Archived: 'Archived',\r\n                Saved: 'Saved',\r\n                EditProfile: 'Edit Profile',\r\n                GeneralSettings: 'General Settings'\r\n            },\r\n            local: {\r\n                PollQuizOneRightAnswer: 'Quiz has only one right answer.',\r\n                LeftChannel: 'Left channel',\r\n                LeftGroup: 'Left group',\r\n                EnterPassword: 'Enter a Password',\r\n                YourAccountProtectedWithPassword: 'Your account is protected with an additional password.',\r\n                DeletedMessage: 'Deleted message',\r\n                YourPhone: 'Your Phone',\r\n                SignInToTelegram: 'Sign in to Telegram',\r\n                PhoneNumber: 'Phone Number',\r\n                Country: 'Country',\r\n                KeepMeSignedIn: 'Keep me signed in',\r\n                StartText: 'Please confirm your country code and enter your phone number.',\r\n                Next: 'Next',\r\n                InvalidPhoneNumber: 'Invalid phone number. Please check the number and try again.',\r\n                More: 'More',\r\n                SendFileConfirmation: 'Are you sure you want to send file?',\r\n                SendFilesConfirmation: 'Are you sure you want to send files?',\r\n                SendMessage: 'Send Message',\r\n                ChatInfo: 'Chat Info',\r\n                ChannelInfo: 'Channel Info',\r\n                Stickers: 'STICKERS',\r\n                Emoji: 'EMOJI',\r\n                SelectChatToStartMessaging: 'Please select a chat to start messaging',\r\n                Text: 'Text',\r\n                ViewChannelInfo: 'View channel info',\r\n                ViewGroupInfo: 'View group info',\r\n                ViewProfile: 'View profile',\r\n                GoToMessage: 'Go to message',\r\n                PhotosTitle: 'Photos',\r\n                VideosTitle: 'Videos',\r\n                VoiceTitle: 'Voice messages',\r\n                UpdateDraftConfirmation: 'Are you sure you want to update draft?'\r\n            },\r\n            emoji: {\r\n                Search: 'Search',\r\n                NotEmojiFound: 'No Emoji Found',\r\n                ChooseDefaultSkinTone: 'Choose your default skin tone',\r\n                SearchResults: 'Search Results',\r\n                Recent: 'Frequently Used',\r\n                SmileysPeople: 'Smileys & People',\r\n                AnimalsNature: 'Animals & Nature',\r\n                FoodDrink: 'Food & Drink',\r\n                Activity: 'Activity',\r\n                TravelPlaces: 'Travel & Places',\r\n                Objects: 'Objects',\r\n                Symbols: 'Symbols',\r\n                Flags: 'Flags',\r\n                Custom: 'Custom'\r\n            },\r\n            translation: {\r\n                AppName: 'Telegram',\r\n                Connecting: 'Connecting...',\r\n                ConnectingToProxy: 'Connecting to proxy...',\r\n                Loading: 'Loading...',\r\n                Updating: 'Updating...',\r\n                WaitingForNetwork: 'Waiting for network...',\r\n                ContinueOnThisLanguage: 'Continue in English',\r\n                SendAsFile: 'Send as a file',\r\n                SendAsPhoto: 'Send as a photo'\r\n            }\r\n        },\r\n        ru: {\r\n            search: {\r\n                ChatsAndContacts: '  ',\r\n                SearchMessagesIn: '  '\r\n            },\r\n            settings: {\r\n                ContactJoinedEnabled: '',\r\n                ContactJoinedDisabled: '',\r\n                NotificationsEnabled: '',\r\n                NotificationsDisabled: '',\r\n                PreviewEnabled: '',\r\n                PreviewDisabled: '',\r\n                BioAbout:\r\n                    ' , : ,    .\\n: 23 ,   -.',\r\n                Archived: '',\r\n                Saved: '',\r\n                EditProfile: ' ',\r\n                GeneralSettings: ' '\r\n            },\r\n            local: {\r\n                PollQuizOneRightAnswer: 'Quiz has only one right answer.',\r\n                LeftChannel: ' ',\r\n                LeftGroup: ' ',\r\n                EnterPassword: ' ',\r\n                YourAccountProtectedWithPassword: '    .',\r\n                DeletedMessage: ' ',\r\n                YourPhone: ' ',\r\n                SignInToTelegram: '  Telegram',\r\n                PhoneNumber: ' ',\r\n                Country: '',\r\n                KeepMeSignedIn: ' ',\r\n                StartText: ',       .',\r\n                Next: '',\r\n                InvalidPhoneNumber: '  . ,      .',\r\n                More: '',\r\n                SendFileConfirmation: '    ?',\r\n                SendFilesConfirmation: '    ?',\r\n                SendMessage: ' ',\r\n                ChatInfo: '  ',\r\n                ChannelInfo: '  ',\r\n                Stickers: '',\r\n                Emoji: '',\r\n                SelectChatToStartMessaging: ', ,    ',\r\n                Text: '',\r\n                ViewChannelInfo: '  ',\r\n                ViewGroupInfo: '  ',\r\n                ViewProfile: ' ',\r\n                GoToMessage: '  ',\r\n                PhotosTitle: '',\r\n                VideosTitle: '',\r\n                VoiceTitle: ' ',\r\n                UpdateDraftConfirmation: '     ?'\r\n            },\r\n            emoji: {\r\n                Search: '',\r\n                NotEmojiFound: '  ',\r\n                ChooseDefaultSkinTone: '    ',\r\n                SearchResults: ' ',\r\n                Recent: ' ',\r\n                SmileysPeople: '  ',\r\n                AnimalsNature: '  ',\r\n                FoodDrink: '  ',\r\n                Activity: '',\r\n                TravelPlaces: '  ',\r\n                Objects: '',\r\n                Symbols: '',\r\n                Flags: '',\r\n                Custom: ''\r\n            },\r\n            translation: {\r\n                AppName: 'Telegram',\r\n                Connecting: '...',\r\n                ConnectingToProxy: '  ...',\r\n                Loading: '...',\r\n                Updating: '...',\r\n                WaitingForNetwork: ' ...',\r\n                ContinueOnThisLanguage: '  ',\r\n                SendAsFile: '  ',\r\n                SendAsPhoto: '  '\r\n            }\r\n        }\r\n    },\r\n    lng,\r\n    fallbackLng,\r\n    interpolation: {\r\n        escapeValue: false\r\n    },\r\n    react: {\r\n        wait: false\r\n    }\r\n});\r\n\r\nconst cache = new LocalizationCache(null, {\r\n    enabled: true,\r\n    prefix: 'i18next_res_',\r\n    expirationTime: Infinity\r\n});\r\n\r\nconst defaultResources = cache.read(fallbackLng, defaultNS, (err, data) => data);\r\nconst currentResources = cache.read(lng, defaultNS, (err, data) => data);\r\n\r\ni18n.addResourceBundle(fallbackLng, defaultNS, defaultResources);\r\ni18n.addResourceBundle(lng, defaultNS, currentResources);\r\n\r\nclass LocalizationStore extends EventEmitter {\r\n    constructor() {\r\n        super();\r\n\r\n        this.fallbackLng = fallbackLng;\r\n        this.i18n = i18n;\r\n        this.cache = cache;\r\n\r\n        this.addTdLibListener();\r\n    }\r\n\r\n    addTdLibListener = () => {\r\n        TdLibController.on('update', this.onUpdate);\r\n        TdLibController.on('clientUpdate', this.onClientUpdate);\r\n    };\r\n\r\n    removeTdLibListener = () => {\r\n        TdLibController.off('update', this.onUpdate);\r\n        TdLibController.off('clientUpdate', this.onClientUpdate);\r\n    };\r\n\r\n    onUpdate = async update => {\r\n        switch (update['@type']) {\r\n            case 'updateAuthorizationState': {\r\n                switch (update.authorization_state['@type']) {\r\n                    case 'authorizationStateWaitTdlibParameters':\r\n                        TdLibController.send({\r\n                            '@type': 'setOption',\r\n                            name: 'localization_target',\r\n                            value: { '@type': 'optionValueString', value: 'android' }\r\n                        });\r\n\r\n                        TdLibController.send({\r\n                            '@type': 'setOption',\r\n                            name: 'language_pack_id',\r\n                            value: { '@type': 'optionValueString', value: lng }\r\n                        });\r\n\r\n                        this.info = await TdLibController.send({\r\n                            '@type': 'getLocalizationTargetInfo',\r\n                            only_local: false\r\n                        });\r\n\r\n                        TdLibController.clientUpdate({\r\n                            '@type': 'clientUpdateLanguageChange',\r\n                            language: lng\r\n                        });\r\n                        break;\r\n                }\r\n                break;\r\n            }\r\n            case 'updateLanguagePackStrings': {\r\n                // add/remove new strings\r\n\r\n                this.emit('updateLanguagePackStrings', update);\r\n                break;\r\n            }\r\n        }\r\n    };\r\n\r\n    onClientUpdate = async update => {\r\n        switch (update['@type']) {\r\n            case 'clientUpdateLanguageChange': {\r\n                const { language } = update;\r\n\r\n                await this.loadLanguage(language);\r\n\r\n                localStorage.setItem('i18next', language);\r\n\r\n                await i18n.changeLanguage(language);\r\n\r\n                TdLibController.send({\r\n                    '@type': 'setOption',\r\n                    name: 'language_pack_id',\r\n                    value: { '@type': 'optionValueString', value: language }\r\n                });\r\n\r\n                this.emit('clientUpdateLanguageChange', update);\r\n                break;\r\n            }\r\n        }\r\n    };\r\n\r\n    processStrings = (lng, languagePackStrings) => {\r\n        if (!languagePackStrings) return {};\r\n        const { strings } = languagePackStrings;\r\n        if (!strings) return {};\r\n\r\n        let result = {};\r\n        for (let i = 0; i < strings.length; i++) {\r\n            const { value } = strings[i];\r\n            switch (value['@type']) {\r\n                case 'languagePackStringValueOrdinary': {\r\n                    result[strings[i].key] = value.value;\r\n                    break;\r\n                }\r\n                case 'languagePackStringValuePluralized': {\r\n                    if (value.zero_value) {\r\n                        result[strings[i].key + 'Z'] = value.zero_value;\r\n                    }\r\n                    if (value.one_value) {\r\n                        result[strings[i].key + 'O'] = value.one_value;\r\n                    }\r\n                    if (value.two_value) {\r\n                        result[strings[i].key + 'T'] = value.two_value;\r\n                    }\r\n                    if (value.few_value) {\r\n                        result[strings[i].key + 'F'] = value.few_value;\r\n                    }\r\n                    if (value.many_value) {\r\n                        result[strings[i].key + 'M'] = value.many_value;\r\n                    }\r\n                    if (value.other_value) {\r\n                        result[strings[i].key + 'OT'] = value.other_value;\r\n                    }\r\n                    break;\r\n                }\r\n                case 'languagePackStringValueDeleted': {\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        return result;\r\n    };\r\n\r\n    loadLanguage = async language => {\r\n        const result = await TdLibController.send({\r\n            '@type': 'getLanguagePackStrings',\r\n            language_pack_id: language,\r\n            keys: []\r\n        });\r\n\r\n        const resources = this.processStrings(language, result);\r\n        this.cache.save(language, defaultNS, resources);\r\n        i18n.addResourceBundle(language, defaultNS, resources);\r\n    };\r\n}\r\n\r\nconst store = new LocalizationStore();\r\nwindow.localization = store;\r\nexport default store;\r\n","/*\r\n *  Copyright (c) 2018-present, Evgeny Nadymov\r\n *\r\n * This source code is licensed under the GPL v.3.0 license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport React from 'react';\r\nimport './HeaderProgress.css';\r\n\r\nclass HeaderProgress extends React.Component {\r\n    render() {\r\n        return (\r\n            <>\r\n                <span className='header-progress'>.</span>\r\n                <span className='header-progress'>.</span>\r\n                <span className='header-progress'>.</span>\r\n            </>\r\n        );\r\n    }\r\n}\r\n\r\nexport default HeaderProgress;\r\n","/*\r\n *  Copyright (c) 2018-present, Evgeny Nadymov\r\n *\r\n * This source code is licensed under the GPL v.3.0 license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport EventEmitter from './EventEmitter';\r\nimport OptionStore from '../Stores/OptionStore';\r\nimport TdLibController from '../Controllers/TdLibController';\r\n\r\nclass UserStore extends EventEmitter {\r\n    constructor() {\r\n        super();\r\n\r\n        this.reset();\r\n\r\n        this.addTdLibListener();\r\n    }\r\n\r\n    reset = () => {\r\n        this.items = new Map();\r\n        this.fullInfoItems = new Map();\r\n    };\r\n\r\n    onUpdate = update => {\r\n        switch (update['@type']) {\r\n            case 'updateAuthorizationState': {\r\n                const { authorization_state } = update;\r\n                if (!authorization_state) break;\r\n\r\n                switch (authorization_state['@type']) {\r\n                    case 'authorizationStateClosed': {\r\n                        this.reset();\r\n                        break;\r\n                    }\r\n                }\r\n\r\n                break;\r\n            }\r\n            case 'updateUser': {\r\n                this.set(update.user);\r\n\r\n                this.emit(update['@type'], update);\r\n                break;\r\n            }\r\n            case 'updateUserFullInfo':\r\n                this.setFullInfo(update.user_id, update.user_full_info);\r\n\r\n                this.emit(update['@type'], update);\r\n                break;\r\n            case 'updateUserStatus': {\r\n                let user = this.get(update.user_id);\r\n                if (user) {\r\n                    this.assign(user, { status: update.status });\r\n                }\r\n\r\n                this.emit(update['@type'], update);\r\n                break;\r\n            }\r\n            default:\r\n                break;\r\n        }\r\n    };\r\n\r\n    onClientUpdate = update => {\r\n        switch (update['@type']) {\r\n            case 'clientUpdateOpenUser': {\r\n                this.emit(update['@type'], update);\r\n                break;\r\n            }\r\n            default:\r\n                break;\r\n        }\r\n    };\r\n\r\n    addTdLibListener = () => {\r\n        TdLibController.on('update', this.onUpdate);\r\n        TdLibController.on('clientUpdate', this.onClientUpdate);\r\n    };\r\n\r\n    removeTdLibListener = () => {\r\n        TdLibController.off('update', this.onUpdate);\r\n        TdLibController.off('clientUpdate', this.onClientUpdate);\r\n    };\r\n\r\n    assign(source1, source2) {\r\n        Object.assign(source1, source2);\r\n        //this.set(Object.assign({}, source1, source2));\r\n    }\r\n\r\n    getMyId() {\r\n        const myId = OptionStore.get('my_id');\r\n        if (!myId) return null;\r\n        if (!myId.value) return null;\r\n\r\n        return myId.value;\r\n    }\r\n\r\n    get(userId) {\r\n        return this.items.get(userId);\r\n    }\r\n\r\n    set(user) {\r\n        this.items.set(user.id, user);\r\n    }\r\n\r\n    getFullInfo(id) {\r\n        return this.fullInfoItems.get(id);\r\n    }\r\n\r\n    setFullInfo(id, fullInfo) {\r\n        this.fullInfoItems.set(id, fullInfo);\r\n    }\r\n}\r\n\r\nconst store = new UserStore();\r\nwindow.user = store;\r\nexport default store;\r\n","/*\r\n *  Copyright (c) 2018-present, Evgeny Nadymov\r\n *\r\n * This source code is licensed under the GPL v.3.0 license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nlet data = null;\r\nexport async function loadData() {\r\n    if (data) return;\r\n\r\n    try {\r\n        const response = await fetch('data/countries.txt');\r\n        const text = await response.text();\r\n\r\n        const lines = text.split('\\n');\r\n        const data2 = [];\r\n        lines.forEach(x => {\r\n            const split = x.split(';');\r\n            const item = {\r\n                prefix: split[0],\r\n                code: split[1],\r\n                name: split[2],\r\n                pattern: split[3],\r\n                count: Number(split[4]),\r\n                emoji: split[5]\r\n            };\r\n            data2.push(item);\r\n        });\r\n        data2.forEach(x => {\r\n            x.phone = '+' + x.prefix;\r\n        });\r\n\r\n        data = data2.filter(x => x.emoji);\r\n\r\n        return data;\r\n    } catch (error) {\r\n        console.error(error);\r\n    }\r\n}\r\n\r\nfunction clearPhone(phone) {\r\n    if (!phone) return phone;\r\n\r\n    return phone\r\n        .replace(/ /g, '')\r\n        .replace('+', '')\r\n        .toLowerCase();\r\n}\r\n\r\nfunction isPhoneWithOptionCode(phone, option) {\r\n    if (!phone) return false;\r\n    if (!option) return false;\r\n\r\n    phone = clearPhone(phone);\r\n    const code = clearPhone(option.phone);\r\n\r\n    return phone.startsWith(code) && option.pattern;\r\n}\r\n\r\nfunction getCountryFromPhone(phone, data) {\r\n    if (!data) return null;\r\n\r\n    const index = data.findIndex(x => isPhoneWithOptionCode(phone, x));\r\n\r\n    return index !== -1 ? data[index] : null;\r\n}\r\n\r\nfunction formatByPattern(phone, pattern) {\r\n    phone = clearPhone(phone);\r\n\r\n    let result = '';\r\n    let index = 0;\r\n    for (let i = 0; i < pattern.length && index < phone.length; i++) {\r\n        if (pattern[i] >= '0' && pattern[i] <= '9') {\r\n            result += pattern[i];\r\n            if (phone[index] === pattern[i]) {\r\n                index++;\r\n            }\r\n        } else if (pattern[i] === ' ') {\r\n            result += pattern[i];\r\n        } else if (pattern[i] === 'X') {\r\n            result += phone[index++];\r\n        }\r\n    }\r\n\r\n    result += ' ' + phone.substring(index);\r\n\r\n    return '+' + result;\r\n}\r\n\r\nexport function formatPhoneNumber(phone) {\r\n    if (!phone) return phone;\r\n    if (!data) return phone.startsWith('+') ? phone : '+' + phone;\r\n\r\n    const country = getCountryFromPhone(phone, data);\r\n    if (!country) return phone.startsWith('+') ? phone : '+' + phone;\r\n\r\n    return formatByPattern(phone, country.pattern);\r\n}\r\n"],"sourceRoot":""}